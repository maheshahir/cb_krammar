D, [2018-09-12T21:20:20.812862 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mSHOW server_version;[0m
D, [2018-09-12T21:20:20.880677 #11095] DEBUG -- :   [1m[36mStore Load (3.4ms)[0m  [1m[34mSELECT "stores".* FROM "stores" WHERE "stores"."store_object_id" = 3 AND "stores"."o_id" = $1 ORDER BY created_at ASC, id ASC[0m  [["o_id", 2]]
D, [2018-09-12T21:20:20.896760 #11095] DEBUG -- :   [1m[36mStore Load (0.2ms)[0m  [1m[34mSELECT  "stores".* FROM "stores" WHERE "stores"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
D, [2018-09-12T21:20:20.900349 #11095] DEBUG -- :   [1m[36mStore::File Load (1.3ms)[0m  [1m[34mSELECT  "store_files".* FROM "store_files" WHERE "store_files"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:20:20.913801 #11095] DEBUG -- :   [1m[36mStore::Provider::DB Load (2.1ms)[0m  [1m[34mSELECT  "store_provider_dbs".* FROM "store_provider_dbs" WHERE "store_provider_dbs"."sha" = $1 LIMIT $2[0m  [["sha", "8180fbd3b72f3fbf6e4e22d187ee0632ad7b63f72c6bcf22e59ed4d0ba381b24"], ["LIMIT", 1]]
D, [2018-09-12T21:20:20.922256 #11095] DEBUG -- :   [1m[36mSetting Load (1.7ms)[0m  [1m[34mSELECT  "settings".* FROM "settings" WHERE "settings"."name" = $1 LIMIT $2[0m  [["name", "product_logo"], ["LIMIT", 1]]
D, [2018-09-12T21:20:20.935047 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:20:20.948026 #11095] DEBUG -- : Setting.reset_change_id: set new cache, 435222474
D, [2018-09-12T21:20:20.948709 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:20:20.949856 #11095]  INFO -- : Setting.set('product_logo', "73a4aa758e6629c9ad420d2e312af0a0.png")
D, [2018-09-12T21:20:20.950413 #11095] DEBUG -- :   [1m[36mStore::File Load (0.3ms)[0m  [1m[34mSELECT  "store_files".* FROM "store_files" WHERE "store_files"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:20:20.951050 #11095] DEBUG -- :   [1m[36mStore::Provider::DB Load (0.2ms)[0m  [1m[34mSELECT  "store_provider_dbs".* FROM "store_provider_dbs" WHERE "store_provider_dbs"."sha" = $1 LIMIT $2[0m  [["sha", "8180fbd3b72f3fbf6e4e22d187ee0632ad7b63f72c6bcf22e59ed4d0ba381b24"], ["LIMIT", 1]]
D, [2018-09-12T21:20:20.951938 #11095] DEBUG -- :   [1m[36mStore::File Load (0.2ms)[0m  [1m[34mSELECT  "store_files".* FROM "store_files" WHERE "store_files"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:20:20.952471 #11095] DEBUG -- :   [1m[36mStore::Provider::DB Load (0.2ms)[0m  [1m[34mSELECT  "store_provider_dbs".* FROM "store_provider_dbs" WHERE "store_provider_dbs"."sha" = $1 LIMIT $2[0m  [["sha", "8180fbd3b72f3fbf6e4e22d187ee0632ad7b63f72c6bcf22e59ed4d0ba381b24"], ["LIMIT", 1]]
D, [2018-09-12T21:20:21.859603 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT  "settings"."updated_at" FROM "settings" ORDER BY "settings"."updated_at" DESC LIMIT $1[0m  [["LIMIT", 1]]
D, [2018-09-12T21:20:21.860328 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "settings"."name", "settings"."state_current" FROM "settings" ORDER BY "settings"."id" ASC[0m
D, [2018-09-12T21:20:21.872020 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT  "settings".* FROM "settings" WHERE "settings"."name" = $1 LIMIT $2[0m  [["name", "models_searchable"], ["LIMIT", 1]]
I, [2018-09-12T21:38:54.401694 #11095]  INFO -- : Started GET "/" for ::1 at 2018-09-12 21:38:54 +0530
D, [2018-09-12T21:38:54.448028 #11095] DEBUG -- :   [1m[35m (1.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
I, [2018-09-12T21:38:54.524979 #11095]  INFO -- : Processing by InitController#index as HTML
I, [2018-09-12T21:38:54.545457 #11095]  INFO -- :   Rendering init/index.html.erb within layouts/application
I, [2018-09-12T21:38:54.546314 #11095]  INFO -- :   Rendered init/index.html.erb within layouts/application (0.7ms)
D, [2018-09-12T21:38:55.059197 #11095] DEBUG -- :   [1m[36mSetting Load (0.7ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:38:55.059703 #11095]  INFO -- : Completed 200 OK in 535ms (Views: 515.3ms | ActiveRecord: 8.1ms)


D, [2018-09-12T21:38:55.060877 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:38:55.062139 #11095] DEBUG -- :   [1m[35mSQL (0.2ms)[0m  [1m[33mUPDATE "sessions" SET "data" = $1, "updated_at" = $2 WHERE "sessions"."id" = $3[0m  [["data", "BAh7CEkiCXBpbmcGOgZFRkkiGTIwMTgtMDktMTJUMTY6MDg6NTRaBjsAVEki\nD3VzZXJfYWdlbnQGOwBGIm5Nb3ppbGxhLzUuMCAoWDExOyBMaW51eCB4ODZf\nNjQpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENo\ncm9tZS82OC4wLjM0NDAuMTA2IFNhZmFyaS81MzcuMzZJIhBfY3NyZl90b2tl\nbgY7AEZJIjE1SzlmTEZWTnRwVFYydjArWGQ1M21QMjFWbDAzT1RSeEp2cUpm\nbitDRDUwPQY7AEY=\n"], ["updated_at", "2018-09-12 16:08:55.061074"], ["id", 33]]
D, [2018-09-12T21:38:55.063249 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:38:55.070738 #11095]  INFO -- : Started GET "/assets/application.css" for ::1 at 2018-09-12 21:38:55 +0530
I, [2018-09-12T21:38:55.091604 #11095]  INFO -- : Started GET "/assets/application.js" for ::1 at 2018-09-12 21:38:55 +0530
D, [2018-09-12T21:38:55.113032 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:38:55.114411 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:38:55.131662 #11095]  INFO -- : Started GET "/assets/application-print.css" for ::1 at 2018-09-12 21:38:55 +0530
D, [2018-09-12T21:38:55.214350 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:38:55.220067 #11095] DEBUG -- :   [1m[35m (2.5ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:38:55.220452 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:38:55.221753 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:38:55.495132 #11095]  INFO -- : Started POST "/api/v1/signshow" for ::1 at 2018-09-12 21:38:55 +0530
I, [2018-09-12T21:38:55.514098 #11095]  INFO -- : Processing by SessionsController#show as JSON
I, [2018-09-12T21:38:55.514161 #11095]  INFO -- :   Parameters: {"fingerprint"=>"-1992429858"}
D, [2018-09-12T21:38:55.518039 #11095] DEBUG -- :   [1m[36mObjectManager::Attribute Load (1.4ms)[0m  [1m[34mSELECT "object_manager_attributes".* FROM "object_manager_attributes" WHERE "object_manager_attributes"."object_lookup_id" = $1 AND "object_manager_attributes"."active" = $2 AND "object_manager_attributes"."to_create" = $3 AND "object_manager_attributes"."to_delete" = $4 ORDER BY position ASC, name ASC[0m  [["object_lookup_id", 2], ["active", "t"], ["to_create", "f"], ["to_delete", "f"]]
D, [2018-09-12T21:38:55.523730 #11095] DEBUG -- :   [1m[36mObjectManager::Attribute Load (0.5ms)[0m  [1m[34mSELECT "object_manager_attributes".* FROM "object_manager_attributes" WHERE "object_manager_attributes"."object_lookup_id" = $1 AND "object_manager_attributes"."active" = $2 AND "object_manager_attributes"."to_create" = $3 AND "object_manager_attributes"."to_delete" = $4 ORDER BY position ASC, name ASC[0m  [["object_lookup_id", 3], ["active", "t"], ["to_create", "f"], ["to_delete", "f"]]
D, [2018-09-12T21:38:55.530601 #11095] DEBUG -- :   [1m[36mObjectManager::Attribute Load (0.9ms)[0m  [1m[34mSELECT "object_manager_attributes".* FROM "object_manager_attributes" WHERE "object_manager_attributes"."object_lookup_id" = $1 AND "object_manager_attributes"."active" = $2 AND "object_manager_attributes"."to_create" = $3 AND "object_manager_attributes"."to_delete" = $4 ORDER BY position ASC, name ASC[0m  [["object_lookup_id", 1], ["active", "t"], ["to_create", "f"], ["to_delete", "f"]]
D, [2018-09-12T21:38:55.540077 #11095] DEBUG -- :   [1m[36mObjectManager::Attribute Load (0.5ms)[0m  [1m[34mSELECT "object_manager_attributes".* FROM "object_manager_attributes" WHERE "object_manager_attributes"."object_lookup_id" = $1 AND "object_manager_attributes"."active" = $2 AND "object_manager_attributes"."to_create" = $3 AND "object_manager_attributes"."to_delete" = $4 ORDER BY position ASC, name ASC[0m  [["object_lookup_id", 4], ["active", "t"], ["to_create", "f"], ["to_delete", "f"]]
D, [2018-09-12T21:38:55.543606 #11095] DEBUG -- :   [1m[36mObjectManager::Attribute Load (0.4ms)[0m  [1m[34mSELECT "object_manager_attributes".* FROM "object_manager_attributes" WHERE "object_manager_attributes"."object_lookup_id" = $1 AND "object_manager_attributes"."active" = $2 AND "object_manager_attributes"."to_create" = $3 AND "object_manager_attributes"."to_delete" = $4 ORDER BY position ASC, name ASC[0m  [["object_lookup_id", 5], ["active", "t"], ["to_create", "f"], ["to_delete", "f"]]
D, [2018-09-12T21:38:55.548749 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT name, preferences FROM "settings" WHERE "settings"."frontend" = $1[0m  [["frontend", "t"]]
D, [2018-09-12T21:38:55.567240 #11095] DEBUG -- :   [1m[36mLocale Load (1.2ms)[0m  [1m[34mSELECT "locales".* FROM "locales" WHERE "locales"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T21:38:55.584469 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:38:55.585309 #11095]  INFO -- : Completed 200 OK in 71ms (Views: 18.7ms | ActiveRecord: 5.7ms)


D, [2018-09-12T21:38:55.586420 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:38:55.588224 #11095] DEBUG -- :   [1m[35mSQL (0.4ms)[0m  [1m[33mUPDATE "sessions" SET "data" = $1, "updated_at" = $2 WHERE "sessions"."id" = $3[0m  [["data", "BAh7CEkiCXBpbmcGOgZFRkkiGTIwMTgtMDktMTJUMTY6MDg6NTVaBjsAVEki\nD3VzZXJfYWdlbnQGOwBGIm5Nb3ppbGxhLzUuMCAoWDExOyBMaW51eCB4ODZf\nNjQpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENo\ncm9tZS82OC4wLjM0NDAuMTA2IFNhZmFyaS81MzcuMzZJIhBfY3NyZl90b2tl\nbgY7AEZJIjE1SzlmTEZWTnRwVFYydjArWGQ1M21QMjFWbDAzT1RSeEp2cUpm\nbitDRDUwPQY7AEY=\n"], ["updated_at", "2018-09-12 16:08:55.586660"], ["id", 33]]
D, [2018-09-12T21:38:55.589404 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:38:55.598465 #11095]  INFO -- : Started GET "/api/v1/translations/lang/en-us?_=1536768535402" for ::1 at 2018-09-12 21:38:55 +0530
I, [2018-09-12T21:38:55.622934 #11095]  INFO -- : Processing by TranslationsController#lang as JSON
I, [2018-09-12T21:38:55.623028 #11095]  INFO -- :   Parameters: {"_"=>"1536768535402", "locale"=>"en-us"}
D, [2018-09-12T21:38:55.626271 #11095] DEBUG -- :   [1m[36mSetting Load (0.8ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:38:55.632082 #11095]  INFO -- : Completed 200 OK in 9ms (Views: 0.6ms | ActiveRecord: 0.8ms)


D, [2018-09-12T21:38:55.633392 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:38:55.634152 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:38:55.638906 #11095]  INFO -- : Started GET "/ws" for ::1 at 2018-09-12 21:38:55 +0530
D, [2018-09-12T21:38:55.659437 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:38:55.661347 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
F, [2018-09-12T21:38:55.662252 #11095] FATAL -- :   
F, [2018-09-12T21:38:55.662310 #11095] FATAL -- : ActionController::RoutingError (No route matches [GET] "/ws"):
F, [2018-09-12T21:38:55.662356 #11095] FATAL -- :   
F, [2018-09-12T21:38:55.662441 #11095] FATAL -- : actionpack (5.1.5) lib/action_dispatch/middleware/debug_exceptions.rb:63:in `call'
actionpack (5.1.5) lib/action_dispatch/middleware/show_exceptions.rb:31:in `call'
railties (5.1.5) lib/rails/rack/logger.rb:36:in `call_app'
railties (5.1.5) lib/rails/rack/logger.rb:24:in `block in call'
activesupport (5.1.5) lib/active_support/tagged_logging.rb:69:in `block in tagged'
activesupport (5.1.5) lib/active_support/tagged_logging.rb:26:in `tagged'
activesupport (5.1.5) lib/active_support/tagged_logging.rb:69:in `tagged'
railties (5.1.5) lib/rails/rack/logger.rb:24:in `call'
actionpack (5.1.5) lib/action_dispatch/middleware/remote_ip.rb:79:in `call'
actionpack (5.1.5) lib/action_dispatch/middleware/request_id.rb:25:in `call'
rack (2.0.5) lib/rack/method_override.rb:22:in `call'
rack (2.0.5) lib/rack/runtime.rb:22:in `call'
activesupport (5.1.5) lib/active_support/cache/strategy/local_cache_middleware.rb:27:in `call'
actionpack (5.1.5) lib/action_dispatch/middleware/executor.rb:12:in `call'
actionpack (5.1.5) lib/action_dispatch/middleware/static.rb:125:in `call'
rack (2.0.5) lib/rack/sendfile.rb:111:in `call'
railties (5.1.5) lib/rails/engine.rb:522:in `call'
puma (3.11.0) lib/puma/configuration.rb:225:in `call'
puma (3.11.0) lib/puma/server.rb:624:in `handle_request'
puma (3.11.0) lib/puma/server.rb:438:in `process_client'
puma (3.11.0) lib/puma/server.rb:302:in `block in run'
puma (3.11.0) lib/puma/thread_pool.rb:120:in `block in spawn_thread'
logging (2.2.2) lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'
I, [2018-09-12T21:38:55.843818 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 21:38:55 +0530
I, [2018-09-12T21:38:55.858200 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T21:38:55.858265 #11095]  INFO -- :   Parameters: {"data"=>{"event"=>"login"}}
I, [2018-09-12T21:38:55.858583 #11095]  INFO -- : client(668100529) new client connection
D, [2018-09-12T21:38:55.860101 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:38:55.860468 #11095]  INFO -- : Completed 200 OK in 2ms (Views: 0.1ms | ActiveRecord: 0.4ms)


D, [2018-09-12T21:38:55.861200 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:38:55.861922 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:38:55.865932 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:38:55 +0530
I, [2018-09-12T21:38:55.874793 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 21:38:55 +0530
I, [2018-09-12T21:38:55.888089 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:38:55.888186 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
I, [2018-09-12T21:38:55.890130 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T21:38:55.890209 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"login", "fingerprint"=>"-1992429858"}}
D, [2018-09-12T21:38:55.891790 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:38:55.892171 #11095]  INFO -- : Completed 200 OK in 2ms (Views: 0.1ms | ActiveRecord: 0.3ms)


D, [2018-09-12T21:38:55.892958 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:38:55.893524 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:38:57.449533 #11095]  INFO -- : Started POST "/api/v1/signin" for ::1 at 2018-09-12 21:38:57 +0530
I, [2018-09-12T21:38:57.465169 #11095]  INFO -- : Processing by SessionsController#create as JSON
I, [2018-09-12T21:38:57.465249 #11095]  INFO -- :   Parameters: {"username"=>"vaibhav.dkm@gmail.com", "password"=>"[FILTERED]", "fingerprint"=>"-1992429858"}
D, [2018-09-12T21:38:57.469841 #11095] DEBUG -- :   [1m[36mUser Load (3.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."login" = $1 LIMIT $2[0m  [["login", "vaibhav.dkm@gmail.com"], ["LIMIT", 1]]
D, [2018-09-12T21:39:02.903019 #11095] DEBUG -- :   [1m[36mSetting Load (4.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:39:02.904571 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.5ms | ActiveRecord: 4.0ms)


D, [2018-09-12T21:39:02.907262 #11095] DEBUG -- :   [1m[36mSetting Load (4.6ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1[0m  [["area", "Security::Authentication"]]
D, [2018-09-12T21:39:02.913464 #11095] DEBUG -- :   [1m[35m (6.7ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:39:02.914312 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:39:02.919040 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:39:02 +0530
I, [2018-09-12T21:39:02.932523 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:39:02.932638 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
I, [2018-09-12T21:39:03.061172 #11095]  INFO -- : Authentication against Auth::Internal for user vaibhav.dkm@gmail.com ok.
D, [2018-09-12T21:39:03.061674 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:39:03.062783 #11095] DEBUG -- :   [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."login" = $1 LIMIT $2[0m  [["login", "vaibhav.dkm@gmail.com"], ["LIMIT", 1]]
D, [2018-09-12T21:39:03.081242 #11095] DEBUG -- :   [1m[35m (1.7ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:39:03.085233 #11095] DEBUG -- :   [1m[36mRole Load (0.3ms)[0m  [1m[34mSELECT "roles".* FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:39:03.092017 #11095] DEBUG -- :   [1m[36mPermission Load (1.2ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" INNER JOIN "permissions_roles" ON "permissions"."id" = "permissions_roles"."permission_id" WHERE "permissions_roles"."role_id" = $1[0m  [["role_id", 1]]
D, [2018-09-12T21:39:03.093906 #11095] DEBUG -- :   [1m[36mPermission Load (0.3ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions" INNER JOIN "permissions_roles" ON "permissions"."id" = "permissions_roles"."permission_id" WHERE "permissions_roles"."role_id" = $1[0m  [["role_id", 2]]
D, [2018-09-12T21:39:03.097660 #11095] DEBUG -- :   [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:39:03.101872 #11095] DEBUG -- :   [1m[35mSQL (1.3ms)[0m  [1m[33mUPDATE "users" SET "last_login" = $1, "updated_by_id" = $2, "updated_at" = $3 WHERE "users"."id" = $4[0m  [["last_login", "2018-09-12 16:09:03.061000"], ["updated_by_id", 1], ["updated_at", "2018-09-12 16:09:03.081000"], ["id", 3]]
D, [2018-09-12T21:39:03.104037 #11095] DEBUG -- : User.find(3) notify UPDATED 2018-09-12 16:09:03 UTC
D, [2018-09-12T21:39:09.949942 #11095] DEBUG -- :   [1m[36mSetting Load (6.8ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:39:09.950398 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.5ms | ActiveRecord: 6.8ms)


D, [2018-09-12T21:39:09.951999 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:39:09.952905 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:39:09.964874 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:39:09 +0530
D, [2018-09-12T21:39:09.973864 #11095] DEBUG -- :   [1m[35mSQL (9.4ms)[0m  [1m[32mINSERT INTO "delayed_jobs" ("handler", "run_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["handler", "--- !ruby/object:BackgroundJobSearchIndex\nobject: User\no_id: 3\n"], ["run_at", "2018-09-12 16:09:09.963526"], ["created_at", "2018-09-12 16:09:09.963000"], ["updated_at", "2018-09-12 16:09:09.963000"]]
I, [2018-09-12T21:39:09.978568 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:39:09.980152 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:39:09.981321 #11095] DEBUG -- :   [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:39:09.988350 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:39:16.993182 #11095] DEBUG -- :   [1m[36mSetting Load (3.6ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:39:16.994638 #11095]  INFO -- : Completed 200 OK in 7014ms (Views: 0.5ms | ActiveRecord: 3.6ms)


D, [2018-09-12T21:39:16.997490 #11095] DEBUG -- :   [1m[35m (4.7ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:39:16.998042 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:39:17.003430 #11095] DEBUG -- :   [1m[35mSQL (2.0ms)[0m  [1m[32mINSERT INTO "delayed_jobs" ("handler", "run_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["handler", "--- !ruby/object:Observer::UserDeviceLogJob\nhttp_user_agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko)\n  Chrome/68.0.3440.106 Safari/537.36\nremote_ip: \"::1\"\nuser_id: 3\nfingerprint: \"-1992429858\"\ntype: session\n"], ["run_at", "2018-09-12 16:09:16.998581"], ["created_at", "2018-09-12 16:09:16.998000"], ["updated_at", "2018-09-12 16:09:16.998000"]]
D, [2018-09-12T21:39:17.004916 #11095] DEBUG -- :   [1m[35m (1.9ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:39:17.012182 #11095] DEBUG -- :   [1m[35m (7.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:39:17.019709 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:39:17 +0530
D, [2018-09-12T21:39:17.049146 #11095] DEBUG -- :   [1m[36mActivityStream Load (29.5ms)[0m  [1m[34mSELECT  "activity_streams".* FROM "activity_streams" WHERE "activity_streams"."o_id" = $1 AND "activity_streams"."permission_id" = $2 AND "activity_streams"."activity_stream_object_id" = $3 AND "activity_streams"."created_by_id" = $4 ORDER BY created_at DESC, id DESC LIMIT $5[0m  [["o_id", 3], ["permission_id", 2], ["activity_stream_object_id", 1], ["created_by_id", 3], ["LIMIT", 1]]
I, [2018-09-12T21:39:17.053564 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
D, [2018-09-12T21:39:17.053763 #11095] DEBUG -- :   [1m[35m (3.0ms)[0m  [1m[35mBEGIN[0m
I, [2018-09-12T21:39:17.053921 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:39:17.059666 #11095] DEBUG -- :   [1m[35mSQL (3.4ms)[0m  [1m[32mINSERT INTO "activity_streams" ("activity_stream_type_id", "activity_stream_object_id", "permission_id", "o_id", "created_by_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["activity_stream_type_id", 1], ["activity_stream_object_id", 1], ["permission_id", 2], ["o_id", 3], ["created_by_id", 3], ["created_at", "2018-09-12 16:09:17.012985"], ["updated_at", "2018-09-12 16:09:17.054000"]]
D, [2018-09-12T21:39:17.060997 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:39:17.071245 #11095] DEBUG -- :   [1m[35m (3.8ms)[0m  [1m[34mSELECT roles.id, organizations.id, tokens.id, authorizations.id FROM "users" LEFT OUTER JOIN "roles_users" ON "roles_users"."user_id" = "users"."id" LEFT OUTER JOIN "roles" ON "roles"."id" = "roles_users"."role_id" LEFT OUTER JOIN "organizations_users" ON "organizations_users"."user_id" = "users"."id" LEFT OUTER JOIN "organizations" ON "organizations"."id" = "organizations_users"."organization_id" LEFT OUTER JOIN "tokens" ON "tokens"."user_id" = "users"."id" LEFT OUTER JOIN "authorizations" ON "authorizations"."user_id" = "users"."id" WHERE "users"."id" = $1[0m  [["id", 3]]
D, [2018-09-12T21:39:17.073469 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('ticket','ticket.agent') AND permissions.active = 't')[0m
D, [2018-09-12T21:39:17.078672 #11095] DEBUG -- :   [1m[35m (1.5ms)[0m  [1m[34mSELECT "groups"."id", "access" FROM "groups" INNER JOIN "groups_users" ON "groups"."id" = "groups_users"."group_id" WHERE "groups_users"."user_id" = $1 AND "groups"."active" = $2[0m  [["user_id", 3], ["active", "t"]]
D, [2018-09-12T21:39:17.081125 #11095] DEBUG -- :   [1m[36mAuthorization Load (0.2ms)[0m  [1m[34mSELECT "authorizations".* FROM "authorizations" WHERE "authorizations"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:39:17.085844 #11095] DEBUG -- :   [1m[36mMacro Load (1.2ms)[0m  [1m[34mSELECT "macros".* FROM "macros"[0m
D, [2018-09-12T21:39:17.087656 #11095] DEBUG -- :   [1m[36mTicket::StateType Load (0.8ms)[0m  [1m[34mSELECT "ticket_state_types".* FROM "ticket_state_types"[0m
D, [2018-09-12T21:39:17.090578 #11095] DEBUG -- :   [1m[36mTicket::State Load (1.0ms)[0m  [1m[34mSELECT "ticket_states".* FROM "ticket_states"[0m
D, [2018-09-12T21:39:17.093307 #11095] DEBUG -- :   [1m[36mTicket::Priority Load (0.8ms)[0m  [1m[34mSELECT "ticket_priorities".* FROM "ticket_priorities"[0m
D, [2018-09-12T21:39:17.095813 #11095] DEBUG -- :   [1m[36mTicket::Article::Type Load (0.8ms)[0m  [1m[34mSELECT "ticket_article_types".* FROM "ticket_article_types"[0m
D, [2018-09-12T21:39:17.110820 #11095] DEBUG -- :   [1m[36mTicket::Article::Sender Load (0.7ms)[0m  [1m[34mSELECT "ticket_article_senders".* FROM "ticket_article_senders"[0m
D, [2018-09-12T21:39:17.121935 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('ticket','ticket.agent') AND permissions.active = 't')[0m
D, [2018-09-12T21:39:17.124437 #11095] DEBUG -- :   [1m[36mSignature Load (2.0ms)[0m  [1m[34mSELECT "signatures".* FROM "signatures"[0m
D, [2018-09-12T21:39:17.125669 #11095] DEBUG -- :   [1m[36mEmailAddress Load (0.6ms)[0m  [1m[34mSELECT "email_addresses".* FROM "email_addresses"[0m
D, [2018-09-12T21:39:17.127922 #11095] DEBUG -- :   [1m[36mTaskbar Load (1.1ms)[0m  [1m[34mSELECT "taskbars".* FROM "taskbars" WHERE "taskbars"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:39:17.129786 #11095] DEBUG -- :   [1m[36mOnlineNotification Load (1.2ms)[0m  [1m[34mSELECT  "online_notifications".* FROM "online_notifications" WHERE "online_notifications"."user_id" = $1 ORDER BY created_at DESC, id DESC LIMIT $2[0m  [["user_id", 3], ["LIMIT", 200]]
D, [2018-09-12T21:39:17.147575 #11095] DEBUG -- :   [1m[36mTicket Load (4.9ms)[0m  [1m[34mSELECT  "tickets".* FROM "tickets" WHERE "tickets"."id" = $1 LIMIT $2[0m  [["id", 26], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.149981 #11095] DEBUG -- :   [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 59], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.150639 #11095] DEBUG -- :   [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.151708 #11095] DEBUG -- :   [1m[36mTicket Load (0.3ms)[0m  [1m[34mSELECT  "tickets".* FROM "tickets" WHERE "tickets"."id" = $1 LIMIT $2[0m  [["id", 25], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.152786 #11095] DEBUG -- :   [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 59], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.153201 #11095] DEBUG -- :   [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.154511 #11095] DEBUG -- :   [1m[36mTicket Load (0.6ms)[0m  [1m[34mSELECT  "tickets".* FROM "tickets" WHERE "tickets"."id" = $1 LIMIT $2[0m  [["id", 24], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.155281 #11095] DEBUG -- :   [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.155759 #11095] DEBUG -- :   [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.156710 #11095] DEBUG -- :   [1m[36mTicket Load (0.3ms)[0m  [1m[34mSELECT  "tickets".* FROM "tickets" WHERE "tickets"."id" = $1 LIMIT $2[0m  [["id", 23], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.158096 #11095] DEBUG -- :   [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 58], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.158556 #11095] DEBUG -- :   [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.159597 #11095] DEBUG -- :   [1m[36mTicket Load (0.3ms)[0m  [1m[34mSELECT  "tickets".* FROM "tickets" WHERE "tickets"."id" = $1 LIMIT $2[0m  [["id", 22], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.160896 #11095] DEBUG -- :   [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.161222 #11095] DEBUG -- :   [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.162012 #11095] DEBUG -- :   [1m[36mTicket Load (0.3ms)[0m  [1m[34mSELECT  "tickets".* FROM "tickets" WHERE "tickets"."id" = $1 LIMIT $2[0m  [["id", 21], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.163333 #11095] DEBUG -- :   [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 57], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.163749 #11095] DEBUG -- :   [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.164408 #11095] DEBUG -- :   [1m[36mTicket Load (0.1ms)[0m  [1m[34mSELECT  "tickets".* FROM "tickets" WHERE "tickets"."id" = $1 LIMIT $2[0m  [["id", 20], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.165031 #11095] DEBUG -- :   [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 57], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.165315 #11095] DEBUG -- :   [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.166154 #11095] DEBUG -- :   [1m[36mTicket Load (0.2ms)[0m  [1m[34mSELECT  "tickets".* FROM "tickets" WHERE "tickets"."id" = $1 LIMIT $2[0m  [["id", 19], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.167029 #11095] DEBUG -- :   [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 57], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.167363 #11095] DEBUG -- :   [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.168115 #11095] DEBUG -- :   [1m[36mTicket Load (0.2ms)[0m  [1m[34mSELECT  "tickets".* FROM "tickets" WHERE "tickets"."id" = $1 LIMIT $2[0m  [["id", 18], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.169254 #11095] DEBUG -- :   [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.169546 #11095] DEBUG -- :   [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.170272 #11095] DEBUG -- :   [1m[36mTicket Load (0.2ms)[0m  [1m[34mSELECT  "tickets".* FROM "tickets" WHERE "tickets"."id" = $1 LIMIT $2[0m  [["id", 17], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.171544 #11095] DEBUG -- :   [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 29], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.171953 #11095] DEBUG -- :   [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.172645 #11095] DEBUG -- :   [1m[36mTicket Load (0.1ms)[0m  [1m[34mSELECT  "tickets".* FROM "tickets" WHERE "tickets"."id" = $1 LIMIT $2[0m  [["id", 16], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.173489 #11095] DEBUG -- :   [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 29], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.173892 #11095] DEBUG -- :   [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.174734 #11095] DEBUG -- :   [1m[36mTicket Load (0.2ms)[0m  [1m[34mSELECT  "tickets".* FROM "tickets" WHERE "tickets"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.176156 #11095] DEBUG -- :   [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 28], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.176991 #11095] DEBUG -- :   [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.177826 #11095] DEBUG -- :   [1m[36mTicket Load (0.2ms)[0m  [1m[34mSELECT  "tickets".* FROM "tickets" WHERE "tickets"."id" = $1 LIMIT $2[0m  [["id", 14], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.178947 #11095] DEBUG -- :   [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.179274 #11095] DEBUG -- :   [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.180025 #11095] DEBUG -- :   [1m[36mTicket Load (0.2ms)[0m  [1m[34mSELECT  "tickets".* FROM "tickets" WHERE "tickets"."id" = $1 LIMIT $2[0m  [["id", 13], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.180900 #11095] DEBUG -- :   [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.181373 #11095] DEBUG -- :   [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.182173 #11095] DEBUG -- :   [1m[36mTicket Load (0.2ms)[0m  [1m[34mSELECT  "tickets".* FROM "tickets" WHERE "tickets"."id" = $1 LIMIT $2[0m  [["id", 12], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.182808 #11095] DEBUG -- :   [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.183113 #11095] DEBUG -- :   [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.183854 #11095] DEBUG -- :   [1m[36mTicket Load (0.2ms)[0m  [1m[34mSELECT  "tickets".* FROM "tickets" WHERE "tickets"."id" = $1 LIMIT $2[0m  [["id", 11], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.185098 #11095] DEBUG -- :   [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 7], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.185507 #11095] DEBUG -- :   [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.186186 #11095] DEBUG -- :   [1m[36mTicket Load (0.1ms)[0m  [1m[34mSELECT  "tickets".* FROM "tickets" WHERE "tickets"."id" = $1 LIMIT $2[0m  [["id", 10], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.186817 #11095] DEBUG -- :   [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.187114 #11095] DEBUG -- :   [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.188070 #11095] DEBUG -- :   [1m[36mTicket Load (0.2ms)[0m  [1m[34mSELECT  "tickets".* FROM "tickets" WHERE "tickets"."id" = $1 LIMIT $2[0m  [["id", 9], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.188878 #11095] DEBUG -- :   [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 7], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.189165 #11095] DEBUG -- :   [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.189822 #11095] DEBUG -- :   [1m[36mTicket Load (0.1ms)[0m  [1m[34mSELECT  "tickets".* FROM "tickets" WHERE "tickets"."id" = $1 LIMIT $2[0m  [["id", 8], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.190432 #11095] DEBUG -- :   [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 7], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.190709 #11095] DEBUG -- :   [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.191379 #11095] DEBUG -- :   [1m[36mTicket Load (0.1ms)[0m  [1m[34mSELECT  "tickets".* FROM "tickets" WHERE "tickets"."id" = $1 LIMIT $2[0m  [["id", 7], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.191995 #11095] DEBUG -- :   [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.192283 #11095] DEBUG -- :   [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.192936 #11095] DEBUG -- :   [1m[36mTicket Load (0.1ms)[0m  [1m[34mSELECT  "tickets".* FROM "tickets" WHERE "tickets"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.194468 #11095] DEBUG -- :   [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.195009 #11095] DEBUG -- :   [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.196004 #11095] DEBUG -- :   [1m[36mTicket Load (0.1ms)[0m  [1m[34mSELECT  "tickets".* FROM "tickets" WHERE "tickets"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.197200 #11095] DEBUG -- :   [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.197605 #11095] DEBUG -- :   [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.198240 #11095] DEBUG -- :   [1m[36mTicket Load (0.1ms)[0m  [1m[34mSELECT  "tickets".* FROM "tickets" WHERE "tickets"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.198831 #11095] DEBUG -- :   [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.199114 #11095] DEBUG -- :   [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.201440 #11095] DEBUG -- :   [1m[36mRecentView Load (1.5ms)[0m  [1m[34mSELECT  o_id, recent_view_object_id, MAX(created_at) as created_at, MAX(id) as id, created_by_id FROM "recent_views" WHERE "recent_views"."created_by_id" = $1 GROUP BY "recent_views"."o_id", "recent_views"."recent_view_object_id", "recent_views"."created_by_id" LIMIT $2[0m  [["created_by_id", 3], ["LIMIT", 10]]
D, [2018-09-12T21:39:17.204958 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('ticket','ticket.customer') AND permissions.active = 't')[0m
D, [2018-09-12T21:39:17.207353 #11095] DEBUG -- :   [1m[36mGroup Load (0.2ms)[0m  [1m[34mSELECT  "groups".* FROM "groups" WHERE "groups"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.208662 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('ticket','ticket.agent') AND permissions.active = 't')[0m
D, [2018-09-12T21:39:17.212193 #11095] DEBUG -- :   [1m[36mUserGroup Exists (0.4ms)[0m  [1m[34mSELECT  1 AS one FROM "groups_users" LEFT OUTER JOIN "groups" ON "groups"."id" = "groups_users"."group_id" WHERE "groups_users"."user_id" = $1 AND "groups_users"."group_id" = $2 AND "groups_users"."access" IN ('read', 'full') AND "groups"."active" = $3 LIMIT $4[0m  [["user_id", 3], ["group_id", 1], ["active", "t"], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.213516 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('ticket','ticket.customer') AND permissions.active = 't')[0m
D, [2018-09-12T21:39:17.214934 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('admin') AND permissions.active = 't')[0m
D, [2018-09-12T21:39:17.216114 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('ticket','ticket.customer') AND permissions.active = 't')[0m
D, [2018-09-12T21:39:17.216790 #11095] DEBUG -- :   [1m[36mCACHE Group Load (0.0ms)[0m  [1m[34mSELECT  "groups".* FROM "groups" WHERE "groups"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.217819 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('ticket','ticket.agent') AND permissions.active = 't')[0m
D, [2018-09-12T21:39:17.218803 #11095] DEBUG -- :   [1m[36mCACHE UserGroup Exists (0.0ms)[0m  [1m[34mSELECT  1 AS one FROM "groups_users" LEFT OUTER JOIN "groups" ON "groups"."id" = "groups_users"."group_id" WHERE "groups_users"."user_id" = $1 AND "groups_users"."group_id" = $2 AND "groups_users"."access" IN ('read', 'full') AND "groups"."active" = $3 LIMIT $4[0m  [["user_id", 3], ["group_id", 1], ["active", "t"], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.220010 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('ticket','ticket.customer') AND permissions.active = 't')[0m
D, [2018-09-12T21:39:17.220469 #11095] DEBUG -- :   [1m[36mCACHE Group Load (0.0ms)[0m  [1m[34mSELECT  "groups".* FROM "groups" WHERE "groups"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.221406 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('ticket','ticket.agent') AND permissions.active = 't')[0m
D, [2018-09-12T21:39:17.222338 #11095] DEBUG -- :   [1m[36mCACHE UserGroup Exists (0.0ms)[0m  [1m[34mSELECT  1 AS one FROM "groups_users" LEFT OUTER JOIN "groups" ON "groups"."id" = "groups_users"."group_id" WHERE "groups_users"."user_id" = $1 AND "groups_users"."group_id" = $2 AND "groups_users"."access" IN ('read', 'full') AND "groups"."active" = $3 LIMIT $4[0m  [["user_id", 3], ["group_id", 1], ["active", "t"], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.222689 #11095] DEBUG -- :   [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.224876 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('admin') AND permissions.active = 't')[0m
D, [2018-09-12T21:39:17.226001 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('ticket','ticket.customer') AND permissions.active = 't')[0m
D, [2018-09-12T21:39:17.226478 #11095] DEBUG -- :   [1m[36mCACHE Group Load (0.0ms)[0m  [1m[34mSELECT  "groups".* FROM "groups" WHERE "groups"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.227339 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('ticket','ticket.agent') AND permissions.active = 't')[0m
D, [2018-09-12T21:39:17.228293 #11095] DEBUG -- :   [1m[36mCACHE UserGroup Exists (0.0ms)[0m  [1m[34mSELECT  1 AS one FROM "groups_users" LEFT OUTER JOIN "groups" ON "groups"."id" = "groups_users"."group_id" WHERE "groups_users"."user_id" = $1 AND "groups_users"."group_id" = $2 AND "groups_users"."access" IN ('read', 'full') AND "groups"."active" = $3 LIMIT $4[0m  [["user_id", 3], ["group_id", 1], ["active", "t"], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.229480 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('ticket','ticket.customer') AND permissions.active = 't')[0m
D, [2018-09-12T21:39:17.229933 #11095] DEBUG -- :   [1m[36mCACHE Group Load (0.0ms)[0m  [1m[34mSELECT  "groups".* FROM "groups" WHERE "groups"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.231024 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('ticket','ticket.agent') AND permissions.active = 't')[0m
D, [2018-09-12T21:39:17.232224 #11095] DEBUG -- :   [1m[36mCACHE UserGroup Exists (0.0ms)[0m  [1m[34mSELECT  1 AS one FROM "groups_users" LEFT OUTER JOIN "groups" ON "groups"."id" = "groups_users"."group_id" WHERE "groups_users"."user_id" = $1 AND "groups_users"."group_id" = $2 AND "groups_users"."access" IN ('read', 'full') AND "groups"."active" = $3 LIMIT $4[0m  [["user_id", 3], ["group_id", 1], ["active", "t"], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.233394 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('ticket','ticket.customer') AND permissions.active = 't')[0m
D, [2018-09-12T21:39:17.233837 #11095] DEBUG -- :   [1m[36mCACHE Group Load (0.0ms)[0m  [1m[34mSELECT  "groups".* FROM "groups" WHERE "groups"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.234694 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('ticket','ticket.agent') AND permissions.active = 't')[0m
D, [2018-09-12T21:39:17.235592 #11095] DEBUG -- :   [1m[36mCACHE UserGroup Exists (0.0ms)[0m  [1m[34mSELECT  1 AS one FROM "groups_users" LEFT OUTER JOIN "groups" ON "groups"."id" = "groups_users"."group_id" WHERE "groups_users"."user_id" = $1 AND "groups_users"."group_id" = $2 AND "groups_users"."access" IN ('read', 'full') AND "groups"."active" = $3 LIMIT $4[0m  [["user_id", 3], ["group_id", 1], ["active", "t"], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.236745 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('ticket','ticket.customer') AND permissions.active = 't')[0m
D, [2018-09-12T21:39:17.237187 #11095] DEBUG -- :   [1m[36mCACHE Group Load (0.0ms)[0m  [1m[34mSELECT  "groups".* FROM "groups" WHERE "groups"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.238336 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('ticket','ticket.agent') AND permissions.active = 't')[0m
D, [2018-09-12T21:39:17.240100 #11095] DEBUG -- :   [1m[36mCACHE UserGroup Exists (0.0ms)[0m  [1m[34mSELECT  1 AS one FROM "groups_users" LEFT OUTER JOIN "groups" ON "groups"."id" = "groups_users"."group_id" WHERE "groups_users"."user_id" = $1 AND "groups_users"."group_id" = $2 AND "groups_users"."access" IN ('read', 'full') AND "groups"."active" = $3 LIMIT $4[0m  [["user_id", 3], ["group_id", 1], ["active", "t"], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.241140 #11095] DEBUG -- :   [1m[36mTicket Load (0.5ms)[0m  [1m[34mSELECT  "tickets".* FROM "tickets" WHERE "tickets"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.241873 #11095] DEBUG -- :   [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.242732 #11095] DEBUG -- :   [1m[36mTicket Load (0.3ms)[0m  [1m[34mSELECT  "tickets".* FROM "tickets" WHERE "tickets"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.243352 #11095] DEBUG -- :   [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.255235 #11095] DEBUG -- :   [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.255627 #11095] DEBUG -- :   [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.256519 #11095] DEBUG -- :   [1m[36mTicket Load (0.3ms)[0m  [1m[34mSELECT  "tickets".* FROM "tickets" WHERE "tickets"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.257159 #11095] DEBUG -- :   [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.257662 #11095] DEBUG -- :   [1m[36mCACHE Ticket Load (0.0ms)[0m  [1m[34mSELECT  "tickets".* FROM "tickets" WHERE "tickets"."id" = $1 LIMIT $2[0m  [["id", 7], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.257982 #11095] DEBUG -- :   [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.258485 #11095] DEBUG -- :   [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.258776 #11095] DEBUG -- :   [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.259401 #11095] DEBUG -- :   [1m[36mCACHE Ticket Load (0.0ms)[0m  [1m[34mSELECT  "tickets".* FROM "tickets" WHERE "tickets"."id" = $1 LIMIT $2[0m  [["id", 24], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.259845 #11095] DEBUG -- :   [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.260516 #11095] DEBUG -- :   [1m[36mCACHE Ticket Load (0.0ms)[0m  [1m[34mSELECT  "tickets".* FROM "tickets" WHERE "tickets"."id" = $1 LIMIT $2[0m  [["id", 18], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.260836 #11095] DEBUG -- :   [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.261631 #11095] DEBUG -- :   [1m[36mTicket Load (0.3ms)[0m  [1m[34mSELECT  "tickets".* FROM "tickets" WHERE "tickets"."id" = $1 LIMIT $2[0m  [["id", 134], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.262251 #11095] DEBUG -- :   [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.263043 #11095] DEBUG -- :   [1m[36mTicket Load (0.3ms)[0m  [1m[34mSELECT  "tickets".* FROM "tickets" WHERE "tickets"."id" = $1 LIMIT $2[0m  [["id", 27], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.264191 #11095] DEBUG -- :   [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.264846 #11095] DEBUG -- :   [1m[36mPermission Load (0.2ms)[0m  [1m[34mSELECT "permissions".* FROM "permissions"[0m
D, [2018-09-12T21:39:17.272807 #11095] DEBUG -- :   [1m[36mRole Load (0.3ms)[0m  [1m[34mSELECT "roles".* FROM "roles"[0m
D, [2018-09-12T21:39:17.273598 #11095] DEBUG -- :   [1m[36mGroup Load (0.2ms)[0m  [1m[34mSELECT "groups".* FROM "groups"[0m
D, [2018-09-12T21:39:17.276553 #11095] DEBUG -- :   [1m[36mStatsStore Load (1.3ms)[0m  [1m[34mSELECT  "stats_stores".* FROM "stats_stores" WHERE "stats_stores"."o_id" = $1 AND "stats_stores"."key" = $2 AND "stats_stores"."stats_store_object_id" = $3 LIMIT $4[0m  [["o_id", 3], ["key", "dashboard"], ["stats_store_object_id", 1], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.277975 #11095] DEBUG -- :   [1m[36mObjectManager::Attribute Load (0.5ms)[0m  [1m[34mSELECT "object_manager_attributes".* FROM "object_manager_attributes" WHERE "object_manager_attributes"."object_lookup_id" = $1 AND "object_manager_attributes"."active" = $2 AND "object_manager_attributes"."to_create" = $3 AND "object_manager_attributes"."to_delete" = $4 ORDER BY position ASC, name ASC[0m  [["object_lookup_id", 2], ["active", "t"], ["to_create", "f"], ["to_delete", "f"]]
D, [2018-09-12T21:39:17.279596 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('ticket','ticket.agent') AND permissions.active = 't')[0m
D, [2018-09-12T21:39:17.281441 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('ticket','ticket.agent') AND permissions.active = 't')[0m
D, [2018-09-12T21:39:17.282699 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('ticket','ticket.agent') AND permissions.active = 't')[0m
D, [2018-09-12T21:39:17.283883 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('ticket','ticket.agent') AND permissions.active = 't')[0m
D, [2018-09-12T21:39:17.285512 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('ticket','ticket.agent') AND permissions.active = 't')[0m
D, [2018-09-12T21:39:17.286414 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('ticket','ticket.customer') AND permissions.active = 't')[0m
D, [2018-09-12T21:39:17.287183 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('ticket','ticket.agent') AND permissions.active = 't')[0m
D, [2018-09-12T21:39:17.288274 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('ticket','ticket.customer') AND permissions.active = 't')[0m
D, [2018-09-12T21:39:17.290064 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('ticket','ticket.agent') AND permissions.active = 't')[0m
D, [2018-09-12T21:39:17.290986 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('ticket','ticket.agent') AND permissions.active = 't')[0m
D, [2018-09-12T21:39:17.292181 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('ticket','ticket.agent') AND permissions.active = 't')[0m
D, [2018-09-12T21:39:17.294435 #11095] DEBUG -- :   [1m[36mObjectManager::Attribute Load (0.4ms)[0m  [1m[34mSELECT "object_manager_attributes".* FROM "object_manager_attributes" WHERE "object_manager_attributes"."object_lookup_id" = $1 AND "object_manager_attributes"."active" = $2 AND "object_manager_attributes"."to_create" = $3 AND "object_manager_attributes"."to_delete" = $4 ORDER BY position ASC, name ASC[0m  [["object_lookup_id", 3], ["active", "t"], ["to_create", "f"], ["to_delete", "f"]]
D, [2018-09-12T21:39:17.296528 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('ticket','ticket.agent') AND permissions.active = 't')[0m
D, [2018-09-12T21:39:17.307675 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('ticket','ticket.agent') AND permissions.active = 't')[0m
D, [2018-09-12T21:39:17.308968 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('ticket','ticket.agent') AND permissions.active = 't')[0m
D, [2018-09-12T21:39:17.310563 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('ticket','ticket.agent') AND permissions.active = 't')[0m
D, [2018-09-12T21:39:17.312036 #11095] DEBUG -- :   [1m[36mObjectManager::Attribute Load (0.5ms)[0m  [1m[34mSELECT "object_manager_attributes".* FROM "object_manager_attributes" WHERE "object_manager_attributes"."object_lookup_id" = $1 AND "object_manager_attributes"."active" = $2 AND "object_manager_attributes"."to_create" = $3 AND "object_manager_attributes"."to_delete" = $4 ORDER BY position ASC, name ASC[0m  [["object_lookup_id", 1], ["active", "t"], ["to_create", "f"], ["to_delete", "f"]]
D, [2018-09-12T21:39:17.318245 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('admin','admin.user') AND permissions.active = 't')[0m
D, [2018-09-12T21:39:17.319288 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('admin','admin.user') AND permissions.active = 't')[0m
D, [2018-09-12T21:39:17.320706 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('admin','admin.user') AND permissions.active = 't')[0m
D, [2018-09-12T21:39:17.321879 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('admin','admin.user') AND permissions.active = 't')[0m
D, [2018-09-12T21:39:17.323080 #11095] DEBUG -- :   [1m[36mObjectManager::Attribute Load (0.3ms)[0m  [1m[34mSELECT "object_manager_attributes".* FROM "object_manager_attributes" WHERE "object_manager_attributes"."object_lookup_id" = $1 AND "object_manager_attributes"."active" = $2 AND "object_manager_attributes"."to_create" = $3 AND "object_manager_attributes"."to_delete" = $4 ORDER BY position ASC, name ASC[0m  [["object_lookup_id", 4], ["active", "t"], ["to_create", "f"], ["to_delete", "f"]]
D, [2018-09-12T21:39:17.325570 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('admin','admin.organization') AND permissions.active = 't')[0m
D, [2018-09-12T21:39:17.326702 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('admin','admin.organization') AND permissions.active = 't')[0m
D, [2018-09-12T21:39:17.328159 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('admin','admin.organization') AND permissions.active = 't')[0m
D, [2018-09-12T21:39:17.329281 #11095] DEBUG -- :   [1m[36mObjectManager::Attribute Load (0.3ms)[0m  [1m[34mSELECT "object_manager_attributes".* FROM "object_manager_attributes" WHERE "object_manager_attributes"."object_lookup_id" = $1 AND "object_manager_attributes"."active" = $2 AND "object_manager_attributes"."to_create" = $3 AND "object_manager_attributes"."to_delete" = $4 ORDER BY position ASC, name ASC[0m  [["object_lookup_id", 5], ["active", "t"], ["to_create", "f"], ["to_delete", "f"]]
D, [2018-09-12T21:39:17.333590 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('admin','admin.group') AND permissions.active = 't')[0m
D, [2018-09-12T21:39:17.335168 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT name, preferences FROM "settings" WHERE "settings"."frontend" = $1[0m  [["frontend", "t"]]
D, [2018-09-12T21:39:17.347222 #11095] DEBUG -- :   [1m[36mLocale Load (0.4ms)[0m  [1m[34mSELECT "locales".* FROM "locales" WHERE "locales"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T21:39:17.377859 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
D, [2018-09-12T21:39:17.378343 #11095] DEBUG -- :   [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:39:17.378548 #11095] DEBUG -- : Execute singel backend Transaction::Trigger
D, [2018-09-12T21:39:17.379661 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:39:17.382708 #11095] DEBUG -- :   [1m[35mSQL (0.4ms)[0m  [1m[32mINSERT INTO "delayed_jobs" ("handler", "run_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["handler", "--- !ruby/object:Transaction::BackgroundJob\nitem:\n  :object: User\n  :object_id: 3\n  :user_id: 1\n  :created_at: !ruby/object:ActiveSupport::TimeWithZone\n    utc: &1 2018-09-12 16:09:03.098985737 Z\n    zone: &2 !ruby/object:ActiveSupport::TimeZone\n      name: Etc/UTC\n    time: *1\n  :type: update\n  :changes:\n    last_login:\n    - !ruby/object:ActiveSupport::TimeWithZone\n      utc: &3 2018-09-11 11:50:31.610000000 Z\n      zone: *2\n      time: *3\n    - !ruby/object:ActiveSupport::TimeWithZone\n      utc: &4 2018-09-12 16:09:03.061000000 Z\n      zone: *2\n      time: *4\n    updated_by_id:\n    - 3\n    - 1\nparams:\n  :interface_handle: application_server\n"], ["run_at", "2018-09-12 16:09:17.379785"], ["created_at", "2018-09-12 16:09:17.379000"], ["updated_at", "2018-09-12 16:09:17.379000"]]
D, [2018-09-12T21:39:17.383885 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:39:17.386550 #11095]  INFO -- : Completed 201 Created in 19921ms (Views: 31.7ms | ActiveRecord: 134.1ms)


D, [2018-09-12T21:39:17.388153 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:39:17.389709 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "sessions" SET "data" = $1, "persistent" = $2, "updated_at" = $3 WHERE "sessions"."id" = $4[0m  [["data", "BAh7DUkiCXBpbmcGOgZFRkkiGTIwMTgtMDktMTJUMTY6MDg6NTdaBjsAVEki\nD3VzZXJfYWdlbnQGOwBGIm5Nb3ppbGxhLzUuMCAoWDExOyBMaW51eCB4ODZf\nNjQpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENo\ncm9tZS82OC4wLjM0NDAuMTA2IFNhZmFyaS81MzcuMzZJIhBfY3NyZl90b2tl\nbgY7AEZJIjE1SzlmTEZWTnRwVFYydjArWGQ1M21QMjFWbDAzT1RSeEp2cUpm\nbitDRDUwPQY7AEZJIgx1c2VyX2lkBjsARmkISSIadXNlcl9kZXZpY2VfcmVt\nb3RlX2lwBjsARiIIOjoxSSIcdXNlcl9kZXZpY2VfZmluZ2VycHJpbnQGOwBG\nSSIQLTE5OTI0Mjk4NTgGOwBUSSIbdXNlcl9kZXZpY2VfdXBkYXRlZF9hdAY7\nAEZVOiBBY3RpdmVTdXBwb3J0OjpUaW1lV2l0aFpvbmVbCEl1OglUaW1lDZCh\nHcCFFZ8kCToJem9uZUkiCFVUQwY7AEY6DW5hbm9fbnVtaQK9AToNbmFub19k\nZW5pBjoNc3VibWljcm8iB0RQSSIIVVRDBjsAVEAWSSIPcGVyc2lzdGVudAY7\nAEZU\n"], ["persistent", "t"], ["updated_at", "2018-09-12 16:09:17.388540"], ["id", 33]]
D, [2018-09-12T21:39:17.390768 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:39:17.400962 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 21:39:17 +0530
I, [2018-09-12T21:39:17.411880 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T21:39:17.411943 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"login", "session_id"=>"603f5b4fa2b7f736dbc2d8320d2ae2bd", "fingerprint"=>"-1992429858"}}
D, [2018-09-12T21:39:17.414080 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:39:17.415363 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:39:17.417393 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:39:17.417866 #11095]  INFO -- : Completed 200 OK in 6ms (Views: 0.1ms | ActiveRecord: 1.2ms)


D, [2018-09-12T21:39:17.418781 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:39:17.419372 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:39:17.519520 #11095]  INFO -- : Started GET "/api/v1/activity_stream?full=true&limit=25&_=1536768535403" for ::1 at 2018-09-12 21:39:17 +0530
I, [2018-09-12T21:39:17.536628 #11095]  INFO -- : Started GET "/api/v1/first_steps?_=1536768535404" for ::1 at 2018-09-12 21:39:17 +0530
D, [2018-09-12T21:39:18.060152 #11095] DEBUG -- : send [{"event"=>"ws:login", "data"=>{"success"=>true}}] to 668100529
I, [2018-09-12T21:39:18.088870 #11095]  INFO -- : Processing by FirstStepsController#index as JSON
I, [2018-09-12T21:39:18.089172 #11095]  INFO -- :   Parameters: {"_"=>"1536768535404"}
D, [2018-09-12T21:39:18.089930 #11095] DEBUG -- : session based auth check
I, [2018-09-12T21:39:18.095256 #11095]  INFO -- : Processing by ActivityStreamController#show as JSON
I, [2018-09-12T21:39:18.101899 #11095]  INFO -- :   Parameters: {"full"=>"true", "limit"=>"25", "_"=>"1536768535403"}
D, [2018-09-12T21:39:18.103803 #11095] DEBUG -- :   [1m[36mSetting Load (39.8ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
D, [2018-09-12T21:39:18.105893 #11095] DEBUG -- : session based auth check
I, [2018-09-12T21:39:18.111716 #11095]  INFO -- : Completed 200 OK in 1049ms (Views: 0.4ms | ActiveRecord: 39.8ms)


D, [2018-09-12T21:39:18.115366 #11095] DEBUG -- :   [1m[35m (10.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:39:18.121733 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:39:18.125896 #11095] DEBUG -- :   [1m[35m (11.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:39:18.129281 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:39:18.130366 #11095] DEBUG -- :   [1m[35m (8.2ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:39:18.131552 #11095] DEBUG -- :   [1m[35m (1.4ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:39:18.132170 #11095] DEBUG -- : session for 'vaibhav.dkm@gmail.com'
D, [2018-09-12T21:39:18.136314 #11095] DEBUG -- : session for 'vaibhav.dkm@gmail.com'
D, [2018-09-12T21:39:18.136525 #11095] DEBUG -- :   [1m[35mCACHE  (0.1ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:39:18.139105 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T21:39:18.140431 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 21:39:18 +0530
I, [2018-09-12T21:39:18.169216 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T21:39:18.171115 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:39:18 +0530
I, [2018-09-12T21:39:18.189847 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"spool"}}
D, [2018-09-12T21:39:18.190449 #11095] DEBUG -- :   [1m[35m (19.4ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('admin') AND permissions.active = 't')[0m
D, [2018-09-12T21:39:18.193658 #11095] DEBUG -- :   [1m[35m (3.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('ticket','ticket.agent') AND permissions.active = 't')[0m
D, [2018-09-12T21:39:18.195509 #11095] DEBUG -- :   [1m[35m (3.9ms)[0m  [1m[34mSELECT COUNT(*) FROM "channels" WHERE "channels"."area" = $1[0m  [["area", "Twitter::Account"]]
D, [2018-09-12T21:39:18.195744 #11095] DEBUG -- :   [1m[35m (2.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:39:18.196584 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT "permissions"."name", "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND permissions.active = 't')[0m
D, [2018-09-12T21:39:18.198087 #11095] DEBUG -- :   [1m[35m (1.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "channels" WHERE "channels"."area" = $1[0m  [["area", "Facebook::Account"]]
D, [2018-09-12T21:39:18.199803 #11095] DEBUG -- :   [1m[35m (2.0ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:39:18.200692 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT "permissions"."id" FROM "permissions" WHERE (permissions.active = 't' AND (permissions.name = 'user_preferences' OR permissions.name LIKE 'user_preferences.%' OR permissions.name = 'admin' OR permissions.name LIKE 'admin.%' OR permissions.name = 'report' OR permissions.name LIKE 'report.%' OR permissions.name = 'ticket.agent' OR permissions.name LIKE 'ticket.agent.%' OR permissions.name = 'chat.agent' OR permissions.name LIKE 'chat.agent.%' OR permissions.name = 'cti.agent' OR permissions.name LIKE 'cti.agent.%'))[0m
D, [2018-09-12T21:39:18.202078 #11095] DEBUG -- :   [1m[35m (1.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "channels" WHERE "channels"."area" = $1[0m  [["area", "Email::Account"]]
D, [2018-09-12T21:39:18.203834 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('ticket','ticket.agent') AND permissions.active = 't')[0m
D, [2018-09-12T21:39:18.208197 #11095] DEBUG -- :   [1m[35m (4.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "text_modules"[0m
D, [2018-09-12T21:39:18.208368 #11095] DEBUG -- :   [1m[35m (2.3ms)[0m  [1m[34mSELECT "groups_users"."group_id" FROM "groups_users" LEFT OUTER JOIN "groups" ON "groups"."id" = "groups_users"."group_id" WHERE "groups_users"."user_id" = $1 AND "groups_users"."access" IN ('read', 'full') AND "groups"."active" = $2[0m  [["user_id", 3], ["active", "t"]]
D, [2018-09-12T21:39:18.212342 #11095] DEBUG -- :   [1m[36mSetting Load (2.8ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
D, [2018-09-12T21:39:18.212534 #11095] DEBUG -- :   [1m[35m (2.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "macros"[0m
I, [2018-09-12T21:39:18.215223 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:39:18.216911 #11095]  INFO -- : Completed 200 OK in 25ms (Views: 0.1ms | ActiveRecord: 6.8ms)


D, [2018-09-12T21:39:18.217751 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('admin') AND permissions.active = 't')[0m
I, [2018-09-12T21:39:18.218587 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:39:18.218744 #11095] DEBUG -- :   [1m[35m (1.0ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:39:18.221579 #11095] DEBUG -- :   [1m[35m (1.4ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:39:18.222001 #11095] DEBUG -- :   [1m[35m (9.9ms)[0m  [1m[34mSELECT "roles_groups"."group_id" FROM "roles_groups" LEFT OUTER JOIN "groups" ON "groups"."id" = "roles_groups"."group_id" WHERE "roles_groups"."role_id" IN (1, 2) AND "roles_groups"."access" IN ('read', 'full') AND "groups"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T21:39:18.223278 #11095] DEBUG -- :   [1m[35m (1.8ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:39:18.224792 #11095] DEBUG -- :   [1m[36mActivityStream Load (1.9ms)[0m  [1m[34mSELECT  "activity_streams".* FROM "activity_streams" WHERE ((permission_id IN (1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,45,48,50) AND group_id is NULL) OR (permission_id IN (1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,45,48,50) AND group_id IN (1)) OR (permission_id is NULL AND group_id IN (1))) ORDER BY created_at DESC, id DESC LIMIT $1[0m  [["LIMIT", 25]]
D, [2018-09-12T21:39:18.227317 #11095] DEBUG -- :   [1m[36mOverview Load (2.7ms)[0m  [1m[34mSELECT  "overviews".* FROM "overviews" WHERE "overviews"."name" = $1 LIMIT $2[0m  [["name", "Unassigned & Open"], ["LIMIT", 1]]
D, [2018-09-12T21:39:18.227522 #11095] DEBUG -- :   [1m[35m (3.0ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:39:18.228868 #11095] DEBUG -- :   [1m[36mUser Load (1.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:39:18.229684 #11095] DEBUG -- :   [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."login" = $1 LIMIT $2[0m  [["login", "nicole.braun@zammad.org"], ["LIMIT", 1]]
D, [2018-09-12T21:39:18.232612 #11095] DEBUG -- :   [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:39:18.233312 #11095] DEBUG -- :   [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:39:18.233495 #11095] DEBUG -- :   [1m[35m (2.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "groups" WHERE "groups"."active" = $1 AND "groups"."name" = $2[0m  [["active", "t"], ["name", "Users"]]
D, [2018-09-12T21:39:18.233931 #11095] DEBUG -- :   [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:39:18.236108 #11095] DEBUG -- :   [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:39:18.236485 #11095] DEBUG -- :   [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:39:18.236652 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
D, [2018-09-12T21:39:18.237375 #11095] DEBUG -- :   [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
I, [2018-09-12T21:39:18.237828 #11095]  INFO -- : Completed 200 OK in 148ms (Views: 0.7ms | ActiveRecord: 64.3ms)


D, [2018-09-12T21:39:18.238306 #11095] DEBUG -- :   [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:39:18.239840 #11095] DEBUG -- :   [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:39:18.239970 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:39:18.240376 #11095] DEBUG -- :   [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:39:18.242024 #11095] DEBUG -- :   [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:39:18.242376 #11095] DEBUG -- :   [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:39:18.243051 #11095] DEBUG -- :   [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:39:18.243394 #11095] DEBUG -- :   [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:39:18.244059 #11095] DEBUG -- :   [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:39:18.244313 #11095] DEBUG -- :   [1m[35mSQL (2.9ms)[0m  [1m[33mUPDATE "sessions" SET "data" = $1, "updated_at" = $2 WHERE "sessions"."id" = $3[0m  [["data", "BAh7D0kiCXBpbmcGOgZFRkkiGTIwMTgtMDktMTJUMTY6MDk6MThaBjsAVEki\nD3VzZXJfYWdlbnQGOwBGIm5Nb3ppbGxhLzUuMCAoWDExOyBMaW51eCB4ODZf\nNjQpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENo\ncm9tZS82OC4wLjM0NDAuMTA2IFNhZmFyaS81MzcuMzZJIhBfY3NyZl90b2tl\nbgY7AEZJIjE1SzlmTEZWTnRwVFYydjArWGQ1M21QMjFWbDAzT1RSeEp2cUpm\nbitDRDUwPQY7AEZJIgx1c2VyX2lkBjsARmkISSIadXNlcl9kZXZpY2VfcmVt\nb3RlX2lwBjsARiIIOjoxSSIcdXNlcl9kZXZpY2VfZmluZ2VycHJpbnQGOwBG\nSSIQLTE5OTI0Mjk4NTgGOwBUSSIbdXNlcl9kZXZpY2VfdXBkYXRlZF9hdAY7\nAEZVOiBBY3RpdmVTdXBwb3J0OjpUaW1lV2l0aFpvbmVbCEl1OglUaW1lDZCh\nHcCFFZ8kCToJem9uZUkiCFVUQwY7AEY6DW5hbm9fbnVtaQK9AToNbmFub19k\nZW5pBjoNc3VibWljcm8iB0RQSSIIVVRDBjsAVEAWSSIPcGVyc2lzdGVudAY7\nAEZUSSIOcmVtb3RlX2lwBjsARiIIOjoxSSIIZ2VvBjsARnsA\n"], ["updated_at", "2018-09-12 16:09:18.240651"], ["id", 33]]
D, [2018-09-12T21:39:18.244708 #11095] DEBUG -- :   [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:39:18.250076 #11095] DEBUG -- :   [1m[35m (5.0ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:39:18.255867 #11095] DEBUG -- :   [1m[36mTicket::Article Load (2.2ms)[0m  [1m[34mSELECT  "ticket_articles".* FROM "ticket_articles" WHERE "ticket_articles"."id" = $1 LIMIT $2[0m  [["id", 156], ["LIMIT", 1]]
D, [2018-09-12T21:39:18.259622 #11095] DEBUG -- :   [1m[36mStore Load (0.5ms)[0m  [1m[34mSELECT "stores".* FROM "stores" WHERE "stores"."store_object_id" = 5 AND "stores"."o_id" = $1 ORDER BY created_at ASC, id ASC[0m  [["o_id", 156]]
D, [2018-09-12T21:39:19.231758 #11095] DEBUG -- : send [{"event"=>"spool:sent", "data"=>{"timestamp"=>1536768558}}] to 668100529
D, [2018-09-12T21:39:19.247909 #11095] DEBUG -- :   [1m[36mCACHE User Load (0.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
I, [2018-09-12T21:39:19.249224 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 21:39:19 +0530
D, [2018-09-12T21:39:19.274993 #11095] DEBUG -- :   [1m[36mSetting Load (12.9ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:39:19.280279 #11095]  INFO -- : Completed 200 OK in 1061ms (Views: 0.6ms | ActiveRecord: 17.7ms)


D, [2018-09-12T21:39:19.281707 #11095] DEBUG -- :   [1m[36mOrganization Load (1.3ms)[0m  [1m[34mSELECT  "organizations".* FROM "organizations" WHERE "organizations"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
D, [2018-09-12T21:39:19.281875 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
I, [2018-09-12T21:39:19.285199 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
D, [2018-09-12T21:39:19.285376 #11095] DEBUG -- :   [1m[35m (2.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:39:19.285966 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
D, [2018-09-12T21:39:19.286798 #11095] DEBUG -- :   [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:39:19.289621 #11095] DEBUG -- :   [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:39:19.290693 #11095] DEBUG -- :   [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
I, [2018-09-12T21:39:19.290896 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:39:19 +0530
D, [2018-09-12T21:39:19.291375 #11095] DEBUG -- :   [1m[35m (1.2ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:39:19.303149 #11095] DEBUG -- :   [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:39:19.305301 #11095] DEBUG -- :   [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:39:19.307802 #11095] DEBUG -- :   [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
I, [2018-09-12T21:39:19.308301 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
D, [2018-09-12T21:39:19.308663 #11095] DEBUG -- :   [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
I, [2018-09-12T21:39:19.308957 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:39:19.310874 #11095] DEBUG -- :   [1m[35m (4.1ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:39:19.311518 #11095] DEBUG -- :   [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:39:19.311754 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:39:19.313024 #11095] DEBUG -- :   [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:39:19.314845 #11095] DEBUG -- :   [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:39:19.315015 #11095] DEBUG -- :   [1m[35m (1.0ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:39:19.315452 #11095] DEBUG -- :   [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:39:19.317045 #11095] DEBUG -- :   [1m[36mTicket Load (0.2ms)[0m  [1m[34mSELECT  "tickets".* FROM "tickets" WHERE "tickets"."id" = $1 LIMIT $2[0m  [["id", 133], ["LIMIT", 1]]
D, [2018-09-12T21:39:19.317817 #11095] DEBUG -- :   [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:39:19.318569 #11095] DEBUG -- :   [1m[36mTicket Load (0.1ms)[0m  [1m[34mSELECT  "tickets".* FROM "tickets" WHERE "tickets"."id" = $1 LIMIT $2[0m  [["id", 132], ["LIMIT", 1]]
D, [2018-09-12T21:39:19.319792 #11095] DEBUG -- :   [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:39:19.320592 #11095] DEBUG -- :   [1m[36mTicket Load (0.2ms)[0m  [1m[34mSELECT  "tickets".* FROM "tickets" WHERE "tickets"."id" = $1 LIMIT $2[0m  [["id", 131], ["LIMIT", 1]]
D, [2018-09-12T21:39:19.321901 #11095] DEBUG -- :   [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:39:19.323170 #11095] DEBUG -- :   [1m[36mTicket Load (0.2ms)[0m  [1m[34mSELECT  "tickets".* FROM "tickets" WHERE "tickets"."id" = $1 LIMIT $2[0m  [["id", 130], ["LIMIT", 1]]
D, [2018-09-12T21:39:19.324484 #11095] DEBUG -- :   [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:39:19.325261 #11095] DEBUG -- :   [1m[36mTicket Load (0.2ms)[0m  [1m[34mSELECT  "tickets".* FROM "tickets" WHERE "tickets"."id" = $1 LIMIT $2[0m  [["id", 129], ["LIMIT", 1]]
D, [2018-09-12T21:39:19.326010 #11095] DEBUG -- :   [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:39:19.326798 #11095] DEBUG -- :   [1m[36mTicket Load (0.1ms)[0m  [1m[34mSELECT  "tickets".* FROM "tickets" WHERE "tickets"."id" = $1 LIMIT $2[0m  [["id", 127], ["LIMIT", 1]]
D, [2018-09-12T21:39:19.327810 #11095] DEBUG -- :   [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:39:19.328645 #11095] DEBUG -- :   [1m[36mTicket Load (0.2ms)[0m  [1m[34mSELECT  "tickets".* FROM "tickets" WHERE "tickets"."id" = $1 LIMIT $2[0m  [["id", 126], ["LIMIT", 1]]
D, [2018-09-12T21:39:19.329919 #11095] DEBUG -- :   [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:39:19.330693 #11095] DEBUG -- :   [1m[36mTicket Load (0.1ms)[0m  [1m[34mSELECT  "tickets".* FROM "tickets" WHERE "tickets"."id" = $1 LIMIT $2[0m  [["id", 125], ["LIMIT", 1]]
D, [2018-09-12T21:39:19.331378 #11095] DEBUG -- :   [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:39:19.332148 #11095] DEBUG -- :   [1m[36mTicket Load (0.1ms)[0m  [1m[34mSELECT  "tickets".* FROM "tickets" WHERE "tickets"."id" = $1 LIMIT $2[0m  [["id", 124], ["LIMIT", 1]]
D, [2018-09-12T21:39:19.332843 #11095] DEBUG -- :   [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:39:19.333616 #11095] DEBUG -- :   [1m[36mTicket Load (0.1ms)[0m  [1m[34mSELECT  "tickets".* FROM "tickets" WHERE "tickets"."id" = $1 LIMIT $2[0m  [["id", 123], ["LIMIT", 1]]
D, [2018-09-12T21:39:19.334247 #11095] DEBUG -- :   [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:39:19.342014 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:39:19.342400 #11095]  INFO -- : Completed 200 OK in 1239ms (Views: 6.6ms | ActiveRecord: 41.7ms)


D, [2018-09-12T21:39:19.343216 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:39:19.344547 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "sessions" SET "data" = $1, "updated_at" = $2 WHERE "sessions"."id" = $3[0m  [["data", "BAh7D0kiCXBpbmcGOgZFRkkiGTIwMTgtMDktMTJUMTY6MDk6MThaBjsAVEki\nD3VzZXJfYWdlbnQGOwBGIm5Nb3ppbGxhLzUuMCAoWDExOyBMaW51eCB4ODZf\nNjQpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENo\ncm9tZS82OC4wLjM0NDAuMTA2IFNhZmFyaS81MzcuMzZJIhBfY3NyZl90b2tl\nbgY7AEZJIjE1SzlmTEZWTnRwVFYydjArWGQ1M21QMjFWbDAzT1RSeEp2cUpm\nbitDRDUwPQY7AEZJIgx1c2VyX2lkBjsARmkISSIadXNlcl9kZXZpY2VfcmVt\nb3RlX2lwBjsARiIIOjoxSSIcdXNlcl9kZXZpY2VfZmluZ2VycHJpbnQGOwBG\nSSIQLTE5OTI0Mjk4NTgGOwBUSSIbdXNlcl9kZXZpY2VfdXBkYXRlZF9hdAY7\nAEZVOiBBY3RpdmVTdXBwb3J0OjpUaW1lV2l0aFpvbmVbCEl1OglUaW1lDZCh\nHcCFFZ8kCToJem9uZUkiCFVUQwY7AEY6DW5hbm9fbnVtaQK9AToNbmFub19k\nZW5pBjoNc3VibWljcm8iB0RQSSIIVVRDBjsAVEAWSSIPcGVyc2lzdGVudAY7\nAEZUSSIOcmVtb3RlX2lwBjsARiIIOjoxSSIIZ2VvBjsARnsA\n"], ["updated_at", "2018-09-12 16:09:19.343438"], ["id", 33]]
D, [2018-09-12T21:39:19.345716 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:39:26.324332 #11095]  INFO -- : Started GET "/api/v1/cti/log?_=1536768535405" for ::1 at 2018-09-12 21:39:26 +0530
I, [2018-09-12T21:39:26.342110 #11095]  INFO -- : Started GET "/api/v1/ticket_overviews?_=1536768535406" for ::1 at 2018-09-12 21:39:26 +0530
I, [2018-09-12T21:39:26.356912 #11095]  INFO -- : Started GET "/api/v1/ticket_create?_=1536768535407" for ::1 at 2018-09-12 21:39:26 +0530
D, [2018-09-12T21:39:26.377773 #11095] DEBUG -- :   [1m[36mSetting Load (55.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
D, [2018-09-12T21:39:26.378020 #11095] DEBUG -- :   [1m[36mUser Load (54.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
I, [2018-09-12T21:39:26.378936 #11095]  INFO -- : Completed 200 OK in 7070ms (Views: 0.2ms | ActiveRecord: 56.9ms)


D, [2018-09-12T21:39:26.381753 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:39:26.384899 #11095] DEBUG -- :   [1m[35m (1.8ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:39:26.387119 #11095] DEBUG -- :   [1m[35m (1.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T21:39:26.388651 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:39:26.400848 #11095]  INFO -- : Processing by TicketOverviewsController#show as JSON
I, [2018-09-12T21:39:26.400980 #11095]  INFO -- :   Parameters: {"_"=>"1536768535406"}
D, [2018-09-12T21:39:26.401246 #11095] DEBUG -- : session based auth check
D, [2018-09-12T21:39:26.401506 #11095] DEBUG -- :   [1m[36mChat::Agent Load (11.4ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
I, [2018-09-12T21:39:26.403250 #11095]  INFO -- : Processing by CtiController#index as JSON
I, [2018-09-12T21:39:26.404956 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:39:26 +0530
D, [2018-09-12T21:39:26.422046 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
I, [2018-09-12T21:39:26.422742 #11095]  INFO -- :   Parameters: {"_"=>"1536768535405"}
D, [2018-09-12T21:39:26.423250 #11095] DEBUG -- : session based auth check
D, [2018-09-12T21:39:26.429331 #11095] DEBUG -- :   [1m[35m (2.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:39:26.435154 #11095] DEBUG -- :   [1m[35m (1.1ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:39:26.436585 #11095] DEBUG -- :   [1m[35m (7.1ms)[0m  [1m[35mBEGIN[0m
I, [2018-09-12T21:39:26.438261 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
D, [2018-09-12T21:39:26.438747 #11095] DEBUG -- :   [1m[35m (2.0ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('cti','cti.agent') AND permissions.active = 't')[0m
I, [2018-09-12T21:39:26.440972 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:39:26.441259 #11095] DEBUG -- :   [1m[35m (6.8ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:39:26.441712 #11095] DEBUG -- :   [1m[35mSQL (2.7ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:09:26.422000"], ["id", 1]]
D, [2018-09-12T21:39:26.442547 #11095] DEBUG -- : session for 'vaibhav.dkm@gmail.com'
D, [2018-09-12T21:39:26.445363 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:39:26.448241 #11095] DEBUG -- :   [1m[35m (7.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:39:26.448436 #11095] DEBUG -- :   [1m[35m (6.3ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:39:26.452623 #11095] DEBUG -- :   [1m[35m (5.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:39:26.454277 #11095] DEBUG -- : session for 'vaibhav.dkm@gmail.com'
D, [2018-09-12T21:39:26.455561 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:39:26.457269 #11095] DEBUG -- :   [1m[36mChat::Session Load (3.2ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T21:39:26.457348 #11095] DEBUG -- :   [1m[35m (5.4ms)[0m  [1m[34mSELECT roles.id FROM "users" INNER JOIN "roles_users" ON "roles_users"."user_id" = "users"."id" INNER JOIN "roles" ON "roles"."id" = "roles_users"."role_id" WHERE "users"."id" = $1 AND "users"."active" = $2 AND "roles"."active" = $3[0m  [["id", 3], ["active", "t"], ["active", "t"]]
D, [2018-09-12T21:39:26.457418 #11095] DEBUG -- :   [1m[35m (3.2ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:39:26.458719 #11095] DEBUG -- :   [1m[36mCti::Log Load (1.6ms)[0m  [1m[34mSELECT  "cti_logs".* FROM "cti_logs" ORDER BY created_at DESC, id DESC LIMIT $1[0m  [["LIMIT", 60]]
D, [2018-09-12T21:39:26.461135 #11095] DEBUG -- :   [1m[36mChat Load (2.7ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T21:39:26.464670 #11095] DEBUG -- :   [1m[35m (4.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('ticket','ticket.customer') AND permissions.active = 't')[0m
D, [2018-09-12T21:39:26.466441 #11095] DEBUG -- :   [1m[36mSetting Load (2.6ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:39:26.467024 #11095]  INFO -- : Completed 200 OK in 44ms (Views: 0.3ms | ActiveRecord: 14.8ms)


D, [2018-09-12T21:39:26.468279 #11095] DEBUG -- :   [1m[35m (1.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('ticket','ticket.agent') AND permissions.active = 't')[0m
D, [2018-09-12T21:39:26.468452 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:39:26.470790 #11095] DEBUG -- :   [1m[35m (1.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "users" WHERE (out_of_office = 't' AND out_of_office_start_at <= '2018-09-12' AND out_of_office_end_at >= '2018-09-12' AND out_of_office_replacement_id = 3 AND active = 't')[0m
D, [2018-09-12T21:39:26.471017 #11095] DEBUG -- :   [1m[36mChat::Agent Load (6.5ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:07:26.464036')[0m  [["active", "t"]]
D, [2018-09-12T21:39:26.472840 #11095] DEBUG -- :   [1m[35mSQL (2.2ms)[0m  [1m[33mUPDATE "sessions" SET "data" = $1, "updated_at" = $2 WHERE "sessions"."id" = $3[0m  [["data", "BAh7D0kiCXBpbmcGOgZFRkkiGTIwMTgtMDktMTJUMTY6MDk6MjZaBjsAVEki\nD3VzZXJfYWdlbnQGOwBGIm5Nb3ppbGxhLzUuMCAoWDExOyBMaW51eCB4ODZf\nNjQpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENo\ncm9tZS82OC4wLjM0NDAuMTA2IFNhZmFyaS81MzcuMzZJIhBfY3NyZl90b2tl\nbgY7AEZJIjE1SzlmTEZWTnRwVFYydjArWGQ1M21QMjFWbDAzT1RSeEp2cUpm\nbitDRDUwPQY7AEZJIgx1c2VyX2lkBjsARmkISSIadXNlcl9kZXZpY2VfcmVt\nb3RlX2lwBjsARiIIOjoxSSIcdXNlcl9kZXZpY2VfZmluZ2VycHJpbnQGOwBG\nSSIQLTE5OTI0Mjk4NTgGOwBUSSIbdXNlcl9kZXZpY2VfdXBkYXRlZF9hdAY7\nAEZVOiBBY3RpdmVTdXBwb3J0OjpUaW1lV2l0aFpvbmVbCEl1OglUaW1lDZCh\nHcCFFZ8kCToJem9uZUkiCFVUQwY7AEY6DW5hbm9fbnVtaQK9AToNbmFub19k\nZW5pBjoNc3VibWljcm8iB0RQSSIIVVRDBjsAVEAWSSIPcGVyc2lzdGVudAY7\nAEZUSSIOcmVtb3RlX2lwBjsARiIIOjoxSSIIZ2VvBjsARnsA\n"], ["updated_at", "2018-09-12 16:09:26.469790"], ["id", 33]]
D, [2018-09-12T21:39:26.476471 #11095] DEBUG -- :   [1m[35m (2.7ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:39:26.482434 #11095] DEBUG -- :   [1m[36mOverview Load (2.5ms)[0m  [1m[34mSELECT DISTINCT "overviews".* FROM "overviews" INNER JOIN "overviews_roles" ON "overviews_roles"."overview_id" = "overviews"."id" INNER JOIN "roles" ON "roles"."id" = "overviews_roles"."role_id" LEFT OUTER JOIN "overviews_users" ON "overviews_users"."overview_id" = "overviews"."id" LEFT OUTER JOIN "users" ON "users"."id" = "overviews_users"."user_id" WHERE ("overviews_roles"."role_id" IN (1, 2) AND "overviews_users"."user_id" IS NULL AND "overviews"."active" = $1 OR "overviews_roles"."role_id" IN (1, 2) AND "overviews_users"."user_id" = $2 AND "overviews"."active" = $3) AND ("overviews"."out_of_office" != $4) ORDER BY "overviews"."prio" ASC, "overviews"."name" ASC[0m  [["active", "t"], ["user_id", 3], ["active", "t"], ["out_of_office", "t"]]
D, [2018-09-12T21:39:26.493331 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.5ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T21:39:26.494009 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('ticket','ticket.agent') AND permissions.active = 't')[0m
D, [2018-09-12T21:39:26.495279 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('ticket','ticket.agent') AND permissions.active = 't')[0m
D, [2018-09-12T21:39:26.496707 #11095] DEBUG -- :   [1m[35m (2.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T21:39:26.497499 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT "groups_users"."group_id" FROM "groups_users" LEFT OUTER JOIN "groups" ON "groups"."id" = "groups_users"."group_id" WHERE "groups_users"."user_id" = $1 AND "groups_users"."access" IN ('overview', 'full') AND "groups"."active" = $2[0m  [["user_id", 3], ["active", "t"]]
D, [2018-09-12T21:39:26.497646 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T21:39:26.499944 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "roles_groups"."group_id" FROM "roles_groups" LEFT OUTER JOIN "groups" ON "groups"."id" = "roles_groups"."group_id" WHERE "roles_groups"."role_id" IN (1, 2) AND "roles_groups"."access" IN ('overview', 'full') AND "groups"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T21:39:26.501592 #11095] DEBUG -- :   [1m[35m (1.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T21:39:26.502455 #11095] DEBUG -- :   [1m[35m (1.0ms)[0m  [1m[34mSELECT  DISTINCT "tickets"."id", "tickets"."updated_at", "tickets"."created_at" FROM "tickets" WHERE (group_id IN (1)) AND ("tickets"."state_id" IN ('1','2','7','3') AND "tickets"."owner_id" IN (3)) ORDER BY "tickets"."created_at" ASC LIMIT $1[0m  [["LIMIT", 2000]]
D, [2018-09-12T21:39:26.503211 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:07:26.501795')[0m  [["active", "t"]]
D, [2018-09-12T21:39:26.504008 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[34mSELECT COUNT(DISTINCT "tickets"."id") FROM "tickets" WHERE (group_id IN (1)) AND ("tickets"."state_id" IN ('1','2','7','3') AND "tickets"."owner_id" IN (3))[0m
D, [2018-09-12T21:39:26.504204 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:07:26.503413')[0m  [["active", "t"]]
D, [2018-09-12T21:39:26.506387 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[34mSELECT  DISTINCT "tickets"."id", "tickets"."updated_at", "tickets"."created_at" FROM "tickets" WHERE (group_id IN (1)) AND ("tickets"."state_id" IN (2,1,3) AND ("tickets"."owner_id" IS NULL OR "tickets"."owner_id" IN (1))) ORDER BY "tickets"."created_at" ASC LIMIT $1[0m  [["LIMIT", 2000]]
D, [2018-09-12T21:39:26.506527 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T21:39:26.508093 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(DISTINCT "tickets"."id") FROM "tickets" WHERE (group_id IN (1)) AND ("tickets"."state_id" IN (2,1,3) AND ("tickets"."owner_id" IS NULL OR "tickets"."owner_id" IN (1)))[0m
D, [2018-09-12T21:39:26.508246 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:07:26.507366')[0m  [["active", "t"]]
D, [2018-09-12T21:39:26.511014 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT  DISTINCT "tickets"."id", "tickets"."updated_at", "tickets"."created_at" FROM "tickets" WHERE (group_id IN (1)) AND ("tickets"."state_id" IN (3) AND "tickets"."owner_id" IN (3) AND "tickets"."pending_time" <= '2018-09-12 16:09:26.508993') ORDER BY "tickets"."created_at" ASC LIMIT $1[0m  [["LIMIT", 2000]]
D, [2018-09-12T21:39:26.511253 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:39:26.512733 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(DISTINCT "tickets"."id") FROM "tickets" WHERE (group_id IN (1)) AND ("tickets"."state_id" IN (3) AND "tickets"."owner_id" IN (3) AND "tickets"."pending_time" <= '2018-09-12 16:09:26.508993')[0m
D, [2018-09-12T21:39:26.514103 #11095] DEBUG -- :   [1m[36mChat::Session Load (1.5ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T21:39:26.516555 #11095] DEBUG -- :   [1m[35m (2.6ms)[0m  [1m[34mSELECT  DISTINCT "tickets"."id", "tickets"."updated_at", "tickets"."created_at" FROM "tickets" WHERE (group_id IN (1)) AND ("tickets"."state_id" IN (2,1,3)) ORDER BY "tickets"."created_at" ASC LIMIT $1[0m  [["LIMIT", 2000]]
D, [2018-09-12T21:39:26.517299 #11095] DEBUG -- :   [1m[36mSetting Load (0.8ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:39:26.517869 #11095]  INFO -- : Completed 200 OK in 7231ms (Views: 0.1ms | ActiveRecord: 111.8ms)


D, [2018-09-12T21:39:26.518803 #11095] DEBUG -- :   [1m[35m (1.7ms)[0m  [1m[34mSELECT COUNT(DISTINCT "tickets"."id") FROM "tickets" WHERE (group_id IN (1)) AND ("tickets"."state_id" IN (2,1,3))[0m
D, [2018-09-12T21:39:26.520639 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT  DISTINCT "tickets"."id", "tickets"."updated_at", "tickets"."created_at" FROM "tickets" WHERE (group_id IN (1)) AND ("tickets"."state_id" IN (3) AND "tickets"."pending_time" <= '2018-09-12 16:09:26.519327') ORDER BY "tickets"."created_at" ASC LIMIT $1[0m  [["LIMIT", 2000]]
D, [2018-09-12T21:39:26.521291 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:39:26.522395 #11095] DEBUG -- :   [1m[35m (1.2ms)[0m  [1m[34mSELECT COUNT(DISTINCT "tickets"."id") FROM "tickets" WHERE (group_id IN (1)) AND ("tickets"."state_id" IN (3) AND "tickets"."pending_time" <= '2018-09-12 16:09:26.519327')[0m
D, [2018-09-12T21:39:26.522987 #11095] DEBUG -- :   [1m[35mSQL (0.7ms)[0m  [1m[33mUPDATE "sessions" SET "data" = $1, "updated_at" = $2 WHERE "sessions"."id" = $3[0m  [["data", "BAh7D0kiCXBpbmcGOgZFRkkiGTIwMTgtMDktMTJUMTY6MDk6MThaBjsAVEki\nD3VzZXJfYWdlbnQGOwBGIm5Nb3ppbGxhLzUuMCAoWDExOyBMaW51eCB4ODZf\nNjQpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENo\ncm9tZS82OC4wLjM0NDAuMTA2IFNhZmFyaS81MzcuMzZJIhBfY3NyZl90b2tl\nbgY7AEZJIjE1SzlmTEZWTnRwVFYydjArWGQ1M21QMjFWbDAzT1RSeEp2cUpm\nbitDRDUwPQY7AEZJIgx1c2VyX2lkBjsARmkISSIadXNlcl9kZXZpY2VfcmVt\nb3RlX2lwBjsARiIIOjoxSSIcdXNlcl9kZXZpY2VfZmluZ2VycHJpbnQGOwBG\nSSIQLTE5OTI0Mjk4NTgGOwBUSSIbdXNlcl9kZXZpY2VfdXBkYXRlZF9hdAY7\nAEZVOiBBY3RpdmVTdXBwb3J0OjpUaW1lV2l0aFpvbmVbCEl1OglUaW1lDZCh\nHcCFFZ8kCToJem9uZUkiCFVUQwY7AEY6DW5hbm9fbnVtaQK9AToNbmFub19k\nZW5pBjoNc3VibWljcm8iB0RQSSIIVVRDBjsAVEAWSSIPcGVyc2lzdGVudAY7\nAEZUSSIOcmVtb3RlX2lwBjsARiIIOjoxSSIIZ2VvBjsARnsA\n"], ["updated_at", "2018-09-12 16:09:26.521587"], ["id", 33]]
D, [2018-09-12T21:39:26.524223 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT  DISTINCT "tickets"."id", "tickets"."updated_at", "tickets"."escalation_at" FROM "tickets" WHERE (group_id IN (1)) AND ("tickets"."escalation_at" <= '2018-09-12 16:19:26.522765') ORDER BY "tickets"."escalation_at" ASC LIMIT $1[0m  [["LIMIT", 2000]]
D, [2018-09-12T21:39:26.525101 #11095] DEBUG -- :   [1m[35m (1.0ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:39:26.525883 #11095] DEBUG -- :   [1m[35m (1.1ms)[0m  [1m[34mSELECT COUNT(DISTINCT "tickets"."id") FROM "tickets" WHERE (group_id IN (1)) AND ("tickets"."escalation_at" <= '2018-09-12 16:19:26.522765')[0m
D, [2018-09-12T21:39:26.529956 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:39:26.530451 #11095]  INFO -- : Completed 200 OK in 129ms (Views: 0.4ms | ActiveRecord: 42.0ms)


D, [2018-09-12T21:39:26.531372 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:39:26.532579 #11095] DEBUG -- :   [1m[35mSQL (0.2ms)[0m  [1m[33mUPDATE "sessions" SET "data" = $1, "updated_at" = $2 WHERE "sessions"."id" = $3[0m  [["data", "BAh7D0kiCXBpbmcGOgZFRkkiGTIwMTgtMDktMTJUMTY6MDk6MjZaBjsAVEki\nD3VzZXJfYWdlbnQGOwBGIm5Nb3ppbGxhLzUuMCAoWDExOyBMaW51eCB4ODZf\nNjQpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENo\ncm9tZS82OC4wLjM0NDAuMTA2IFNhZmFyaS81MzcuMzZJIhBfY3NyZl90b2tl\nbgY7AEZJIjE1SzlmTEZWTnRwVFYydjArWGQ1M21QMjFWbDAzT1RSeEp2cUpm\nbitDRDUwPQY7AEZJIgx1c2VyX2lkBjsARmkISSIadXNlcl9kZXZpY2VfcmVt\nb3RlX2lwBjsARiIIOjoxSSIcdXNlcl9kZXZpY2VfZmluZ2VycHJpbnQGOwBG\nSSIQLTE5OTI0Mjk4NTgGOwBUSSIbdXNlcl9kZXZpY2VfdXBkYXRlZF9hdAY7\nAEZVOiBBY3RpdmVTdXBwb3J0OjpUaW1lV2l0aFpvbmVbCEl1OglUaW1lDZCh\nHcCFFZ8kCToJem9uZUkiCFVUQwY7AEY6DW5hbm9fbnVtaQK9AToNbmFub19k\nZW5pBjoNc3VibWljcm8iB0RQSSIIVVRDBjsAVEAWSSIPcGVyc2lzdGVudAY7\nAEZUSSIOcmVtb3RlX2lwBjsARiIIOjoxSSIIZ2VvBjsARnsA\n"], ["updated_at", "2018-09-12 16:09:26.531630"], ["id", 33]]
D, [2018-09-12T21:39:26.533594 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:39:27.464443 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
I, [2018-09-12T21:39:27.495958 #11095]  INFO -- : Processing by TicketsController#ticket_create as JSON
I, [2018-09-12T21:39:27.496926 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 21:39:27 +0530
I, [2018-09-12T21:39:27.497448 #11095]  INFO -- :   Parameters: {"_"=>"1536768535407"}
D, [2018-09-12T21:39:27.498116 #11095] DEBUG -- :   [1m[36mSetting Load (27.7ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
D, [2018-09-12T21:39:27.528651 #11095] DEBUG -- : session based auth check
I, [2018-09-12T21:39:27.529022 #11095]  INFO -- : Completed 200 OK in 1087ms (Views: 3.9ms | ActiveRecord: 36.2ms)


D, [2018-09-12T21:39:27.533869 #11095] DEBUG -- :   [1m[35m (2.6ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:39:27.535134 #11095] DEBUG -- :   [1m[35m (1.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:39:27.536707 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:39:27.539280 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
D, [2018-09-12T21:39:27.539940 #11095] DEBUG -- :   [1m[35m (3.1ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T21:39:27.540538 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"broadcast", "spool"=>true, "recipient"=>{"user_id"=>[3]}, "data"=>{"event"=>"session:takeover", "data"=>{"taskbar_id"=>49506482}}}}
D, [2018-09-12T21:39:27.541238 #11095] DEBUG -- : session for 'vaibhav.dkm@gmail.com'
D, [2018-09-12T21:39:27.547059 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T21:39:27.549069 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:39:27 +0530
D, [2018-09-12T21:39:27.563523 #11095] DEBUG -- :   [1m[35m (2.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:39:27.566280 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:39:27.567540 #11095] DEBUG -- :   [1m[36mTicket::StateType Load (0.8ms)[0m  [1m[34mSELECT  "ticket_state_types".* FROM "ticket_state_types" WHERE "ticket_state_types"."name" = $1 LIMIT $2[0m  [["name", "open"], ["LIMIT", 1]]
I, [2018-09-12T21:39:27.572947 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:39:27.573539 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:39:27.578197 #11095] DEBUG -- :   [1m[35m (1.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:39:27.578466 #11095] DEBUG -- :   [1m[36mTicket::State Load (1.9ms)[0m  [1m[34mSELECT "ticket_states".* FROM "ticket_states" WHERE "ticket_states"."state_type_id" = $1[0m  [["state_type_id", 2]]
D, [2018-09-12T21:39:27.583403 #11095] DEBUG -- :   [1m[35m (2.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:39:27.585488 #11095] DEBUG -- :   [1m[36mTicket::StateType Load (0.3ms)[0m  [1m[34mSELECT  "ticket_state_types".* FROM "ticket_state_types" WHERE "ticket_state_types"."name" = $1 LIMIT $2[0m  [["name", "closed"], ["LIMIT", 1]]
D, [2018-09-12T21:39:27.587618 #11095] DEBUG -- :   [1m[36mTicket::State Load (0.5ms)[0m  [1m[34mSELECT "ticket_states".* FROM "ticket_states" WHERE "ticket_states"."state_type_id" = $1[0m  [["state_type_id", 5]]
D, [2018-09-12T21:39:27.590024 #11095] DEBUG -- :   [1m[36mTicket::StateType Load (0.4ms)[0m  [1m[34mSELECT  "ticket_state_types".* FROM "ticket_state_types" WHERE "ticket_state_types"."name" = $1 LIMIT $2[0m  [["name", "pending action"], ["LIMIT", 1]]
D, [2018-09-12T21:39:27.591428 #11095] DEBUG -- :   [1m[36mTicket::State Load (0.3ms)[0m  [1m[34mSELECT "ticket_states".* FROM "ticket_states" WHERE "ticket_states"."state_type_id" = $1[0m  [["state_type_id", 4]]
D, [2018-09-12T21:39:27.592872 #11095] DEBUG -- :   [1m[36mTicket::StateType Load (0.3ms)[0m  [1m[34mSELECT  "ticket_state_types".* FROM "ticket_state_types" WHERE "ticket_state_types"."name" = $1 LIMIT $2[0m  [["name", "pending reminder"], ["LIMIT", 1]]
D, [2018-09-12T21:39:27.594410 #11095] DEBUG -- :   [1m[36mTicket::State Load (0.5ms)[0m  [1m[34mSELECT "ticket_states".* FROM "ticket_states" WHERE "ticket_states"."state_type_id" = $1[0m  [["state_type_id", 3]]
D, [2018-09-12T21:39:27.597011 #11095] DEBUG -- :   [1m[36mTicket::Priority Load (1.1ms)[0m  [1m[34mSELECT "ticket_priorities".* FROM "ticket_priorities" WHERE "ticket_priorities"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T21:39:27.601142 #11095] DEBUG -- :   [1m[35m (1.0ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('ticket','ticket.agent') AND permissions.active = 't')[0m
D, [2018-09-12T21:39:27.602783 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('ticket','ticket.agent') AND permissions.active = 't')[0m
D, [2018-09-12T21:39:27.606939 #11095] DEBUG -- :   [1m[35m (1.7ms)[0m  [1m[34mSELECT "groups_users"."group_id" FROM "groups_users" LEFT OUTER JOIN "groups" ON "groups"."id" = "groups_users"."group_id" WHERE "groups_users"."user_id" = $1 AND "groups_users"."access" IN ('create', 'change', 'full') AND "groups"."active" = $2[0m  [["user_id", 3], ["active", "t"]]
D, [2018-09-12T21:39:27.610538 #11095] DEBUG -- :   [1m[35m (1.7ms)[0m  [1m[34mSELECT "roles_groups"."group_id" FROM "roles_groups" LEFT OUTER JOIN "groups" ON "groups"."id" = "roles_groups"."group_id" WHERE "roles_groups"."role_id" IN (1, 2) AND "roles_groups"."access" IN ('create', 'change', 'full') AND "groups"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T21:39:27.612172 #11095] DEBUG -- :   [1m[36mSetting Load (1.8ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:39:27.612834 #11095]  INFO -- : Completed 200 OK in 71ms (Views: 0.3ms | ActiveRecord: 4.9ms)


D, [2018-09-12T21:39:27.615432 #11095] DEBUG -- :   [1m[35m (1.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:39:27.616889 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:39:27.617863 #11095] DEBUG -- :   [1m[35m (2.4ms)[0m  [1m[34mSELECT DISTINCT "roles"."id" FROM "roles" INNER JOIN "permissions_roles" ON "permissions_roles"."role_id" = "roles"."id" INNER JOIN "permissions_roles" "roles_permissions_roles_join" ON "roles_permissions_roles_join"."role_id" = "roles"."id" INNER JOIN "permissions" ON "permissions"."id" = "roles_permissions_roles_join"."permission_id" WHERE (permissions_roles.permission_id IN (44,45) AND roles.active = 't' AND permissions.active = 't')[0m
I, [2018-09-12T21:39:27.622566 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 21:39:27 +0530
D, [2018-09-12T21:39:27.637094 #11095] DEBUG -- :   [1m[35m (16.4ms)[0m  [1m[34mSELECT "users"."id" FROM "users" INNER JOIN "roles_users" ON "roles_users"."user_id" = "users"."id" INNER JOIN "roles" ON "roles"."id" = "roles_users"."role_id" WHERE "users"."active" = $1 AND (roles_users.role_id IN (2))[0m  [["active", "t"]]
I, [2018-09-12T21:39:27.640549 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T21:39:27.640646 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T21:39:27.642986 #11095] DEBUG -- :   [1m[36mGroup Load (4.7ms)[0m  [1m[34mSELECT "groups".* FROM "groups" WHERE "groups"."id" = 1[0m
D, [2018-09-12T21:39:27.644408 #11095] DEBUG -- :   [1m[35m (1.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:39:27.646178 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:39:27.648437 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "users"."id" FROM "users" , groups_users WHERE (users.id = groups_users.user_id AND groups_users.access = 'full' AND groups_users.group_id = 1 AND users.id IN (52,5,4,3))[0m
D, [2018-09-12T21:39:27.649372 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT "roles"."id" FROM "roles" , roles_groups WHERE (roles.id = roles_groups.role_id AND roles_groups.access = 'full' AND roles_groups.group_id = 1 AND roles.id IN (2))[0m
D, [2018-09-12T21:39:27.651400 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "users"."id" FROM "users" INNER JOIN "roles_users" ON "roles_users"."user_id" = "users"."id" INNER JOIN "roles" ON "roles"."id" = "roles_users"."role_id" WHERE 1=0[0m
D, [2018-09-12T21:39:27.652446 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "users"."id" FROM "users" WHERE "users"."id" IN (3, 4, 5, 52) AND "users"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T21:39:27.659005 #11095] DEBUG -- :   [1m[36mSetting Load (0.8ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:39:27.659549 #11095]  INFO -- : Completed 200 OK in 133ms (Views: 3.0ms | ActiveRecord: 43.6ms)


D, [2018-09-12T21:39:27.660505 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:39:27.661819 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "sessions" SET "data" = $1, "updated_at" = $2 WHERE "sessions"."id" = $3[0m  [["data", "BAh7D0kiCXBpbmcGOgZFRkkiGTIwMTgtMDktMTJUMTY6MDk6MjdaBjsAVEki\nD3VzZXJfYWdlbnQGOwBGIm5Nb3ppbGxhLzUuMCAoWDExOyBMaW51eCB4ODZf\nNjQpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENo\ncm9tZS82OC4wLjM0NDAuMTA2IFNhZmFyaS81MzcuMzZJIhBfY3NyZl90b2tl\nbgY7AEZJIjE1SzlmTEZWTnRwVFYydjArWGQ1M21QMjFWbDAzT1RSeEp2cUpm\nbitDRDUwPQY7AEZJIgx1c2VyX2lkBjsARmkISSIadXNlcl9kZXZpY2VfcmVt\nb3RlX2lwBjsARiIIOjoxSSIcdXNlcl9kZXZpY2VfZmluZ2VycHJpbnQGOwBG\nSSIQLTE5OTI0Mjk4NTgGOwBUSSIbdXNlcl9kZXZpY2VfdXBkYXRlZF9hdAY7\nAEZVOiBBY3RpdmVTdXBwb3J0OjpUaW1lV2l0aFpvbmVbCEl1OglUaW1lDZCh\nHcCFFZ8kCToJem9uZUkiCFVUQwY7AEY6DW5hbm9fbnVtaQK9AToNbmFub19k\nZW5pBjoNc3VibWljcm8iB0RQSSIIVVRDBjsAVEAWSSIPcGVyc2lzdGVudAY7\nAEZUSSIOcmVtb3RlX2lwBjsARiIIOjoxSSIIZ2VvBjsARnsA\n"], ["updated_at", "2018-09-12 16:09:27.660796"], ["id", 33]]
D, [2018-09-12T21:39:27.662858 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:39:34.596141 #11095] DEBUG -- :   [1m[36mSetting Load (2.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:39:34.597498 #11095]  INFO -- : Completed 200 OK in 7024ms (Views: 0.5ms | ActiveRecord: 6.7ms)


D, [2018-09-12T21:39:34.600141 #11095] DEBUG -- :   [1m[36mUser Load (4.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:39:34.605572 #11095] DEBUG -- :   [1m[35m (2.0ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:39:34.607638 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:39:34.611240 #11095] DEBUG -- :   [1m[35m (3.4ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:39:34.612881 #11095] DEBUG -- :   [1m[35m (1.8ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T21:39:34.615885 #11095] DEBUG -- :   [1m[36mChat::Agent Load (1.2ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:39:34.617328 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
I, [2018-09-12T21:39:34.622057 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:39:34 +0530
D, [2018-09-12T21:39:34.622638 #11095] DEBUG -- :   [1m[35mSQL (1.6ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:09:34.616000"], ["id", 1]]
I, [2018-09-12T21:39:34.638445 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:39:34.638500 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:39:34.640260 #11095] DEBUG -- :   [1m[35m (3.8ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:39:34.641272 #11095] DEBUG -- :   [1m[35m (1.1ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:39:34.642217 #11095] DEBUG -- :   [1m[36mChat::Agent Load (1.1ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 08:09:34.640707')[0m
D, [2018-09-12T21:39:34.643439 #11095] DEBUG -- :   [1m[35m (1.2ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:39:34.644392 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:39:34.644748 #11095]  INFO -- : Completed 200 OK in 7004ms (Views: 0.1ms | ActiveRecord: 17.5ms)


D, [2018-09-12T21:39:34.645892 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:39:34.647235 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "sessions" SET "data" = $1, "updated_at" = $2 WHERE "sessions"."id" = $3[0m  [["data", "BAh7D0kiCXBpbmcGOgZFRkkiGTIwMTgtMDktMTJUMTY6MDk6MjZaBjsAVEki\nD3VzZXJfYWdlbnQGOwBGIm5Nb3ppbGxhLzUuMCAoWDExOyBMaW51eCB4ODZf\nNjQpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENo\ncm9tZS82OC4wLjM0NDAuMTA2IFNhZmFyaS81MzcuMzZJIhBfY3NyZl90b2tl\nbgY7AEZJIjE1SzlmTEZWTnRwVFYydjArWGQ1M21QMjFWbDAzT1RSeEp2cUpm\nbitDRDUwPQY7AEZJIgx1c2VyX2lkBjsARmkISSIadXNlcl9kZXZpY2VfcmVt\nb3RlX2lwBjsARiIIOjoxSSIcdXNlcl9kZXZpY2VfZmluZ2VycHJpbnQGOwBG\nSSIQLTE5OTI0Mjk4NTgGOwBUSSIbdXNlcl9kZXZpY2VfdXBkYXRlZF9hdAY7\nAEZVOiBBY3RpdmVTdXBwb3J0OjpUaW1lV2l0aFpvbmVbCEl1OglUaW1lDZCh\nHcCFFZ8kCToJem9uZUkiCFVUQwY7AEY6DW5hbm9fbnVtaQK9AToNbmFub19k\nZW5pBjoNc3VibWljcm8iB0RQSSIIVVRDBjsAVEAWSSIPcGVyc2lzdGVudAY7\nAEZUSSIOcmVtb3RlX2lwBjsARiIIOjoxSSIIZ2VvBjsARnsA\n"], ["updated_at", "2018-09-12 16:09:34.646175"], ["id", 33]]
D, [2018-09-12T21:39:34.648544 #11095] DEBUG -- :   [1m[35m (1.0ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:39:35.646563 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T21:39:35.650543 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:39:35.651875 #11095]  INFO -- : Completed 200 OK in 1013ms (Views: 0.5ms | ActiveRecord: 3.5ms)


D, [2018-09-12T21:39:35.654522 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:39:35.656739 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:39:35.667551 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 21:39:35 +0530
I, [2018-09-12T21:39:35.694699 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:39:35 +0530
I, [2018-09-12T21:39:35.717501 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T21:39:35.717668 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
I, [2018-09-12T21:39:35.720389 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:39:35.723936 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:39:35.727015 #11095] DEBUG -- :   [1m[35m (3.1ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:39:35.729082 #11095] DEBUG -- :   [1m[35m (2.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:39:35.730974 #11095] DEBUG -- :   [1m[35m (2.0ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:39:35.732869 #11095] DEBUG -- :   [1m[35m (2.1ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:39:35.734469 #11095] DEBUG -- :   [1m[36mUser Load (1.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:39:35.737848 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:39:35.741156 #11095] DEBUG -- :   [1m[35m (1.1ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T21:39:35.742938 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.8ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:39:35.743790 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:39:35.744651 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:39:35.747475 #11095] DEBUG -- :   [1m[35mSQL (0.6ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:09:35.744000"], ["id", 1]]
D, [2018-09-12T21:39:35.751169 #11095] DEBUG -- :   [1m[35m (3.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:39:35.753979 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.9ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T21:39:35.756001 #11095] DEBUG -- :   [1m[36mChat Load (0.7ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T21:39:35.759709 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.7ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:07:35.758245')[0m  [["active", "t"]]
D, [2018-09-12T21:39:35.764255 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.5ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T21:39:35.765873 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T21:39:35.767105 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.4ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T21:39:35.768222 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T21:39:35.769908 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:07:35.768495')[0m  [["active", "t"]]
D, [2018-09-12T21:39:35.771117 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:07:35.770190')[0m  [["active", "t"]]
D, [2018-09-12T21:39:35.772364 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T21:39:35.773308 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:07:35.772565')[0m  [["active", "t"]]
D, [2018-09-12T21:39:35.773975 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:39:35.775042 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T21:39:35.777770 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:39:35.778174 #11095]  INFO -- : Completed 200 OK in 58ms (Views: 0.1ms | ActiveRecord: 19.1ms)


D, [2018-09-12T21:39:35.779302 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:39:35.780088 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:39:36.739450 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T21:39:36.746863 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:39:36.748220 #11095]  INFO -- : Completed 200 OK in 1024ms (Views: 4.0ms | ActiveRecord: 5.4ms)


D, [2018-09-12T21:39:36.750782 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:39:36.753036 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:39:36.764344 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:39:36 +0530
I, [2018-09-12T21:39:36.792797 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:39:36.792886 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:39:36.795615 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:39:36.797362 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:39:43.810458 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:39:43.811888 #11095]  INFO -- : Completed 200 OK in 7019ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T21:39:43.814614 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:39:43.816036 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:39:43.819855 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:39:43 +0530
I, [2018-09-12T21:39:43.834339 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:39:43.834428 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:39:43.836978 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:39:43.838687 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:39:50.849384 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:39:50.850685 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.4ms | ActiveRecord: 2.1ms)


D, [2018-09-12T21:39:50.853203 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:39:50.855248 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:39:50.867743 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:39:50 +0530
I, [2018-09-12T21:39:50.897604 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:39:50.897735 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:39:50.900980 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:39:50.902728 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:39:57.913564 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:39:57.914948 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.4ms | ActiveRecord: 2.2ms)


D, [2018-09-12T21:39:57.917752 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:39:57.920091 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:39:57.929465 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:39:57 +0530
I, [2018-09-12T21:39:57.960341 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:39:57.960468 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:39:57.963372 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:39:57.965190 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:40:04.978222 #11095] DEBUG -- :   [1m[36mSetting Load (1.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:40:04.981236 #11095]  INFO -- : Completed 200 OK in 7019ms (Views: 0.5ms | ActiveRecord: 2.5ms)


D, [2018-09-12T21:40:04.984963 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:40:04.987619 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:40:04.998113 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:40:04 +0530
I, [2018-09-12T21:40:05.025111 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:40:05.025190 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:40:05.027587 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:40:05.029224 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:40:12.041456 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:40:12.042795 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.5ms | ActiveRecord: 2.1ms)


D, [2018-09-12T21:40:12.045549 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:40:12.047871 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:40:12.057568 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:40:12 +0530
I, [2018-09-12T21:40:12.087181 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:40:12.087312 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:40:12.090873 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:40:12.092487 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:40:19.105657 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:40:19.107103 #11095]  INFO -- : Completed 200 OK in 7019ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T21:40:19.109907 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:40:19.112197 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:40:19.121739 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:40:19 +0530
I, [2018-09-12T21:40:19.134502 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:40:19.134575 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:40:19.137269 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:40:19.139403 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T21:40:23.365152 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 21:40:23 +0530
I, [2018-09-12T21:40:23.378531 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T21:40:23.378613 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T21:40:23.380822 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:40:23.382372 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:40:23.383712 #11095] DEBUG -- :   [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:40:23.385228 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:40:23.386672 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T21:40:23.387657 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.5ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:40:23.388221 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:40:23.389720 #11095] DEBUG -- :   [1m[35mSQL (0.4ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:10:23.387000"], ["id", 1]]
D, [2018-09-12T21:40:23.390917 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:40:23.392137 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 08:10:23.391368')[0m
D, [2018-09-12T21:40:23.393732 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:40:23.394214 #11095]  INFO -- : Completed 200 OK in 15ms (Views: 0.1ms | ActiveRecord: 4.5ms)


D, [2018-09-12T21:40:23.396144 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:40:23.397023 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:40:24.147763 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T21:40:24.151362 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:40:24.152741 #11095]  INFO -- : Completed 200 OK in 5018ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T21:40:24.155138 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:40:24.157119 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:40:24.167981 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:40:24 +0530
I, [2018-09-12T21:40:24.168360 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 21:40:24 +0530
I, [2018-09-12T21:40:24.193200 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:40:24.194578 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
I, [2018-09-12T21:40:24.196272 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T21:40:24.196385 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
D, [2018-09-12T21:40:24.197891 #11095] DEBUG -- :   [1m[35m (1.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:40:24.198896 #11095] DEBUG -- :   [1m[35m (1.1ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:40:24.199906 #11095] DEBUG -- :   [1m[35m (1.2ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:40:24.200500 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:40:24.201750 #11095] DEBUG -- :   [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:40:24.203300 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:40:24.204546 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T21:40:24.205417 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:40:24.205765 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:40:24.206188 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:40:24.207628 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:10:24.205000"], ["id", 1]]
D, [2018-09-12T21:40:24.214648 #11095] DEBUG -- :   [1m[35m (6.7ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:40:24.216430 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.7ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T21:40:24.217475 #11095] DEBUG -- :   [1m[36mChat Load (0.4ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T21:40:24.219296 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:08:24.218586')[0m  [["active", "t"]]
D, [2018-09-12T21:40:24.221433 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.2ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T21:40:24.222205 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T21:40:24.222817 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.2ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T21:40:24.223485 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T21:40:24.224308 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:08:24.223646')[0m  [["active", "t"]]
D, [2018-09-12T21:40:24.225029 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:08:24.224452')[0m  [["active", "t"]]
D, [2018-09-12T21:40:24.225817 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T21:40:24.226511 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:08:24.225963')[0m  [["active", "t"]]
D, [2018-09-12T21:40:24.227045 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:40:24.227842 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T21:40:24.230203 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:40:24.230558 #11095]  INFO -- : Completed 200 OK in 34ms (Views: 0.1ms | ActiveRecord: 14.5ms)


D, [2018-09-12T21:40:24.231708 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:40:24.232435 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:40:25.205729 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T21:40:25.208991 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:40:25.209418 #11095]  INFO -- : Completed 200 OK in 1015ms (Views: 1.8ms | ActiveRecord: 3.2ms)


D, [2018-09-12T21:40:25.210411 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:40:25.211249 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:40:25.216786 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:40:25 +0530
I, [2018-09-12T21:40:25.228412 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:40:25.228481 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:40:25.230575 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:40:25.231944 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:40:32.245065 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:40:32.246480 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.5ms | ActiveRecord: 2.0ms)


D, [2018-09-12T21:40:32.249306 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:40:32.251733 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:40:32.262035 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:40:32 +0530
I, [2018-09-12T21:40:32.293998 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:40:32.294117 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:40:32.297072 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:40:32.298980 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:40:39.312776 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:40:39.314175 #11095]  INFO -- : Completed 200 OK in 7020ms (Views: 0.5ms | ActiveRecord: 2.4ms)


D, [2018-09-12T21:40:39.317043 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:40:39.318240 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:40:39.322174 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:40:39 +0530
I, [2018-09-12T21:40:39.344389 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:40:39.344468 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:40:39.346864 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:40:39.348358 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:40:46.361371 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:40:46.362687 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.5ms | ActiveRecord: 2.1ms)


D, [2018-09-12T21:40:46.365469 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:40:46.367833 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:40:46.381855 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:40:46 +0530
I, [2018-09-12T21:40:46.409821 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:40:46.409913 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:40:46.412497 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:40:46.414158 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:40:53.426440 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:40:53.428022 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.8ms | ActiveRecord: 2.1ms)


D, [2018-09-12T21:40:53.430983 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:40:53.433545 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:40:53.443972 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:40:53 +0530
I, [2018-09-12T21:40:53.468244 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:40:53.468319 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:40:53.470578 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:40:53.472105 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:41:00.482972 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:41:00.484384 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.5ms | ActiveRecord: 2.1ms)


D, [2018-09-12T21:41:00.486990 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:41:00.488550 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:41:00.492302 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:41:00 +0530
I, [2018-09-12T21:41:00.505303 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:41:00.505374 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:41:00.507548 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:41:00.508953 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:41:07.520171 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:41:07.521438 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.4ms | ActiveRecord: 1.8ms)


D, [2018-09-12T21:41:07.523890 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:41:07.525882 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:41:07.534756 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:41:07 +0530
I, [2018-09-12T21:41:07.569038 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:41:07.569210 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:41:07.574908 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:41:07.577857 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:41:14.591718 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:41:14.593192 #11095]  INFO -- : Completed 200 OK in 7024ms (Views: 0.5ms | ActiveRecord: 2.8ms)


D, [2018-09-12T21:41:14.595965 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:41:14.596905 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:41:14.600770 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:41:14 +0530
I, [2018-09-12T21:41:14.616408 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:41:14.616519 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:41:14.619501 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:41:14.621563 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T21:41:18.368775 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 21:41:18 +0530
I, [2018-09-12T21:41:18.383054 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T21:41:18.383124 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T21:41:18.385211 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:41:18.386654 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:41:18.387855 #11095] DEBUG -- :   [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:41:18.389296 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:41:18.390546 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T21:41:18.391288 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:41:18.391858 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:41:18.393188 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:11:18.391000"], ["id", 1]]
D, [2018-09-12T21:41:18.400555 #11095] DEBUG -- :   [1m[35m (6.9ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:41:18.402987 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.8ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 08:11:18.401186')[0m
D, [2018-09-12T21:41:18.405533 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:41:18.405985 #11095]  INFO -- : Completed 200 OK in 23ms (Views: 0.4ms | ActiveRecord: 10.5ms)


D, [2018-09-12T21:41:18.407282 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:41:18.408112 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:41:19.630113 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T21:41:19.632992 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:41:19.633457 #11095]  INFO -- : Completed 200 OK in 5017ms (Views: 0.6ms | ActiveRecord: 1.5ms)


D, [2018-09-12T21:41:19.634311 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:41:19.635006 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:41:19.639306 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:41:19 +0530
I, [2018-09-12T21:41:19.639558 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 21:41:19 +0530
I, [2018-09-12T21:41:19.663817 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:41:19.665261 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T21:41:19.665365 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
I, [2018-09-12T21:41:19.665516 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
D, [2018-09-12T21:41:19.669065 #11095] DEBUG -- :   [1m[35m (1.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:41:19.670119 #11095] DEBUG -- :   [1m[35m (1.2ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:41:19.671081 #11095] DEBUG -- :   [1m[35m (1.1ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:41:19.671797 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:41:19.673159 #11095] DEBUG -- :   [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:41:19.674972 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:41:19.676752 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T21:41:19.677854 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:41:19.678623 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:41:19.679786 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:41:19.682688 #11095] DEBUG -- :   [1m[35mSQL (0.5ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:11:19.678000"], ["id", 1]]
D, [2018-09-12T21:41:19.685975 #11095] DEBUG -- :   [1m[35m (2.8ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:41:19.688661 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.8ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T21:41:19.690674 #11095] DEBUG -- :   [1m[36mChat Load (0.4ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T21:41:19.693238 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:09:19.692063')[0m  [["active", "t"]]
D, [2018-09-12T21:41:19.695718 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T21:41:19.696493 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T21:41:19.697122 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T21:41:19.697937 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T21:41:19.698902 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:09:19.698099')[0m  [["active", "t"]]
D, [2018-09-12T21:41:19.699692 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:09:19.699053')[0m  [["active", "t"]]
D, [2018-09-12T21:41:19.700596 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T21:41:19.701406 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:09:19.700785')[0m  [["active", "t"]]
D, [2018-09-12T21:41:19.701989 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:41:19.702875 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T21:41:19.705430 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:41:19.705805 #11095]  INFO -- : Completed 200 OK in 38ms (Views: 0.1ms | ActiveRecord: 11.6ms)


D, [2018-09-12T21:41:19.706974 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:41:19.707756 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:41:20.675727 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T21:41:20.680396 #11095] DEBUG -- :   [1m[36mSetting Load (0.6ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:41:20.681047 #11095]  INFO -- : Completed 200 OK in 1015ms (Views: 2.9ms | ActiveRecord: 3.2ms)


D, [2018-09-12T21:41:20.682333 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:41:20.684380 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:41:20.691049 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:41:20 +0530
I, [2018-09-12T21:41:20.707134 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:41:20.707321 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:41:20.712022 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:41:20.714945 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:41:27.726790 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:41:27.728172 #11095]  INFO -- : Completed 200 OK in 7020ms (Views: 0.5ms | ActiveRecord: 2.6ms)


D, [2018-09-12T21:41:27.730907 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:41:27.733058 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:41:27.742842 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:41:27 +0530
I, [2018-09-12T21:41:27.772137 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:41:27.772246 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:41:27.774833 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:41:27.776454 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:41:34.789213 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:41:34.791560 #11095]  INFO -- : Completed 200 OK in 7019ms (Views: 0.9ms | ActiveRecord: 2.1ms)


D, [2018-09-12T21:41:34.795886 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:41:34.799264 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:41:34.806759 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:41:34 +0530
I, [2018-09-12T21:41:34.823144 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:41:34.823220 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:41:34.825611 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:41:34.827097 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:41:41.837781 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:41:41.839153 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.5ms | ActiveRecord: 2.0ms)


D, [2018-09-12T21:41:41.841849 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:41:41.844052 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:41:41.854162 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:41:41 +0530
I, [2018-09-12T21:41:41.884291 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:41:41.884383 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:41:41.887030 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:41:41.888801 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:41:48.901859 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:41:48.903237 #11095]  INFO -- : Completed 200 OK in 7019ms (Views: 0.6ms | ActiveRecord: 2.4ms)


D, [2018-09-12T21:41:48.905956 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:41:48.907635 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:41:48.912262 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:41:48 +0530
I, [2018-09-12T21:41:48.930540 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:41:48.930650 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:41:48.934474 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:41:48.936729 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:41:55.950768 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:41:55.951762 #11095]  INFO -- : Completed 200 OK in 7021ms (Views: 0.5ms | ActiveRecord: 2.5ms)


D, [2018-09-12T21:41:55.952638 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:41:55.953353 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:41:55.957549 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:41:55 +0530
I, [2018-09-12T21:41:55.972692 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:41:55.972806 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:41:55.975431 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:41:55.977253 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:42:02.995382 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:42:02.996753 #11095]  INFO -- : Completed 200 OK in 7024ms (Views: 0.5ms | ActiveRecord: 2.3ms)


D, [2018-09-12T21:42:02.999445 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:42:03.001724 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:42:03.012218 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:42:03 +0530
I, [2018-09-12T21:42:03.042099 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:42:03.042218 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:42:03.044808 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:42:03.046478 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:42:10.060724 #11095] DEBUG -- :   [1m[36mSetting Load (1.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:42:10.062094 #11095]  INFO -- : Completed 200 OK in 7020ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T21:42:10.064820 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:42:10.067161 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:42:10.077189 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:42:10 +0530
I, [2018-09-12T21:42:10.108760 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:42:10.108891 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:42:10.111918 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:42:10.113763 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T21:42:13.362126 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 21:42:13 +0530
I, [2018-09-12T21:42:13.377218 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T21:42:13.377313 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T21:42:13.379875 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:42:13.381541 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:42:13.382975 #11095] DEBUG -- :   [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:42:13.384763 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:42:13.386316 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T21:42:13.387198 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:42:13.387817 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:42:13.389408 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:12:13.387000"], ["id", 1]]
D, [2018-09-12T21:42:13.390704 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:42:13.392487 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 08:12:13.391526')[0m
D, [2018-09-12T21:42:13.394797 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:42:13.395318 #11095]  INFO -- : Completed 200 OK in 18ms (Views: 0.3ms | ActiveRecord: 4.5ms)


D, [2018-09-12T21:42:13.396806 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:42:13.398094 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:42:15.126777 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T21:42:15.130826 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:42:15.132169 #11095]  INFO -- : Completed 200 OK in 5023ms (Views: 0.6ms | ActiveRecord: 2.1ms)


D, [2018-09-12T21:42:15.134847 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:42:15.137065 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:42:15.145591 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 21:42:15 +0530
I, [2018-09-12T21:42:15.156509 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:42:15 +0530
I, [2018-09-12T21:42:15.169358 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T21:42:15.170905 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
I, [2018-09-12T21:42:15.172924 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:42:15.173045 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:42:15.174790 #11095] DEBUG -- :   [1m[35m (1.8ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:42:15.175981 #11095] DEBUG -- :   [1m[35m (1.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:42:15.177129 #11095] DEBUG -- :   [1m[35m (1.3ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:42:15.178187 #11095] DEBUG -- :   [1m[35m (1.1ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:42:15.178848 #11095] DEBUG -- :   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:42:15.180444 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:42:15.181872 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T21:42:15.182670 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:42:15.183085 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:42:15.183530 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:42:15.185021 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:12:15.183000"], ["id", 1]]
D, [2018-09-12T21:42:15.192279 #11095] DEBUG -- :   [1m[35m (6.9ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:42:15.194104 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.5ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T21:42:15.195087 #11095] DEBUG -- :   [1m[36mChat Load (0.3ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T21:42:15.197100 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:10:15.196366')[0m  [["active", "t"]]
D, [2018-09-12T21:42:15.199502 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T21:42:15.200292 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T21:42:15.200951 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T21:42:15.201729 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T21:42:15.202616 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:10:15.201923')[0m  [["active", "t"]]
D, [2018-09-12T21:42:15.203382 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:10:15.202758')[0m  [["active", "t"]]
D, [2018-09-12T21:42:15.204249 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T21:42:15.205050 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:10:15.204407')[0m  [["active", "t"]]
D, [2018-09-12T21:42:15.205636 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:42:15.206504 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T21:42:15.208872 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:42:15.209259 #11095]  INFO -- : Completed 200 OK in 38ms (Views: 0.1ms | ActiveRecord: 16.1ms)


D, [2018-09-12T21:42:15.210493 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:42:15.211257 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:42:16.183587 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T21:42:16.187221 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:42:16.187655 #11095]  INFO -- : Completed 200 OK in 1014ms (Views: 2.1ms | ActiveRecord: 2.9ms)


D, [2018-09-12T21:42:16.188578 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:42:16.189798 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:42:16.193919 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:42:16 +0530
I, [2018-09-12T21:42:16.206658 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:42:16.206733 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:42:16.209011 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:42:16.210518 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:42:23.224160 #11095] DEBUG -- :   [1m[36mSetting Load (1.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:42:23.225736 #11095]  INFO -- : Completed 200 OK in 7019ms (Views: 0.5ms | ActiveRecord: 2.3ms)


D, [2018-09-12T21:42:23.228533 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:42:23.229860 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:42:23.234136 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:42:23 +0530
I, [2018-09-12T21:42:23.250150 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:42:23.250247 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:42:23.253200 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:42:23.255229 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:42:30.266144 #11095] DEBUG -- :   [1m[36mSetting Load (1.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:42:30.268047 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.5ms | ActiveRecord: 2.6ms)


D, [2018-09-12T21:42:30.271691 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:42:30.274014 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:42:30.284557 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:42:30 +0530
I, [2018-09-12T21:42:30.310579 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:42:30.310673 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:42:30.313553 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:42:30.315037 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:42:37.325268 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:42:37.326694 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.5ms | ActiveRecord: 1.9ms)


D, [2018-09-12T21:42:37.329438 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:42:37.331747 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:42:37.339441 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:42:37 +0530
I, [2018-09-12T21:42:37.352833 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:42:37.352905 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:42:37.355501 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:42:37.366020 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:42:44.375308 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:42:44.376565 #11095]  INFO -- : Completed 200 OK in 7023ms (Views: 0.4ms | ActiveRecord: 2.2ms)


D, [2018-09-12T21:42:44.377416 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:42:44.378096 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:42:44.382166 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:42:44 +0530
I, [2018-09-12T21:42:44.395945 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:42:44.396043 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:42:44.398483 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:42:44.400107 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:42:51.411419 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:42:51.412791 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.4ms | ActiveRecord: 2.2ms)


D, [2018-09-12T21:42:51.415136 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:42:51.416561 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:42:51.421460 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:42:51 +0530
I, [2018-09-12T21:42:51.434508 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:42:51.434605 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:42:51.436992 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:42:51.438511 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:42:58.448709 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:42:58.450061 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.4ms | ActiveRecord: 2.2ms)


D, [2018-09-12T21:42:58.452811 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:42:58.456137 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:42:58.466196 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:42:58 +0530
I, [2018-09-12T21:42:58.496963 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:42:58.497050 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:42:58.499717 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:42:58.501458 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:43:05.512164 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:43:05.513994 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.7ms | ActiveRecord: 2.3ms)


D, [2018-09-12T21:43:05.517258 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:43:05.519113 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:43:05.527977 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:43:05 +0530
I, [2018-09-12T21:43:05.548470 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:43:05.548546 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:43:05.550868 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:43:05.552373 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T21:43:07.548466 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 21:43:07 +0530
I, [2018-09-12T21:43:07.571660 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T21:43:07.571759 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T21:43:07.574249 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:43:07.575813 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:43:07.577093 #11095] DEBUG -- :   [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:43:07.578756 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:43:07.580812 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T21:43:07.581591 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:43:07.582119 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:43:07.583412 #11095] DEBUG -- :   [1m[35mSQL (0.2ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:13:07.581000"], ["id", 1]]
D, [2018-09-12T21:43:07.584622 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:43:07.585655 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 08:13:07.585037')[0m
D, [2018-09-12T21:43:07.586891 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:43:07.587253 #11095]  INFO -- : Completed 200 OK in 15ms (Views: 0.1ms | ActiveRecord: 4.2ms)


D, [2018-09-12T21:43:07.588343 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:43:07.588972 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:43:08.570178 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T21:43:08.573910 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:43:08.575044 #11095]  INFO -- : Completed 200 OK in 3026ms (Views: 0.5ms | ActiveRecord: 2.0ms)


D, [2018-09-12T21:43:08.577479 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:43:08.579475 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:43:08.589939 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 21:43:08 +0530
I, [2018-09-12T21:43:08.613806 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:43:08 +0530
I, [2018-09-12T21:43:08.634315 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T21:43:08.634438 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
I, [2018-09-12T21:43:08.639882 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
D, [2018-09-12T21:43:08.640316 #11095] DEBUG -- :   [1m[35m (3.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
I, [2018-09-12T21:43:08.641918 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:43:08.645038 #11095] DEBUG -- :   [1m[35m (2.9ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:43:08.646566 #11095] DEBUG -- :   [1m[35m (1.8ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:43:08.648368 #11095] DEBUG -- :   [1m[36mUser Load (1.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:43:08.650671 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:43:08.651769 #11095] DEBUG -- :   [1m[35m (2.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:43:08.652551 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T21:43:08.653432 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:43:08.653837 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:43:08.654293 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:43:08.655650 #11095] DEBUG -- :   [1m[35mSQL (0.2ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:13:08.653000"], ["id", 1]]
D, [2018-09-12T21:43:08.662650 #11095] DEBUG -- :   [1m[35m (6.7ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:43:08.664406 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.7ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T21:43:08.665352 #11095] DEBUG -- :   [1m[36mChat Load (0.3ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T21:43:08.666935 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:11:08.666322')[0m  [["active", "t"]]
D, [2018-09-12T21:43:08.668845 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.2ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T21:43:08.669502 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T21:43:08.670032 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.2ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T21:43:08.670662 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T21:43:08.671377 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:11:08.670790')[0m  [["active", "t"]]
D, [2018-09-12T21:43:08.671940 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:11:08.671494')[0m  [["active", "t"]]
D, [2018-09-12T21:43:08.672591 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T21:43:08.673200 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:11:08.672726')[0m  [["active", "t"]]
D, [2018-09-12T21:43:08.673674 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:43:08.674380 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T21:43:08.676712 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:43:08.677044 #11095]  INFO -- : Completed 200 OK in 42ms (Views: 0.1ms | ActiveRecord: 19.6ms)


D, [2018-09-12T21:43:08.678169 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:43:08.678828 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:43:09.657800 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T21:43:09.664595 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:43:09.665846 #11095]  INFO -- : Completed 200 OK in 1024ms (Views: 3.5ms | ActiveRecord: 5.4ms)


D, [2018-09-12T21:43:09.668366 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:43:09.670383 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:43:09.680987 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:43:09 +0530
I, [2018-09-12T21:43:09.708807 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:43:09.708893 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:43:09.711588 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:43:09.713138 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:43:16.722817 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:43:16.724132 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.4ms | ActiveRecord: 2.0ms)


D, [2018-09-12T21:43:16.726601 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:43:16.728616 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:43:16.737468 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:43:16 +0530
I, [2018-09-12T21:43:16.766686 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:43:16.766794 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:43:16.769869 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:43:16.771716 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:43:23.781164 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:43:23.782362 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.5ms | ActiveRecord: 2.1ms)


D, [2018-09-12T21:43:23.784905 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:43:23.786817 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:43:23.795276 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:43:23 +0530
I, [2018-09-12T21:43:23.821737 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:43:23.821819 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:43:23.824319 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:43:23.825961 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:43:30.835126 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:43:30.836353 #11095]  INFO -- : Completed 200 OK in 7014ms (Views: 0.4ms | ActiveRecord: 1.9ms)


D, [2018-09-12T21:43:30.838746 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:43:30.840743 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:43:30.849167 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:43:30 +0530
I, [2018-09-12T21:43:30.877132 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:43:30.877246 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:43:30.880273 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:43:30.882078 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:43:37.891924 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:43:37.893188 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.4ms | ActiveRecord: 2.2ms)


D, [2018-09-12T21:43:37.895649 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:43:37.897678 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:43:37.907675 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:43:37 +0530
I, [2018-09-12T21:43:37.934489 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:43:37.934590 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:43:37.937313 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:43:37.939100 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:43:44.953617 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:43:44.955348 #11095]  INFO -- : Completed 200 OK in 7020ms (Views: 0.6ms | ActiveRecord: 2.3ms)


D, [2018-09-12T21:43:44.958526 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:43:44.961423 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:43:44.968648 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:43:44 +0530
I, [2018-09-12T21:43:44.984659 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:43:44.984741 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:43:44.987317 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:43:44.988804 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:43:51.999228 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:43:52.000602 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.4ms | ActiveRecord: 1.9ms)


D, [2018-09-12T21:43:52.003240 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:43:52.005502 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:43:52.015390 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:43:52 +0530
I, [2018-09-12T21:43:52.044150 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:43:52.044256 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:43:52.046981 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:43:52.048761 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:43:59.055682 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:43:59.056057 #11095]  INFO -- : Completed 200 OK in 7012ms (Views: 0.2ms | ActiveRecord: 1.4ms)


D, [2018-09-12T21:43:59.056874 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:43:59.057517 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:43:59.060446 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:43:59 +0530
I, [2018-09-12T21:43:59.070697 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:43:59.070785 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:43:59.073425 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:43:59.075114 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T21:44:03.365135 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 21:44:03 +0530
I, [2018-09-12T21:44:03.390011 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T21:44:03.390106 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T21:44:03.392610 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:44:03.394544 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:44:03.396394 #11095] DEBUG -- :   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:44:03.398252 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:44:03.400060 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T21:44:03.402668 #11095] DEBUG -- :   [1m[36mChat::Agent Load (1.6ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:44:03.403395 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:44:03.405964 #11095] DEBUG -- :   [1m[35mSQL (0.5ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:14:03.402000"], ["id", 1]]
D, [2018-09-12T21:44:03.407701 #11095] DEBUG -- :   [1m[35m (1.0ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:44:03.409105 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 08:14:03.408248')[0m
D, [2018-09-12T21:44:03.410555 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:44:03.410975 #11095]  INFO -- : Completed 200 OK in 21ms (Views: 0.1ms | ActiveRecord: 6.6ms)


D, [2018-09-12T21:44:03.412227 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:44:03.412999 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:44:04.082774 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T21:44:04.085741 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:44:04.086484 #11095]  INFO -- : Completed 200 OK in 5016ms (Views: 0.5ms | ActiveRecord: 1.3ms)


D, [2018-09-12T21:44:04.089220 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:44:04.090331 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:44:04.094599 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 21:44:04 +0530
I, [2018-09-12T21:44:04.107598 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:44:04 +0530
I, [2018-09-12T21:44:04.125726 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T21:44:04.125832 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
I, [2018-09-12T21:44:04.129638 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
D, [2018-09-12T21:44:04.129890 #11095] DEBUG -- :   [1m[35m (2.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
I, [2018-09-12T21:44:04.130915 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:44:04.133600 #11095] DEBUG -- :   [1m[35m (2.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:44:04.135639 #11095] DEBUG -- :   [1m[35m (2.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:44:04.137095 #11095] DEBUG -- :   [1m[36mUser Load (1.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:44:04.138948 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:44:04.140015 #11095] DEBUG -- :   [1m[35m (3.0ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:44:04.140870 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T21:44:04.141808 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:44:04.142281 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:44:04.142786 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:44:04.144827 #11095] DEBUG -- :   [1m[35mSQL (0.5ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:14:04.142000"], ["id", 1]]
D, [2018-09-12T21:44:04.151916 #11095] DEBUG -- :   [1m[35m (6.7ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:44:04.153275 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T21:44:04.154149 #11095] DEBUG -- :   [1m[36mChat Load (0.2ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T21:44:04.155923 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:12:04.155227')[0m  [["active", "t"]]
D, [2018-09-12T21:44:04.158016 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T21:44:04.158698 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T21:44:04.159242 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.2ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T21:44:04.159862 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T21:44:04.160609 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:12:04.160000')[0m  [["active", "t"]]
D, [2018-09-12T21:44:04.161270 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:12:04.160754')[0m  [["active", "t"]]
D, [2018-09-12T21:44:04.161989 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T21:44:04.162637 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:12:04.162113')[0m  [["active", "t"]]
D, [2018-09-12T21:44:04.163135 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:44:04.163894 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T21:44:04.165994 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:44:04.166344 #11095]  INFO -- : Completed 200 OK in 40ms (Views: 0.2ms | ActiveRecord: 18.2ms)


D, [2018-09-12T21:44:04.167378 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:44:04.168083 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:44:05.145892 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T21:44:05.148634 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:44:05.149047 #11095]  INFO -- : Completed 200 OK in 1018ms (Views: 1.3ms | ActiveRecord: 5.8ms)


D, [2018-09-12T21:44:05.149929 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:44:05.150653 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:44:05.154577 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:44:05 +0530
I, [2018-09-12T21:44:05.166739 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:44:05.166812 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:44:05.168967 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:44:05.170362 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:44:12.180718 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:44:12.182075 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T21:44:12.184929 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:44:12.187242 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:44:12.197438 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:44:12 +0530
I, [2018-09-12T21:44:12.226984 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:44:12.227092 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:44:12.229838 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:44:12.231757 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:44:19.242800 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:44:19.244177 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.5ms | ActiveRecord: 2.4ms)


D, [2018-09-12T21:44:19.246880 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:44:19.249114 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:44:19.259191 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:44:19 +0530
I, [2018-09-12T21:44:19.290000 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:44:19.290105 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:44:19.293329 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:44:19.295468 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:44:26.305945 #11095] DEBUG -- :   [1m[36mSetting Load (1.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:44:26.307409 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.5ms | ActiveRecord: 2.6ms)


D, [2018-09-12T21:44:26.310670 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:44:26.313367 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:44:26.323631 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:44:26 +0530
I, [2018-09-12T21:44:26.344569 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:44:26.344656 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:44:26.347162 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:44:26.348733 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:44:33.360115 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:44:33.360738 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.7ms | ActiveRecord: 2.2ms)


D, [2018-09-12T21:44:33.361961 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:44:33.362835 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:44:33.367045 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:44:33 +0530
I, [2018-09-12T21:44:33.381832 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:44:33.381926 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:44:33.384334 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:44:33.385933 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:44:40.399762 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:44:40.401707 #11095]  INFO -- : Completed 200 OK in 7019ms (Views: 0.6ms | ActiveRecord: 2.2ms)


D, [2018-09-12T21:44:40.404552 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:44:40.405422 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:44:40.409512 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:44:40 +0530
I, [2018-09-12T21:44:40.435260 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:44:40.435342 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:44:40.437809 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:44:40.439365 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:44:47.449448 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:44:47.450756 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.4ms | ActiveRecord: 2.1ms)


D, [2018-09-12T21:44:47.453284 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:44:47.455297 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:44:47.465596 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:44:47 +0530
I, [2018-09-12T21:44:47.496783 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:44:47.496895 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:44:47.499638 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:44:47.501485 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:44:54.513213 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:44:54.514542 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.4ms | ActiveRecord: 2.2ms)


D, [2018-09-12T21:44:54.517193 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:44:54.519337 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:44:54.531398 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:44:54 +0530
I, [2018-09-12T21:44:54.547134 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:44:54.547214 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:44:54.549611 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:44:54.551132 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T21:44:58.364462 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 21:44:58 +0530
I, [2018-09-12T21:44:58.378891 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T21:44:58.378989 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T21:44:58.381562 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:44:58.383322 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:44:58.384893 #11095] DEBUG -- :   [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:44:58.386661 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:44:58.388272 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T21:44:58.389138 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:44:58.389735 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:44:58.391340 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:14:58.389000"], ["id", 1]]
D, [2018-09-12T21:44:58.398574 #11095] DEBUG -- :   [1m[35m (6.8ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:44:58.400206 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 08:14:58.399215')[0m
D, [2018-09-12T21:44:58.401923 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:44:58.402403 #11095]  INFO -- : Completed 200 OK in 23ms (Views: 0.1ms | ActiveRecord: 10.3ms)


D, [2018-09-12T21:44:58.403872 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:44:58.404924 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:44:59.558167 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T21:44:59.562167 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:44:59.563514 #11095]  INFO -- : Completed 200 OK in 5016ms (Views: 0.5ms | ActiveRecord: 2.1ms)


D, [2018-09-12T21:44:59.566240 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:44:59.568484 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:44:59.577681 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:44:59 +0530
I, [2018-09-12T21:44:59.589203 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 21:44:59 +0530
I, [2018-09-12T21:44:59.602519 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:44:59.602636 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
I, [2018-09-12T21:44:59.606040 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T21:44:59.606120 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
D, [2018-09-12T21:44:59.607831 #11095] DEBUG -- :   [1m[35m (3.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:44:59.608960 #11095] DEBUG -- :   [1m[35m (1.2ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:44:59.609970 #11095] DEBUG -- :   [1m[35m (1.1ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:44:59.610653 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:44:59.611923 #11095] DEBUG -- :   [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:44:59.613490 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:44:59.614959 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T21:44:59.615810 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:44:59.616232 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:44:59.616724 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:44:59.618747 #11095] DEBUG -- :   [1m[35mSQL (0.7ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:14:59.616000"], ["id", 1]]
D, [2018-09-12T21:44:59.621873 #11095] DEBUG -- :   [1m[35m (2.8ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:44:59.623326 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T21:44:59.624315 #11095] DEBUG -- :   [1m[36mChat Load (0.3ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T21:44:59.626229 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:12:59.625498')[0m  [["active", "t"]]
D, [2018-09-12T21:44:59.628629 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T21:44:59.629428 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T21:44:59.630096 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T21:44:59.630862 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T21:44:59.631738 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:12:59.631029')[0m  [["active", "t"]]
D, [2018-09-12T21:44:59.632473 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:12:59.631900')[0m  [["active", "t"]]
D, [2018-09-12T21:44:59.633307 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T21:44:59.634063 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:12:59.633460')[0m  [["active", "t"]]
D, [2018-09-12T21:44:59.634645 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:44:59.635525 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T21:44:59.637909 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:44:59.638334 #11095]  INFO -- : Completed 200 OK in 32ms (Views: 0.1ms | ActiveRecord: 10.9ms)


D, [2018-09-12T21:44:59.639565 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:44:59.640360 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:45:00.614888 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T21:45:00.618578 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:45:00.619032 #11095]  INFO -- : Completed 200 OK in 1016ms (Views: 2.2ms | ActiveRecord: 4.9ms)


D, [2018-09-12T21:45:00.620013 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:45:00.620885 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:45:00.625690 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:45:00 +0530
I, [2018-09-12T21:45:00.643254 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:45:00.643386 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:45:00.647281 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:45:00.649695 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:45:07.660165 #11095] DEBUG -- :   [1m[36mSetting Load (0.7ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:45:07.661249 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.3ms | ActiveRecord: 2.4ms)


D, [2018-09-12T21:45:07.663180 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:45:07.665576 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:45:07.671950 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:45:07 +0530
I, [2018-09-12T21:45:07.692053 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:45:07.692144 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:45:07.695664 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:45:07.698559 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:45:14.708886 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:45:14.710134 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.4ms | ActiveRecord: 2.5ms)


D, [2018-09-12T21:45:14.712478 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:45:14.714384 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:45:14.723253 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:45:14 +0530
I, [2018-09-12T21:45:14.751473 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:45:14.751629 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:45:14.754479 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:45:14.756229 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:45:21.765806 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:45:21.767056 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.4ms | ActiveRecord: 2.0ms)


D, [2018-09-12T21:45:21.769531 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:45:21.770798 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:45:21.774140 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:45:21 +0530
I, [2018-09-12T21:45:21.785355 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:45:21.785429 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:45:21.787433 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:45:21.788829 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:45:28.798439 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:45:28.799634 #11095]  INFO -- : Completed 200 OK in 7014ms (Views: 0.5ms | ActiveRecord: 1.9ms)


D, [2018-09-12T21:45:28.802001 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:45:28.804156 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:45:28.811148 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:45:28 +0530
I, [2018-09-12T21:45:28.821275 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:45:28.821336 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:45:28.823305 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:45:28.824570 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:45:35.836304 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:45:35.837637 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.5ms | ActiveRecord: 1.9ms)


D, [2018-09-12T21:45:35.840373 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:45:35.842633 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:45:35.853025 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:45:35 +0530
I, [2018-09-12T21:45:35.868732 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:45:35.868810 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:45:35.871286 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:45:35.872854 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:45:42.885130 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:45:42.886554 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.5ms | ActiveRecord: 2.3ms)


D, [2018-09-12T21:45:42.889342 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:45:42.890377 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:45:42.895594 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:45:42 +0530
I, [2018-09-12T21:45:42.912046 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:45:42.912155 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:45:42.915287 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:45:42.917974 #11095] DEBUG -- :   [1m[35m (1.0ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:45:49.929295 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:45:49.930712 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.5ms | ActiveRecord: 2.6ms)


D, [2018-09-12T21:45:49.931848 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:45:49.932554 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:45:49.936689 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:45:49 +0530
I, [2018-09-12T21:45:49.953298 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:45:49.953397 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:45:49.956558 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:45:49.958636 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T21:45:53.363399 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 21:45:53 +0530
I, [2018-09-12T21:45:53.395823 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T21:45:53.395944 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T21:45:53.399241 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:45:53.401238 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:45:53.402762 #11095] DEBUG -- :   [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:45:53.404495 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:45:53.406011 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T21:45:53.406796 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:45:53.407328 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:45:53.408734 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:15:53.406000"], ["id", 1]]
D, [2018-09-12T21:45:53.409919 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:45:53.410988 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 08:15:53.410361')[0m
D, [2018-09-12T21:45:53.412249 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:45:53.412614 #11095]  INFO -- : Completed 200 OK in 17ms (Views: 0.1ms | ActiveRecord: 4.4ms)


D, [2018-09-12T21:45:53.413746 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:45:53.415617 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:45:54.965116 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T21:45:54.969207 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:45:54.970536 #11095]  INFO -- : Completed 200 OK in 5017ms (Views: 0.6ms | ActiveRecord: 2.4ms)


D, [2018-09-12T21:45:54.973226 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:45:54.974459 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:45:54.978583 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 21:45:54 +0530
I, [2018-09-12T21:45:54.990194 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:45:54 +0530
I, [2018-09-12T21:45:55.003664 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T21:45:55.003751 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
I, [2018-09-12T21:45:55.007194 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
D, [2018-09-12T21:45:55.007359 #11095] DEBUG -- :   [1m[35m (1.7ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
I, [2018-09-12T21:45:55.007456 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:45:55.010389 #11095] DEBUG -- :   [1m[35m (1.8ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:45:55.011387 #11095] DEBUG -- :   [1m[35m (1.1ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:45:55.012497 #11095] DEBUG -- :   [1m[36mUser Load (1.2ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:45:55.014201 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:45:55.015234 #11095] DEBUG -- :   [1m[35m (2.8ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:45:55.015865 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T21:45:55.016661 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:45:55.017067 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:45:55.017603 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:45:55.019049 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:15:55.017000"], ["id", 1]]
D, [2018-09-12T21:45:55.026231 #11095] DEBUG -- :   [1m[35m (6.8ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:45:55.028112 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.5ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T21:45:55.029117 #11095] DEBUG -- :   [1m[36mChat Load (0.2ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T21:45:55.030820 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:13:55.030198')[0m  [["active", "t"]]
D, [2018-09-12T21:45:55.032873 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T21:45:55.033566 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T21:45:55.034129 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.2ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T21:45:55.034731 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T21:45:55.035447 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:13:55.034858')[0m  [["active", "t"]]
D, [2018-09-12T21:45:55.036116 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:13:55.035571')[0m  [["active", "t"]]
D, [2018-09-12T21:45:55.036795 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T21:45:55.037437 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:13:55.036920')[0m  [["active", "t"]]
D, [2018-09-12T21:45:55.037888 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:45:55.038593 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T21:45:55.040826 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:45:55.041165 #11095]  INFO -- : Completed 200 OK in 37ms (Views: 0.1ms | ActiveRecord: 16.5ms)


D, [2018-09-12T21:45:55.042200 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:45:55.042876 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:45:56.021033 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T21:45:56.024303 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:45:56.024750 #11095]  INFO -- : Completed 200 OK in 1016ms (Views: 1.8ms | ActiveRecord: 4.3ms)


D, [2018-09-12T21:45:56.025628 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:45:56.026333 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:45:56.030814 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:45:56 +0530
I, [2018-09-12T21:45:56.045872 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:45:56.045960 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:45:56.048650 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:45:56.050314 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:46:03.062161 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:46:03.063679 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T21:46:03.066547 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:46:03.067558 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:46:03.071847 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:46:03 +0530
I, [2018-09-12T21:46:03.085857 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:46:03.085930 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:46:03.088170 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:46:03.089630 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:46:10.101433 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:46:10.102850 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.7ms | ActiveRecord: 2.0ms)


D, [2018-09-12T21:46:10.105587 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:46:10.106933 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:46:10.110922 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:46:10 +0530
I, [2018-09-12T21:46:10.128320 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:46:10.128408 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:46:10.131227 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:46:10.133315 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:46:17.142999 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:46:17.144793 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.5ms | ActiveRecord: 2.5ms)


D, [2018-09-12T21:46:17.148248 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:46:17.150958 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:46:17.160135 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:46:17 +0530
I, [2018-09-12T21:46:17.177354 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:46:17.177429 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:46:17.179951 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:46:17.182931 #11095] DEBUG -- :   [1m[35m (1.1ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:46:24.195713 #11095] DEBUG -- :   [1m[36mSetting Load (1.6ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:46:24.197540 #11095]  INFO -- : Completed 200 OK in 7020ms (Views: 0.5ms | ActiveRecord: 3.2ms)


D, [2018-09-12T21:46:24.201063 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:46:24.203988 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:46:24.214479 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:46:24 +0530
I, [2018-09-12T21:46:24.250590 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:46:24.250705 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:46:24.253847 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:46:24.255886 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:46:31.263443 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:46:31.263939 #11095]  INFO -- : Completed 200 OK in 7013ms (Views: 0.2ms | ActiveRecord: 1.6ms)


D, [2018-09-12T21:46:31.264757 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:46:31.265403 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:46:31.268950 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:46:31 +0530
I, [2018-09-12T21:46:31.282509 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:46:31.282580 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:46:31.284774 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:46:31.286098 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:46:38.296266 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:46:38.297697 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.5ms | ActiveRecord: 1.9ms)


D, [2018-09-12T21:46:38.300615 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:46:38.302959 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:46:38.312973 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:46:38 +0530
I, [2018-09-12T21:46:38.350363 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:46:38.350439 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:46:38.352769 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:46:38.354274 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:46:45.368728 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:46:45.370160 #11095]  INFO -- : Completed 200 OK in 7019ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T21:46:45.373170 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:46:45.375518 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:46:45.386494 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:46:45 +0530
I, [2018-09-12T21:46:45.414790 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:46:45.414881 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:46:45.417519 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:46:45.419162 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T21:46:48.364258 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 21:46:48 +0530
I, [2018-09-12T21:46:48.380136 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T21:46:48.380217 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T21:46:48.382350 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:46:48.383754 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:46:48.384959 #11095] DEBUG -- :   [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:46:48.386454 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:46:48.387761 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T21:46:48.388470 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:46:48.388943 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:46:48.390254 #11095] DEBUG -- :   [1m[35mSQL (0.2ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:16:48.388000"], ["id", 1]]
D, [2018-09-12T21:46:48.393200 #11095] DEBUG -- :   [1m[35m (2.6ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:46:48.394496 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 08:16:48.393714')[0m
D, [2018-09-12T21:46:48.396532 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:46:48.396964 #11095]  INFO -- : Completed 200 OK in 17ms (Views: 0.1ms | ActiveRecord: 5.3ms)


D, [2018-09-12T21:46:48.398137 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:46:48.398859 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:46:48.422890 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T21:46:48.427131 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:46:48.428568 #11095]  INFO -- : Completed 200 OK in 3013ms (Views: 0.7ms | ActiveRecord: 2.1ms)


D, [2018-09-12T21:46:48.431092 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:46:48.433188 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:46:48.442302 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 21:46:48 +0530
I, [2018-09-12T21:46:48.460599 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:46:48 +0530
I, [2018-09-12T21:46:48.473870 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:46:48.473915 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T21:46:48.473998 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
I, [2018-09-12T21:46:48.474079 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
D, [2018-09-12T21:46:48.477313 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:46:48.478224 #11095] DEBUG -- :   [1m[35m (1.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:46:48.479034 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:46:48.479900 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:46:48.480366 #11095] DEBUG -- :   [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:46:48.481746 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:46:48.483072 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T21:46:48.483846 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:46:48.484259 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:46:48.484665 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:46:48.486338 #11095] DEBUG -- :   [1m[35mSQL (0.4ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:16:48.484000"], ["id", 1]]
D, [2018-09-12T21:46:48.489416 #11095] DEBUG -- :   [1m[35m (2.7ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:46:48.490805 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T21:46:48.491590 #11095] DEBUG -- :   [1m[36mChat Load (0.2ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T21:46:48.493326 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:14:48.492694')[0m  [["active", "t"]]
D, [2018-09-12T21:46:48.495509 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.2ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T21:46:48.496179 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T21:46:48.496727 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.2ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T21:46:48.497304 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T21:46:48.498048 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:14:48.497429')[0m  [["active", "t"]]
D, [2018-09-12T21:46:48.498671 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:14:48.498166')[0m  [["active", "t"]]
D, [2018-09-12T21:46:48.499398 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T21:46:48.500068 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:14:48.499531')[0m  [["active", "t"]]
D, [2018-09-12T21:46:48.500554 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:46:48.501269 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T21:46:48.503579 #11095] DEBUG -- :   [1m[36mSetting Load (0.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:46:48.503896 #11095]  INFO -- : Completed 200 OK in 29ms (Views: 0.1ms | ActiveRecord: 9.7ms)


D, [2018-09-12T21:46:48.504935 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:46:48.505590 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:46:49.484425 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T21:46:49.489031 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:46:49.489505 #11095]  INFO -- : Completed 200 OK in 1015ms (Views: 3.1ms | ActiveRecord: 2.4ms)


D, [2018-09-12T21:46:49.490469 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:46:49.491309 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:46:49.496283 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:46:49 +0530
I, [2018-09-12T21:46:49.511295 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:46:49.511401 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:46:49.514136 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:46:49.516188 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:46:56.527583 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:46:56.528872 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.5ms | ActiveRecord: 2.3ms)


D, [2018-09-12T21:46:56.531432 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:46:56.533471 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:46:56.542414 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:46:56 +0530
I, [2018-09-12T21:46:56.572263 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:46:56.572371 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:46:56.575248 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:46:56.576911 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:47:03.588776 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:47:03.589981 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.4ms | ActiveRecord: 2.0ms)


D, [2018-09-12T21:47:03.590716 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:47:03.591300 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:47:03.594547 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:47:03 +0530
I, [2018-09-12T21:47:03.607169 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:47:03.607259 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:47:03.609501 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:47:03.610997 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:47:10.621142 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:47:10.622343 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.4ms | ActiveRecord: 1.9ms)


D, [2018-09-12T21:47:10.624891 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:47:10.626926 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:47:10.637674 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:47:10 +0530
I, [2018-09-12T21:47:10.667661 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:47:10.667754 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:47:10.671083 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:47:10.672907 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:47:17.686161 #11095] DEBUG -- :   [1m[36mSetting Load (1.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:47:17.687675 #11095]  INFO -- : Completed 200 OK in 7020ms (Views: 0.5ms | ActiveRecord: 2.7ms)


D, [2018-09-12T21:47:17.691306 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:47:17.693571 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:47:17.703975 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:47:17 +0530
I, [2018-09-12T21:47:17.725365 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:47:17.725475 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:47:17.729168 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:47:17.731019 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:47:24.743897 #11095] DEBUG -- :   [1m[36mSetting Load (1.7ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:47:24.745986 #11095]  INFO -- : Completed 200 OK in 7020ms (Views: 0.6ms | ActiveRecord: 2.9ms)


D, [2018-09-12T21:47:24.749626 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:47:24.752119 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:47:24.764132 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:47:24 +0530
I, [2018-09-12T21:47:24.788066 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:47:24.788154 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:47:24.791253 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:47:24.792945 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:47:31.802736 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:47:31.804048 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.4ms | ActiveRecord: 2.3ms)


D, [2018-09-12T21:47:31.806679 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:47:31.808884 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:47:31.820460 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:47:31 +0530
I, [2018-09-12T21:47:31.852769 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:47:31.852902 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:47:31.856078 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:47:31.858098 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:47:38.868714 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:47:38.869946 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.4ms | ActiveRecord: 2.3ms)


D, [2018-09-12T21:47:38.872475 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:47:38.874534 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:47:38.883813 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:47:38 +0530
I, [2018-09-12T21:47:38.913184 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:47:38.913301 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:47:38.916336 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:47:38.918119 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T21:47:43.364911 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 21:47:43 +0530
I, [2018-09-12T21:47:43.397642 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T21:47:43.397762 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T21:47:43.401002 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:47:43.402585 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:47:43.403992 #11095] DEBUG -- :   [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:47:43.406456 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:47:43.408629 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T21:47:43.409734 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:47:43.410389 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:47:43.412271 #11095] DEBUG -- :   [1m[35mSQL (0.4ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:17:43.409000"], ["id", 1]]
D, [2018-09-12T21:47:43.413786 #11095] DEBUG -- :   [1m[35m (1.0ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:47:43.415194 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 08:17:43.414344')[0m
D, [2018-09-12T21:47:43.416625 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:47:43.417060 #11095]  INFO -- : Completed 200 OK in 19ms (Views: 0.1ms | ActiveRecord: 4.7ms)


D, [2018-09-12T21:47:43.418224 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:47:43.418997 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:47:43.924208 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T21:47:43.927753 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:47:43.929002 #11095]  INFO -- : Completed 200 OK in 5015ms (Views: 0.4ms | ActiveRecord: 2.1ms)


D, [2018-09-12T21:47:43.931310 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:47:43.932765 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:47:43.936549 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 21:47:43 +0530
I, [2018-09-12T21:47:43.946357 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:47:43 +0530
I, [2018-09-12T21:47:43.960051 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T21:47:43.960190 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
I, [2018-09-12T21:47:43.963991 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:47:43.964078 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:47:43.966034 #11095] DEBUG -- :   [1m[35m (3.7ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:47:43.967350 #11095] DEBUG -- :   [1m[35m (1.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:47:43.968702 #11095] DEBUG -- :   [1m[35m (1.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:47:43.969988 #11095] DEBUG -- :   [1m[35m (1.4ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:47:43.970701 #11095] DEBUG -- :   [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:47:43.972450 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:47:43.974087 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T21:47:43.974921 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:47:43.975386 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:47:43.975899 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:47:43.977451 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:17:43.975000"], ["id", 1]]
D, [2018-09-12T21:47:43.984595 #11095] DEBUG -- :   [1m[35m (6.8ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:47:43.986628 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.4ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T21:47:43.987744 #11095] DEBUG -- :   [1m[36mChat Load (0.3ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T21:47:43.989841 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:15:43.989076')[0m  [["active", "t"]]
D, [2018-09-12T21:47:43.992508 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T21:47:43.993366 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T21:47:43.994081 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T21:47:43.994893 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T21:47:43.995872 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:15:43.995086')[0m  [["active", "t"]]
D, [2018-09-12T21:47:43.996699 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:15:43.996025')[0m  [["active", "t"]]
D, [2018-09-12T21:47:43.997616 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T21:47:43.998444 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:15:43.997782')[0m  [["active", "t"]]
D, [2018-09-12T21:47:43.999086 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:47:44.000049 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T21:47:44.002649 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:47:44.003115 #11095]  INFO -- : Completed 200 OK in 43ms (Views: 0.1ms | ActiveRecord: 18.5ms)


D, [2018-09-12T21:47:44.004457 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:47:44.005322 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:47:44.974538 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T21:47:44.978650 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:47:44.979063 #11095]  INFO -- : Completed 200 OK in 1015ms (Views: 2.7ms | ActiveRecord: 3.3ms)


D, [2018-09-12T21:47:44.979903 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:47:44.981006 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:47:44.985021 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:47:44 +0530
I, [2018-09-12T21:47:44.997213 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:47:44.997290 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:47:44.999552 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:47:45.001047 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:47:52.015554 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:47:52.016957 #11095]  INFO -- : Completed 200 OK in 7019ms (Views: 0.6ms | ActiveRecord: 2.1ms)


D, [2018-09-12T21:47:52.019732 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:47:52.022013 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:47:52.032529 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:47:52 +0530
I, [2018-09-12T21:47:52.063849 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:47:52.063961 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:47:52.066857 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:47:52.068681 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:47:59.083700 #11095] DEBUG -- :   [1m[36mSetting Load (0.8ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:47:59.084995 #11095]  INFO -- : Completed 200 OK in 7021ms (Views: 0.3ms | ActiveRecord: 1.9ms)


D, [2018-09-12T21:47:59.087270 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:47:59.088573 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:47:59.092217 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:47:59 +0530
I, [2018-09-12T21:47:59.106364 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:47:59.106435 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:47:59.108604 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:47:59.110041 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:48:06.124542 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:48:06.127324 #11095]  INFO -- : Completed 200 OK in 7020ms (Views: 0.7ms | ActiveRecord: 2.1ms)


D, [2018-09-12T21:48:06.131424 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:48:06.133910 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:48:06.144441 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:48:06 +0530
I, [2018-09-12T21:48:06.173296 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:48:06.173388 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:48:06.175828 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:48:06.177299 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:48:13.188853 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:48:13.190290 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.6ms | ActiveRecord: 2.1ms)


D, [2018-09-12T21:48:13.193101 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:48:13.195315 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:48:13.204625 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:48:13 +0530
I, [2018-09-12T21:48:13.232120 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:48:13.232205 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:48:13.234786 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:48:13.236295 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:48:20.247252 #11095] DEBUG -- :   [1m[36mSetting Load (0.9ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:48:20.248398 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.3ms | ActiveRecord: 1.8ms)


D, [2018-09-12T21:48:20.250586 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:48:20.251684 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:48:20.258247 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:48:20 +0530
I, [2018-09-12T21:48:20.276848 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:48:20.276955 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:48:20.280070 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:48:20.281640 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:48:27.294797 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:48:27.296411 #11095]  INFO -- : Completed 200 OK in 7019ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T21:48:27.297820 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:48:27.298718 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:48:27.304565 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:48:27 +0530
I, [2018-09-12T21:48:27.320668 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:48:27.320757 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:48:27.323660 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:48:27.325774 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:48:34.338991 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:48:34.340464 #11095]  INFO -- : Completed 200 OK in 7019ms (Views: 0.5ms | ActiveRecord: 2.5ms)


D, [2018-09-12T21:48:34.343283 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:48:34.345643 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:48:34.356166 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:48:34 +0530
I, [2018-09-12T21:48:34.394731 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:48:34.394810 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:48:34.397206 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:48:34.398941 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T21:48:38.365268 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 21:48:38 +0530
I, [2018-09-12T21:48:38.380280 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T21:48:38.380361 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T21:48:38.382601 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:48:38.384082 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:48:38.385335 #11095] DEBUG -- :   [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:48:38.386910 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:48:38.388397 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T21:48:38.389190 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:48:38.389762 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:48:38.391175 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:18:38.389000"], ["id", 1]]
D, [2018-09-12T21:48:38.398894 #11095] DEBUG -- :   [1m[35m (7.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:48:38.402760 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.9ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 08:18:38.400362')[0m
D, [2018-09-12T21:48:38.407625 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:48:38.408518 #11095]  INFO -- : Completed 200 OK in 28ms (Views: 0.4ms | ActiveRecord: 11.6ms)


D, [2018-09-12T21:48:38.412095 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:48:38.413636 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:48:39.406394 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T21:48:39.410396 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:48:39.411847 #11095]  INFO -- : Completed 200 OK in 5017ms (Views: 0.5ms | ActiveRecord: 2.1ms)


D, [2018-09-12T21:48:39.414660 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:48:39.416999 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:48:39.433783 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 21:48:39 +0530
I, [2018-09-12T21:48:39.455210 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:48:39 +0530
I, [2018-09-12T21:48:39.469144 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T21:48:39.471948 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:48:39.472134 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
I, [2018-09-12T21:48:39.472245 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:48:39.477293 #11095] DEBUG -- :   [1m[35m (2.2ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:48:39.479189 #11095] DEBUG -- :   [1m[35m (1.9ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:48:39.480773 #11095] DEBUG -- :   [1m[35m (1.8ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:48:39.481833 #11095] DEBUG -- :   [1m[35m (1.2ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:48:39.482392 #11095] DEBUG -- :   [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:48:39.484057 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:48:39.485562 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T21:48:39.486330 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:48:39.486776 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:48:39.487330 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:48:39.489830 #11095] DEBUG -- :   [1m[35mSQL (0.6ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:18:39.486000"], ["id", 1]]
D, [2018-09-12T21:48:39.492995 #11095] DEBUG -- :   [1m[35m (2.8ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:48:39.494584 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.4ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T21:48:39.495567 #11095] DEBUG -- :   [1m[36mChat Load (0.3ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T21:48:39.497823 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.5ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:16:39.496789')[0m  [["active", "t"]]
D, [2018-09-12T21:48:39.500405 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T21:48:39.501203 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T21:48:39.501875 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T21:48:39.502605 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T21:48:39.503477 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:16:39.502770')[0m  [["active", "t"]]
D, [2018-09-12T21:48:39.504250 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:16:39.503629')[0m  [["active", "t"]]
D, [2018-09-12T21:48:39.505110 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T21:48:39.505925 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:16:39.505269')[0m  [["active", "t"]]
D, [2018-09-12T21:48:39.506517 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:48:39.507383 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T21:48:39.510476 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:48:39.510872 #11095]  INFO -- : Completed 200 OK in 38ms (Views: 0.1ms | ActiveRecord: 13.2ms)


D, [2018-09-12T21:48:39.512198 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:48:39.513075 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:48:40.486320 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T21:48:40.492726 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:48:40.493859 #11095]  INFO -- : Completed 200 OK in 1021ms (Views: 3.3ms | ActiveRecord: 4.1ms)


D, [2018-09-12T21:48:40.496296 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:48:40.498422 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:48:40.507800 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:48:40 +0530
I, [2018-09-12T21:48:40.521913 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:48:40.521989 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:48:40.524267 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:48:40.525738 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:48:47.536816 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:48:47.537998 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.4ms | ActiveRecord: 2.0ms)


D, [2018-09-12T21:48:47.540492 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:48:47.542508 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:48:47.551793 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:48:47 +0530
I, [2018-09-12T21:48:47.581915 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:48:47.582019 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:48:47.585091 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:48:47.587016 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:48:54.597119 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:48:54.598316 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.4ms | ActiveRecord: 2.1ms)


D, [2018-09-12T21:48:54.600712 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:48:54.602656 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:48:54.611234 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:48:54 +0530
I, [2018-09-12T21:48:54.642181 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:48:54.642321 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:48:54.645566 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:48:54.647584 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:49:01.656629 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:49:01.657230 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.3ms | ActiveRecord: 1.7ms)


D, [2018-09-12T21:49:01.658999 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:49:01.660080 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:49:01.664699 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:49:01 +0530
I, [2018-09-12T21:49:01.680582 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:49:01.680663 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:49:01.683194 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:49:01.684781 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:49:08.695465 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:49:08.696743 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.6ms | ActiveRecord: 2.1ms)


D, [2018-09-12T21:49:08.699156 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:49:08.701196 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:49:08.711039 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:49:08 +0530
I, [2018-09-12T21:49:08.739372 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:49:08.739521 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:49:08.742683 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:49:08.744431 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:49:15.756513 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:49:15.757921 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.5ms | ActiveRecord: 2.1ms)


D, [2018-09-12T21:49:15.760539 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:49:15.762759 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:49:15.774146 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:49:15 +0530
I, [2018-09-12T21:49:15.803204 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:49:15.803328 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:49:15.806040 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:49:15.807858 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:49:15.809119 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:49:15.810601 #11095] DEBUG -- :   [1m[35mSQL (0.4ms)[0m  [1m[32mINSERT INTO "delayed_jobs" ("handler", "run_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["handler", "--- !ruby/object:Observer::UserDeviceLogJob\nhttp_user_agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko)\n  Chrome/68.0.3440.106 Safari/537.36\nremote_ip: \"::1\"\nuser_id: 3\nfingerprint: \"-1992429858\"\ntype: session\n"], ["run_at", "2018-09-12 16:19:15.809267"], ["created_at", "2018-09-12 16:19:15.809000"], ["updated_at", "2018-09-12 16:19:15.809000"]]
D, [2018-09-12T21:49:15.814264 #11095] DEBUG -- :   [1m[35m (3.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:49:22.828112 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:49:22.829476 #11095]  INFO -- : Completed 200 OK in 7026ms (Views: 0.5ms | ActiveRecord: 6.1ms)


D, [2018-09-12T21:49:22.833257 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:49:22.837181 #11095] DEBUG -- :   [1m[35mSQL (0.8ms)[0m  [1m[33mUPDATE "sessions" SET "data" = $1, "updated_at" = $2 WHERE "sessions"."id" = $3[0m  [["data", "BAh7D0kiCXBpbmcGOgZFRkkiGTIwMTgtMDktMTJUMTY6MDk6MjZaBjsAVEki\nD3VzZXJfYWdlbnQGOwBGIm5Nb3ppbGxhLzUuMCAoWDExOyBMaW51eCB4ODZf\nNjQpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENo\ncm9tZS82OC4wLjM0NDAuMTA2IFNhZmFyaS81MzcuMzZJIhBfY3NyZl90b2tl\nbgY7AEZJIjE1SzlmTEZWTnRwVFYydjArWGQ1M21QMjFWbDAzT1RSeEp2cUpm\nbitDRDUwPQY7AEZJIgx1c2VyX2lkBjsARmkISSIadXNlcl9kZXZpY2VfcmVt\nb3RlX2lwBjsARiIIOjoxSSIcdXNlcl9kZXZpY2VfZmluZ2VycHJpbnQGOwBG\nSSIQLTE5OTI0Mjk4NTgGOwBUSSIbdXNlcl9kZXZpY2VfdXBkYXRlZF9hdAY7\nAEZVOiBBY3RpdmVTdXBwb3J0OjpUaW1lV2l0aFpvbmVbCEl1OglUaW1lDZCh\nHcDnVPxMCToJem9uZUkiCFVUQwY7AEY6DW5hbm9fbnVtaQKTAzoNbmFub19k\nZW5pBjoNc3VibWljcm8iB5FQSSIIVVRDBjsAVEAWSSIPcGVyc2lzdGVudAY7\nAEZUSSIOcmVtb3RlX2lwBjsARiIIOjoxSSIIZ2VvBjsARnsA\n"], ["updated_at", "2018-09-12 16:19:22.834169"], ["id", 33]]
D, [2018-09-12T21:49:22.840910 #11095] DEBUG -- :   [1m[35m (2.8ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:49:22.848774 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:49:22 +0530
I, [2018-09-12T21:49:22.862842 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:49:22.862913 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:49:22.865274 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:49:22.866826 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:49:29.877432 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:49:29.878846 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.5ms | ActiveRecord: 2.1ms)


D, [2018-09-12T21:49:29.881576 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:49:29.884077 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:49:29.893882 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:49:29 +0530
I, [2018-09-12T21:49:29.924813 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:49:29.924901 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:49:29.927269 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:49:29.928818 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T21:49:33.364527 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 21:49:33 +0530
I, [2018-09-12T21:49:33.398406 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T21:49:33.398535 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T21:49:33.401992 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:49:33.403843 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:49:33.405406 #11095] DEBUG -- :   [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:49:33.407211 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:49:33.408656 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T21:49:33.409467 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:49:33.410022 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:49:33.411449 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:19:33.409000"], ["id", 1]]
D, [2018-09-12T21:49:33.412638 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:49:33.413719 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 08:19:33.413072')[0m
D, [2018-09-12T21:49:33.414983 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:49:33.415369 #11095]  INFO -- : Completed 200 OK in 17ms (Views: 0.1ms | ActiveRecord: 4.6ms)


D, [2018-09-12T21:49:33.416540 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:49:33.417277 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:49:34.935641 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T21:49:34.939801 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:49:34.941174 #11095]  INFO -- : Completed 200 OK in 5016ms (Views: 0.5ms | ActiveRecord: 2.1ms)


D, [2018-09-12T21:49:34.943782 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:49:34.946534 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:49:34.953910 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 21:49:34 +0530
I, [2018-09-12T21:49:34.959226 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:49:34 +0530
I, [2018-09-12T21:49:34.979527 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:49:34.979617 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
I, [2018-09-12T21:49:34.983143 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T21:49:34.983234 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
D, [2018-09-12T21:49:34.985066 #11095] DEBUG -- :   [1m[35m (3.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:49:34.986209 #11095] DEBUG -- :   [1m[35m (1.2ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:49:34.987250 #11095] DEBUG -- :   [1m[35m (1.1ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:49:34.987974 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:49:34.989323 #11095] DEBUG -- :   [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:49:34.991021 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:49:34.992539 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T21:49:34.993398 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:49:34.993822 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:49:34.994347 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:49:34.996476 #11095] DEBUG -- :   [1m[35mSQL (0.4ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:19:34.993000"], ["id", 1]]
D, [2018-09-12T21:49:34.999872 #11095] DEBUG -- :   [1m[35m (3.0ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:49:35.001387 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.4ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T21:49:35.002342 #11095] DEBUG -- :   [1m[36mChat Load (0.3ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T21:49:35.004425 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:17:35.003664')[0m  [["active", "t"]]
D, [2018-09-12T21:49:35.006936 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T21:49:35.007778 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T21:49:35.008474 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T21:49:35.009264 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T21:49:35.010208 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:17:35.009448')[0m  [["active", "t"]]
D, [2018-09-12T21:49:35.011070 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:17:35.010386')[0m  [["active", "t"]]
D, [2018-09-12T21:49:35.012046 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T21:49:35.012929 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:17:35.012217')[0m  [["active", "t"]]
D, [2018-09-12T21:49:35.013590 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:49:35.014520 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T21:49:35.017467 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:49:35.017868 #11095]  INFO -- : Completed 200 OK in 34ms (Views: 0.1ms | ActiveRecord: 11.2ms)


D, [2018-09-12T21:49:35.019127 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:49:35.019963 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:49:35.991588 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T21:49:35.998052 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:49:35.999239 #11095]  INFO -- : Completed 200 OK in 1019ms (Views: 3.3ms | ActiveRecord: 5.6ms)


D, [2018-09-12T21:49:36.001704 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:49:36.003691 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:49:36.013525 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:49:36 +0530
I, [2018-09-12T21:49:36.044492 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:49:36.044599 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:49:36.047918 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:49:36.049789 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:49:43.061496 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:49:43.062849 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.5ms | ActiveRecord: 2.3ms)


D, [2018-09-12T21:49:43.065618 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:49:43.067939 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:49:43.078165 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:49:43 +0530
I, [2018-09-12T21:49:43.112129 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:49:43.112259 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:49:43.115687 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:49:43.117679 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:49:50.129100 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:49:50.130513 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.6ms | ActiveRecord: 2.4ms)


D, [2018-09-12T21:49:50.133624 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:49:50.136001 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:49:50.147597 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:49:50 +0530
I, [2018-09-12T21:49:50.172290 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:49:50.172427 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:49:50.176135 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:49:50.178337 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:49:57.189326 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:49:57.190504 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.4ms | ActiveRecord: 2.3ms)


D, [2018-09-12T21:49:57.193007 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:49:57.194456 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:49:57.198000 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:49:57 +0530
I, [2018-09-12T21:49:57.210258 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:49:57.210327 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:49:57.212524 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:49:57.213866 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:50:04.222458 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:50:04.223779 #11095]  INFO -- : Completed 200 OK in 7013ms (Views: 0.5ms | ActiveRecord: 1.9ms)


D, [2018-09-12T21:50:04.226190 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:50:04.227625 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:50:04.230790 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:50:04 +0530
I, [2018-09-12T21:50:04.242877 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:50:04.242945 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:50:04.245043 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:50:04.246427 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:50:11.254081 #11095] DEBUG -- :   [1m[36mSetting Load (0.6ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:50:11.254770 #11095]  INFO -- : Completed 200 OK in 7012ms (Views: 0.3ms | ActiveRecord: 1.4ms)


D, [2018-09-12T21:50:11.256321 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:50:11.257720 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:50:11.262781 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:50:11 +0530
I, [2018-09-12T21:50:11.280610 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:50:11.280767 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:50:11.283640 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:50:11.285373 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:50:18.294342 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:50:18.295595 #11095]  INFO -- : Completed 200 OK in 7014ms (Views: 0.4ms | ActiveRecord: 2.0ms)


D, [2018-09-12T21:50:18.298072 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:50:18.300738 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:50:18.310226 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:50:18 +0530
I, [2018-09-12T21:50:18.339470 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:50:18.339674 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:50:18.342592 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:50:18.344432 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:50:25.353905 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:50:25.355162 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.4ms | ActiveRecord: 2.1ms)


D, [2018-09-12T21:50:25.358080 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:50:25.360575 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:50:25.369546 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:50:25 +0530
I, [2018-09-12T21:50:25.400257 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:50:25.400362 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:50:25.403597 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:50:25.405413 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T21:50:28.364789 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 21:50:28 +0530
I, [2018-09-12T21:50:28.380863 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T21:50:28.380950 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T21:50:28.383275 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:50:28.384865 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:50:28.393442 #11095] DEBUG -- :   [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:50:28.395247 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:50:28.396986 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T21:50:28.397772 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:50:28.398260 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:50:28.399611 #11095] DEBUG -- :   [1m[35mSQL (0.2ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:20:28.397000"], ["id", 1]]
D, [2018-09-12T21:50:28.402552 #11095] DEBUG -- :   [1m[35m (2.6ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:50:28.403637 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 08:20:28.403007')[0m
D, [2018-09-12T21:50:28.404928 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:50:28.405363 #11095]  INFO -- : Completed 200 OK in 24ms (Views: 0.1ms | ActiveRecord: 5.4ms)


D, [2018-09-12T21:50:28.406488 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:50:28.407249 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:50:28.409509 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T21:50:28.410978 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:50:28.411440 #11095]  INFO -- : Completed 200 OK in 3011ms (Views: 0.2ms | ActiveRecord: 1.6ms)


D, [2018-09-12T21:50:28.412534 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:50:28.413358 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:50:28.417549 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 21:50:28 +0530
I, [2018-09-12T21:50:28.429455 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:50:28 +0530
I, [2018-09-12T21:50:28.441322 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T21:50:28.441392 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
I, [2018-09-12T21:50:28.444554 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
D, [2018-09-12T21:50:28.444730 #11095] DEBUG -- :   [1m[35m (1.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
I, [2018-09-12T21:50:28.444837 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:50:28.447321 #11095] DEBUG -- :   [1m[35m (1.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:50:28.448248 #11095] DEBUG -- :   [1m[35m (1.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:50:28.449189 #11095] DEBUG -- :   [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:50:28.450634 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:50:28.451589 #11095] DEBUG -- :   [1m[35m (2.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:50:28.452173 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T21:50:28.452891 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:50:28.453253 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:50:28.453706 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:50:28.455068 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:20:28.453000"], ["id", 1]]
D, [2018-09-12T21:50:28.456277 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:50:28.458096 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.4ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T21:50:28.458978 #11095] DEBUG -- :   [1m[36mChat Load (0.3ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T21:50:28.460842 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:18:28.460177')[0m  [["active", "t"]]
D, [2018-09-12T21:50:28.462993 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T21:50:28.463738 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T21:50:28.464402 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T21:50:28.465106 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T21:50:28.465906 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:18:28.465255')[0m  [["active", "t"]]
D, [2018-09-12T21:50:28.466566 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:18:28.466030')[0m  [["active", "t"]]
D, [2018-09-12T21:50:28.467355 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T21:50:28.468101 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:18:28.467502')[0m  [["active", "t"]]
D, [2018-09-12T21:50:28.468879 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:50:28.469689 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T21:50:28.471879 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:50:28.472230 #11095]  INFO -- : Completed 200 OK in 31ms (Views: 0.1ms | ActiveRecord: 10.1ms)


D, [2018-09-12T21:50:28.473336 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:50:28.474011 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:50:29.455971 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T21:50:29.459801 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:50:29.460261 #11095]  INFO -- : Completed 200 OK in 1014ms (Views: 2.3ms | ActiveRecord: 4.0ms)


D, [2018-09-12T21:50:29.461317 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:50:29.462229 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:50:29.468219 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:50:29 +0530
I, [2018-09-12T21:50:29.481991 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:50:29.482076 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:50:29.484713 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:50:29.486787 #11095] DEBUG -- :   [1m[35m (1.0ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:50:36.498227 #11095] DEBUG -- :   [1m[36mSetting Load (1.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:50:36.499868 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.5ms | ActiveRecord: 2.8ms)


D, [2018-09-12T21:50:36.502840 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:50:36.504117 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:50:36.508956 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:50:36 +0530
I, [2018-09-12T21:50:36.525871 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:50:36.525986 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:50:36.529408 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:50:36.531831 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:50:43.544899 #11095] DEBUG -- :   [1m[36mSetting Load (1.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:50:43.546562 #11095]  INFO -- : Completed 200 OK in 7020ms (Views: 0.6ms | ActiveRecord: 2.8ms)


D, [2018-09-12T21:50:43.549609 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:50:43.551854 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:50:43.562956 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:50:43 +0530
I, [2018-09-12T21:50:43.591993 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:50:43.592139 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:50:43.594751 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:50:43.596491 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:50:50.608404 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:50:50.609759 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.5ms | ActiveRecord: 2.0ms)


D, [2018-09-12T21:50:50.610877 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:50:50.611601 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:50:50.615530 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:50:50 +0530
I, [2018-09-12T21:50:50.630037 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:50:50.630122 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:50:50.632726 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:50:50.634491 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:50:57.643772 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:50:57.644943 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.4ms | ActiveRecord: 2.0ms)


D, [2018-09-12T21:50:57.647394 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:50:57.649025 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:50:57.652579 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:50:57 +0530
I, [2018-09-12T21:50:57.663640 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:50:57.663710 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:50:57.665847 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:50:57.667265 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:51:04.679888 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:51:04.681124 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.5ms | ActiveRecord: 1.8ms)


D, [2018-09-12T21:51:04.683562 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:51:04.685353 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:51:04.688572 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:51:04 +0530
I, [2018-09-12T21:51:04.699409 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:51:04.699473 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:51:04.701419 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:51:04.702779 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:51:11.717786 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:51:11.719041 #11095]  INFO -- : Completed 200 OK in 7019ms (Views: 0.4ms | ActiveRecord: 1.9ms)


D, [2018-09-12T21:51:11.721466 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:51:11.722742 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:51:11.726212 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:51:11 +0530
I, [2018-09-12T21:51:11.737440 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:51:11.737507 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:51:11.739474 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:51:11.740860 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:51:18.752911 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:51:18.754284 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.5ms | ActiveRecord: 2.1ms)


D, [2018-09-12T21:51:18.757133 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:51:18.759519 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:51:18.769224 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:51:18 +0530
I, [2018-09-12T21:51:18.795305 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:51:18.795428 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:51:18.798101 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:51:18.799692 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T21:51:22.550386 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 21:51:22 +0530
I, [2018-09-12T21:51:22.584880 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T21:51:22.584979 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T21:51:22.588872 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:51:22.590429 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:51:22.591763 #11095] DEBUG -- :   [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:51:22.593390 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:51:22.594744 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T21:51:22.595467 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:51:22.595962 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:51:22.597247 #11095] DEBUG -- :   [1m[35mSQL (0.2ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:21:22.595000"], ["id", 1]]
D, [2018-09-12T21:51:22.604888 #11095] DEBUG -- :   [1m[35m (7.0ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:51:22.606918 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 08:21:22.605820')[0m
D, [2018-09-12T21:51:22.609047 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:51:22.609763 #11095]  INFO -- : Completed 200 OK in 25ms (Views: 0.2ms | ActiveRecord: 10.2ms)


D, [2018-09-12T21:51:22.611759 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:51:22.612778 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:51:23.815671 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T21:51:23.819600 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:51:23.821040 #11095]  INFO -- : Completed 200 OK in 5025ms (Views: 0.5ms | ActiveRecord: 2.1ms)


D, [2018-09-12T21:51:23.823770 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:51:23.826026 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:51:23.838717 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 21:51:23 +0530
I, [2018-09-12T21:51:23.863608 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:51:23 +0530
I, [2018-09-12T21:51:23.881155 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T21:51:23.881252 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
I, [2018-09-12T21:51:23.885516 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:51:23.885623 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:51:23.888132 #11095] DEBUG -- :   [1m[35m (4.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:51:23.889970 #11095] DEBUG -- :   [1m[35m (2.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:51:23.891298 #11095] DEBUG -- :   [1m[35m (1.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:51:23.892713 #11095] DEBUG -- :   [1m[35m (1.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:51:23.893546 #11095] DEBUG -- :   [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:51:23.895694 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:51:23.897434 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T21:51:23.898356 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:51:23.898848 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:51:23.899374 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:51:23.901024 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:21:23.898000"], ["id", 1]]
D, [2018-09-12T21:51:23.908749 #11095] DEBUG -- :   [1m[35m (7.0ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:51:23.913765 #11095] DEBUG -- :   [1m[36mChat::Session Load (1.0ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T21:51:23.917052 #11095] DEBUG -- :   [1m[36mChat Load (0.8ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T21:51:23.924992 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.9ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:19:23.922494')[0m  [["active", "t"]]
D, [2018-09-12T21:51:23.930439 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.6ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T21:51:23.931648 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T21:51:23.932599 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.4ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T21:51:23.933809 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T21:51:23.935416 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:19:23.934151')[0m  [["active", "t"]]
D, [2018-09-12T21:51:23.936510 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:19:23.935655')[0m  [["active", "t"]]
D, [2018-09-12T21:51:23.940169 #11095] DEBUG -- :   [1m[35m (1.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T21:51:23.942753 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.5ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:19:23.941326')[0m  [["active", "t"]]
D, [2018-09-12T21:51:23.944431 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.8ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:51:23.946125 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.4ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T21:51:23.951855 #11095] DEBUG -- :   [1m[36mSetting Load (0.6ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:51:23.952558 #11095]  INFO -- : Completed 200 OK in 71ms (Views: 0.2ms | ActiveRecord: 24.7ms)


D, [2018-09-12T21:51:23.954697 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:51:23.956788 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:51:24.897124 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T21:51:24.903566 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:51:24.904724 #11095]  INFO -- : Completed 200 OK in 1019ms (Views: 3.2ms | ActiveRecord: 4.5ms)


D, [2018-09-12T21:51:24.907330 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:51:24.909744 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:51:24.919462 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:51:24 +0530
I, [2018-09-12T21:51:24.941152 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:51:24.941231 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:51:24.943671 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:51:24.945200 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:51:31.954713 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:51:31.956255 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.6ms | ActiveRecord: 2.2ms)


D, [2018-09-12T21:51:31.959138 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:51:31.961344 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:51:31.974652 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:51:31 +0530
I, [2018-09-12T21:51:31.999740 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:51:31.999851 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:51:32.003066 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:51:32.005094 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:51:39.011741 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:51:39.012176 #11095]  INFO -- : Completed 200 OK in 7012ms (Views: 0.2ms | ActiveRecord: 1.7ms)


D, [2018-09-12T21:51:39.013064 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:51:39.013754 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:51:39.016785 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:51:39 +0530
I, [2018-09-12T21:51:39.029500 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:51:39.029612 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:51:39.032787 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:51:39.034576 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:51:46.040941 #11095] DEBUG -- :   [1m[36mSetting Load (0.6ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:51:46.041977 #11095]  INFO -- : Completed 200 OK in 7012ms (Views: 0.2ms | ActiveRecord: 1.6ms)


D, [2018-09-12T21:51:46.043110 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:51:46.043946 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:51:46.050559 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:51:46 +0530
I, [2018-09-12T21:51:46.064121 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:51:46.064193 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:51:46.066407 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:51:46.067922 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:51:53.077707 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:51:53.079203 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T21:51:53.082927 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:51:53.090314 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:51:53.100856 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:51:53 +0530
I, [2018-09-12T21:51:53.126582 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:51:53.126687 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:51:53.129938 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:51:53.131855 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:52:00.140787 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:52:00.141384 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.2ms | ActiveRecord: 1.7ms)


D, [2018-09-12T21:52:00.142506 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:52:00.143896 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:52:00.147174 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:52:00 +0530
I, [2018-09-12T21:52:00.162986 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:52:00.163074 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:52:00.165576 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:52:00.167458 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:52:07.178695 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:52:07.180302 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T21:52:07.183169 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:52:07.187151 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:52:07.196028 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:52:07 +0530
I, [2018-09-12T21:52:07.221435 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:52:07.221591 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:52:07.225336 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:52:07.228471 #11095] DEBUG -- :   [1m[35m (1.2ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:52:14.240892 #11095] DEBUG -- :   [1m[36mSetting Load (0.7ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:52:14.241824 #11095]  INFO -- : Completed 200 OK in 7020ms (Views: 0.5ms | ActiveRecord: 2.6ms)


D, [2018-09-12T21:52:14.243452 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:52:14.245466 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:52:14.252119 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:52:14 +0530
I, [2018-09-12T21:52:14.271879 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:52:14.272023 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:52:14.276554 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:52:14.278672 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T21:52:18.362878 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 21:52:18 +0530
I, [2018-09-12T21:52:18.376878 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T21:52:18.376970 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T21:52:18.379457 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:52:18.381793 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:52:18.384208 #11095] DEBUG -- :   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:52:18.386234 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:52:18.387846 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T21:52:18.388695 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:52:18.389295 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:52:18.390833 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:22:18.388000"], ["id", 1]]
D, [2018-09-12T21:52:18.398219 #11095] DEBUG -- :   [1m[35m (7.0ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:52:18.399886 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 08:22:18.398875')[0m
D, [2018-09-12T21:52:18.401439 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:52:18.401854 #11095]  INFO -- : Completed 200 OK in 25ms (Views: 0.1ms | ActiveRecord: 11.0ms)


D, [2018-09-12T21:52:18.403244 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:52:18.404113 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:52:19.286866 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T21:52:19.288184 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:52:19.288556 #11095]  INFO -- : Completed 200 OK in 5016ms (Views: 0.2ms | ActiveRecord: 1.5ms)


D, [2018-09-12T21:52:19.289398 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:52:19.290040 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:52:19.293288 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 21:52:19 +0530
I, [2018-09-12T21:52:19.303312 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:52:19 +0530
I, [2018-09-12T21:52:19.321483 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T21:52:19.321818 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
I, [2018-09-12T21:52:19.324842 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:52:19.324928 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:52:19.326514 #11095] DEBUG -- :   [1m[35m (3.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:52:19.327465 #11095] DEBUG -- :   [1m[35m (1.1ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:52:19.328364 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:52:19.329505 #11095] DEBUG -- :   [1m[35m (1.1ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:52:19.330052 #11095] DEBUG -- :   [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:52:19.331455 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:52:19.333081 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T21:52:19.334457 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.5ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:52:19.335072 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:52:19.335804 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:52:19.337478 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:22:19.335000"], ["id", 1]]
D, [2018-09-12T21:52:19.344472 #11095] DEBUG -- :   [1m[35m (6.7ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:52:19.345876 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.4ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T21:52:19.346803 #11095] DEBUG -- :   [1m[36mChat Load (0.3ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T21:52:19.349008 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:20:19.348197')[0m  [["active", "t"]]
D, [2018-09-12T21:52:19.351045 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T21:52:19.351734 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T21:52:19.352286 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.2ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T21:52:19.352908 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T21:52:19.353663 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:20:19.353064')[0m  [["active", "t"]]
D, [2018-09-12T21:52:19.354223 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:20:19.353780')[0m  [["active", "t"]]
D, [2018-09-12T21:52:19.354923 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T21:52:19.355599 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:20:19.355060')[0m  [["active", "t"]]
D, [2018-09-12T21:52:19.356235 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:52:19.357096 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.2ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T21:52:19.359313 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:52:19.359710 #11095]  INFO -- : Completed 200 OK in 38ms (Views: 0.1ms | ActiveRecord: 16.7ms)


D, [2018-09-12T21:52:19.360694 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:52:19.361530 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:52:20.337180 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T21:52:20.339977 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:52:20.340433 #11095]  INFO -- : Completed 200 OK in 1015ms (Views: 1.4ms | ActiveRecord: 2.6ms)


D, [2018-09-12T21:52:20.341352 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:52:20.342192 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:52:20.346296 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:52:20 +0530
I, [2018-09-12T21:52:20.361243 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:52:20.361350 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:52:20.365006 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:52:20.367620 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:52:27.375566 #11095] DEBUG -- :   [1m[36mSetting Load (0.6ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:52:27.376182 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.2ms | ActiveRecord: 1.6ms)


D, [2018-09-12T21:52:27.377191 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:52:27.377751 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:52:27.380415 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:52:27 +0530
I, [2018-09-12T21:52:27.390422 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:52:27.390479 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:52:27.392327 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:52:27.393490 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:52:34.404934 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:52:34.406412 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.5ms | ActiveRecord: 1.8ms)


D, [2018-09-12T21:52:34.409335 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:52:34.412292 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:52:34.424163 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:52:34 +0530
I, [2018-09-12T21:52:34.453478 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:52:34.453591 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:52:34.456256 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:52:34.458014 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:52:41.468452 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:52:41.469851 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.4ms | ActiveRecord: 2.2ms)


D, [2018-09-12T21:52:41.472521 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:52:41.474701 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:52:41.485284 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:52:41 +0530
I, [2018-09-12T21:52:41.508471 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:52:41.508608 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:52:41.511063 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:52:41.512731 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:52:48.521791 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:52:48.523161 #11095]  INFO -- : Completed 200 OK in 7014ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T21:52:48.526045 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:52:48.528596 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:52:48.538395 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:52:48 +0530
I, [2018-09-12T21:52:48.569389 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:52:48.569499 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:52:48.572500 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:52:48.574352 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:52:55.584132 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:52:55.585467 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.4ms | ActiveRecord: 2.2ms)


D, [2018-09-12T21:52:55.588123 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:52:55.590293 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:52:55.600239 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:52:55 +0530
I, [2018-09-12T21:52:55.627462 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:52:55.627584 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:52:55.630233 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:52:55.631810 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:53:02.640951 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:53:02.642223 #11095]  INFO -- : Completed 200 OK in 7014ms (Views: 0.4ms | ActiveRecord: 2.0ms)


D, [2018-09-12T21:53:02.644670 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:53:02.646577 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:53:02.654887 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:53:02 +0530
I, [2018-09-12T21:53:02.686778 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:53:02.686908 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:53:02.690822 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:53:02.693683 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:53:09.703398 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:53:09.704631 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.4ms | ActiveRecord: 2.5ms)


D, [2018-09-12T21:53:09.706926 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:53:09.709190 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:53:09.718426 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:53:09 +0530
I, [2018-09-12T21:53:09.746813 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:53:09.746893 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:53:09.749375 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:53:09.750845 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T21:53:13.365293 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 21:53:13 +0530
I, [2018-09-12T21:53:13.397455 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T21:53:13.397574 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T21:53:13.400381 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:53:13.402254 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:53:13.403925 #11095] DEBUG -- :   [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:53:13.405798 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:53:13.407535 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T21:53:13.408474 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:53:13.409129 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:53:13.410799 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:23:13.408000"], ["id", 1]]
D, [2018-09-12T21:53:13.411936 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:53:13.413336 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 08:23:13.412479')[0m
D, [2018-09-12T21:53:13.415054 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:53:13.415601 #11095]  INFO -- : Completed 200 OK in 18ms (Views: 0.2ms | ActiveRecord: 4.7ms)


D, [2018-09-12T21:53:13.417163 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:53:13.418195 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:53:14.756140 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T21:53:14.757617 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:53:14.757992 #11095]  INFO -- : Completed 200 OK in 5011ms (Views: 0.2ms | ActiveRecord: 1.3ms)


D, [2018-09-12T21:53:14.758796 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:53:14.759427 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:53:14.763175 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:53:14 +0530
I, [2018-09-12T21:53:14.763227 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 21:53:14 +0530
I, [2018-09-12T21:53:14.789364 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:53:14.789470 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
I, [2018-09-12T21:53:14.794904 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T21:53:14.795050 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
D, [2018-09-12T21:53:14.795517 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:53:14.798509 #11095] DEBUG -- :   [1m[35m (1.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:53:14.799305 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:53:14.800548 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:53:14.801676 #11095] DEBUG -- :   [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:53:14.803146 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:53:14.804394 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T21:53:14.805196 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:53:14.805774 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:53:14.806427 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:53:14.807956 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:23:14.805000"], ["id", 1]]
D, [2018-09-12T21:53:14.815355 #11095] DEBUG -- :   [1m[35m (7.0ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:53:14.817193 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.4ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T21:53:14.818073 #11095] DEBUG -- :   [1m[36mChat Load (0.2ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T21:53:14.819969 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:21:14.819161')[0m  [["active", "t"]]
D, [2018-09-12T21:53:14.823684 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T21:53:14.824369 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T21:53:14.824970 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.2ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T21:53:14.825898 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T21:53:14.827009 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:21:14.826132')[0m  [["active", "t"]]
D, [2018-09-12T21:53:14.827885 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:21:14.827189')[0m  [["active", "t"]]
D, [2018-09-12T21:53:14.829034 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T21:53:14.829970 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:21:14.829239')[0m  [["active", "t"]]
D, [2018-09-12T21:53:14.830676 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:53:14.831788 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T21:53:14.834491 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:53:14.834847 #11095]  INFO -- : Completed 200 OK in 40ms (Views: 0.1ms | ActiveRecord: 13.8ms)


D, [2018-09-12T21:53:14.835818 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:53:14.837094 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:53:15.802687 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T21:53:15.809775 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:53:15.810986 #11095]  INFO -- : Completed 200 OK in 1021ms (Views: 3.6ms | ActiveRecord: 3.4ms)


D, [2018-09-12T21:53:15.813493 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:53:15.815804 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:53:15.827291 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:53:15 +0530
I, [2018-09-12T21:53:15.861856 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:53:15.861976 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:53:15.866136 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:53:15.868954 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:53:22.878192 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:53:22.879549 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.5ms | ActiveRecord: 2.4ms)


D, [2018-09-12T21:53:22.882100 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:53:22.884553 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:53:22.895937 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:53:22 +0530
I, [2018-09-12T21:53:22.920333 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:53:22.920438 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:53:22.922735 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:53:22.924382 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:53:29.934933 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:53:29.936302 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.5ms | ActiveRecord: 2.1ms)


D, [2018-09-12T21:53:29.938974 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:53:29.940481 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:53:29.945130 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:53:29 +0530
I, [2018-09-12T21:53:29.958307 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:53:29.958379 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:53:29.960580 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:53:29.962254 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:53:36.974078 #11095] DEBUG -- :   [1m[36mSetting Load (1.6ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:53:36.975556 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.6ms | ActiveRecord: 2.5ms)


D, [2018-09-12T21:53:36.978620 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:53:36.981434 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:53:36.992227 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:53:36 +0530
I, [2018-09-12T21:53:37.022194 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:53:37.022278 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:53:37.024865 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:53:37.026672 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:53:44.038091 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:53:44.039510 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T21:53:44.042275 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:53:44.044509 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:53:44.055010 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:53:44 +0530
I, [2018-09-12T21:53:44.085404 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:53:44.085492 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:53:44.088893 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:53:44.091300 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:53:51.102539 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:53:51.104005 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.5ms | ActiveRecord: 2.6ms)


D, [2018-09-12T21:53:51.106683 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:53:51.108753 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:53:51.119118 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:53:51 +0530
I, [2018-09-12T21:53:51.156226 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:53:51.156315 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:53:51.158845 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:53:51.160493 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:53:58.179231 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:53:58.180479 #11095]  INFO -- : Completed 200 OK in 7024ms (Views: 0.4ms | ActiveRecord: 2.0ms)


D, [2018-09-12T21:53:58.182862 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:53:58.185569 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:53:58.194894 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:53:58 +0530
I, [2018-09-12T21:53:58.221835 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:53:58.221942 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:53:58.224590 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:53:58.226278 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:54:05.238530 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:54:05.239806 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.4ms | ActiveRecord: 2.1ms)


D, [2018-09-12T21:54:05.240835 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:54:05.241498 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:54:05.245169 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:54:05 +0530
I, [2018-09-12T21:54:05.259038 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:54:05.259120 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:54:05.261538 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:54:05.263184 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T21:54:08.364734 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 21:54:08 +0530
I, [2018-09-12T21:54:08.381578 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T21:54:08.381670 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T21:54:08.384093 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:54:08.385733 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:54:08.387094 #11095] DEBUG -- :   [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:54:08.388787 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:54:08.390270 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T21:54:08.391121 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:54:08.391650 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:54:08.393487 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:24:08.391000"], ["id", 1]]
D, [2018-09-12T21:54:08.395838 #11095] DEBUG -- :   [1m[35m (1.9ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:54:08.397330 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 08:24:08.396429')[0m
D, [2018-09-12T21:54:08.398951 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:54:08.399428 #11095]  INFO -- : Completed 200 OK in 18ms (Views: 0.1ms | ActiveRecord: 5.1ms)


D, [2018-09-12T21:54:08.400856 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:54:08.401726 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:54:10.271107 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T21:54:10.274739 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:54:10.275951 #11095]  INFO -- : Completed 200 OK in 5017ms (Views: 0.5ms | ActiveRecord: 2.0ms)


D, [2018-09-12T21:54:10.278372 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:54:10.280141 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:54:10.283975 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 21:54:10 +0530
I, [2018-09-12T21:54:10.293851 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:54:10 +0530
I, [2018-09-12T21:54:10.306095 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T21:54:10.306179 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
I, [2018-09-12T21:54:10.309248 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
D, [2018-09-12T21:54:10.309412 #11095] DEBUG -- :   [1m[35m (1.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
I, [2018-09-12T21:54:10.309514 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:54:10.312069 #11095] DEBUG -- :   [1m[35m (1.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:54:10.312984 #11095] DEBUG -- :   [1m[35m (1.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:54:10.322071 #11095] DEBUG -- :   [1m[36mUser Load (9.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:54:10.323755 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:54:10.324754 #11095] DEBUG -- :   [1m[35m (2.8ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:54:10.325396 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T21:54:10.326165 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:54:10.326556 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:54:10.327004 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:54:10.328406 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:24:10.326000"], ["id", 1]]
D, [2018-09-12T21:54:10.331836 #11095] DEBUG -- :   [1m[35m (2.8ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:54:10.333500 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.4ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T21:54:10.334447 #11095] DEBUG -- :   [1m[36mChat Load (0.3ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T21:54:10.336345 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:22:10.335651')[0m  [["active", "t"]]
D, [2018-09-12T21:54:10.338616 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T21:54:10.339389 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T21:54:10.340033 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T21:54:10.340795 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T21:54:10.341666 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:22:10.340956')[0m  [["active", "t"]]
D, [2018-09-12T21:54:10.342404 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:22:10.341800')[0m  [["active", "t"]]
D, [2018-09-12T21:54:10.343231 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T21:54:10.344005 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:22:10.343380')[0m  [["active", "t"]]
D, [2018-09-12T21:54:10.344597 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:54:10.345442 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T21:54:10.348301 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:54:10.348700 #11095]  INFO -- : Completed 200 OK in 42ms (Views: 0.2ms | ActiveRecord: 20.4ms)


D, [2018-09-12T21:54:10.349882 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:54:10.350643 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:54:11.330439 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T21:54:11.334058 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:54:11.334590 #11095]  INFO -- : Completed 200 OK in 1024ms (Views: 2.0ms | ActiveRecord: 4.4ms)


D, [2018-09-12T21:54:11.335744 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:54:11.336676 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:54:11.341884 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:54:11 +0530
I, [2018-09-12T21:54:11.359329 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:54:11.359435 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:54:11.362630 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:54:11.364269 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:54:18.372227 #11095] DEBUG -- :   [1m[36mSetting Load (0.6ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:54:18.372892 #11095]  INFO -- : Completed 200 OK in 7013ms (Views: 0.3ms | ActiveRecord: 1.7ms)


D, [2018-09-12T21:54:18.374170 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:54:18.375269 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:54:18.381097 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:54:18 +0530
I, [2018-09-12T21:54:18.402096 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:54:18.402220 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:54:18.406270 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:54:18.408246 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:54:25.418196 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:54:25.419571 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.5ms | ActiveRecord: 2.4ms)


D, [2018-09-12T21:54:25.422325 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:54:25.424652 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:54:25.434436 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:54:25 +0530
I, [2018-09-12T21:54:25.462565 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:54:25.462658 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:54:25.465300 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:54:25.466941 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:54:32.476128 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:54:32.477333 #11095]  INFO -- : Completed 200 OK in 7014ms (Views: 0.4ms | ActiveRecord: 2.0ms)


D, [2018-09-12T21:54:32.479823 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:54:32.481822 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:54:32.490587 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:54:32 +0530
I, [2018-09-12T21:54:32.520513 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:54:32.520621 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:54:32.523704 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:54:32.525454 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:54:39.533672 #11095] DEBUG -- :   [1m[36mSetting Load (0.6ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:54:39.534411 #11095]  INFO -- : Completed 200 OK in 7014ms (Views: 0.2ms | ActiveRecord: 1.7ms)


D, [2018-09-12T21:54:39.535731 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:54:39.536800 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:54:39.540733 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:54:39 +0530
I, [2018-09-12T21:54:39.559267 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:54:39.559360 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:54:39.561675 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:54:39.565270 #11095] DEBUG -- :   [1m[35m (1.4ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:54:46.577436 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:54:46.579036 #11095]  INFO -- : Completed 200 OK in 7019ms (Views: 1.0ms | ActiveRecord: 2.9ms)


D, [2018-09-12T21:54:46.583028 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:54:46.585407 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:54:46.597837 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:54:46 +0530
I, [2018-09-12T21:54:46.619703 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:54:46.619778 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:54:46.622045 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:54:46.623621 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:54:53.633714 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:54:53.635128 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T21:54:53.638008 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:54:53.640296 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:54:53.650620 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:54:53 +0530
I, [2018-09-12T21:54:53.679337 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:54:53.679450 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:54:53.682229 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:54:53.683749 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:55:00.694744 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:55:00.695862 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.5ms | ActiveRecord: 2.1ms)


D, [2018-09-12T21:55:00.696699 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:55:00.697431 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:55:00.701474 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:55:00 +0530
I, [2018-09-12T21:55:00.715667 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:55:00.715748 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:55:00.718323 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:55:00.719912 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T21:55:03.365122 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 21:55:03 +0530
I, [2018-09-12T21:55:03.397846 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T21:55:03.397976 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T21:55:03.401071 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:55:03.402917 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:55:03.404436 #11095] DEBUG -- :   [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:55:03.406029 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:55:03.407422 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T21:55:03.408316 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:55:03.408873 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:55:03.410222 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:25:03.408000"], ["id", 1]]
D, [2018-09-12T21:55:03.411464 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:55:03.412560 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 08:25:03.411890')[0m
D, [2018-09-12T21:55:03.413814 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:55:03.414201 #11095]  INFO -- : Completed 200 OK in 16ms (Views: 0.1ms | ActiveRecord: 4.3ms)


D, [2018-09-12T21:55:03.415360 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:55:03.416239 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:55:03.724632 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T21:55:03.729070 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:55:03.730428 #11095]  INFO -- : Completed 200 OK in 3014ms (Views: 0.7ms | ActiveRecord: 2.1ms)


D, [2018-09-12T21:55:03.734273 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:55:03.737062 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:55:03.748615 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 21:55:03 +0530
I, [2018-09-12T21:55:03.772931 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:55:03 +0530
I, [2018-09-12T21:55:03.787303 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T21:55:03.789361 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:55:03.789476 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
I, [2018-09-12T21:55:03.791554 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:55:03.792283 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:55:03.794469 #11095] DEBUG -- :   [1m[35m (1.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:55:03.795512 #11095] DEBUG -- :   [1m[35m (1.1ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:55:03.796598 #11095] DEBUG -- :   [1m[35m (1.2ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:55:03.797232 #11095] DEBUG -- :   [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:55:03.801063 #11095] DEBUG -- :   [1m[35mCACHE  (0.1ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:55:03.803121 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T21:55:03.804244 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:55:03.804930 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:55:03.805571 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:55:03.807179 #11095] DEBUG -- :   [1m[35mSQL (0.4ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:25:03.805000"], ["id", 1]]
D, [2018-09-12T21:55:03.810147 #11095] DEBUG -- :   [1m[35m (2.6ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:55:03.811484 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T21:55:03.812405 #11095] DEBUG -- :   [1m[36mChat Load (0.3ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T21:55:03.814373 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:23:03.813604')[0m  [["active", "t"]]
D, [2018-09-12T21:55:03.818074 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.4ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T21:55:03.819069 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T21:55:03.819931 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T21:55:03.820736 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T21:55:03.821683 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:23:03.820923')[0m  [["active", "t"]]
D, [2018-09-12T21:55:03.822404 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:23:03.821832')[0m  [["active", "t"]]
D, [2018-09-12T21:55:03.823243 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T21:55:03.824033 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:23:03.823418')[0m  [["active", "t"]]
D, [2018-09-12T21:55:03.824642 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:55:03.825473 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T21:55:03.828078 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:55:03.828478 #11095]  INFO -- : Completed 200 OK in 39ms (Views: 0.1ms | ActiveRecord: 10.6ms)


D, [2018-09-12T21:55:03.829555 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:55:03.830259 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:55:04.801805 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T21:55:04.808291 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:55:04.809481 #11095]  INFO -- : Completed 200 OK in 1018ms (Views: 3.3ms | ActiveRecord: 3.4ms)


D, [2018-09-12T21:55:04.811811 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:55:04.813934 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:55:04.823785 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:55:04 +0530
I, [2018-09-12T21:55:04.848502 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:55:04.848598 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:55:04.851089 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:55:04.852833 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:55:11.863774 #11095] DEBUG -- :   [1m[36mSetting Load (1.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:55:11.865225 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.6ms | ActiveRecord: 2.4ms)


D, [2018-09-12T21:55:11.868255 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:55:11.870417 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:55:11.882034 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:55:11 +0530
I, [2018-09-12T21:55:11.907620 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:55:11.907716 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:55:11.911900 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:55:11.913576 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:55:18.923674 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:55:18.924436 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.7ms | ActiveRecord: 2.3ms)


D, [2018-09-12T21:55:18.925810 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:55:18.926549 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:55:18.930042 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:55:18 +0530
I, [2018-09-12T21:55:18.945316 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:55:18.945400 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:55:18.947837 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:55:18.949560 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:55:25.959661 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:55:25.960971 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T21:55:25.963711 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:55:25.965172 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:55:25.968959 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:55:25 +0530
I, [2018-09-12T21:55:25.982214 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:55:25.982286 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:55:25.984518 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:55:25.986009 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:55:32.995967 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:55:32.997146 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.4ms | ActiveRecord: 2.0ms)


D, [2018-09-12T21:55:32.999626 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:55:33.001197 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:55:33.004377 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:55:33 +0530
I, [2018-09-12T21:55:33.016012 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:55:33.016077 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:55:33.018098 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:55:33.019319 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:55:40.026644 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:55:40.027072 #11095]  INFO -- : Completed 200 OK in 7011ms (Views: 0.2ms | ActiveRecord: 1.2ms)


D, [2018-09-12T21:55:40.028151 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:55:40.029104 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:55:40.033091 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:55:40 +0530
I, [2018-09-12T21:55:40.046047 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:55:40.046108 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:55:40.048025 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:55:40.049241 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:55:47.059431 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:55:47.060856 #11095]  INFO -- : Completed 200 OK in 7014ms (Views: 0.5ms | ActiveRecord: 1.8ms)


D, [2018-09-12T21:55:47.063617 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:55:47.066112 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:55:47.076048 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:55:47 +0530
I, [2018-09-12T21:55:47.106649 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:55:47.106758 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:55:47.109386 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:55:47.111162 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:55:54.121280 #11095] DEBUG -- :   [1m[36mSetting Load (1.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:55:54.121839 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.5ms | ActiveRecord: 2.5ms)


D, [2018-09-12T21:55:54.122925 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:55:54.123909 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:55:54.127986 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:55:54 +0530
I, [2018-09-12T21:55:54.141782 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:55:54.141874 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:55:54.144161 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:55:54.145666 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T21:55:58.365365 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 21:55:58 +0530
I, [2018-09-12T21:55:58.398841 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T21:55:58.399015 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T21:55:58.403106 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:55:58.405485 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:55:58.407163 #11095] DEBUG -- :   [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:55:58.409149 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:55:58.410819 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T21:55:58.411625 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:55:58.412202 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:55:58.413630 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:25:58.411000"], ["id", 1]]
D, [2018-09-12T21:55:58.416519 #11095] DEBUG -- :   [1m[35m (2.6ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:55:58.417476 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 08:25:58.416926')[0m
D, [2018-09-12T21:55:58.418665 #11095] DEBUG -- :   [1m[36mSetting Load (0.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:55:58.419029 #11095]  INFO -- : Completed 200 OK in 20ms (Views: 0.1ms | ActiveRecord: 6.4ms)


D, [2018-09-12T21:55:58.420143 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:55:58.420978 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:55:59.152383 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T21:55:59.156381 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:55:59.157687 #11095]  INFO -- : Completed 200 OK in 5015ms (Views: 0.5ms | ActiveRecord: 2.1ms)


D, [2018-09-12T21:55:59.160417 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:55:59.162638 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:55:59.174725 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:55:59 +0530
I, [2018-09-12T21:55:59.207196 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 21:55:59 +0530
I, [2018-09-12T21:55:59.229556 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:55:59.229723 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
I, [2018-09-12T21:55:59.235626 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T21:55:59.235784 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
D, [2018-09-12T21:55:59.238534 #11095] DEBUG -- :   [1m[35m (5.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:55:59.240392 #11095] DEBUG -- :   [1m[35m (2.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:55:59.242260 #11095] DEBUG -- :   [1m[35m (2.0ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:55:59.243406 #11095] DEBUG -- :   [1m[35m (1.3ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:55:59.246059 #11095] DEBUG -- :   [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:55:59.248849 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:55:59.251113 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T21:55:59.252287 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:55:59.252945 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:55:59.253661 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:55:59.255845 #11095] DEBUG -- :   [1m[35mSQL (0.4ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:25:59.253000"], ["id", 1]]
D, [2018-09-12T21:55:59.263067 #11095] DEBUG -- :   [1m[35m (6.8ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:55:59.265096 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.5ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T21:55:59.266505 #11095] DEBUG -- :   [1m[36mChat Load (0.4ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T21:55:59.269335 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:23:59.268303')[0m  [["active", "t"]]
D, [2018-09-12T21:55:59.273130 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.4ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T21:55:59.274383 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T21:55:59.275437 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.4ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T21:55:59.277047 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T21:55:59.278492 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:23:59.277337')[0m  [["active", "t"]]
D, [2018-09-12T21:55:59.279645 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:23:59.278719')[0m  [["active", "t"]]
D, [2018-09-12T21:55:59.281055 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T21:55:59.282088 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:23:59.281285')[0m  [["active", "t"]]
D, [2018-09-12T21:55:59.282831 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:55:59.283960 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.4ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T21:55:59.296147 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:55:59.296580 #11095]  INFO -- : Completed 200 OK in 61ms (Views: 0.1ms | ActiveRecord: 17.9ms)


D, [2018-09-12T21:55:59.297866 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:55:59.298654 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:56:00.248293 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T21:56:00.251605 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:56:00.252096 #11095]  INFO -- : Completed 200 OK in 1022ms (Views: 1.8ms | ActiveRecord: 8.0ms)


D, [2018-09-12T21:56:00.253120 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:56:00.253978 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:56:00.258538 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:56:00 +0530
I, [2018-09-12T21:56:00.272489 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:56:00.272569 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:56:00.275443 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:56:00.277471 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:56:07.287305 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:56:07.288675 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.4ms | ActiveRecord: 2.3ms)


D, [2018-09-12T21:56:07.291138 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:56:07.293392 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:56:07.300923 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:56:07 +0530
I, [2018-09-12T21:56:07.311863 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:56:07.311924 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:56:07.314339 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:56:07.316262 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:56:14.327282 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:56:14.328985 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.5ms | ActiveRecord: 2.0ms)


D, [2018-09-12T21:56:14.332804 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:56:14.335273 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:56:14.348745 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:56:14 +0530
I, [2018-09-12T21:56:14.375293 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:56:14.375405 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:56:14.378032 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:56:14.380451 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:56:21.388634 #11095] DEBUG -- :   [1m[36mSetting Load (0.6ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:56:21.389365 #11095]  INFO -- : Completed 200 OK in 7014ms (Views: 0.2ms | ActiveRecord: 1.7ms)


D, [2018-09-12T21:56:21.390896 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:56:21.392345 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:56:21.398943 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:56:21 +0530
I, [2018-09-12T21:56:21.420039 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:56:21.420132 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:56:21.422995 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:56:21.424620 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:56:28.439657 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:56:28.441181 #11095]  INFO -- : Completed 200 OK in 7021ms (Views: 0.5ms | ActiveRecord: 2.1ms)


D, [2018-09-12T21:56:28.443886 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:56:28.446260 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:56:28.456412 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:56:28 +0530
I, [2018-09-12T21:56:28.484270 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:56:28.484369 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:56:28.487082 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:56:28.488937 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:56:35.496606 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:56:35.497029 #11095]  INFO -- : Completed 200 OK in 7013ms (Views: 0.2ms | ActiveRecord: 1.5ms)


D, [2018-09-12T21:56:35.497872 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:56:35.498581 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:56:35.501435 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:56:35 +0530
I, [2018-09-12T21:56:35.512029 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:56:35.512089 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:56:35.513972 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:56:35.515350 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:56:42.526600 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:56:42.527838 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.5ms | ActiveRecord: 1.9ms)


D, [2018-09-12T21:56:42.528886 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:56:42.529660 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:56:42.533667 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:56:42 +0530
I, [2018-09-12T21:56:42.548473 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:56:42.548560 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:56:42.551204 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:56:42.553081 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:56:49.563160 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:56:49.564525 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T21:56:49.567330 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:56:49.568636 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:56:49.572463 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:56:49 +0530
I, [2018-09-12T21:56:49.585451 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:56:49.585525 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:56:49.587693 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:56:49.589291 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T21:56:53.364318 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 21:56:53 +0530
I, [2018-09-12T21:56:53.379289 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T21:56:53.379386 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T21:56:53.381967 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:56:53.383731 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:56:53.385203 #11095] DEBUG -- :   [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:56:53.387064 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:56:53.388744 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T21:56:53.389661 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:56:53.390327 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:56:53.391991 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:26:53.389000"], ["id", 1]]
D, [2018-09-12T21:56:53.397912 #11095] DEBUG -- :   [1m[35m (5.5ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:56:53.399639 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 08:26:53.398551')[0m
D, [2018-09-12T21:56:53.401317 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:56:53.401789 #11095]  INFO -- : Completed 200 OK in 22ms (Views: 0.2ms | ActiveRecord: 9.0ms)


D, [2018-09-12T21:56:53.403249 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:56:53.404196 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:56:54.596520 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T21:56:54.600130 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:56:54.601408 #11095]  INFO -- : Completed 200 OK in 5016ms (Views: 0.5ms | ActiveRecord: 1.8ms)


D, [2018-09-12T21:56:54.604076 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:56:54.606094 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:56:54.619537 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 21:56:54 +0530
I, [2018-09-12T21:56:54.642630 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:56:54 +0530
I, [2018-09-12T21:56:54.658788 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T21:56:54.660825 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:56:54.660949 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
I, [2018-09-12T21:56:54.661075 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:56:54.664763 #11095] DEBUG -- :   [1m[35m (1.7ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:56:54.665928 #11095] DEBUG -- :   [1m[35m (1.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:56:54.667425 #11095] DEBUG -- :   [1m[35m (1.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:56:54.670906 #11095] DEBUG -- :   [1m[35m (3.1ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:56:54.672039 #11095] DEBUG -- :   [1m[36mUser Load (1.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:56:54.673964 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:56:54.675545 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T21:56:54.676324 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:56:54.676726 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:56:54.677170 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:56:54.678539 #11095] DEBUG -- :   [1m[35mSQL (0.2ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:26:54.676000"], ["id", 1]]
D, [2018-09-12T21:56:54.681417 #11095] DEBUG -- :   [1m[35m (2.6ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:56:54.682677 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T21:56:54.683546 #11095] DEBUG -- :   [1m[36mChat Load (0.2ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T21:56:54.687876 #11095] DEBUG -- :   [1m[36mChat::Agent Load (1.0ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:24:54.685549')[0m  [["active", "t"]]
D, [2018-09-12T21:56:54.691090 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T21:56:54.691921 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T21:56:54.692519 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.2ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T21:56:54.693235 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T21:56:54.694154 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:24:54.693416')[0m  [["active", "t"]]
D, [2018-09-12T21:56:54.694865 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:24:54.694306')[0m  [["active", "t"]]
D, [2018-09-12T21:56:54.695664 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T21:56:54.696387 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:24:54.695842')[0m  [["active", "t"]]
D, [2018-09-12T21:56:54.696911 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:56:54.697680 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.2ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T21:56:54.700434 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:56:54.700866 #11095]  INFO -- : Completed 200 OK in 40ms (Views: 0.1ms | ActiveRecord: 13.1ms)


D, [2018-09-12T21:56:54.703225 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:56:54.704594 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:56:55.677875 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T21:56:55.686010 #11095] DEBUG -- :   [1m[36mSetting Load (1.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:56:55.687652 #11095]  INFO -- : Completed 200 OK in 1024ms (Views: 3.8ms | ActiveRecord: 5.8ms)


D, [2018-09-12T21:56:55.690595 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:56:55.692939 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:56:55.705786 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:56:55 +0530
I, [2018-09-12T21:56:55.728590 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:56:55.728683 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:56:55.730902 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:56:55.732457 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:57:02.743006 #11095] DEBUG -- :   [1m[36mSetting Load (1.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:57:02.744956 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.5ms | ActiveRecord: 2.3ms)


D, [2018-09-12T21:57:02.749448 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:57:02.751970 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:57:02.765098 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:57:02 +0530
I, [2018-09-12T21:57:02.797892 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:57:02.798121 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:57:02.802161 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:57:02.804333 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:57:09.813752 #11095] DEBUG -- :   [1m[36mSetting Load (0.8ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:57:09.814827 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.2ms | ActiveRecord: 2.1ms)


D, [2018-09-12T21:57:09.816384 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:57:09.817182 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:57:09.820561 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:57:09 +0530
I, [2018-09-12T21:57:09.834287 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:57:09.834352 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:57:09.836480 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:57:09.837859 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:57:16.847446 #11095] DEBUG -- :   [1m[36mSetting Load (1.6ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:57:16.849588 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.6ms | ActiveRecord: 2.5ms)


D, [2018-09-12T21:57:16.853854 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:57:16.857121 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:57:16.868554 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:57:16 +0530
I, [2018-09-12T21:57:16.887680 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:57:16.887757 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:57:16.890000 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:57:16.891836 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:57:23.901368 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:57:23.902834 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.4ms | ActiveRecord: 2.3ms)


D, [2018-09-12T21:57:23.906067 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:57:23.908904 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:57:23.918939 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:57:23 +0530
I, [2018-09-12T21:57:23.951542 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:57:23.951656 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:57:23.955195 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:57:23.959079 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:57:30.969581 #11095] DEBUG -- :   [1m[36mSetting Load (2.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:57:30.970858 #11095]  INFO -- : Completed 200 OK in 7019ms (Views: 0.4ms | ActiveRecord: 3.6ms)


D, [2018-09-12T21:57:30.973483 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:57:30.975554 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:57:30.984429 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:57:30 +0530
I, [2018-09-12T21:57:31.017366 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:57:31.017515 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:57:31.022741 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:57:31.024963 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:57:38.035645 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:57:38.037118 #11095]  INFO -- : Completed 200 OK in 7019ms (Views: 0.5ms | ActiveRecord: 2.4ms)


D, [2018-09-12T21:57:38.040123 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:57:38.042572 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:57:38.053618 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:57:38 +0530
I, [2018-09-12T21:57:38.079539 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:57:38.079621 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:57:38.082512 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:57:38.085329 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:57:45.094648 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:57:45.095192 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.2ms | ActiveRecord: 1.8ms)


D, [2018-09-12T21:57:45.096248 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:57:45.097113 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:57:45.101156 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:57:45 +0530
I, [2018-09-12T21:57:45.114031 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:57:45.114110 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:57:45.117555 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:57:45.119509 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T21:57:48.369846 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 21:57:48 +0530
I, [2018-09-12T21:57:48.405214 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T21:57:48.405359 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T21:57:48.410583 #11095] DEBUG -- :   [1m[35m (1.2ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:57:48.412538 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:57:48.414379 #11095] DEBUG -- :   [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:57:48.417172 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:57:48.419368 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T21:57:48.420536 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:57:48.421188 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:57:48.423022 #11095] DEBUG -- :   [1m[35mSQL (0.4ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:27:48.420000"], ["id", 1]]
D, [2018-09-12T21:57:48.430406 #11095] DEBUG -- :   [1m[35m (6.9ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:57:48.432709 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.5ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 08:27:48.431134')[0m
D, [2018-09-12T21:57:48.434516 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:57:48.435004 #11095]  INFO -- : Completed 200 OK in 29ms (Views: 0.1ms | ActiveRecord: 11.9ms)


D, [2018-09-12T21:57:48.436434 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:57:48.437275 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:57:50.148935 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T21:57:50.152922 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:57:50.154328 #11095]  INFO -- : Completed 200 OK in 5040ms (Views: 0.6ms | ActiveRecord: 2.3ms)


D, [2018-09-12T21:57:50.157166 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:57:50.159789 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:57:50.170648 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 21:57:50 +0530
I, [2018-09-12T21:57:50.196524 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:57:50 +0530
I, [2018-09-12T21:57:50.211936 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T21:57:50.212038 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
I, [2018-09-12T21:57:50.215476 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:57:50.215581 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:57:50.217363 #11095] DEBUG -- :   [1m[35m (1.8ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:57:50.218415 #11095] DEBUG -- :   [1m[35m (1.1ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:57:50.219327 #11095] DEBUG -- :   [1m[35m (1.0ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:57:50.220265 #11095] DEBUG -- :   [1m[35m (1.0ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:57:50.220790 #11095] DEBUG -- :   [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:57:50.222257 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:57:50.223586 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T21:57:50.224329 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:57:50.224710 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:57:50.225142 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:57:50.226371 #11095] DEBUG -- :   [1m[35mSQL (0.2ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:27:50.224000"], ["id", 1]]
D, [2018-09-12T21:57:50.229235 #11095] DEBUG -- :   [1m[35m (2.6ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:57:50.230742 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.4ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T21:57:50.231593 #11095] DEBUG -- :   [1m[36mChat Load (0.2ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T21:57:50.233390 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:25:50.232717')[0m  [["active", "t"]]
D, [2018-09-12T21:57:50.235597 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.2ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T21:57:50.236320 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T21:57:50.236926 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T21:57:50.237615 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T21:57:50.238458 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:25:50.237769')[0m  [["active", "t"]]
D, [2018-09-12T21:57:50.239245 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:25:50.238620')[0m  [["active", "t"]]
D, [2018-09-12T21:57:50.240171 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T21:57:50.241451 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:25:50.240712')[0m  [["active", "t"]]
D, [2018-09-12T21:57:50.242035 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:57:50.242842 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T21:57:50.245631 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:57:50.246006 #11095]  INFO -- : Completed 200 OK in 34ms (Views: 0.1ms | ActiveRecord: 10.9ms)


D, [2018-09-12T21:57:50.247087 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:57:50.247889 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:57:51.225367 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T21:57:51.228668 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:57:51.229116 #11095]  INFO -- : Completed 200 OK in 1013ms (Views: 2.0ms | ActiveRecord: 2.5ms)


D, [2018-09-12T21:57:51.230004 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:57:51.230762 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:57:51.236645 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:57:51 +0530
I, [2018-09-12T21:57:51.257794 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:57:51.257886 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:57:51.260187 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:57:51.261655 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:57:58.273370 #11095] DEBUG -- :   [1m[36mSetting Load (1.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:57:58.275597 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.5ms | ActiveRecord: 2.3ms)


D, [2018-09-12T21:57:58.279890 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:57:58.282387 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:57:58.289901 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:57:58 +0530
I, [2018-09-12T21:57:58.307185 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:57:58.307299 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:57:58.312904 #11095] DEBUG -- :   [1m[35m (1.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:57:58.315101 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:58:05.326437 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:58:05.327683 #11095]  INFO -- : Completed 200 OK in 7020ms (Views: 0.5ms | ActiveRecord: 3.1ms)


D, [2018-09-12T21:58:05.330209 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:58:05.332228 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:58:05.340919 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:58:05 +0530
I, [2018-09-12T21:58:05.370482 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:58:05.370594 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:58:05.373517 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:58:05.375178 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:58:12.385242 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:58:12.386581 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.5ms | ActiveRecord: 2.0ms)


D, [2018-09-12T21:58:12.389295 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:58:12.392415 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:58:12.403349 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:58:12 +0530
I, [2018-09-12T21:58:12.438533 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:58:12.438621 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:58:12.441404 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:58:12.445385 #11095] DEBUG -- :   [1m[35m (1.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:58:19.457292 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:58:19.458742 #11095]  INFO -- : Completed 200 OK in 7020ms (Views: 0.4ms | ActiveRecord: 3.1ms)


D, [2018-09-12T21:58:19.462032 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:58:19.464439 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:58:19.476449 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:58:19 +0530
I, [2018-09-12T21:58:19.506499 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:58:19.506591 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:58:19.509088 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:58:19.510630 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:58:26.522542 #11095] DEBUG -- :   [1m[36mSetting Load (1.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:58:26.524182 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.5ms | ActiveRecord: 2.3ms)


D, [2018-09-12T21:58:26.527927 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:58:26.530458 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:58:26.540118 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:58:26 +0530
I, [2018-09-12T21:58:26.573058 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:58:26.573177 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:58:26.576201 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:58:26.577913 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:58:33.589078 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:58:33.590513 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.5ms | ActiveRecord: 2.0ms)


D, [2018-09-12T21:58:33.593209 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:58:33.595927 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:58:33.610187 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:58:33 +0530
I, [2018-09-12T21:58:33.629311 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:58:33.629381 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:58:33.633593 #11095] DEBUG -- :   [1m[35m (1.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:58:33.635848 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:58:40.644213 #11095] DEBUG -- :   [1m[36mSetting Load (1.6ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:58:40.645683 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.4ms | ActiveRecord: 3.8ms)


D, [2018-09-12T21:58:40.648530 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:58:40.650649 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:58:40.663822 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:58:40 +0530
I, [2018-09-12T21:58:40.688164 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:58:40.688255 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:58:40.691230 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:58:40.692874 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T21:58:43.362652 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 21:58:43 +0530
I, [2018-09-12T21:58:43.393407 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T21:58:43.393529 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T21:58:43.397230 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:58:43.399214 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:58:43.400801 #11095] DEBUG -- :   [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:58:43.402632 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:58:43.404151 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T21:58:43.404952 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:58:43.405525 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:58:43.406933 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:28:43.405000"], ["id", 1]]
D, [2018-09-12T21:58:43.413965 #11095] DEBUG -- :   [1m[35m (6.8ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:58:43.415002 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 08:28:43.414388')[0m
D, [2018-09-12T21:58:43.416318 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:58:43.416665 #11095]  INFO -- : Completed 200 OK in 23ms (Views: 0.1ms | ActiveRecord: 10.3ms)


D, [2018-09-12T21:58:43.417786 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:58:43.418424 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:58:43.697776 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T21:58:43.701714 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:58:43.704097 #11095]  INFO -- : Completed 200 OK in 3015ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T21:58:43.707615 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:58:43.709715 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:58:43.718212 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 21:58:43 +0530
I, [2018-09-12T21:58:43.740831 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:58:43 +0530
I, [2018-09-12T21:58:43.753737 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T21:58:43.755735 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:58:43.755850 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
I, [2018-09-12T21:58:43.755970 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:58:43.760393 #11095] DEBUG -- :   [1m[35m (1.9ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:58:43.761533 #11095] DEBUG -- :   [1m[35m (1.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:58:43.762589 #11095] DEBUG -- :   [1m[35m (1.1ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:58:43.763613 #11095] DEBUG -- :   [1m[35m (1.1ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:58:43.764221 #11095] DEBUG -- :   [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:58:43.765811 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:58:43.767193 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T21:58:43.767975 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:58:43.768376 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:58:43.768898 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:58:43.773041 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:28:43.768000"], ["id", 1]]
D, [2018-09-12T21:58:43.775956 #11095] DEBUG -- :   [1m[35m (2.6ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:58:43.777426 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T21:58:43.778299 #11095] DEBUG -- :   [1m[36mChat Load (0.2ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T21:58:43.780178 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:26:43.779528')[0m  [["active", "t"]]
D, [2018-09-12T21:58:43.782797 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T21:58:43.783728 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T21:58:43.784479 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.2ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T21:58:43.785637 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T21:58:43.788249 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:26:43.786192')[0m  [["active", "t"]]
D, [2018-09-12T21:58:43.789429 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:26:43.788502')[0m  [["active", "t"]]
D, [2018-09-12T21:58:43.791058 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T21:58:43.792006 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:26:43.791272')[0m  [["active", "t"]]
D, [2018-09-12T21:58:43.792595 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:58:43.793485 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T21:58:43.797148 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:58:43.797723 #11095]  INFO -- : Completed 200 OK in 42ms (Views: 0.1ms | ActiveRecord: 12.1ms)


D, [2018-09-12T21:58:43.799040 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:58:43.799842 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:58:44.768172 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T21:58:44.776026 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:58:44.777378 #11095]  INFO -- : Completed 200 OK in 1019ms (Views: 4.4ms | ActiveRecord: 3.5ms)


D, [2018-09-12T21:58:44.780261 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:58:44.782894 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:58:44.794556 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:58:44 +0530
I, [2018-09-12T21:58:44.823043 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:58:44.823133 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:58:44.826328 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:58:44.828611 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:58:51.838126 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:58:51.840118 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.4ms | ActiveRecord: 2.3ms)


D, [2018-09-12T21:58:51.843596 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:58:51.846067 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:58:51.856655 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:58:51 +0530
I, [2018-09-12T21:58:51.890378 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:58:51.890534 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:58:51.895797 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:58:51.899220 #11095] DEBUG -- :   [1m[35m (1.0ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:58:58.910594 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:58:58.911908 #11095]  INFO -- : Completed 200 OK in 7021ms (Views: 0.7ms | ActiveRecord: 3.0ms)


D, [2018-09-12T21:58:58.915161 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:58:58.917298 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:58:58.926927 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:58:58 +0530
I, [2018-09-12T21:58:58.959547 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:58:58.959656 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:58:58.962333 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:58:58.963942 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:59:05.970460 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:59:05.970945 #11095]  INFO -- : Completed 200 OK in 7011ms (Views: 0.2ms | ActiveRecord: 1.5ms)


D, [2018-09-12T21:59:05.972224 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:59:05.973251 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:59:05.978324 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:59:05 +0530
I, [2018-09-12T21:59:05.991321 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:59:05.991411 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:59:05.995248 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:59:05.997472 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:59:13.007815 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:59:13.010769 #11095]  INFO -- : Completed 200 OK in 7019ms (Views: 0.5ms | ActiveRecord: 2.4ms)


D, [2018-09-12T21:59:13.014970 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:59:13.017488 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:59:13.024556 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:59:13 +0530
I, [2018-09-12T21:59:13.040742 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:59:13.040819 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:59:13.044223 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:59:13.046843 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:59:20.058138 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:59:20.059520 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.4ms | ActiveRecord: 2.3ms)


D, [2018-09-12T21:59:20.062190 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:59:20.064281 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:59:20.073345 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:59:20 +0530
I, [2018-09-12T21:59:20.100569 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:59:20.100715 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:59:20.103354 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:59:20.105100 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:59:20.106072 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:59:20.107411 #11095] DEBUG -- :   [1m[35mSQL (0.4ms)[0m  [1m[32mINSERT INTO "delayed_jobs" ("handler", "run_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["handler", "--- !ruby/object:Observer::UserDeviceLogJob\nhttp_user_agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko)\n  Chrome/68.0.3440.106 Safari/537.36\nremote_ip: \"::1\"\nuser_id: 3\nfingerprint: \"-1992429858\"\ntype: session\n"], ["run_at", "2018-09-12 16:29:20.106208"], ["created_at", "2018-09-12 16:29:20.106000"], ["updated_at", "2018-09-12 16:29:20.106000"]]
D, [2018-09-12T21:59:20.114992 #11095] DEBUG -- :   [1m[35m (6.8ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:59:27.122972 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:59:27.123297 #11095]  INFO -- : Completed 200 OK in 7022ms (Views: 0.2ms | ActiveRecord: 8.6ms)


D, [2018-09-12T21:59:27.124217 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:59:27.125293 #11095] DEBUG -- :   [1m[35mSQL (0.2ms)[0m  [1m[33mUPDATE "sessions" SET "data" = $1, "updated_at" = $2 WHERE "sessions"."id" = $3[0m  [["data", "BAh7D0kiCXBpbmcGOgZFRkkiGTIwMTgtMDktMTJUMTY6MDk6MjZaBjsAVEki\nD3VzZXJfYWdlbnQGOwBGIm5Nb3ppbGxhLzUuMCAoWDExOyBMaW51eCB4ODZf\nNjQpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENo\ncm9tZS82OC4wLjM0NDAuMTA2IFNhZmFyaS81MzcuMzZJIhBfY3NyZl90b2tl\nbgY7AEZJIjE1SzlmTEZWTnRwVFYydjArWGQ1M21QMjFWbDAzT1RSeEp2cUpm\nbitDRDUwPQY7AEZJIgx1c2VyX2lkBjsARmkISSIadXNlcl9kZXZpY2VfcmVt\nb3RlX2lwBjsARiIIOjoxSSIcdXNlcl9kZXZpY2VfZmluZ2VycHJpbnQGOwBG\nSSIQLTE5OTI0Mjk4NTgGOwBUSSIbdXNlcl9kZXZpY2VfdXBkYXRlZF9hdAY7\nAEZVOiBBY3RpdmVTdXBwb3J0OjpUaW1lV2l0aFpvbmVbCEl1OglUaW1lDZCh\nHcCfm0F1CToJem9uZUkiCFVUQwY7AEY6DW5hbm9fbnVtaQIVAjoNbmFub19k\nZW5pBjoNc3VibWljcm8iB1MwSSIIVVRDBjsAVEAWSSIPcGVyc2lzdGVudAY7\nAEZUSSIOcmVtb3RlX2lwBjsARiIIOjoxSSIIZ2VvBjsARnsA\n"], ["updated_at", "2018-09-12 16:29:27.124478"], ["id", 33]]
D, [2018-09-12T21:59:27.127707 #11095] DEBUG -- :   [1m[35m (2.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:59:27.130940 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:59:27 +0530
I, [2018-09-12T21:59:27.140976 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:59:27.141033 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:59:27.142995 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:59:27.144220 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:59:34.153556 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:59:34.154803 #11095]  INFO -- : Completed 200 OK in 7013ms (Views: 0.4ms | ActiveRecord: 1.8ms)


D, [2018-09-12T21:59:34.157327 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:59:34.159167 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:59:34.162366 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:59:34 +0530
I, [2018-09-12T21:59:34.173818 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:59:34.173894 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:59:34.176066 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:59:34.177575 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T21:59:38.364035 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 21:59:38 +0530
I, [2018-09-12T21:59:38.397804 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T21:59:38.397932 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T21:59:38.400934 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:59:38.402504 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:59:38.403841 #11095] DEBUG -- :   [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:59:38.405444 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:59:38.406880 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T21:59:38.407763 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:59:38.408394 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:59:38.409899 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:29:38.408000"], ["id", 1]]
D, [2018-09-12T21:59:38.411214 #11095] DEBUG -- :   [1m[35m (1.0ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:59:38.412368 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 08:29:38.411683')[0m
D, [2018-09-12T21:59:38.413757 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:59:38.414185 #11095]  INFO -- : Completed 200 OK in 16ms (Views: 0.1ms | ActiveRecord: 4.2ms)


D, [2018-09-12T21:59:38.415409 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:59:38.416186 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:59:39.183435 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T21:59:39.185741 #11095] DEBUG -- :   [1m[36mSetting Load (0.7ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:59:39.186431 #11095]  INFO -- : Completed 200 OK in 5012ms (Views: 0.3ms | ActiveRecord: 1.6ms)


D, [2018-09-12T21:59:39.187892 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:59:39.189462 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:59:39.198318 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:59:39 +0530
I, [2018-09-12T21:59:39.214202 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 21:59:39 +0530
I, [2018-09-12T21:59:39.236838 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:59:39.236957 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
I, [2018-09-12T21:59:39.243277 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T21:59:39.243718 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
D, [2018-09-12T21:59:39.246900 #11095] DEBUG -- :   [1m[35m (7.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:59:39.248751 #11095] DEBUG -- :   [1m[35m (2.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:59:39.250826 #11095] DEBUG -- :   [1m[35m (2.2ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:59:39.251993 #11095] DEBUG -- :   [1m[35m (1.3ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:59:39.254493 #11095] DEBUG -- :   [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:59:39.258162 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:59:39.261369 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T21:59:39.262791 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.5ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:59:39.263361 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:59:39.263837 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:59:39.265323 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:29:39.263000"], ["id", 1]]
D, [2018-09-12T21:59:39.272580 #11095] DEBUG -- :   [1m[35m (6.8ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:59:39.277894 #11095] DEBUG -- :   [1m[36mChat::Session Load (1.1ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T21:59:39.280168 #11095] DEBUG -- :   [1m[36mChat Load (0.7ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T21:59:39.283615 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.5ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:27:39.282343')[0m  [["active", "t"]]
D, [2018-09-12T21:59:39.288435 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.6ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T21:59:39.290192 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T21:59:39.291694 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.5ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T21:59:39.293005 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T21:59:39.294748 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:27:39.293390')[0m  [["active", "t"]]
D, [2018-09-12T21:59:39.295881 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:27:39.295048')[0m  [["active", "t"]]
D, [2018-09-12T21:59:39.296882 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T21:59:39.297743 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:27:39.297056')[0m  [["active", "t"]]
D, [2018-09-12T21:59:39.298418 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T21:59:39.299364 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T21:59:39.302029 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:59:39.302460 #11095]  INFO -- : Completed 200 OK in 59ms (Views: 0.1ms | ActiveRecord: 19.3ms)


D, [2018-09-12T21:59:39.303724 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:59:39.304749 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T21:59:40.257721 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T21:59:40.266187 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:59:40.267979 #11095]  INFO -- : Completed 200 OK in 1030ms (Views: 5.0ms | ActiveRecord: 10.2ms)


D, [2018-09-12T21:59:40.271313 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:59:40.273477 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:59:40.282144 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:59:40 +0530
I, [2018-09-12T21:59:40.310543 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:59:40.310619 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:59:40.313153 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:59:40.314924 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:59:47.325829 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:59:47.327053 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.4ms | ActiveRecord: 2.1ms)


D, [2018-09-12T21:59:47.330235 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:59:47.332513 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:59:47.343993 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:59:47 +0530
I, [2018-09-12T21:59:47.361523 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:59:47.361612 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:59:47.364368 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:59:47.366069 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T21:59:54.376006 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T21:59:54.377414 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.4ms | ActiveRecord: 2.1ms)


D, [2018-09-12T21:59:54.380168 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T21:59:54.382505 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T21:59:54.392433 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 21:59:54 +0530
I, [2018-09-12T21:59:54.420546 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T21:59:54.420653 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T21:59:54.423384 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T21:59:54.425003 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:00:01.435340 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:00:01.436708 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.5ms | ActiveRecord: 2.1ms)


D, [2018-09-12T22:00:01.439536 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:00:01.444078 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:00:01.453992 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:00:01 +0530
I, [2018-09-12T22:00:01.482098 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:00:01.482188 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:00:01.484889 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:00:01.486670 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:00:08.499407 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:00:08.500864 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T22:00:08.503596 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:00:08.504632 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:00:08.508746 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:00:08 +0530
I, [2018-09-12T22:00:08.526028 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:00:08.526129 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:00:08.529922 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:00:08.532600 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:00:15.545055 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:00:15.546478 #11095]  INFO -- : Completed 200 OK in 7020ms (Views: 0.5ms | ActiveRecord: 2.6ms)


D, [2018-09-12T22:00:15.549264 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:00:15.550872 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:00:15.554857 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:00:15 +0530
I, [2018-09-12T22:00:15.568415 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:00:15.568494 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:00:15.570782 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:00:15.572482 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:00:22.583206 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:00:22.584606 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.5ms | ActiveRecord: 2.4ms)


D, [2018-09-12T22:00:22.587375 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:00:22.590716 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:00:22.600827 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:00:22 +0530
I, [2018-09-12T22:00:22.637713 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:00:22.638005 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:00:22.643847 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:00:22.647176 #11095] DEBUG -- :   [1m[35m (1.2ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:00:29.658512 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:00:29.659903 #11095]  INFO -- : Completed 200 OK in 7021ms (Views: 0.5ms | ActiveRecord: 3.1ms)


D, [2018-09-12T22:00:29.662669 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:00:29.664987 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:00:29.675534 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:00:29 +0530
I, [2018-09-12T22:00:29.710739 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:00:29.710853 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:00:29.714189 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:00:29.716467 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T22:00:33.364016 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:00:33 +0530
I, [2018-09-12T22:00:33.380621 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:00:33.380706 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T22:00:33.383044 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:00:33.384611 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:00:33.385987 #11095] DEBUG -- :   [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:00:33.387660 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:00:33.389121 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:00:33.389969 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:00:33.390519 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:00:33.392103 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:30:33.390000"], ["id", 1]]
D, [2018-09-12T22:00:33.400083 #11095] DEBUG -- :   [1m[35m (7.3ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:00:33.404040 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.9ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 08:30:33.401652')[0m
D, [2018-09-12T22:00:33.408406 #11095] DEBUG -- :   [1m[36mSetting Load (0.9ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:00:33.409785 #11095]  INFO -- : Completed 200 OK in 29ms (Views: 0.4ms | ActiveRecord: 11.9ms)


D, [2018-09-12T22:00:33.413428 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:00:33.415694 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:00:34.723441 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T22:00:34.726216 #11095] DEBUG -- :   [1m[36mSetting Load (0.8ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:00:34.727422 #11095]  INFO -- : Completed 200 OK in 5016ms (Views: 0.4ms | ActiveRecord: 2.1ms)


D, [2018-09-12T22:00:34.729313 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:00:34.730557 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:00:34.736971 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:00:34 +0530
I, [2018-09-12T22:00:34.756115 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:00:34 +0530
I, [2018-09-12T22:00:34.775156 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:00:34.777573 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:00:34.777758 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
I, [2018-09-12T22:00:34.777872 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:00:34.782567 #11095] DEBUG -- :   [1m[35m (1.8ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:00:34.784306 #11095] DEBUG -- :   [1m[35m (1.9ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:00:34.785378 #11095] DEBUG -- :   [1m[35m (1.2ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:00:34.786096 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:00:34.787215 #11095] DEBUG -- :   [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:00:34.788824 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:00:34.790055 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:00:34.790715 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:00:34.791066 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:00:34.791434 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:00:34.792657 #11095] DEBUG -- :   [1m[35mSQL (0.2ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:30:34.791000"], ["id", 1]]
D, [2018-09-12T22:00:34.795578 #11095] DEBUG -- :   [1m[35m (2.6ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:00:34.796690 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.2ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:00:34.797446 #11095] DEBUG -- :   [1m[36mChat Load (0.2ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T22:00:34.799053 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:28:34.798494')[0m  [["active", "t"]]
D, [2018-09-12T22:00:34.801164 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.2ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:00:34.801827 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:00:34.802324 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.2ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:00:34.802931 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:00:34.803686 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:28:34.803076')[0m  [["active", "t"]]
D, [2018-09-12T22:00:34.804354 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:28:34.803816')[0m  [["active", "t"]]
D, [2018-09-12T22:00:34.805146 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T22:00:34.805815 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:28:34.805291')[0m  [["active", "t"]]
D, [2018-09-12T22:00:34.806327 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:00:34.807091 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.2ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:00:34.809305 #11095] DEBUG -- :   [1m[36mSetting Load (0.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:00:34.809663 #11095]  INFO -- : Completed 200 OK in 32ms (Views: 0.1ms | ActiveRecord: 9.4ms)


D, [2018-09-12T22:00:34.810694 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:00:34.811348 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:00:35.792499 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T22:00:35.799624 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:00:35.800938 #11095]  INFO -- : Completed 200 OK in 1022ms (Views: 3.6ms | ActiveRecord: 4.3ms)


D, [2018-09-12T22:00:35.803562 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:00:35.805892 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:00:35.816770 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:00:35 +0530
I, [2018-09-12T22:00:35.841335 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:00:35.841426 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:00:35.843899 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:00:35.845400 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:00:42.854784 #11095] DEBUG -- :   [1m[36mSetting Load (0.9ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:00:42.856484 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.4ms | ActiveRecord: 1.8ms)


D, [2018-09-12T22:00:42.859583 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:00:42.861911 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:00:42.868664 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:00:42 +0530
I, [2018-09-12T22:00:42.884793 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:00:42.884899 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:00:42.888317 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:00:42.890802 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:00:49.902950 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:00:49.904399 #11095]  INFO -- : Completed 200 OK in 7019ms (Views: 0.5ms | ActiveRecord: 2.9ms)


D, [2018-09-12T22:00:49.907153 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:00:49.909491 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:00:49.920195 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:00:49 +0530
I, [2018-09-12T22:00:49.951592 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:00:49.951699 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:00:49.954911 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:00:49.956562 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:00:56.967428 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:00:56.968816 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.5ms | ActiveRecord: 2.1ms)


D, [2018-09-12T22:00:56.971567 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:00:56.973894 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:00:56.985682 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:00:56 +0530
I, [2018-09-12T22:00:57.018344 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:00:57.018484 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:00:57.021721 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:00:57.023533 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:01:04.033764 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:01:04.035154 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.4ms | ActiveRecord: 2.2ms)


D, [2018-09-12T22:01:04.036027 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:01:04.036725 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:01:04.040607 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:01:04 +0530
I, [2018-09-12T22:01:04.053515 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:01:04.053581 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:01:04.055651 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:01:04.057116 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:01:11.069183 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:01:11.070599 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.5ms | ActiveRecord: 2.1ms)


D, [2018-09-12T22:01:11.073380 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:01:11.074887 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:01:11.078777 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:01:11 +0530
I, [2018-09-12T22:01:11.093520 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:01:11.093608 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:01:11.096275 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:01:11.098040 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:01:18.107773 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:01:18.109062 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.4ms | ActiveRecord: 2.1ms)


D, [2018-09-12T22:01:18.111518 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:01:18.112716 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:01:18.116381 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:01:18 +0530
I, [2018-09-12T22:01:18.127107 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:01:18.127165 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:01:18.129153 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:01:18.130393 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:01:25.138753 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:01:25.139967 #11095]  INFO -- : Completed 200 OK in 7012ms (Views: 0.4ms | ActiveRecord: 1.8ms)


D, [2018-09-12T22:01:25.142999 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:01:25.145347 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:01:25.154329 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:01:25 +0530
I, [2018-09-12T22:01:25.181331 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:01:25.181415 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:01:25.183928 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:01:25.185994 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T22:01:28.364054 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:01:28 +0530
I, [2018-09-12T22:01:28.397055 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:01:28.397220 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T22:01:28.400288 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:01:28.401760 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:01:28.403026 #11095] DEBUG -- :   [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:01:28.404532 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:01:28.405841 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:01:28.406573 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:01:28.407091 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:01:28.408392 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:31:28.406000"], ["id", 1]]
D, [2018-09-12T22:01:28.409497 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:01:28.410545 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 08:31:28.409916')[0m
D, [2018-09-12T22:01:28.411781 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:01:28.412169 #11095]  INFO -- : Completed 200 OK in 15ms (Views: 0.1ms | ActiveRecord: 3.8ms)


D, [2018-09-12T22:01:28.413342 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:01:28.414053 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:01:30.191096 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T22:01:30.194619 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:01:30.195883 #11095]  INFO -- : Completed 200 OK in 5014ms (Views: 0.5ms | ActiveRecord: 1.9ms)


D, [2018-09-12T22:01:30.198332 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:01:30.201126 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:01:30.210804 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:01:30 +0530
I, [2018-09-12T22:01:30.212208 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:01:30 +0530
I, [2018-09-12T22:01:30.249675 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:01:30.251412 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:01:30.251580 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
I, [2018-09-12T22:01:30.251684 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:01:30.256375 #11095] DEBUG -- :   [1m[35m (1.8ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:01:30.257740 #11095] DEBUG -- :   [1m[35m (1.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:01:30.258934 #11095] DEBUG -- :   [1m[35m (1.4ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:01:30.259680 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:01:30.261138 #11095] DEBUG -- :   [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:01:30.263057 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:01:30.264776 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:01:30.265686 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:01:30.266198 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:01:30.266742 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:01:30.268394 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:31:30.266000"], ["id", 1]]
D, [2018-09-12T22:01:30.275805 #11095] DEBUG -- :   [1m[35m (6.9ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:01:30.279275 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.8ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:01:30.281999 #11095] DEBUG -- :   [1m[36mChat Load (0.7ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T22:01:30.287922 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.8ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:29:30.285725')[0m  [["active", "t"]]
D, [2018-09-12T22:01:30.293545 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.5ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:01:30.295065 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:01:30.296310 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.5ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:01:30.297428 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:01:30.298781 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:29:30.297691')[0m  [["active", "t"]]
D, [2018-09-12T22:01:30.299893 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:29:30.299006')[0m  [["active", "t"]]
D, [2018-09-12T22:01:30.301180 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T22:01:30.302172 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:29:30.301384')[0m  [["active", "t"]]
D, [2018-09-12T22:01:30.302914 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:01:30.304001 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.4ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:01:30.307661 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:01:30.308084 #11095]  INFO -- : Completed 200 OK in 56ms (Views: 0.1ms | ActiveRecord: 17.6ms)


D, [2018-09-12T22:01:30.309593 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:01:30.310542 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:01:31.264991 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T22:01:31.269786 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:01:31.270381 #11095]  INFO -- : Completed 200 OK in 1018ms (Views: 3.1ms | ActiveRecord: 3.6ms)


D, [2018-09-12T22:01:31.271624 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:01:31.272431 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:01:31.278026 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:01:31 +0530
I, [2018-09-12T22:01:31.292951 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:01:31.293034 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:01:31.296488 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:01:31.298498 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:01:38.308768 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:01:38.310058 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.7ms | ActiveRecord: 2.1ms)


D, [2018-09-12T22:01:38.313154 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:01:38.315262 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:01:38.324305 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:01:38 +0530
I, [2018-09-12T22:01:38.363081 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:01:38.363196 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:01:38.365715 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:01:38.367151 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:01:45.376237 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:01:45.377440 #11095]  INFO -- : Completed 200 OK in 7014ms (Views: 0.5ms | ActiveRecord: 1.9ms)


D, [2018-09-12T22:01:45.379968 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:01:45.382124 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:01:45.391855 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:01:45 +0530
I, [2018-09-12T22:01:45.418097 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:01:45.418185 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:01:45.420894 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:01:45.422437 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:01:52.431302 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:01:52.432786 #11095]  INFO -- : Completed 200 OK in 7014ms (Views: 0.4ms | ActiveRecord: 2.0ms)


D, [2018-09-12T22:01:52.435364 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:01:52.437987 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:01:52.447157 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:01:52 +0530
I, [2018-09-12T22:01:52.476209 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:01:52.476294 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:01:52.479019 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:01:52.480705 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:01:59.490707 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:01:59.492145 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.5ms | ActiveRecord: 2.1ms)


D, [2018-09-12T22:01:59.495647 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:01:59.499721 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:01:59.510264 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:01:59 +0530
I, [2018-09-12T22:01:59.534741 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:01:59.534819 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:01:59.537828 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:01:59.539473 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:02:06.549307 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:02:06.550545 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.4ms | ActiveRecord: 2.0ms)


D, [2018-09-12T22:02:06.552977 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:02:06.554978 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:02:06.563949 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:02:06 +0530
I, [2018-09-12T22:02:06.592465 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:02:06.592571 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:02:06.595211 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:02:06.596920 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:02:13.609072 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:02:13.610674 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.9ms | ActiveRecord: 2.3ms)


D, [2018-09-12T22:02:13.614026 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:02:13.616756 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:02:13.627639 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:02:13 +0530
I, [2018-09-12T22:02:13.649165 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:02:13.649241 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:02:13.651634 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:02:13.655080 #11095] DEBUG -- :   [1m[35m (1.4ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:02:20.669467 #11095] DEBUG -- :   [1m[36mSetting Load (1.6ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:02:20.670974 #11095]  INFO -- : Completed 200 OK in 7021ms (Views: 0.5ms | ActiveRecord: 3.4ms)


D, [2018-09-12T22:02:20.674692 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:02:20.677240 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:02:20.690021 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:02:20 +0530
I, [2018-09-12T22:02:20.717970 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:02:20.718046 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:02:20.723739 #11095] DEBUG -- :   [1m[35m (1.7ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:02:20.726600 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T22:02:23.364472 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:02:23 +0530
I, [2018-09-12T22:02:23.389056 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:02:23.389146 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T22:02:23.392267 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:02:23.394176 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:02:23.395820 #11095] DEBUG -- :   [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:02:23.397931 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:02:23.399508 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:02:23.400299 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:02:23.400853 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:02:23.402511 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:32:23.400000"], ["id", 1]]
D, [2018-09-12T22:02:23.404275 #11095] DEBUG -- :   [1m[35m (1.0ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:02:23.406576 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 08:32:23.405650')[0m
D, [2018-09-12T22:02:23.408675 #11095] DEBUG -- :   [1m[36mSetting Load (0.6ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:02:23.409265 #11095]  INFO -- : Completed 200 OK in 20ms (Views: 0.1ms | ActiveRecord: 4.8ms)


D, [2018-09-12T22:02:23.410659 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:02:23.411418 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:02:23.730908 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T22:02:23.732305 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:02:23.732672 #11095]  INFO -- : Completed 200 OK in 3015ms (Views: 0.2ms | ActiveRecord: 2.8ms)


D, [2018-09-12T22:02:23.733504 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:02:23.734174 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:02:23.738141 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:02:23 +0530
I, [2018-09-12T22:02:23.751954 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:02:23 +0530
I, [2018-09-12T22:02:23.769563 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:02:23.769663 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
I, [2018-09-12T22:02:23.775511 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
D, [2018-09-12T22:02:23.775729 #11095] DEBUG -- :   [1m[35m (3.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
I, [2018-09-12T22:02:23.777626 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
D, [2018-09-12T22:02:23.780634 #11095] DEBUG -- :   [1m[35m (3.4ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:02:23.781458 #11095] DEBUG -- :   [1m[35m (1.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:02:23.783348 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:02:23.785078 #11095] DEBUG -- :   [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:02:23.787340 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:02:23.789257 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:02:23.790221 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:02:23.790731 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:02:23.791226 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:02:23.792838 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:32:23.790000"], ["id", 1]]
D, [2018-09-12T22:02:23.795980 #11095] DEBUG -- :   [1m[35m (2.8ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:02:23.797577 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.4ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:02:23.798467 #11095] DEBUG -- :   [1m[36mChat Load (0.2ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T22:02:23.800986 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:30:23.799872')[0m  [["active", "t"]]
D, [2018-09-12T22:02:23.804664 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:02:23.805656 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:02:23.806366 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.2ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:02:23.807220 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:02:23.808416 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:30:23.807470')[0m  [["active", "t"]]
D, [2018-09-12T22:02:23.809347 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:30:23.808634')[0m  [["active", "t"]]
D, [2018-09-12T22:02:23.810434 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T22:02:23.811324 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:30:23.810635')[0m  [["active", "t"]]
D, [2018-09-12T22:02:23.811991 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:02:23.812991 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.2ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:02:23.817804 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:02:23.818424 #11095]  INFO -- : Completed 200 OK in 41ms (Views: 0.2ms | ActiveRecord: 10.4ms)


D, [2018-09-12T22:02:23.819970 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:02:23.820827 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:02:24.786673 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T22:02:24.794702 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:02:24.796239 #11095]  INFO -- : Completed 200 OK in 1026ms (Views: 4.3ms | ActiveRecord: 7.7ms)


D, [2018-09-12T22:02:24.800283 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:02:24.802619 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:02:24.814137 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:02:24 +0530
I, [2018-09-12T22:02:24.846493 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:02:24.846586 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:02:24.849755 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:02:24.851634 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:02:31.863004 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:02:31.864890 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.6ms | ActiveRecord: 2.4ms)


D, [2018-09-12T22:02:31.867839 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:02:31.870187 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:02:31.880282 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:02:31 +0530
I, [2018-09-12T22:02:31.912147 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:02:31.912258 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:02:31.915368 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:02:31.917467 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:02:38.929468 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:02:38.930872 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.5ms | ActiveRecord: 2.3ms)


D, [2018-09-12T22:02:38.933585 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:02:38.935838 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:02:38.945583 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:02:38 +0530
I, [2018-09-12T22:02:38.971772 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:02:38.971861 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:02:38.974668 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:02:38.976456 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:02:45.986716 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:02:45.987924 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.5ms | ActiveRecord: 2.1ms)


D, [2018-09-12T22:02:45.990362 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:02:45.992439 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:02:46.001259 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:02:46 +0530
I, [2018-09-12T22:02:46.029836 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:02:46.029941 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:02:46.032780 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:02:46.034517 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:02:53.045543 #11095] DEBUG -- :   [1m[36mSetting Load (1.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:02:53.046972 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.5ms | ActiveRecord: 2.6ms)


D, [2018-09-12T22:02:53.050017 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:02:53.052300 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:02:53.061903 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:02:53 +0530
I, [2018-09-12T22:02:53.089861 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:02:53.089959 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:02:53.092669 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:02:53.094322 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:03:00.102060 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:03:00.102481 #11095]  INFO -- : Completed 200 OK in 7012ms (Views: 0.2ms | ActiveRecord: 1.4ms)


D, [2018-09-12T22:03:00.103364 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:03:00.104172 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:03:00.107566 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:03:00 +0530
I, [2018-09-12T22:03:00.119736 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:03:00.119799 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:03:00.121745 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:03:00.122918 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:03:07.135320 #11095] DEBUG -- :   [1m[36mSetting Load (1.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:03:07.137072 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 1.2ms | ActiveRecord: 2.0ms)


D, [2018-09-12T22:03:07.139765 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:03:07.141744 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:03:07.153861 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:03:07 +0530
I, [2018-09-12T22:03:07.182256 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:03:07.182388 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:03:07.185821 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:03:07.187616 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:03:14.196476 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:03:14.197734 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.4ms | ActiveRecord: 2.3ms)


D, [2018-09-12T22:03:14.200588 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:03:14.203084 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:03:14.214100 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:03:14 +0530
I, [2018-09-12T22:03:14.243861 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:03:14.243949 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:03:14.246934 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:03:14.248717 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T22:03:18.364839 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:03:18 +0530
I, [2018-09-12T22:03:18.396924 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:03:18.397067 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T22:03:18.400499 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:03:18.402119 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:03:18.404016 #11095] DEBUG -- :   [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:03:18.406487 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:03:18.408099 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:03:18.408974 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:03:18.409540 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:03:18.410969 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:33:18.409000"], ["id", 1]]
D, [2018-09-12T22:03:18.414026 #11095] DEBUG -- :   [1m[35m (2.7ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:03:18.415137 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 08:33:18.414464')[0m
D, [2018-09-12T22:03:18.416541 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:03:18.416937 #11095]  INFO -- : Completed 200 OK in 20ms (Views: 0.1ms | ActiveRecord: 6.4ms)


D, [2018-09-12T22:03:18.418206 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:03:18.418946 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:03:19.254460 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T22:03:19.258306 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:03:19.259554 #11095]  INFO -- : Completed 200 OK in 5015ms (Views: 0.5ms | ActiveRecord: 2.1ms)


D, [2018-09-12T22:03:19.262190 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:03:19.264296 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:03:19.274379 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:03:19 +0530
I, [2018-09-12T22:03:19.303940 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:03:19 +0530
I, [2018-09-12T22:03:19.319503 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:03:19.319613 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
I, [2018-09-12T22:03:19.324869 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:03:19.324963 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:03:19.327419 #11095] DEBUG -- :   [1m[35m (4.8ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:03:19.329140 #11095] DEBUG -- :   [1m[35m (1.9ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:03:19.330449 #11095] DEBUG -- :   [1m[35m (1.4ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:03:19.331920 #11095] DEBUG -- :   [1m[35m (1.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:03:19.332634 #11095] DEBUG -- :   [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:03:19.334591 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:03:19.336460 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:03:19.337787 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:03:19.338556 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:03:19.339391 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:03:19.341186 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:33:19.338000"], ["id", 1]]
D, [2018-09-12T22:03:19.344212 #11095] DEBUG -- :   [1m[35m (2.7ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:03:19.345730 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:03:19.346753 #11095] DEBUG -- :   [1m[36mChat Load (0.3ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T22:03:19.349037 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:31:19.348188')[0m  [["active", "t"]]
D, [2018-09-12T22:03:19.354349 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.6ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:03:19.356953 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:03:19.358816 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.4ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:03:19.359976 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:03:19.361159 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:31:19.360230')[0m  [["active", "t"]]
D, [2018-09-12T22:03:19.362207 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:31:19.361353')[0m  [["active", "t"]]
D, [2018-09-12T22:03:19.363263 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T22:03:19.364275 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:31:19.363482')[0m  [["active", "t"]]
D, [2018-09-12T22:03:19.365006 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:03:19.366072 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:03:19.369119 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:03:19.369613 #11095]  INFO -- : Completed 200 OK in 50ms (Views: 0.2ms | ActiveRecord: 16.6ms)


D, [2018-09-12T22:03:19.371021 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:03:19.371971 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:03:20.339376 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T22:03:20.347869 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:03:20.349151 #11095]  INFO -- : Completed 200 OK in 1024ms (Views: 4.7ms | ActiveRecord: 4.5ms)


D, [2018-09-12T22:03:20.352693 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:03:20.358925 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:03:20.370683 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:03:20 +0530
I, [2018-09-12T22:03:20.387725 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:03:20.387982 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:03:20.391755 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:03:20.393565 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:03:27.401102 #11095] DEBUG -- :   [1m[36mSetting Load (0.6ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:03:27.401684 #11095]  INFO -- : Completed 200 OK in 7013ms (Views: 0.3ms | ActiveRecord: 1.6ms)


D, [2018-09-12T22:03:27.402791 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:03:27.404244 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:03:27.408075 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:03:27 +0530
I, [2018-09-12T22:03:27.420304 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:03:27.420383 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:03:27.422689 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:03:27.424221 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:03:34.446821 #11095] DEBUG -- :   [1m[36mSetting Load (0.8ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:03:34.447676 #11095]  INFO -- : Completed 200 OK in 7027ms (Views: 0.3ms | ActiveRecord: 1.6ms)


D, [2018-09-12T22:03:34.449361 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:03:34.450783 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:03:34.456732 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:03:34 +0530
I, [2018-09-12T22:03:34.475030 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:03:34.475104 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:03:34.477714 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:03:34.480007 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:03:41.489901 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:03:41.491291 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.5ms | ActiveRecord: 2.3ms)


D, [2018-09-12T22:03:41.494133 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:03:41.496544 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:03:41.506293 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:03:41 +0530
I, [2018-09-12T22:03:41.539028 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:03:41.539135 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:03:41.541774 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:03:41.543320 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:03:48.555671 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:03:48.557151 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.5ms | ActiveRecord: 1.9ms)


D, [2018-09-12T22:03:48.559745 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:03:48.562012 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:03:48.571372 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:03:48 +0530
I, [2018-09-12T22:03:48.606409 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:03:48.606556 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:03:48.610953 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:03:48.614011 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:03:55.625688 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:03:55.627081 #11095]  INFO -- : Completed 200 OK in 7020ms (Views: 0.4ms | ActiveRecord: 2.7ms)


D, [2018-09-12T22:03:55.630396 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:03:55.634005 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:03:55.644171 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:03:55 +0530
I, [2018-09-12T22:03:55.666648 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:03:55.666741 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:03:55.669664 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:03:55.671844 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:04:02.689519 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:04:02.691345 #11095]  INFO -- : Completed 200 OK in 7024ms (Views: 0.4ms | ActiveRecord: 2.6ms)


D, [2018-09-12T22:04:02.694832 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:04:02.697347 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:04:02.705450 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:04:02 +0530
I, [2018-09-12T22:04:02.723975 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:04:02.724051 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:04:02.726872 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:04:02.729179 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:04:09.744345 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:04:09.745737 #11095]  INFO -- : Completed 200 OK in 7021ms (Views: 0.4ms | ActiveRecord: 2.5ms)


D, [2018-09-12T22:04:09.748078 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:04:09.750068 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:04:09.759610 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:04:09 +0530
I, [2018-09-12T22:04:09.788067 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:04:09.788155 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:04:09.790655 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:04:09.792310 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T22:04:13.362896 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:04:13 +0530
I, [2018-09-12T22:04:13.375342 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:04:13.375439 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T22:04:13.377882 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:04:13.379392 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:04:13.380704 #11095] DEBUG -- :   [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:04:13.382284 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:04:13.383720 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:04:13.384492 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:04:13.385042 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:04:13.386419 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:34:13.384000"], ["id", 1]]
D, [2018-09-12T22:04:13.387651 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:04:13.388777 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 08:34:13.388101')[0m
D, [2018-09-12T22:04:13.390300 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:04:13.390828 #11095]  INFO -- : Completed 200 OK in 15ms (Views: 0.2ms | ActiveRecord: 4.0ms)


D, [2018-09-12T22:04:13.392164 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:04:13.393036 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:04:14.800476 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T22:04:14.803945 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:04:14.805107 #11095]  INFO -- : Completed 200 OK in 5017ms (Views: 0.5ms | ActiveRecord: 1.9ms)


D, [2018-09-12T22:04:14.808089 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:04:14.809901 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:04:14.820182 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:04:14 +0530
I, [2018-09-12T22:04:14.842496 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:04:14 +0530
I, [2018-09-12T22:04:14.854582 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:04:14.854663 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
I, [2018-09-12T22:04:14.857627 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:04:14.857702 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:04:14.859235 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:04:14.860344 #11095] DEBUG -- :   [1m[35m (1.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:04:14.861814 #11095] DEBUG -- :   [1m[35m (1.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:04:14.862690 #11095] DEBUG -- :   [1m[35m (1.0ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:04:14.863171 #11095] DEBUG -- :   [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:04:14.864662 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:04:14.865900 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:04:14.866575 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:04:14.866918 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:04:14.867286 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:04:14.868483 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:34:14.867000"], ["id", 1]]
D, [2018-09-12T22:04:14.871713 #11095] DEBUG -- :   [1m[35m (2.7ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:04:14.875251 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.8ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:04:14.877337 #11095] DEBUG -- :   [1m[36mChat Load (0.5ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T22:04:14.880734 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.5ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:32:14.879452')[0m  [["active", "t"]]
D, [2018-09-12T22:04:14.884337 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.4ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:04:14.885854 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:04:14.886658 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:04:14.887510 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:04:14.888555 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:32:14.887699')[0m  [["active", "t"]]
D, [2018-09-12T22:04:14.889494 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:32:14.888726')[0m  [["active", "t"]]
D, [2018-09-12T22:04:14.890501 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T22:04:14.891460 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:32:14.890716')[0m  [["active", "t"]]
D, [2018-09-12T22:04:14.892656 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:04:14.893903 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:04:14.896461 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:04:14.896825 #11095]  INFO -- : Completed 200 OK in 42ms (Views: 0.1ms | ActiveRecord: 11.9ms)


D, [2018-09-12T22:04:14.897881 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:04:14.898569 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:04:15.868292 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T22:04:15.875562 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:04:15.876903 #11095]  INFO -- : Completed 200 OK in 1019ms (Views: 3.7ms | ActiveRecord: 3.2ms)


D, [2018-09-12T22:04:15.879723 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:04:15.882144 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:04:15.893816 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:04:15 +0530
I, [2018-09-12T22:04:15.924853 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:04:15.924942 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:04:15.928011 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:04:15.930977 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:04:22.943199 #11095] DEBUG -- :   [1m[36mSetting Load (1.7ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:04:22.944659 #11095]  INFO -- : Completed 200 OK in 7019ms (Views: 0.5ms | ActiveRecord: 3.1ms)


D, [2018-09-12T22:04:22.947427 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:04:22.949731 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:04:22.961548 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:04:22 +0530
I, [2018-09-12T22:04:22.995101 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:04:22.995211 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:04:22.998237 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:04:23.000636 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:04:30.009288 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:04:30.009832 #11095]  INFO -- : Completed 200 OK in 7014ms (Views: 0.2ms | ActiveRecord: 1.9ms)


D, [2018-09-12T22:04:30.010895 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:04:30.011825 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:04:30.016044 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:04:30 +0530
I, [2018-09-12T22:04:30.030470 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:04:30.030555 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:04:30.033438 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:04:30.035145 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:04:37.044811 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:04:37.046092 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.5ms | ActiveRecord: 2.1ms)


D, [2018-09-12T22:04:37.048554 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:04:37.050866 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:04:37.060251 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:04:37 +0530
I, [2018-09-12T22:04:37.086192 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:04:37.086323 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:04:37.089113 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:04:37.090552 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:04:44.098404 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:04:44.099789 #11095]  INFO -- : Completed 200 OK in 7013ms (Views: 0.6ms | ActiveRecord: 1.9ms)


D, [2018-09-12T22:04:44.102542 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:04:44.106101 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:04:44.115716 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:04:44 +0530
I, [2018-09-12T22:04:44.143643 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:04:44.143755 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:04:44.146229 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:04:44.147765 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:04:51.158256 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:04:51.159653 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.7ms | ActiveRecord: 2.0ms)


D, [2018-09-12T22:04:51.162026 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:04:51.164380 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:04:51.183798 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:04:51 +0530
I, [2018-09-12T22:04:51.205790 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:04:51.205883 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:04:51.208669 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:04:51.210276 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:04:58.220365 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:04:58.221754 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T22:04:58.224497 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:04:58.226722 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:04:58.236385 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:04:58 +0530
I, [2018-09-12T22:04:58.264038 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:04:58.264130 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:04:58.266744 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:04:58.268478 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:05:05.281821 #11095] DEBUG -- :   [1m[36mSetting Load (1.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:05:05.283364 #11095]  INFO -- : Completed 200 OK in 7019ms (Views: 0.6ms | ActiveRecord: 2.4ms)


D, [2018-09-12T22:05:05.286082 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:05:05.288436 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:05:05.298177 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:05:05 +0530
I, [2018-09-12T22:05:05.328542 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:05:05.328653 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:05:05.331599 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:05:05.333365 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T22:05:08.363558 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:05:08 +0530
I, [2018-09-12T22:05:08.378042 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:05:08.378136 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T22:05:08.380646 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:05:08.382345 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:05:08.383791 #11095] DEBUG -- :   [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:05:08.385525 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:05:08.387132 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:05:08.388044 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:05:08.388689 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:05:08.390340 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:35:08.388000"], ["id", 1]]
D, [2018-09-12T22:05:08.391598 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:05:08.393020 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 08:35:08.392126')[0m
D, [2018-09-12T22:05:08.394896 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:05:08.395810 #11095]  INFO -- : Completed 200 OK in 18ms (Views: 0.2ms | ActiveRecord: 4.5ms)


D, [2018-09-12T22:05:08.397270 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:05:08.398079 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:05:10.339033 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T22:05:10.342417 #11095] DEBUG -- :   [1m[36mSetting Load (0.9ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:05:10.343606 #11095]  INFO -- : Completed 200 OK in 5015ms (Views: 0.5ms | ActiveRecord: 1.9ms)


D, [2018-09-12T22:05:10.345925 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:05:10.347727 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:05:10.355316 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:05:10 +0530
I, [2018-09-12T22:05:10.365645 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:05:10 +0530
I, [2018-09-12T22:05:10.377574 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:05:10.377645 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
I, [2018-09-12T22:05:10.380689 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:05:10.380749 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:05:10.382282 #11095] DEBUG -- :   [1m[35m (2.9ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:05:10.383261 #11095] DEBUG -- :   [1m[35m (1.1ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:05:10.384180 #11095] DEBUG -- :   [1m[35m (1.0ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:05:10.385083 #11095] DEBUG -- :   [1m[35m (1.0ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:05:10.385618 #11095] DEBUG -- :   [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:05:10.386982 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:05:10.388285 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:05:10.389033 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:05:10.389393 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:05:10.389842 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:05:10.391094 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:35:10.389000"], ["id", 1]]
D, [2018-09-12T22:05:10.398494 #11095] DEBUG -- :   [1m[35m (6.8ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:05:10.402613 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.9ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:05:10.405720 #11095] DEBUG -- :   [1m[36mChat Load (0.7ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T22:05:10.411091 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.7ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:33:10.409089')[0m  [["active", "t"]]
D, [2018-09-12T22:05:10.417870 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.7ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:05:10.419956 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:05:10.421213 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.5ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:05:10.422660 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:05:10.424443 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:33:10.423007')[0m  [["active", "t"]]
D, [2018-09-12T22:05:10.425678 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:33:10.424751')[0m  [["active", "t"]]
D, [2018-09-12T22:05:10.426946 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T22:05:10.428139 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:33:10.427189')[0m  [["active", "t"]]
D, [2018-09-12T22:05:10.429200 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:05:10.430605 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.4ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:05:10.434523 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:05:10.434995 #11095]  INFO -- : Completed 200 OK in 57ms (Views: 0.2ms | ActiveRecord: 20.1ms)


D, [2018-09-12T22:05:10.436298 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:05:10.437547 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:05:11.387826 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T22:05:11.390434 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:05:11.390874 #11095]  INFO -- : Completed 200 OK in 1010ms (Views: 1.3ms | ActiveRecord: 2.6ms)


D, [2018-09-12T22:05:11.391783 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:05:11.392539 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:05:11.396527 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:05:11 +0530
I, [2018-09-12T22:05:11.409628 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:05:11.409723 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:05:11.412022 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:05:11.413542 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:05:18.425976 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:05:18.427401 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.5ms | ActiveRecord: 2.0ms)


D, [2018-09-12T22:05:18.430224 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:05:18.432597 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:05:18.442548 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:05:18 +0530
I, [2018-09-12T22:05:18.479821 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:05:18.479945 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:05:18.483777 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:05:18.486063 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:05:25.497186 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:05:25.498459 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.7ms | ActiveRecord: 2.3ms)


D, [2018-09-12T22:05:25.501042 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:05:25.503156 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:05:25.511763 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:05:25 +0530
I, [2018-09-12T22:05:25.555502 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:05:25.555597 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:05:25.558477 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:05:25.560196 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:05:32.570819 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:05:32.572285 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.5ms | ActiveRecord: 2.1ms)


D, [2018-09-12T22:05:32.575377 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:05:32.577389 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:05:32.587586 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:05:32 +0530
I, [2018-09-12T22:05:32.614905 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:05:32.614993 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:05:32.617758 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:05:32.619360 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:05:39.630165 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:05:39.631616 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.6ms | ActiveRecord: 2.2ms)


D, [2018-09-12T22:05:39.634393 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:05:39.635602 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:05:39.639508 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:05:39 +0530
I, [2018-09-12T22:05:39.654694 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:05:39.654781 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:05:39.657526 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:05:39.659362 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:05:46.673142 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:05:46.674697 #11095]  INFO -- : Completed 200 OK in 7019ms (Views: 0.5ms | ActiveRecord: 2.3ms)


D, [2018-09-12T22:05:46.677453 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:05:46.679807 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:05:46.687701 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:05:46 +0530
I, [2018-09-12T22:05:46.700684 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:05:46.700755 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:05:46.703042 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:05:46.704807 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:05:53.716857 #11095] DEBUG -- :   [1m[36mSetting Load (0.9ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:05:53.718118 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.4ms | ActiveRecord: 2.0ms)


D, [2018-09-12T22:05:53.719173 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:05:53.719986 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:05:53.723397 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:05:53 +0530
I, [2018-09-12T22:05:53.735985 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:05:53.736061 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:05:53.738336 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:05:53.739848 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:06:00.751999 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:06:00.753202 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.4ms | ActiveRecord: 2.0ms)


D, [2018-09-12T22:06:00.755699 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:06:00.757749 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:06:00.766281 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:06:00 +0530
I, [2018-09-12T22:06:00.795952 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:06:00.796058 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:06:00.799186 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:06:00.800968 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T22:06:03.364602 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:06:03 +0530
I, [2018-09-12T22:06:03.380535 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:06:03.380628 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T22:06:03.382988 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:06:03.384608 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:06:03.386008 #11095] DEBUG -- :   [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:06:03.387746 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:06:03.389207 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:06:03.390019 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:06:03.390562 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:06:03.392004 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:36:03.390000"], ["id", 1]]
D, [2018-09-12T22:06:03.393250 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:06:03.394606 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 08:36:03.393764')[0m
D, [2018-09-12T22:06:03.396905 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:06:03.397364 #11095]  INFO -- : Completed 200 OK in 17ms (Views: 0.1ms | ActiveRecord: 4.3ms)


D, [2018-09-12T22:06:03.398706 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:06:03.399512 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:06:03.808170 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T22:06:03.810924 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:06:03.811409 #11095]  INFO -- : Completed 200 OK in 3015ms (Views: 0.5ms | ActiveRecord: 1.6ms)


D, [2018-09-12T22:06:03.812477 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:06:03.813371 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:06:03.818551 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:06:03 +0530
I, [2018-09-12T22:06:03.837093 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:06:03 +0530
I, [2018-09-12T22:06:03.859512 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:06:03.859658 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
I, [2018-09-12T22:06:03.866475 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
D, [2018-09-12T22:06:03.866867 #11095] DEBUG -- :   [1m[35m (3.2ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
I, [2018-09-12T22:06:03.867130 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
D, [2018-09-12T22:06:03.873325 #11095] DEBUG -- :   [1m[35m (3.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:06:03.874577 #11095] DEBUG -- :   [1m[35m (1.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:06:03.877392 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:06:03.879641 #11095] DEBUG -- :   [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:06:03.882676 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:06:03.885255 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:06:03.886660 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.5ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:06:03.887417 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:06:03.888310 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:06:03.890872 #11095] DEBUG -- :   [1m[35mSQL (0.5ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:36:03.887000"], ["id", 1]]
D, [2018-09-12T22:06:03.898892 #11095] DEBUG -- :   [1m[35m (7.3ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:06:03.902298 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.7ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:06:03.904127 #11095] DEBUG -- :   [1m[36mChat Load (0.5ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T22:06:03.907656 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.5ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:34:03.906361')[0m  [["active", "t"]]
D, [2018-09-12T22:06:03.912128 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.5ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:06:03.913693 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:06:03.914722 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.4ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:06:03.915806 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:06:03.917090 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:34:03.916045')[0m  [["active", "t"]]
D, [2018-09-12T22:06:03.918190 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:34:03.917299')[0m  [["active", "t"]]
D, [2018-09-12T22:06:03.919404 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T22:06:03.920390 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:34:03.919607')[0m  [["active", "t"]]
D, [2018-09-12T22:06:03.921125 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:06:03.922185 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.4ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:06:03.925589 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:06:03.925981 #11095]  INFO -- : Completed 200 OK in 56ms (Views: 0.1ms | ActiveRecord: 18.3ms)


D, [2018-09-12T22:06:03.927244 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:06:03.928051 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:06:04.878444 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T22:06:04.882596 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:06:04.883026 #11095]  INFO -- : Completed 200 OK in 1023ms (Views: 2.6ms | ActiveRecord: 7.3ms)


D, [2018-09-12T22:06:04.883955 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:06:04.884755 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:06:04.889431 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:06:04 +0530
I, [2018-09-12T22:06:04.903893 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:06:04.903966 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:06:04.906308 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:06:04.908543 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:06:11.921945 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:06:11.923397 #11095]  INFO -- : Completed 200 OK in 7019ms (Views: 0.6ms | ActiveRecord: 2.2ms)


D, [2018-09-12T22:06:11.926173 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:06:11.927389 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:06:11.931753 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:06:11 +0530
I, [2018-09-12T22:06:11.945368 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:06:11.945441 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:06:11.947680 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:06:11.949271 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:06:18.961127 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:06:18.962341 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.5ms | ActiveRecord: 2.0ms)


D, [2018-09-12T22:06:18.964798 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:06:18.966852 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:06:18.975890 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:06:18 +0530
I, [2018-09-12T22:06:19.002069 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:06:19.002163 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:06:19.004752 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:06:19.006350 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:06:26.016379 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:06:26.017785 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T22:06:26.020582 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:06:26.023309 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:06:26.033663 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:06:26 +0530
I, [2018-09-12T22:06:26.049993 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:06:26.050089 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:06:26.052588 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:06:26.054147 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:06:33.065858 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:06:33.067352 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.5ms | ActiveRecord: 2.1ms)


D, [2018-09-12T22:06:33.070266 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:06:33.072913 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:06:33.086675 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:06:33 +0530
I, [2018-09-12T22:06:33.112129 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:06:33.112238 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:06:33.114725 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:06:33.116498 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:06:40.125230 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:06:40.125731 #11095]  INFO -- : Completed 200 OK in 7013ms (Views: 0.2ms | ActiveRecord: 1.5ms)


D, [2018-09-12T22:06:40.126700 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:06:40.127858 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:06:40.132043 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:06:40 +0530
I, [2018-09-12T22:06:40.149297 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:06:40.149408 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:06:40.152562 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:06:40.154639 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:06:47.166431 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:06:47.167785 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.5ms | ActiveRecord: 2.4ms)


D, [2018-09-12T22:06:47.170737 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:06:47.173309 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:06:47.181163 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:06:47 +0530
I, [2018-09-12T22:06:47.193922 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:06:47.194005 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:06:47.196263 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:06:47.198039 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:06:54.209305 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:06:54.210766 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T22:06:54.213568 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:06:54.216469 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:06:54.225106 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:06:54 +0530
I, [2018-09-12T22:06:54.238073 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:06:54.238163 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:06:54.241120 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:06:54.242839 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T22:06:58.362164 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:06:58 +0530
I, [2018-09-12T22:06:58.376362 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:06:58.376454 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T22:06:58.378778 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:06:58.380342 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:06:58.381665 #11095] DEBUG -- :   [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:06:58.383317 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:06:58.384761 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:06:58.385562 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:06:58.386141 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:06:58.387634 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:36:58.385000"], ["id", 1]]
D, [2018-09-12T22:06:58.388805 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:06:58.389991 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 08:36:58.389282')[0m
D, [2018-09-12T22:06:58.391563 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:06:58.392063 #11095]  INFO -- : Completed 200 OK in 15ms (Views: 0.1ms | ActiveRecord: 4.0ms)


D, [2018-09-12T22:06:58.393859 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:06:58.394739 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:06:59.250791 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T22:06:59.254268 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:06:59.255448 #11095]  INFO -- : Completed 200 OK in 5017ms (Views: 0.5ms | ActiveRecord: 2.0ms)


D, [2018-09-12T22:06:59.257759 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:06:59.259269 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:06:59.263663 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:06:59 +0530
I, [2018-09-12T22:06:59.263724 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:06:59 +0530
I, [2018-09-12T22:06:59.286731 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:06:59.288092 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:06:59.288165 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
I, [2018-09-12T22:06:59.288390 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:06:59.291355 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:06:59.292292 #11095] DEBUG -- :   [1m[35m (1.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:06:59.293039 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:06:59.293835 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:06:59.294266 #11095] DEBUG -- :   [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:06:59.295530 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:06:59.296695 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:06:59.297371 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:06:59.297685 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:06:59.298093 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:06:59.299288 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:36:59.297000"], ["id", 1]]
D, [2018-09-12T22:06:59.301061 #11095] DEBUG -- :   [1m[35m (1.5ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:06:59.302121 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:06:59.302870 #11095] DEBUG -- :   [1m[36mChat Load (0.2ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T22:06:59.304382 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:34:59.303815')[0m  [["active", "t"]]
D, [2018-09-12T22:06:59.306272 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.2ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:06:59.306943 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:06:59.307457 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.2ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:06:59.308089 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:06:59.308853 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:34:59.308237')[0m  [["active", "t"]]
D, [2018-09-12T22:06:59.309531 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:34:59.308972')[0m  [["active", "t"]]
D, [2018-09-12T22:06:59.310312 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T22:06:59.311562 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:34:59.310508')[0m  [["active", "t"]]
D, [2018-09-12T22:06:59.312171 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:06:59.312949 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:06:59.315725 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:06:59.316056 #11095]  INFO -- : Completed 200 OK in 28ms (Views: 0.1ms | ActiveRecord: 8.3ms)


D, [2018-09-12T22:06:59.317080 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:06:59.317743 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:07:00.298519 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T22:07:00.302223 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:07:00.302650 #11095]  INFO -- : Completed 200 OK in 1014ms (Views: 2.2ms | ActiveRecord: 2.3ms)


D, [2018-09-12T22:07:00.303517 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:07:00.304282 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:07:00.308678 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:07:00 +0530
I, [2018-09-12T22:07:00.322969 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:07:00.323042 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:07:00.325475 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:07:00.327130 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:07:07.339840 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:07:07.341358 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.5ms | ActiveRecord: 2.1ms)


D, [2018-09-12T22:07:07.344237 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:07:07.347833 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:07:07.359700 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:07:07 +0530
I, [2018-09-12T22:07:07.394594 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:07:07.394703 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:07:07.398260 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:07:07.400904 #11095] DEBUG -- :   [1m[35m (1.0ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:07:14.411136 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:07:14.411599 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.2ms | ActiveRecord: 1.9ms)


D, [2018-09-12T22:07:14.412519 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:07:14.413257 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:07:14.416596 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:07:14 +0530
I, [2018-09-12T22:07:14.428753 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:07:14.428838 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:07:14.431057 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:07:14.432643 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:07:21.453066 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:07:21.453534 #11095]  INFO -- : Completed 200 OK in 7025ms (Views: 0.5ms | ActiveRecord: 1.2ms)


D, [2018-09-12T22:07:21.454465 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:07:21.455226 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:07:21.458689 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:07:21 +0530
I, [2018-09-12T22:07:21.471380 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:07:21.471452 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:07:21.473796 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:07:21.475337 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:07:28.489143 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:07:28.490495 #11095]  INFO -- : Completed 200 OK in 7019ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T22:07:28.493301 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:07:28.495580 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:07:28.505413 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:07:28 +0530
I, [2018-09-12T22:07:28.533878 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:07:28.533975 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:07:28.536685 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:07:28.538471 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:07:35.550426 #11095] DEBUG -- :   [1m[36mSetting Load (1.6ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:07:35.551850 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.5ms | ActiveRecord: 2.6ms)


D, [2018-09-12T22:07:35.554447 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:07:35.556725 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:07:35.566466 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:07:35 +0530
I, [2018-09-12T22:07:35.598850 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:07:35.598960 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:07:35.601995 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:07:35.603983 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:07:42.614599 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:07:42.615995 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.5ms | ActiveRecord: 2.4ms)


D, [2018-09-12T22:07:42.618766 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:07:42.621122 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:07:42.630758 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:07:42 +0530
I, [2018-09-12T22:07:42.664382 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:07:42.664496 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:07:42.667774 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:07:42.669741 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:07:49.682774 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:07:49.684164 #11095]  INFO -- : Completed 200 OK in 7019ms (Views: 0.5ms | ActiveRecord: 2.3ms)


D, [2018-09-12T22:07:49.686888 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:07:49.689183 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:07:49.699906 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:07:49 +0530
I, [2018-09-12T22:07:49.727394 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:07:49.727484 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:07:49.730208 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:07:49.731801 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T22:07:53.364723 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:07:53 +0530
I, [2018-09-12T22:07:53.398753 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:07:53.398899 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T22:07:53.402113 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:07:53.403984 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:07:53.405585 #11095] DEBUG -- :   [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:07:53.407135 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:07:53.408574 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:07:53.409385 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:07:53.409980 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:07:53.411343 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:37:53.409000"], ["id", 1]]
D, [2018-09-12T22:07:53.412522 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:07:53.413583 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 08:37:53.412966')[0m
D, [2018-09-12T22:07:53.414851 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:07:53.415208 #11095]  INFO -- : Completed 200 OK in 16ms (Views: 0.1ms | ActiveRecord: 4.3ms)


D, [2018-09-12T22:07:53.416379 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:07:53.417284 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:07:54.743981 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T22:07:54.747944 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:07:54.749281 #11095]  INFO -- : Completed 200 OK in 5021ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T22:07:54.751854 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:07:54.753264 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:07:54.758262 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:07:54 +0530
I, [2018-09-12T22:07:54.768877 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:07:54 +0530
I, [2018-09-12T22:07:54.782233 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:07:54.783800 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:07:54.783905 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
I, [2018-09-12T22:07:54.784022 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
D, [2018-09-12T22:07:54.787707 #11095] DEBUG -- :   [1m[35m (1.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:07:54.788846 #11095] DEBUG -- :   [1m[35m (1.2ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:07:54.789866 #11095] DEBUG -- :   [1m[35m (1.1ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:07:54.790552 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:07:54.791805 #11095] DEBUG -- :   [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:07:54.793315 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:07:54.794731 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:07:54.795506 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:07:54.795879 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:07:54.796338 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:07:54.797771 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:37:54.795000"], ["id", 1]]
D, [2018-09-12T22:07:54.800756 #11095] DEBUG -- :   [1m[35m (2.7ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:07:54.802083 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.4ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:07:54.803073 #11095] DEBUG -- :   [1m[36mChat Load (0.3ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T22:07:54.806008 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:35:54.805055')[0m  [["active", "t"]]
D, [2018-09-12T22:07:54.808514 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:07:54.809389 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:07:54.810092 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:07:54.810865 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:07:54.811827 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:35:54.811033')[0m  [["active", "t"]]
D, [2018-09-12T22:07:54.812619 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:35:54.811975')[0m  [["active", "t"]]
D, [2018-09-12T22:07:54.813572 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T22:07:54.814399 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:35:54.813738')[0m  [["active", "t"]]
D, [2018-09-12T22:07:54.815027 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:07:54.815986 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:07:54.818493 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:07:54.818904 #11095]  INFO -- : Completed 200 OK in 33ms (Views: 0.2ms | ActiveRecord: 10.7ms)


D, [2018-09-12T22:07:54.820184 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:07:54.821006 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:07:55.797117 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T22:07:55.803988 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:07:55.805345 #11095]  INFO -- : Completed 200 OK in 1021ms (Views: 3.5ms | ActiveRecord: 3.9ms)


D, [2018-09-12T22:07:55.808043 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:07:55.810242 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:07:55.817851 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:07:55 +0530
I, [2018-09-12T22:07:55.840301 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:07:55.840390 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:07:55.842823 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:07:55.844288 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:08:02.855064 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:08:02.856780 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.6ms | ActiveRecord: 2.0ms)


D, [2018-09-12T22:08:02.859625 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:08:02.861907 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:08:02.872100 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:08:02 +0530
I, [2018-09-12T22:08:02.908281 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:08:02.908396 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:08:02.911839 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:08:02.913976 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:08:09.924871 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:08:09.926208 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.4ms | ActiveRecord: 2.3ms)


D, [2018-09-12T22:08:09.928945 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:08:09.931101 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:08:09.940937 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:08:09 +0530
I, [2018-09-12T22:08:09.973499 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:08:09.973612 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:08:09.976858 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:08:09.978764 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:08:16.991614 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:08:16.993014 #11095]  INFO -- : Completed 200 OK in 7019ms (Views: 0.5ms | ActiveRecord: 2.3ms)


D, [2018-09-12T22:08:16.995785 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:08:16.997255 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:08:17.001062 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:08:17 +0530
I, [2018-09-12T22:08:17.016048 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:08:17.016134 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:08:17.018888 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:08:17.020971 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:08:24.033349 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:08:24.034722 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.5ms | ActiveRecord: 2.6ms)


D, [2018-09-12T22:08:24.037510 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:08:24.040158 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:08:24.057321 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:08:24 +0530
I, [2018-09-12T22:08:24.087282 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:08:24.087420 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:08:24.090916 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:08:24.092676 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:08:31.104740 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:08:31.106129 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T22:08:31.108940 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:08:31.111259 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:08:31.121336 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:08:31 +0530
I, [2018-09-12T22:08:31.148912 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:08:31.149015 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:08:31.151672 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:08:31.153234 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:08:38.164245 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:08:38.165609 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.5ms | ActiveRecord: 2.1ms)


D, [2018-09-12T22:08:38.168233 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:08:38.170361 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:08:38.180194 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:08:38 +0530
I, [2018-09-12T22:08:38.206929 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:08:38.207014 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:08:38.209637 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:08:38.211156 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:08:45.223393 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:08:45.224939 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.4ms | ActiveRecord: 2.2ms)


D, [2018-09-12T22:08:45.227892 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:08:45.229884 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:08:45.239125 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:08:45 +0530
I, [2018-09-12T22:08:45.268512 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:08:45.268617 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:08:45.271633 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:08:45.273323 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T22:08:48.363015 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:08:48 +0530
I, [2018-09-12T22:08:48.382340 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:08:48.382464 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T22:08:48.385801 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:08:48.388126 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:08:48.389834 #11095] DEBUG -- :   [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:08:48.391805 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:08:48.393752 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:08:48.395002 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.5ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:08:48.395554 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:08:48.397050 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:38:48.395000"], ["id", 1]]
D, [2018-09-12T22:08:48.398218 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:08:48.399426 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 08:38:48.398708')[0m
D, [2018-09-12T22:08:48.400861 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:08:48.401268 #11095]  INFO -- : Completed 200 OK in 19ms (Views: 0.1ms | ActiveRecord: 4.9ms)


D, [2018-09-12T22:08:48.402484 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:08:48.403209 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:08:50.281743 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T22:08:50.285725 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:08:50.287048 #11095]  INFO -- : Completed 200 OK in 5018ms (Views: 0.6ms | ActiveRecord: 2.2ms)


D, [2018-09-12T22:08:50.289774 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:08:50.291915 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:08:50.302646 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:08:50 +0530
I, [2018-09-12T22:08:50.317251 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:08:50 +0530
I, [2018-09-12T22:08:50.329894 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:08:50.329990 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
I, [2018-09-12T22:08:50.333452 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:08:50.333728 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:08:50.333803 #11095] DEBUG -- :   [1m[35m (1.7ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:08:50.336680 #11095] DEBUG -- :   [1m[35m (1.2ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:08:50.337737 #11095] DEBUG -- :   [1m[35m (1.1ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:08:50.338887 #11095] DEBUG -- :   [1m[35m (1.3ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:08:50.339487 #11095] DEBUG -- :   [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:08:50.341230 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:08:50.343169 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:08:50.344042 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:08:50.344513 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:08:50.345012 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:08:50.346545 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:38:50.344000"], ["id", 1]]
D, [2018-09-12T22:08:50.349473 #11095] DEBUG -- :   [1m[35m (2.6ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:08:50.350792 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:08:50.351742 #11095] DEBUG -- :   [1m[36mChat Load (0.3ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T22:08:50.353605 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:36:50.352909')[0m  [["active", "t"]]
D, [2018-09-12T22:08:50.356036 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:08:50.357287 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:08:50.358390 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:08:50.359231 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:08:50.360725 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:36:50.359872')[0m  [["active", "t"]]
D, [2018-09-12T22:08:50.361644 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:36:50.360937')[0m  [["active", "t"]]
D, [2018-09-12T22:08:50.362568 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T22:08:50.363386 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:36:50.362728')[0m  [["active", "t"]]
D, [2018-09-12T22:08:50.363996 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:08:50.364881 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:08:50.367414 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:08:50.367834 #11095]  INFO -- : Completed 200 OK in 38ms (Views: 0.1ms | ActiveRecord: 11.9ms)


D, [2018-09-12T22:08:50.369017 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:08:50.369746 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:08:51.344028 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T22:08:51.350377 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:08:51.351556 #11095]  INFO -- : Completed 200 OK in 1017ms (Views: 3.3ms | ActiveRecord: 3.5ms)


D, [2018-09-12T22:08:51.353975 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:08:51.356273 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:08:51.366226 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:08:51 +0530
I, [2018-09-12T22:08:51.389208 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:08:51.389302 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:08:51.391832 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:08:51.393314 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:08:58.403682 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:08:58.404408 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.6ms | ActiveRecord: 1.5ms)


D, [2018-09-12T22:08:58.405500 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:08:58.406231 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:08:58.412045 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:08:58 +0530
I, [2018-09-12T22:08:58.426603 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:08:58.426687 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:08:58.428999 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:08:58.430557 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:09:05.443537 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:09:05.444978 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.7ms | ActiveRecord: 2.1ms)


D, [2018-09-12T22:09:05.447816 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:09:05.450294 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:09:05.459778 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:09:05 +0530
I, [2018-09-12T22:09:05.483277 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:09:05.483381 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:09:05.485801 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:09:05.487340 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:09:12.499063 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:09:12.500696 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.6ms | ActiveRecord: 2.0ms)


D, [2018-09-12T22:09:12.503533 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:09:12.505843 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:09:12.515814 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:09:12 +0530
I, [2018-09-12T22:09:12.548359 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:09:12.548442 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:09:12.550628 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:09:12.552103 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:09:19.564025 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:09:19.565348 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.4ms | ActiveRecord: 2.1ms)


D, [2018-09-12T22:09:19.567986 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:09:19.570195 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:09:19.579113 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:09:19 +0530
I, [2018-09-12T22:09:19.605833 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:09:19.605935 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:09:19.608675 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:09:19.610289 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:09:26.620465 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:09:26.621634 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.5ms | ActiveRecord: 2.0ms)


D, [2018-09-12T22:09:26.624019 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:09:26.625997 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:09:26.634856 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:09:26 +0530
I, [2018-09-12T22:09:26.665651 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:09:26.665867 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:09:26.669118 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:09:26.671222 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:09:26.672488 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:09:26.673908 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[32mINSERT INTO "delayed_jobs" ("handler", "run_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["handler", "--- !ruby/object:Observer::UserDeviceLogJob\nhttp_user_agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko)\n  Chrome/68.0.3440.106 Safari/537.36\nremote_ip: \"::1\"\nuser_id: 3\nfingerprint: \"-1992429858\"\ntype: session\n"], ["run_at", "2018-09-12 16:39:26.672640"], ["created_at", "2018-09-12 16:39:26.672000"], ["updated_at", "2018-09-12 16:39:26.672000"]]
D, [2018-09-12T22:09:26.677556 #11095] DEBUG -- :   [1m[35m (3.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:09:33.690078 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:09:33.691411 #11095]  INFO -- : Completed 200 OK in 7025ms (Views: 0.6ms | ActiveRecord: 6.0ms)


D, [2018-09-12T22:09:33.695281 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:09:33.700726 #11095] DEBUG -- :   [1m[35mSQL (0.8ms)[0m  [1m[33mUPDATE "sessions" SET "data" = $1, "updated_at" = $2 WHERE "sessions"."id" = $3[0m  [["data", "BAh7D0kiCXBpbmcGOgZFRkkiGTIwMTgtMDktMTJUMTY6MDk6MjZaBjsAVEki\nD3VzZXJfYWdlbnQGOwBGIm5Nb3ppbGxhLzUuMCAoWDExOyBMaW51eCB4ODZf\nNjQpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENo\ncm9tZS82OC4wLjM0NDAuMTA2IFNhZmFyaS81MzcuMzZJIhBfY3NyZl90b2tl\nbgY7AEZJIjE1SzlmTEZWTnRwVFYydjArWGQ1M21QMjFWbDAzT1RSeEp2cUpm\nbitDRDUwPQY7AEZJIgx1c2VyX2lkBjsARmkISSIadXNlcl9kZXZpY2VfcmVt\nb3RlX2lwBjsARiIIOjoxSSIcdXNlcl9kZXZpY2VfZmluZ2VycHJpbnQGOwBG\nSSIQLTE5OTI0Mjk4NTgGOwBUSSIbdXNlcl9kZXZpY2VfdXBkYXRlZF9hdAY7\nAEZVOiBBY3RpdmVTdXBwb3J0OjpUaW1lV2l0aFpvbmVbCEl1OglUaW1lDZCh\nHcB+P6qdCToJem9uZUkiCFVUQwY7AEY6DW5hbm9fbnVtaQGLOg1uYW5vX2Rl\nbmkGOg1zdWJtaWNybyIHE5BJIghVVEMGOwBUQBZJIg9wZXJzaXN0ZW50BjsA\nRlRJIg5yZW1vdGVfaXAGOwBGIgg6OjFJIghnZW8GOwBGewA=\n"], ["updated_at", "2018-09-12 16:39:33.696212"], ["id", 33]]
D, [2018-09-12T22:09:33.704602 #11095] DEBUG -- :   [1m[35m (3.0ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:09:33.714023 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:09:33 +0530
I, [2018-09-12T22:09:33.741851 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:09:33.741935 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:09:33.744613 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:09:33.746270 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:09:40.759078 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:09:40.760560 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.6ms | ActiveRecord: 2.2ms)


D, [2018-09-12T22:09:40.763287 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:09:40.765546 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:09:40.774968 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:09:40 +0530
I, [2018-09-12T22:09:40.804437 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:09:40.804543 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:09:40.807272 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:09:40.809065 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T22:09:43.362504 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:09:43 +0530
I, [2018-09-12T22:09:43.377737 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:09:43.377859 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T22:09:43.380575 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:09:43.382365 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:09:43.383899 #11095] DEBUG -- :   [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:09:43.385738 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:09:43.387440 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:09:43.388378 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:09:43.389172 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:09:43.390977 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:39:43.388000"], ["id", 1]]
D, [2018-09-12T22:09:43.398352 #11095] DEBUG -- :   [1m[35m (6.9ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:09:43.400080 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 08:39:43.399051')[0m
D, [2018-09-12T22:09:43.401887 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:09:43.402423 #11095]  INFO -- : Completed 200 OK in 24ms (Views: 0.2ms | ActiveRecord: 10.6ms)


D, [2018-09-12T22:09:43.403959 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:09:43.404908 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:09:43.814655 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T22:09:43.818656 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:09:43.819965 #11095]  INFO -- : Completed 200 OK in 3015ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T22:09:43.822636 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:09:43.825193 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:09:43.835383 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:09:43 +0530
I, [2018-09-12T22:09:43.835770 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:09:43 +0530
I, [2018-09-12T22:09:43.860633 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:09:43.860717 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
I, [2018-09-12T22:09:43.864169 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:09:43.864252 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:09:43.866064 #11095] DEBUG -- :   [1m[35m (3.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:09:43.867290 #11095] DEBUG -- :   [1m[35m (1.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:09:43.868416 #11095] DEBUG -- :   [1m[35m (1.2ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:09:43.869588 #11095] DEBUG -- :   [1m[35m (1.3ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:09:43.870222 #11095] DEBUG -- :   [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:09:43.871878 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:09:43.873413 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:09:43.874412 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:09:43.875222 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:09:43.875770 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:09:43.877400 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:39:43.875000"], ["id", 1]]
D, [2018-09-12T22:09:43.880361 #11095] DEBUG -- :   [1m[35m (2.7ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:09:43.881756 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.4ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:09:43.882725 #11095] DEBUG -- :   [1m[36mChat Load (0.3ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T22:09:43.884676 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:37:43.883939')[0m  [["active", "t"]]
D, [2018-09-12T22:09:43.887145 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:09:43.887983 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:09:43.888680 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:09:43.889459 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:09:43.890414 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:37:43.889651')[0m  [["active", "t"]]
D, [2018-09-12T22:09:43.891211 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:37:43.890562')[0m  [["active", "t"]]
D, [2018-09-12T22:09:43.892133 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T22:09:43.892968 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:37:43.892297')[0m  [["active", "t"]]
D, [2018-09-12T22:09:43.893578 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:09:43.894485 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:09:43.897290 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:09:43.897707 #11095]  INFO -- : Completed 200 OK in 37ms (Views: 0.1ms | ActiveRecord: 13.4ms)


D, [2018-09-12T22:09:43.898987 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:09:43.899833 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:09:44.874940 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T22:09:44.878109 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:09:44.878577 #11095]  INFO -- : Completed 200 OK in 1014ms (Views: 1.6ms | ActiveRecord: 3.2ms)


D, [2018-09-12T22:09:44.879517 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:09:44.880374 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:09:44.885687 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:09:44 +0530
I, [2018-09-12T22:09:44.900816 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:09:44.900923 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:09:44.903707 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:09:44.905696 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:09:51.917574 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:09:51.918886 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.5ms | ActiveRecord: 2.4ms)


D, [2018-09-12T22:09:51.921570 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:09:51.923941 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:09:51.933923 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:09:51 +0530
I, [2018-09-12T22:09:51.963335 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:09:51.963448 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:09:51.966184 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:09:51.967859 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:09:58.977969 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:09:58.979356 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.5ms | ActiveRecord: 2.1ms)


D, [2018-09-12T22:09:58.982064 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:09:58.984274 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:09:58.993738 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:09:58 +0530
I, [2018-09-12T22:09:59.024017 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:09:59.024114 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:09:59.028152 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:09:59.029890 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:10:06.041137 #11095] DEBUG -- :   [1m[36mSetting Load (1.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:10:06.042492 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.6ms | ActiveRecord: 2.8ms)


D, [2018-09-12T22:10:06.045448 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:10:06.047718 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:10:06.059873 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:10:06 +0530
I, [2018-09-12T22:10:06.090461 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:10:06.090552 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:10:06.093400 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:10:06.095172 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:10:13.105735 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:10:13.107090 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.5ms | ActiveRecord: 2.3ms)


D, [2018-09-12T22:10:13.109869 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:10:13.112154 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:10:13.122331 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:10:13 +0530
I, [2018-09-12T22:10:13.150573 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:10:13.150669 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:10:13.153339 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:10:13.154973 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:10:20.165054 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:10:20.166402 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T22:10:20.169216 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:10:20.171518 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:10:20.181529 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:10:20 +0530
I, [2018-09-12T22:10:20.211807 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:10:20.211916 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:10:20.214754 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:10:20.216619 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:10:27.229699 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:10:27.231000 #11095]  INFO -- : Completed 200 OK in 7019ms (Views: 0.4ms | ActiveRecord: 2.1ms)


D, [2018-09-12T22:10:27.233630 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:10:27.235030 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:10:27.238910 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:10:27 +0530
I, [2018-09-12T22:10:27.251940 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:10:27.252018 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:10:27.254388 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:10:27.255943 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:10:34.270333 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:10:34.271740 #11095]  INFO -- : Completed 200 OK in 7019ms (Views: 0.5ms | ActiveRecord: 2.1ms)


D, [2018-09-12T22:10:34.274488 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:10:34.276814 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:10:34.288330 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:10:34 +0530
I, [2018-09-12T22:10:34.317464 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:10:34.317555 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:10:34.320063 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:10:34.321593 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T22:10:38.363026 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:10:38 +0530
I, [2018-09-12T22:10:38.379096 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:10:38.379224 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T22:10:38.381707 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:10:38.383315 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:10:38.384767 #11095] DEBUG -- :   [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:10:38.386570 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:10:38.390200 #11095] DEBUG -- :   [1m[35m (1.4ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:10:38.392090 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.8ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:10:38.392872 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:10:38.394833 #11095] DEBUG -- :   [1m[35mSQL (0.4ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:40:38.392000"], ["id", 1]]
D, [2018-09-12T22:10:38.396047 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:10:38.397376 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 08:40:38.396578')[0m
D, [2018-09-12T22:10:38.398968 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:10:38.399411 #11095]  INFO -- : Completed 200 OK in 20ms (Views: 0.1ms | ActiveRecord: 5.7ms)


D, [2018-09-12T22:10:38.400781 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:10:38.402033 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:10:39.328303 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T22:10:39.332353 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:10:39.333693 #11095]  INFO -- : Completed 200 OK in 5016ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T22:10:39.336459 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:10:39.338717 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:10:39.352133 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:10:39 +0530
I, [2018-09-12T22:10:39.386172 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:10:39 +0530
I, [2018-09-12T22:10:39.402823 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:10:39.402903 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
I, [2018-09-12T22:10:39.408573 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:10:39.408723 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
D, [2018-09-12T22:10:39.410844 #11095] DEBUG -- :   [1m[35m (5.8ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:10:39.412013 #11095] DEBUG -- :   [1m[35m (1.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:10:39.413014 #11095] DEBUG -- :   [1m[35m (1.1ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:10:39.413881 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:10:39.415188 #11095] DEBUG -- :   [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:10:39.416846 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:10:39.418253 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:10:39.419045 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:10:39.419437 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:10:39.419917 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:10:39.421289 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:40:39.419000"], ["id", 1]]
D, [2018-09-12T22:10:39.422453 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:10:39.423715 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:10:39.424618 #11095] DEBUG -- :   [1m[36mChat Load (0.3ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T22:10:39.426397 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:38:39.425736')[0m  [["active", "t"]]
D, [2018-09-12T22:10:39.428619 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:10:39.429368 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:10:39.429959 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:10:39.430633 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:10:39.431464 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:38:39.430799')[0m  [["active", "t"]]
D, [2018-09-12T22:10:39.432247 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:38:39.431621')[0m  [["active", "t"]]
D, [2018-09-12T22:10:39.433534 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T22:10:39.434361 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:38:39.433737')[0m  [["active", "t"]]
D, [2018-09-12T22:10:39.434936 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:10:39.435765 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:10:39.437946 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:10:39.438337 #11095]  INFO -- : Completed 200 OK in 29ms (Views: 0.1ms | ActiveRecord: 8.6ms)


D, [2018-09-12T22:10:39.439447 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:10:39.440684 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:10:40.416485 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T22:10:40.418953 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:10:40.419422 #11095]  INFO -- : Completed 200 OK in 1016ms (Views: 1.2ms | ActiveRecord: 7.4ms)


D, [2018-09-12T22:10:40.420359 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:10:40.421164 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:10:40.425133 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:10:40 +0530
I, [2018-09-12T22:10:40.438006 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:10:40.438077 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:10:40.440416 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:10:40.441970 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:10:47.452724 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:10:47.454066 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.5ms | ActiveRecord: 2.1ms)


D, [2018-09-12T22:10:47.456830 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:10:47.459066 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:10:47.470271 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:10:47 +0530
I, [2018-09-12T22:10:47.505015 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:10:47.505138 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:10:47.508526 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:10:47.510566 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:10:54.524144 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:10:54.525706 #11095]  INFO -- : Completed 200 OK in 7020ms (Views: 0.7ms | ActiveRecord: 2.3ms)


D, [2018-09-12T22:10:54.528842 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:10:54.531324 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:10:54.540997 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:10:54 +0530
I, [2018-09-12T22:10:54.570889 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:10:54.570987 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:10:54.573795 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:10:54.575554 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:11:01.586180 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:11:01.587665 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.5ms | ActiveRecord: 2.1ms)


D, [2018-09-12T22:11:01.590466 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:11:01.592812 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:11:01.602554 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:11:01 +0530
I, [2018-09-12T22:11:01.646355 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:11:01.646436 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:11:01.648748 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:11:01.650276 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:11:08.662130 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:11:08.663314 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.5ms | ActiveRecord: 2.0ms)


D, [2018-09-12T22:11:08.665630 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:11:08.668020 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:11:08.678074 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:11:08 +0530
I, [2018-09-12T22:11:08.709519 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:11:08.709649 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:11:08.712719 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:11:08.714779 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:11:15.728965 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:11:15.730275 #11095]  INFO -- : Completed 200 OK in 7020ms (Views: 0.5ms | ActiveRecord: 2.5ms)


D, [2018-09-12T22:11:15.733041 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:11:15.735734 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:11:15.745352 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:11:15 +0530
I, [2018-09-12T22:11:15.776407 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:11:15.776516 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:11:15.779334 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:11:15.781068 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:11:22.792411 #11095] DEBUG -- :   [1m[36mSetting Load (1.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:11:22.793853 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.5ms | ActiveRecord: 2.3ms)


D, [2018-09-12T22:11:22.796796 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:11:22.799244 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:11:22.810936 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:11:22 +0530
I, [2018-09-12T22:11:22.840255 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:11:22.840348 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:11:22.842999 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:11:22.844518 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:11:29.856688 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:11:29.858148 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T22:11:29.861152 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:11:29.863389 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:11:29.875424 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:11:29 +0530
I, [2018-09-12T22:11:29.900861 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:11:29.900952 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:11:29.904887 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:11:29.906779 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T22:11:33.370518 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:11:33 +0530
I, [2018-09-12T22:11:33.394107 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:11:33.394189 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T22:11:33.396412 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:11:33.397950 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:11:33.399233 #11095] DEBUG -- :   [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:11:33.401149 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:11:33.404384 #11095] DEBUG -- :   [1m[35m (2.0ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:11:33.406141 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.8ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:11:33.406926 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:11:33.408759 #11095] DEBUG -- :   [1m[35mSQL (0.4ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:41:33.406000"], ["id", 1]]
D, [2018-09-12T22:11:33.409948 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:11:33.411242 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 08:41:33.410435')[0m
D, [2018-09-12T22:11:33.412716 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:11:33.413147 #11095]  INFO -- : Completed 200 OK in 19ms (Views: 0.1ms | ActiveRecord: 6.2ms)


D, [2018-09-12T22:11:33.414440 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:11:33.415515 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:11:34.913604 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T22:11:34.917590 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:11:34.919341 #11095]  INFO -- : Completed 200 OK in 5018ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T22:11:34.922835 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:11:34.925141 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:11:34.936739 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:11:34 +0530
I, [2018-09-12T22:11:34.955937 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:11:34 +0530
I, [2018-09-12T22:11:34.969053 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:11:34.970634 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:11:34.970766 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
I, [2018-09-12T22:11:34.970856 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:11:34.975333 #11095] DEBUG -- :   [1m[35m (1.7ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:11:34.976535 #11095] DEBUG -- :   [1m[35m (1.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:11:34.977566 #11095] DEBUG -- :   [1m[35m (1.2ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:11:34.978659 #11095] DEBUG -- :   [1m[35m (1.2ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:11:34.979269 #11095] DEBUG -- :   [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:11:34.981064 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:11:34.982528 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:11:34.983295 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:11:34.983768 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:11:34.984290 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:11:34.985724 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:41:34.983000"], ["id", 1]]
D, [2018-09-12T22:11:35.000382 #11095] DEBUG -- :   [1m[35m (14.0ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:11:35.005067 #11095] DEBUG -- :   [1m[36mChat::Session Load (1.0ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:11:35.008036 #11095] DEBUG -- :   [1m[36mChat Load (0.8ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T22:11:35.014461 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.9ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:39:35.012005')[0m  [["active", "t"]]
D, [2018-09-12T22:11:35.022338 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.8ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:11:35.024095 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:11:35.025414 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.5ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:11:35.026931 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:11:35.028592 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:39:35.027283')[0m  [["active", "t"]]
D, [2018-09-12T22:11:35.029812 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:39:35.028829')[0m  [["active", "t"]]
D, [2018-09-12T22:11:35.031182 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T22:11:35.032649 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:39:35.031437')[0m  [["active", "t"]]
D, [2018-09-12T22:11:35.033426 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:11:35.034518 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:11:35.037551 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:11:35.038030 #11095]  INFO -- : Completed 200 OK in 67ms (Views: 0.2ms | ActiveRecord: 26.7ms)


D, [2018-09-12T22:11:35.039833 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:11:35.041188 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:11:35.984125 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T22:11:35.991319 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:11:35.992713 #11095]  INFO -- : Completed 200 OK in 1021ms (Views: 3.8ms | ActiveRecord: 3.7ms)


D, [2018-09-12T22:11:35.995337 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:11:35.998761 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:11:36.009627 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:11:36 +0530
I, [2018-09-12T22:11:36.036028 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:11:36.036118 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:11:36.038686 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:11:36.040213 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:11:43.051921 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:11:43.053301 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.5ms | ActiveRecord: 2.1ms)


D, [2018-09-12T22:11:43.056103 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:11:43.058562 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:11:43.068554 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:11:43 +0530
I, [2018-09-12T22:11:43.096061 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:11:43.096146 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:11:43.098710 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:11:43.100235 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:11:50.111094 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:11:50.112581 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.5ms | ActiveRecord: 2.1ms)


D, [2018-09-12T22:11:50.115363 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:11:50.117683 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:11:50.123659 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:11:50 +0530
I, [2018-09-12T22:11:50.136577 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:11:50.136680 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:11:50.139163 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:11:50.140839 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:11:57.151951 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:11:57.153423 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.5ms | ActiveRecord: 2.1ms)


D, [2018-09-12T22:11:57.156475 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:11:57.158743 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:11:57.168420 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:11:57 +0530
I, [2018-09-12T22:11:57.198557 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:11:57.198646 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:11:57.201348 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:11:57.203083 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:12:04.214731 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:12:04.216175 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T22:12:04.218958 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:12:04.221377 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:12:04.233286 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:12:04 +0530
I, [2018-09-12T22:12:04.265454 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:12:04.265564 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:12:04.268294 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:12:04.270082 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:12:11.282287 #11095] DEBUG -- :   [1m[36mSetting Load (1.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:12:11.283783 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.7ms | ActiveRecord: 2.4ms)


D, [2018-09-12T22:12:11.286766 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:12:11.289089 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:12:11.299844 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:12:11 +0530
I, [2018-09-12T22:12:11.329072 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:12:11.329164 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:12:11.331764 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:12:11.333262 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:12:18.343096 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:12:18.344560 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.5ms | ActiveRecord: 2.1ms)


D, [2018-09-12T22:12:18.347384 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:12:18.349996 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:12:18.355273 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:12:18 +0530
I, [2018-09-12T22:12:18.380022 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:12:18.380161 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:12:18.385178 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:12:18.387003 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:12:25.397884 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:12:25.399259 #11095]  INFO -- : Completed 200 OK in 7019ms (Views: 0.5ms | ActiveRecord: 2.4ms)


D, [2018-09-12T22:12:25.402078 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:12:25.404349 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:12:25.415288 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:12:25 +0530
I, [2018-09-12T22:12:25.442492 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:12:25.442581 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:12:25.445092 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:12:25.446522 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T22:12:28.365865 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:12:28 +0530
I, [2018-09-12T22:12:28.398504 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:12:28.398633 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T22:12:28.401491 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:12:28.403158 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:12:28.404890 #11095] DEBUG -- :   [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:12:28.407286 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:12:28.408922 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:12:28.409783 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:12:28.410362 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:12:28.411773 #11095] DEBUG -- :   [1m[35mSQL (0.2ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:42:28.410000"], ["id", 1]]
D, [2018-09-12T22:12:28.413114 #11095] DEBUG -- :   [1m[35m (1.0ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:12:28.414294 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 08:42:28.413607')[0m
D, [2018-09-12T22:12:28.415720 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:12:28.416144 #11095]  INFO -- : Completed 200 OK in 17ms (Views: 0.1ms | ActiveRecord: 4.5ms)


D, [2018-09-12T22:12:28.417429 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:12:28.418303 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:12:28.451735 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T22:12:28.455336 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:12:28.456687 #11095]  INFO -- : Completed 200 OK in 3014ms (Views: 0.5ms | ActiveRecord: 1.8ms)


D, [2018-09-12T22:12:28.459883 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:12:28.462232 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:12:28.473246 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:12:28 +0530
I, [2018-09-12T22:12:28.502095 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:12:28 +0530
I, [2018-09-12T22:12:28.519329 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:12:28.519897 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
I, [2018-09-12T22:12:28.525368 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:12:28.525549 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
D, [2018-09-12T22:12:28.528206 #11095] DEBUG -- :   [1m[35m (5.1ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:12:28.529876 #11095] DEBUG -- :   [1m[35m (1.8ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:12:28.531299 #11095] DEBUG -- :   [1m[35m (1.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:12:28.532328 #11095] DEBUG -- :   [1m[35m (1.2ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:12:28.534034 #11095] DEBUG -- :   [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:12:28.536387 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:12:28.538466 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:12:28.539498 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:12:28.540079 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:12:28.540725 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:12:28.542683 #11095] DEBUG -- :   [1m[35mSQL (0.4ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:42:28.540000"], ["id", 1]]
D, [2018-09-12T22:12:28.544497 #11095] DEBUG -- :   [1m[35m (1.4ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:12:28.546294 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.4ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:12:28.547531 #11095] DEBUG -- :   [1m[36mChat Load (0.3ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T22:12:28.550089 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:40:28.549107')[0m  [["active", "t"]]
D, [2018-09-12T22:12:28.554008 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.4ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:12:28.555046 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:12:28.555764 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:12:28.556634 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:12:28.557638 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:40:28.556836')[0m  [["active", "t"]]
D, [2018-09-12T22:12:28.558404 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:40:28.557806')[0m  [["active", "t"]]
D, [2018-09-12T22:12:28.559319 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T22:12:28.560144 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:40:28.559504')[0m  [["active", "t"]]
D, [2018-09-12T22:12:28.560785 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:12:28.561685 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:12:28.563966 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:12:28.564330 #11095]  INFO -- : Completed 200 OK in 39ms (Views: 0.1ms | ActiveRecord: 11.0ms)


D, [2018-09-12T22:12:28.565415 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:12:28.566182 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:12:29.536956 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T22:12:29.540524 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:12:29.540987 #11095]  INFO -- : Completed 200 OK in 1021ms (Views: 2.0ms | ActiveRecord: 7.2ms)


D, [2018-09-12T22:12:29.542059 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:12:29.543295 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:12:29.549338 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:12:29 +0530
I, [2018-09-12T22:12:29.566577 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:12:29.566684 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:12:29.570375 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:12:29.572712 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:12:36.583780 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:12:36.585207 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.5ms | ActiveRecord: 2.6ms)


D, [2018-09-12T22:12:36.588068 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:12:36.590349 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:12:36.600295 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:12:36 +0530
I, [2018-09-12T22:12:36.633857 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:12:36.633967 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:12:36.637373 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:12:36.639291 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:12:43.650405 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:12:43.651846 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.5ms | ActiveRecord: 2.3ms)


D, [2018-09-12T22:12:43.654562 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:12:43.655872 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:12:43.659579 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:12:43 +0530
I, [2018-09-12T22:12:43.674262 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:12:43.674344 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:12:43.676977 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:12:43.678735 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:12:50.690726 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:12:50.692026 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.5ms | ActiveRecord: 2.0ms)


D, [2018-09-12T22:12:50.694465 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:12:50.696770 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:12:50.705634 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:12:50 +0530
I, [2018-09-12T22:12:50.733750 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:12:50.733839 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:12:50.736582 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:12:50.738401 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:12:57.749703 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:12:57.751121 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.5ms | ActiveRecord: 2.1ms)


D, [2018-09-12T22:12:57.753943 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:12:57.776862 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:12:57.783373 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:12:57 +0530
I, [2018-09-12T22:12:57.799005 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:12:57.799103 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:12:57.801407 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:12:57.802896 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:13:04.813896 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:13:04.815235 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.5ms | ActiveRecord: 2.0ms)


D, [2018-09-12T22:13:04.817999 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:13:04.820338 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:13:04.834107 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:13:04 +0530
I, [2018-09-12T22:13:04.866114 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:13:04.866199 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:13:04.868756 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:13:04.870543 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:13:11.881867 #11095] DEBUG -- :   [1m[36mSetting Load (1.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:13:11.883307 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.7ms | ActiveRecord: 2.4ms)


D, [2018-09-12T22:13:11.886220 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:13:11.888466 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:13:11.900296 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:13:11 +0530
I, [2018-09-12T22:13:11.924978 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:13:11.925070 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:13:11.927559 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:13:11.929063 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:13:18.941312 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:13:18.942630 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.5ms | ActiveRecord: 2.1ms)


D, [2018-09-12T22:13:18.945235 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:13:18.947314 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:13:18.956899 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:13:18 +0530
I, [2018-09-12T22:13:18.983172 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:13:18.983262 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:13:18.985712 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:13:18.987185 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T22:13:23.364201 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:13:23 +0530
I, [2018-09-12T22:13:23.397666 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:13:23.397822 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T22:13:23.401988 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:13:23.403857 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:13:23.405443 #11095] DEBUG -- :   [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:13:23.407370 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:13:23.409063 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:13:23.410008 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:13:23.410667 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:13:23.412429 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:43:23.410000"], ["id", 1]]
D, [2018-09-12T22:13:23.413948 #11095] DEBUG -- :   [1m[35m (1.0ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:13:23.416592 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.6ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 08:43:23.415053')[0m
D, [2018-09-12T22:13:23.418415 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:13:23.418968 #11095]  INFO -- : Completed 200 OK in 21ms (Views: 0.1ms | ActiveRecord: 4.9ms)


D, [2018-09-12T22:13:23.420557 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:13:23.422389 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:13:23.995228 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T22:13:23.999449 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:13:24.000803 #11095]  INFO -- : Completed 200 OK in 5017ms (Views: 0.6ms | ActiveRecord: 2.1ms)


D, [2018-09-12T22:13:24.003389 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:13:24.005694 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:13:24.016317 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:13:24 +0530
I, [2018-09-12T22:13:24.041671 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:13:24 +0530
I, [2018-09-12T22:13:24.057245 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:13:24.057383 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
I, [2018-09-12T22:13:24.059245 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:13:24.061669 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:13:24.063741 #11095] DEBUG -- :   [1m[35m (2.1ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:13:24.065190 #11095] DEBUG -- :   [1m[35m (1.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:13:24.066419 #11095] DEBUG -- :   [1m[35m (1.3ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:13:24.067691 #11095] DEBUG -- :   [1m[35m (1.4ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:13:24.068417 #11095] DEBUG -- :   [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:13:24.070289 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:13:24.071975 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:13:24.072885 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:13:24.073353 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:13:24.073927 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:13:24.075601 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:43:24.073000"], ["id", 1]]
D, [2018-09-12T22:13:24.083052 #11095] DEBUG -- :   [1m[35m (6.9ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:13:24.086560 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.8ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:13:24.089229 #11095] DEBUG -- :   [1m[36mChat Load (0.8ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T22:13:24.094966 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.8ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:41:24.092847')[0m  [["active", "t"]]
D, [2018-09-12T22:13:24.100378 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.5ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:13:24.101845 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:13:24.102852 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.4ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:13:24.103924 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:13:24.105220 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:41:24.104191')[0m  [["active", "t"]]
D, [2018-09-12T22:13:24.106356 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:41:24.105427')[0m  [["active", "t"]]
D, [2018-09-12T22:13:24.107588 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T22:13:24.108523 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:41:24.107778')[0m  [["active", "t"]]
D, [2018-09-12T22:13:24.109261 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:13:24.110300 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.4ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:13:24.112952 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:13:24.113338 #11095]  INFO -- : Completed 200 OK in 54ms (Views: 0.1ms | ActiveRecord: 19.2ms)


D, [2018-09-12T22:13:24.114563 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:13:24.115391 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:13:25.072360 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T22:13:25.076654 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:13:25.077095 #11095]  INFO -- : Completed 200 OK in 1015ms (Views: 2.7ms | ActiveRecord: 3.5ms)


D, [2018-09-12T22:13:25.078091 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:13:25.079016 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:13:25.083944 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:13:25 +0530
I, [2018-09-12T22:13:25.102892 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:13:25.103002 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:13:25.106365 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:13:25.108478 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:13:32.120137 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:13:32.121551 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.5ms | ActiveRecord: 2.5ms)


D, [2018-09-12T22:13:32.122796 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:13:32.123517 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:13:32.128067 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:13:32 +0530
I, [2018-09-12T22:13:32.142491 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:13:32.142574 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:13:32.145086 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:13:32.146758 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:13:39.157529 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:13:39.158932 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T22:13:39.161835 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:13:39.164223 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:13:39.173737 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:13:39 +0530
I, [2018-09-12T22:13:39.203272 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:13:39.203383 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:13:39.206046 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:13:39.207822 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:13:46.219971 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:13:46.221327 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.5ms | ActiveRecord: 2.3ms)


D, [2018-09-12T22:13:46.224088 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:13:46.227530 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:13:46.237436 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:13:46 +0530
I, [2018-09-12T22:13:46.268659 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:13:46.268783 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:13:46.272089 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:13:46.274070 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:13:53.288073 #11095] DEBUG -- :   [1m[36mSetting Load (1.6ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:13:53.290016 #11095]  INFO -- : Completed 200 OK in 7021ms (Views: 0.5ms | ActiveRecord: 3.0ms)


D, [2018-09-12T22:13:53.293384 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:13:53.295769 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:13:53.307159 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:13:53 +0530
I, [2018-09-12T22:13:53.333784 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:13:53.333872 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:13:53.337727 #11095] DEBUG -- :   [1m[35m (1.1ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:13:53.339968 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:14:00.353111 #11095] DEBUG -- :   [1m[36mSetting Load (1.7ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:14:00.355615 #11095]  INFO -- : Completed 200 OK in 7021ms (Views: 0.5ms | ActiveRecord: 3.4ms)


D, [2018-09-12T22:14:00.360092 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:14:00.362688 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:14:00.374009 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:14:00 +0530
I, [2018-09-12T22:14:00.400056 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:14:00.400153 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:14:00.403202 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:14:00.406121 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:14:07.414878 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:14:07.415318 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.2ms | ActiveRecord: 1.8ms)


D, [2018-09-12T22:14:07.416310 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:14:07.417550 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:14:07.422065 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:14:07 +0530
I, [2018-09-12T22:14:07.433855 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:14:07.433958 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:14:07.436120 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:14:07.437505 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:14:14.448855 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:14:14.450300 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.4ms | ActiveRecord: 2.1ms)


D, [2018-09-12T22:14:14.453178 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:14:14.455455 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:14:14.464398 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:14:14 +0530
I, [2018-09-12T22:14:14.481504 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:14:14.481612 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:14:14.483943 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:14:14.485322 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T22:14:18.365369 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:14:18 +0530
I, [2018-09-12T22:14:18.397027 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:14:18.397145 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T22:14:18.399797 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:14:18.401942 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:14:18.404883 #11095] DEBUG -- :   [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:14:18.406967 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:14:18.408602 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:14:18.409434 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:14:18.410023 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:14:18.411506 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:44:18.409000"], ["id", 1]]
D, [2018-09-12T22:14:18.412675 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:14:18.413890 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 08:44:18.413167')[0m
D, [2018-09-12T22:14:18.415386 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:14:18.415826 #11095]  INFO -- : Completed 200 OK in 19ms (Views: 0.1ms | ActiveRecord: 4.8ms)


D, [2018-09-12T22:14:18.417197 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:14:18.418594 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:14:19.491619 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T22:14:19.495655 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:14:19.496933 #11095]  INFO -- : Completed 200 OK in 5015ms (Views: 0.5ms | ActiveRecord: 2.1ms)


D, [2018-09-12T22:14:19.499643 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:14:19.501928 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:14:19.513493 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:14:19 +0530
I, [2018-09-12T22:14:19.513855 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:14:19 +0530
I, [2018-09-12T22:14:19.559427 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:14:19.559547 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
I, [2018-09-12T22:14:19.561319 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:14:19.563655 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
D, [2018-09-12T22:14:19.565726 #11095] DEBUG -- :   [1m[35m (2.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:14:19.567086 #11095] DEBUG -- :   [1m[35m (1.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:14:19.568386 #11095] DEBUG -- :   [1m[35m (1.4ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:14:19.569334 #11095] DEBUG -- :   [1m[35m (1.1ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:14:19.570830 #11095] DEBUG -- :   [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:14:19.573179 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:14:19.574946 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:14:19.575930 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:14:19.576432 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:14:19.576998 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:14:19.578723 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:44:19.576000"], ["id", 1]]
D, [2018-09-12T22:14:19.581739 #11095] DEBUG -- :   [1m[35m (2.6ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:14:19.583268 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.4ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:14:19.584422 #11095] DEBUG -- :   [1m[36mChat Load (0.3ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T22:14:19.586687 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:42:19.585834')[0m  [["active", "t"]]
D, [2018-09-12T22:14:19.590159 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:14:19.591182 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:14:19.592416 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.6ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:14:19.593395 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:14:19.594410 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:42:19.593589')[0m  [["active", "t"]]
D, [2018-09-12T22:14:19.595246 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:42:19.594572')[0m  [["active", "t"]]
D, [2018-09-12T22:14:19.596220 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T22:14:19.597061 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:42:19.596398')[0m  [["active", "t"]]
D, [2018-09-12T22:14:19.597748 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:14:19.598647 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:14:19.600842 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:14:19.601226 #11095]  INFO -- : Completed 200 OK in 37ms (Views: 0.1ms | ActiveRecord: 12.0ms)


D, [2018-09-12T22:14:19.602336 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:14:19.603661 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:14:20.573164 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T22:14:20.577315 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:14:20.577762 #11095]  INFO -- : Completed 200 OK in 1016ms (Views: 2.6ms | ActiveRecord: 3.9ms)


D, [2018-09-12T22:14:20.578838 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:14:20.579817 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:14:20.584537 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:14:20 +0530
I, [2018-09-12T22:14:20.600240 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:14:20.600329 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:14:20.603131 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:14:20.605491 #11095] DEBUG -- :   [1m[35m (1.0ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:14:27.617248 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:14:27.618785 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.5ms | ActiveRecord: 2.7ms)


D, [2018-09-12T22:14:27.621557 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:14:27.623861 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:14:27.635146 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:14:27 +0530
I, [2018-09-12T22:14:27.669612 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:14:27.669724 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:14:27.673179 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:14:27.675087 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:14:34.688111 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:14:34.689507 #11095]  INFO -- : Completed 200 OK in 7019ms (Views: 0.5ms | ActiveRecord: 2.4ms)


D, [2018-09-12T22:14:34.692407 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:14:34.695892 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:14:34.705911 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:14:34 +0530
I, [2018-09-12T22:14:34.735551 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:14:34.735652 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:14:34.738547 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:14:34.740163 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:14:41.751716 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:14:41.753279 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.4ms | ActiveRecord: 2.1ms)


D, [2018-09-12T22:14:41.755825 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:14:41.756895 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:14:41.760569 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:14:41 +0530
I, [2018-09-12T22:14:41.776201 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:14:41.776294 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:14:41.778878 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:14:41.780590 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:14:48.793354 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:14:48.794769 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.5ms | ActiveRecord: 2.1ms)


D, [2018-09-12T22:14:48.797582 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:14:48.801149 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:14:48.812125 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:14:48 +0530
I, [2018-09-12T22:14:48.855288 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:14:48.855368 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:14:48.857797 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:14:48.859365 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:14:55.871721 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:14:55.873140 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.6ms | ActiveRecord: 2.0ms)


D, [2018-09-12T22:14:55.875929 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:14:55.878072 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:14:55.887057 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:14:55 +0530
I, [2018-09-12T22:14:55.901987 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:14:55.902068 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:14:55.904856 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:14:55.906452 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:15:02.919241 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:15:02.920664 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.6ms | ActiveRecord: 2.1ms)


D, [2018-09-12T22:15:02.923519 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:15:02.925855 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:15:02.936299 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:15:02 +0530
I, [2018-09-12T22:15:02.965733 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:15:02.965827 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:15:02.968572 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:15:02.970229 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:15:09.983689 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:15:09.985077 #11095]  INFO -- : Completed 200 OK in 7019ms (Views: 0.5ms | ActiveRecord: 2.1ms)


D, [2018-09-12T22:15:09.987870 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:15:09.990135 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:15:10.000502 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:15:10 +0530
I, [2018-09-12T22:15:10.032859 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:15:10.032972 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:15:10.036019 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:15:10.037802 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T22:15:13.362425 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:15:13 +0530
I, [2018-09-12T22:15:13.377040 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:15:13.377129 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T22:15:13.381524 #11095] DEBUG -- :   [1m[35m (1.1ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:15:13.384453 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:15:13.386292 #11095] DEBUG -- :   [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:15:13.388189 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:15:13.389709 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:15:13.390534 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:15:13.391144 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:15:13.392693 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:45:13.390000"], ["id", 1]]
D, [2018-09-12T22:15:13.394318 #11095] DEBUG -- :   [1m[35m (1.3ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:15:13.396030 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.5ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 08:45:13.394830')[0m
D, [2018-09-12T22:15:13.399073 #11095] DEBUG -- :   [1m[36mSetting Load (0.6ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:15:13.399735 #11095]  INFO -- : Completed 200 OK in 22ms (Views: 0.2ms | ActiveRecord: 5.9ms)


D, [2018-09-12T22:15:13.401221 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:15:13.402058 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:15:15.044949 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T22:15:15.048994 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:15:15.050305 #11095]  INFO -- : Completed 200 OK in 5017ms (Views: 0.5ms | ActiveRecord: 2.3ms)


D, [2018-09-12T22:15:15.053059 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:15:15.055308 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:15:15.062754 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:15:15 +0530
I, [2018-09-12T22:15:15.074539 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:15:15 +0530
I, [2018-09-12T22:15:15.087164 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:15:15.088816 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:15:15.088936 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
I, [2018-09-12T22:15:15.091542 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:15:15.093567 #11095] DEBUG -- :   [1m[35m (2.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:15:15.094750 #11095] DEBUG -- :   [1m[35m (1.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:15:15.095774 #11095] DEBUG -- :   [1m[35m (1.2ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:15:15.096878 #11095] DEBUG -- :   [1m[35m (1.2ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:15:15.097510 #11095] DEBUG -- :   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:15:15.099099 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:15:15.100467 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:15:15.101196 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:15:15.101590 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:15:15.101977 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:15:15.103359 #11095] DEBUG -- :   [1m[35mSQL (0.2ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:45:15.101000"], ["id", 1]]
D, [2018-09-12T22:15:15.110731 #11095] DEBUG -- :   [1m[35m (6.8ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:15:15.115019 #11095] DEBUG -- :   [1m[36mChat::Session Load (1.0ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:15:15.118025 #11095] DEBUG -- :   [1m[36mChat Load (0.8ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T22:15:15.121930 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:43:15.121166')[0m  [["active", "t"]]
D, [2018-09-12T22:15:15.124230 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.2ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:15:15.124898 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:15:15.125450 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.2ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:15:15.126117 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:15:15.126943 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:43:15.126269')[0m  [["active", "t"]]
D, [2018-09-12T22:15:15.127664 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:43:15.127073')[0m  [["active", "t"]]
D, [2018-09-12T22:15:15.128465 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T22:15:15.129182 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:43:15.128613')[0m  [["active", "t"]]
D, [2018-09-12T22:15:15.129752 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:15:15.130551 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:15:15.132860 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:15:15.133239 #11095]  INFO -- : Completed 200 OK in 44ms (Views: 0.1ms | ActiveRecord: 16.3ms)


D, [2018-09-12T22:15:15.134352 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:15:15.135168 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:15:16.102781 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T22:15:16.106010 #11095] DEBUG -- :   [1m[36mSetting Load (0.6ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:15:16.106542 #11095]  INFO -- : Completed 200 OK in 1015ms (Views: 1.7ms | ActiveRecord: 3.1ms)


D, [2018-09-12T22:15:16.107623 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:15:16.108493 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:15:16.113949 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:15:16 +0530
I, [2018-09-12T22:15:16.136344 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:15:16.136473 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:15:16.140080 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:15:16.142052 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:15:23.152258 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:15:23.153613 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.5ms | ActiveRecord: 2.4ms)


D, [2018-09-12T22:15:23.156420 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:15:23.157620 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:15:23.162029 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:15:23 +0530
I, [2018-09-12T22:15:23.175426 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:15:23.175518 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:15:23.177751 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:15:23.179325 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:15:30.190800 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:15:30.192234 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T22:15:30.195026 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:15:30.197997 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:15:30.207597 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:15:30 +0530
I, [2018-09-12T22:15:30.233581 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:15:30.233673 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:15:30.236296 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:15:30.237775 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:15:37.249140 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:15:37.250506 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.5ms | ActiveRecord: 2.1ms)


D, [2018-09-12T22:15:37.253277 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:15:37.256220 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:15:37.266215 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:15:37 +0530
I, [2018-09-12T22:15:37.297060 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:15:37.297146 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:15:37.299679 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:15:37.301143 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:15:44.311927 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:15:44.313285 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.5ms | ActiveRecord: 2.1ms)


D, [2018-09-12T22:15:44.315890 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:15:44.320382 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:15:44.331244 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:15:44 +0530
I, [2018-09-12T22:15:44.360667 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:15:44.360753 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:15:44.363129 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:15:44.364602 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:15:51.375768 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:15:51.377225 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.5ms | ActiveRecord: 2.0ms)


D, [2018-09-12T22:15:51.380111 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:15:51.382471 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:15:51.394504 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:15:51 +0530
I, [2018-09-12T22:15:51.423510 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:15:51.423611 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:15:51.426244 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:15:51.427753 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:15:58.438021 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:15:58.439619 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.5ms | ActiveRecord: 2.1ms)


D, [2018-09-12T22:15:58.442358 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:15:58.445615 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:15:58.455706 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:15:58 +0530
I, [2018-09-12T22:15:58.487017 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:15:58.487150 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:15:58.490064 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:15:58.491835 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:16:05.503674 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:16:05.504893 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.4ms | ActiveRecord: 2.0ms)


D, [2018-09-12T22:16:05.507343 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:16:05.509381 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:16:05.519828 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:16:05 +0530
I, [2018-09-12T22:16:05.548699 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:16:05.548797 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:16:05.551417 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:16:05.553242 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T22:16:08.365285 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:16:08 +0530
I, [2018-09-12T22:16:08.396884 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:16:08.396984 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T22:16:08.399662 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:16:08.401172 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:16:08.402484 #11095] DEBUG -- :   [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:16:08.404175 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:16:08.406483 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:16:08.407585 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:16:08.408142 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:16:08.409630 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:46:08.407000"], ["id", 1]]
D, [2018-09-12T22:16:08.416602 #11095] DEBUG -- :   [1m[35m (6.7ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:16:08.417852 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 08:46:08.417115')[0m
D, [2018-09-12T22:16:08.419297 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:16:08.419738 #11095]  INFO -- : Completed 200 OK in 23ms (Views: 0.1ms | ActiveRecord: 10.3ms)


D, [2018-09-12T22:16:08.421020 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:16:08.422269 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:16:08.558351 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T22:16:08.562472 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:16:08.563846 #11095]  INFO -- : Completed 200 OK in 3015ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T22:16:08.566695 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:16:08.569129 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:16:08.579390 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:16:08 +0530
I, [2018-09-12T22:16:08.604381 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:16:08 +0530
I, [2018-09-12T22:16:08.617549 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:16:08.617664 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
I, [2018-09-12T22:16:08.621949 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
D, [2018-09-12T22:16:08.622191 #11095] DEBUG -- :   [1m[35m (2.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
I, [2018-09-12T22:16:08.622291 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:16:08.625434 #11095] DEBUG -- :   [1m[35m (1.9ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:16:08.626508 #11095] DEBUG -- :   [1m[35m (1.2ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:16:08.627609 #11095] DEBUG -- :   [1m[36mUser Load (1.2ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:16:08.629166 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:16:08.630164 #11095] DEBUG -- :   [1m[35m (2.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:16:08.630810 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:16:08.631579 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:16:08.631998 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:16:08.632493 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:16:08.633928 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:46:08.632000"], ["id", 1]]
D, [2018-09-12T22:16:08.636965 #11095] DEBUG -- :   [1m[35m (2.7ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:16:08.638278 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:16:08.639256 #11095] DEBUG -- :   [1m[36mChat Load (0.3ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T22:16:08.641132 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:44:08.640409')[0m  [["active", "t"]]
D, [2018-09-12T22:16:08.643500 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:16:08.644262 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:16:08.644824 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.2ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:16:08.645458 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:16:08.646221 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:44:08.645591')[0m  [["active", "t"]]
D, [2018-09-12T22:16:08.646869 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:44:08.646348')[0m  [["active", "t"]]
D, [2018-09-12T22:16:08.647673 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T22:16:08.648415 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:44:08.647833')[0m  [["active", "t"]]
D, [2018-09-12T22:16:08.648991 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:16:08.649767 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:16:08.652373 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:16:08.652762 #11095]  INFO -- : Completed 200 OK in 35ms (Views: 0.1ms | ActiveRecord: 13.5ms)


D, [2018-09-12T22:16:08.653907 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:16:08.654536 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:16:09.636673 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T22:16:09.639584 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:16:09.640032 #11095]  INFO -- : Completed 200 OK in 1016ms (Views: 1.5ms | ActiveRecord: 4.3ms)


D, [2018-09-12T22:16:09.641046 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:16:09.641822 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:16:09.646530 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:16:09 +0530
I, [2018-09-12T22:16:09.664104 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:16:09.664207 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:16:09.667785 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:16:09.670063 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:16:16.681337 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:16:16.682825 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.6ms | ActiveRecord: 2.7ms)


D, [2018-09-12T22:16:16.685559 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:16:16.687866 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:16:16.697548 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:16:16 +0530
I, [2018-09-12T22:16:16.725715 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:16:16.725809 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:16:16.728557 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:16:16.730161 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:16:23.741740 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:16:23.743161 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T22:16:23.746036 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:16:23.748354 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:16:23.757929 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:16:23 +0530
I, [2018-09-12T22:16:23.793414 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:16:23.793528 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:16:23.796899 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:16:23.798745 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:16:30.810729 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:16:30.812881 #11095]  INFO -- : Completed 200 OK in 7019ms (Views: 0.5ms | ActiveRecord: 2.4ms)


D, [2018-09-12T22:16:30.816368 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:16:30.821634 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:16:30.832782 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:16:30 +0530
I, [2018-09-12T22:16:30.866275 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:16:30.866371 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:16:30.869237 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:16:30.870874 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:16:37.881467 #11095] DEBUG -- :   [1m[36mSetting Load (1.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:16:37.882918 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.5ms | ActiveRecord: 2.5ms)


D, [2018-09-12T22:16:37.885848 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:16:37.890422 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:16:37.901196 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:16:37 +0530
I, [2018-09-12T22:16:37.941720 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:16:37.941800 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:16:37.944038 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:16:37.945532 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:16:44.958102 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:16:44.959511 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.6ms | ActiveRecord: 1.9ms)


D, [2018-09-12T22:16:44.960394 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:16:44.961137 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:16:44.965355 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:16:44 +0530
I, [2018-09-12T22:16:44.981067 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:16:44.981174 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:16:44.983807 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:16:44.985726 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:16:51.998117 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:16:51.999453 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.5ms | ActiveRecord: 2.4ms)


D, [2018-09-12T22:16:52.002276 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:16:52.004607 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:16:52.014469 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:16:52 +0530
I, [2018-09-12T22:16:52.045829 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:16:52.045972 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:16:52.048853 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:16:52.050649 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:16:59.062259 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:16:59.063635 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.5ms | ActiveRecord: 2.3ms)


D, [2018-09-12T22:16:59.066411 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:16:59.069040 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:16:59.074702 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:16:59 +0530
I, [2018-09-12T22:16:59.088344 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:16:59.088434 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:16:59.090829 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:16:59.092799 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T22:17:03.364784 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:17:03 +0530
I, [2018-09-12T22:17:03.400885 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:17:03.401030 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T22:17:03.404147 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:17:03.405720 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:17:03.407056 #11095] DEBUG -- :   [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:17:03.408662 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:17:03.410044 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:17:03.410823 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:17:03.411398 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:17:03.412886 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:47:03.411000"], ["id", 1]]
D, [2018-09-12T22:17:03.414110 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:17:03.416604 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.8ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 08:47:03.414756')[0m
D, [2018-09-12T22:17:03.418682 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:17:03.419131 #11095]  INFO -- : Completed 200 OK in 18ms (Views: 0.1ms | ActiveRecord: 4.7ms)


D, [2018-09-12T22:17:03.420399 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:17:03.421207 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:17:04.099637 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T22:17:04.103534 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:17:04.104902 #11095]  INFO -- : Completed 200 OK in 5016ms (Views: 0.6ms | ActiveRecord: 2.1ms)


D, [2018-09-12T22:17:04.108364 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:17:04.110629 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:17:04.119649 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:17:04 +0530
I, [2018-09-12T22:17:04.131328 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:17:04 +0530
I, [2018-09-12T22:17:04.143899 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:17:04.144334 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
I, [2018-09-12T22:17:04.147639 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:17:04.147720 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:17:04.149352 #11095] DEBUG -- :   [1m[35m (3.2ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:17:04.150384 #11095] DEBUG -- :   [1m[35m (1.1ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:17:04.151319 #11095] DEBUG -- :   [1m[35m (1.0ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:17:04.152284 #11095] DEBUG -- :   [1m[35m (1.1ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:17:04.152823 #11095] DEBUG -- :   [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:17:04.154223 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:17:04.155496 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:17:04.156206 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:17:04.156551 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:17:04.157002 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:17:04.158291 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:47:04.156000"], ["id", 1]]
D, [2018-09-12T22:17:04.165854 #11095] DEBUG -- :   [1m[35m (7.0ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:17:04.169778 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.9ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:17:04.172359 #11095] DEBUG -- :   [1m[36mChat Load (0.7ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T22:17:04.177610 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.7ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:45:04.175691')[0m  [["active", "t"]]
D, [2018-09-12T22:17:04.184419 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.7ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:17:04.186582 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:17:04.188458 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.7ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:17:04.190582 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:17:04.193791 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:45:04.191211')[0m  [["active", "t"]]
D, [2018-09-12T22:17:04.196293 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.8ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:45:04.194288')[0m  [["active", "t"]]
D, [2018-09-12T22:17:04.198978 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T22:17:04.201353 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.7ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:45:04.199457')[0m  [["active", "t"]]
D, [2018-09-12T22:17:04.203097 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.7ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:17:04.205679 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.8ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:17:04.213465 #11095] DEBUG -- :   [1m[36mSetting Load (0.8ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:17:04.214554 #11095]  INFO -- : Completed 200 OK in 70ms (Views: 0.3ms | ActiveRecord: 23.5ms)


D, [2018-09-12T22:17:04.218022 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:17:04.220211 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:17:05.158033 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T22:17:05.165668 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:17:05.167011 #11095]  INFO -- : Completed 200 OK in 1019ms (Views: 3.9ms | ActiveRecord: 3.5ms)


D, [2018-09-12T22:17:05.169859 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:17:05.172136 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:17:05.183147 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:17:05 +0530
I, [2018-09-12T22:17:05.216634 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:17:05.216775 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:17:05.219878 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:17:05.221689 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:17:12.233976 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:17:12.235567 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.5ms | ActiveRecord: 2.5ms)


D, [2018-09-12T22:17:12.238545 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:17:12.240936 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:17:12.251940 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:17:12 +0530
I, [2018-09-12T22:17:12.282597 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:17:12.282688 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:17:12.285113 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:17:12.286579 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:17:19.297623 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:17:19.298998 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.5ms | ActiveRecord: 1.9ms)


D, [2018-09-12T22:17:19.301712 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:17:19.307247 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:17:19.317686 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:17:19 +0530
I, [2018-09-12T22:17:19.341652 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:17:19.341727 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:17:19.344035 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:17:19.345513 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:17:26.362379 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:17:26.364208 #11095]  INFO -- : Completed 200 OK in 7022ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T22:17:26.367313 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:17:26.370331 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:17:26.381584 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:17:26 +0530
I, [2018-09-12T22:17:26.410753 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:17:26.410868 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:17:26.414143 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:17:26.415780 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:17:33.432509 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:17:33.433905 #11095]  INFO -- : Completed 200 OK in 7023ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T22:17:33.436586 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:17:33.438686 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:17:33.448300 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:17:33 +0530
I, [2018-09-12T22:17:33.481798 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:17:33.481903 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:17:33.485015 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:17:33.486843 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:17:40.502830 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:17:40.504212 #11095]  INFO -- : Completed 200 OK in 7022ms (Views: 0.5ms | ActiveRecord: 2.4ms)


D, [2018-09-12T22:17:40.506930 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:17:40.509255 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:17:40.519844 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:17:40 +0530
I, [2018-09-12T22:17:40.551198 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:17:40.551310 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:17:40.554068 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:17:40.555877 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:17:47.568026 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:17:47.569446 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.5ms | ActiveRecord: 2.3ms)


D, [2018-09-12T22:17:47.572258 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:17:47.574598 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:17:47.584930 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:17:47 +0530
I, [2018-09-12T22:17:47.611216 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:17:47.611332 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:17:47.613881 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:17:47.615393 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:17:54.626440 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:17:54.627802 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.5ms | ActiveRecord: 2.1ms)


D, [2018-09-12T22:17:54.630507 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:17:54.632811 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:17:54.642473 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:17:54 +0530
I, [2018-09-12T22:17:54.672037 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:17:54.672126 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:17:54.674888 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:17:54.676593 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T22:17:58.364406 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:17:58 +0530
I, [2018-09-12T22:17:58.398543 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:17:58.398649 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T22:17:58.401512 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:17:58.403962 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:17:58.405935 #11095] DEBUG -- :   [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:17:58.407726 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:17:58.409184 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:17:58.409976 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:17:58.410493 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:17:58.411909 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:47:58.410000"], ["id", 1]]
D, [2018-09-12T22:17:58.419254 #11095] DEBUG -- :   [1m[35m (6.8ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:17:58.422795 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.8ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 08:47:58.420736')[0m
D, [2018-09-12T22:17:58.425677 #11095] DEBUG -- :   [1m[36mSetting Load (0.6ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:17:58.426663 #11095]  INFO -- : Completed 200 OK in 28ms (Views: 0.3ms | ActiveRecord: 11.3ms)


D, [2018-09-12T22:17:58.429133 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:17:58.430320 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:17:59.682537 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T22:17:59.686486 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:17:59.687864 #11095]  INFO -- : Completed 200 OK in 5015ms (Views: 0.5ms | ActiveRecord: 2.1ms)


D, [2018-09-12T22:17:59.690499 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:17:59.692912 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:17:59.703417 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:17:59 +0530
I, [2018-09-12T22:17:59.704676 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:17:59 +0530
I, [2018-09-12T22:17:59.740636 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:17:59.740716 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
I, [2018-09-12T22:17:59.744218 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:17:59.744306 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:17:59.746053 #11095] DEBUG -- :   [1m[35m (3.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:17:59.747222 #11095] DEBUG -- :   [1m[35m (1.2ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:17:59.748376 #11095] DEBUG -- :   [1m[35m (1.3ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:17:59.749439 #11095] DEBUG -- :   [1m[35m (1.1ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:17:59.750087 #11095] DEBUG -- :   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:17:59.751666 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:17:59.753173 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:17:59.754004 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:17:59.754424 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:17:59.754897 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:17:59.756346 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:47:59.754000"], ["id", 1]]
D, [2018-09-12T22:17:59.759361 #11095] DEBUG -- :   [1m[35m (2.7ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:17:59.762204 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.7ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:17:59.763787 #11095] DEBUG -- :   [1m[36mChat Load (0.5ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T22:17:59.765848 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:45:59.765041')[0m  [["active", "t"]]
D, [2018-09-12T22:17:59.768245 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:17:59.769053 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:17:59.769850 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:17:59.770720 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:17:59.771867 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:45:59.770952')[0m  [["active", "t"]]
D, [2018-09-12T22:17:59.772639 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:45:59.772040')[0m  [["active", "t"]]
D, [2018-09-12T22:17:59.773507 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T22:17:59.774252 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:45:59.773659')[0m  [["active", "t"]]
D, [2018-09-12T22:17:59.774829 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:17:59.775847 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:17:59.780310 #11095] DEBUG -- :   [1m[36mSetting Load (0.8ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:17:59.780824 #11095]  INFO -- : Completed 200 OK in 40ms (Views: 0.3ms | ActiveRecord: 14.8ms)


D, [2018-09-12T22:17:59.782185 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:17:59.782997 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:18:00.753482 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T22:18:00.757732 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:18:00.758162 #11095]  INFO -- : Completed 200 OK in 1014ms (Views: 2.8ms | ActiveRecord: 2.8ms)


D, [2018-09-12T22:18:00.759040 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:18:00.759851 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:18:00.764456 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:18:00 +0530
I, [2018-09-12T22:18:00.778872 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:18:00.778976 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:18:00.781493 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:18:00.783184 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:18:07.794282 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:18:07.795638 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.5ms | ActiveRecord: 2.1ms)


D, [2018-09-12T22:18:07.798743 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:18:07.801643 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:18:07.811347 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:18:07 +0530
I, [2018-09-12T22:18:07.840512 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:18:07.840600 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:18:07.842995 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:18:07.844534 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:18:14.856980 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:18:14.858449 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.6ms | ActiveRecord: 2.0ms)


D, [2018-09-12T22:18:14.861338 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:18:14.863685 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:18:14.874557 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:18:14 +0530
I, [2018-09-12T22:18:14.903048 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:18:14.903127 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:18:14.905600 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:18:14.907067 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:18:21.918308 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:18:21.919814 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.5ms | ActiveRecord: 2.0ms)


D, [2018-09-12T22:18:21.922727 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:18:21.925469 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:18:21.935196 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:18:21 +0530
I, [2018-09-12T22:18:21.965619 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:18:21.965711 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:18:21.968520 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:18:21.970261 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:18:28.984594 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:18:28.986082 #11095]  INFO -- : Completed 200 OK in 7020ms (Views: 0.5ms | ActiveRecord: 2.3ms)


D, [2018-09-12T22:18:28.989221 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:18:28.991958 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:18:29.009168 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:18:29 +0530
I, [2018-09-12T22:18:29.043946 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:18:29.044024 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:18:29.046424 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:18:29.048001 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:18:36.060949 #11095] DEBUG -- :   [1m[36mSetting Load (1.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:18:36.062370 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.5ms | ActiveRecord: 2.4ms)


D, [2018-09-12T22:18:36.065165 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:18:36.067447 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:18:36.077845 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:18:36 +0530
I, [2018-09-12T22:18:36.108917 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:18:36.109045 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:18:36.111774 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:18:36.113563 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:18:43.122871 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:18:43.123368 #11095]  INFO -- : Completed 200 OK in 7014ms (Views: 0.2ms | ActiveRecord: 1.5ms)


D, [2018-09-12T22:18:43.124428 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:18:43.125294 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:18:43.129320 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:18:43 +0530
I, [2018-09-12T22:18:43.146687 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:18:43.146791 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:18:43.149855 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:18:43.151937 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:18:50.163736 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:18:50.165060 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.5ms | ActiveRecord: 2.4ms)


D, [2018-09-12T22:18:50.167888 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:18:50.170249 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:18:50.179703 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:18:50 +0530
I, [2018-09-12T22:18:50.207003 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:18:50.207092 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:18:50.209685 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:18:50.211271 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T22:18:53.365380 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:18:53 +0530
I, [2018-09-12T22:18:53.396499 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:18:53.396656 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T22:18:53.399316 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:18:53.400932 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:18:53.402325 #11095] DEBUG -- :   [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:18:53.405344 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:18:53.407456 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:18:53.408355 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:18:53.408960 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:18:53.410428 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:48:53.408000"], ["id", 1]]
D, [2018-09-12T22:18:53.418192 #11095] DEBUG -- :   [1m[35m (7.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:18:53.423524 #11095] DEBUG -- :   [1m[36mChat::Agent Load (1.0ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 08:48:53.420184')[0m
D, [2018-09-12T22:18:53.428283 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:18:53.429684 #11095]  INFO -- : Completed 200 OK in 33ms (Views: 0.4ms | ActiveRecord: 12.0ms)


D, [2018-09-12T22:18:53.435547 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:18:53.438015 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:18:55.219232 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T22:18:55.223358 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:18:55.224708 #11095]  INFO -- : Completed 200 OK in 5017ms (Views: 0.6ms | ActiveRecord: 2.0ms)


D, [2018-09-12T22:18:55.227292 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:18:55.229462 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:18:55.242617 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:18:55 +0530
I, [2018-09-12T22:18:55.243033 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:18:55 +0530
I, [2018-09-12T22:18:55.293859 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:18:55.293975 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
I, [2018-09-12T22:18:55.299026 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:18:55.299169 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
D, [2018-09-12T22:18:55.301854 #11095] DEBUG -- :   [1m[35m (5.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:18:55.303705 #11095] DEBUG -- :   [1m[35m (2.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:18:55.307526 #11095] DEBUG -- :   [1m[35m (3.8ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:18:55.309059 #11095] DEBUG -- :   [1m[35m (2.1ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:18:55.311111 #11095] DEBUG -- :   [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:18:55.313660 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:18:55.315669 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:18:55.316571 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:18:55.317086 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:18:55.317632 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:18:55.319339 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:48:55.317000"], ["id", 1]]
D, [2018-09-12T22:18:55.326722 #11095] DEBUG -- :   [1m[35m (6.9ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:18:55.328491 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.4ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:18:55.329442 #11095] DEBUG -- :   [1m[36mChat Load (0.3ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T22:18:55.332077 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:46:55.331315')[0m  [["active", "t"]]
D, [2018-09-12T22:18:55.334490 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:18:55.335259 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:18:55.335939 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:18:55.336739 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:18:55.337920 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:46:55.336913')[0m  [["active", "t"]]
D, [2018-09-12T22:18:55.340028 #11095] DEBUG -- :   [1m[36mChat::Agent Load (1.0ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:46:55.338284')[0m  [["active", "t"]]
D, [2018-09-12T22:18:55.341539 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T22:18:55.342530 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:46:55.341783')[0m  [["active", "t"]]
D, [2018-09-12T22:18:55.343180 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:18:55.344152 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:18:55.346754 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:18:55.347167 #11095]  INFO -- : Completed 200 OK in 48ms (Views: 0.2ms | ActiveRecord: 18.1ms)


D, [2018-09-12T22:18:55.348464 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:18:55.349270 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:18:56.313623 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T22:18:56.321133 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:18:56.323110 #11095]  INFO -- : Completed 200 OK in 1029ms (Views: 3.8ms | ActiveRecord: 10.1ms)


D, [2018-09-12T22:18:56.326129 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:18:56.327405 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:18:56.331434 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:18:56 +0530
I, [2018-09-12T22:18:56.345479 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:18:56.345558 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:18:56.348073 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:18:56.349602 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:19:03.361879 #11095] DEBUG -- :   [1m[36mSetting Load (1.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:19:03.364112 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.5ms | ActiveRecord: 2.4ms)


D, [2018-09-12T22:19:03.367080 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:19:03.369386 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:19:03.380892 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:19:03 +0530
I, [2018-09-12T22:19:03.405167 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:19:03.405255 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:19:03.407950 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:19:03.410177 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:19:10.420829 #11095] DEBUG -- :   [1m[36mSetting Load (1.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:19:10.422243 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.5ms | ActiveRecord: 2.5ms)


D, [2018-09-12T22:19:10.425207 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:19:10.427759 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:19:10.437576 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:19:10 +0530
I, [2018-09-12T22:19:10.464370 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:19:10.464463 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:19:10.467042 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:19:10.468634 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:19:17.476621 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:19:17.477009 #11095]  INFO -- : Completed 200 OK in 7012ms (Views: 0.2ms | ActiveRecord: 1.4ms)


D, [2018-09-12T22:19:17.477780 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:19:17.478598 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:19:17.481830 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:19:17 +0530
I, [2018-09-12T22:19:17.492857 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:19:17.492933 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:19:17.495960 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:19:17.497570 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:19:24.508700 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:19:24.510120 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.5ms | ActiveRecord: 2.4ms)


D, [2018-09-12T22:19:24.512970 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:19:24.515952 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:19:24.525708 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:19:24 +0530
I, [2018-09-12T22:19:24.554916 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:19:24.555029 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:19:24.557675 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:19:24.559440 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:19:31.570290 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:19:31.571653 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.5ms | ActiveRecord: 2.1ms)


D, [2018-09-12T22:19:31.574105 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:19:31.576218 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:19:31.586023 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:19:31 +0530
I, [2018-09-12T22:19:31.613608 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:19:31.613715 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:19:31.616582 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:19:31.618264 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:19:31.619409 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:19:31.620999 #11095] DEBUG -- :   [1m[35mSQL (0.4ms)[0m  [1m[32mINSERT INTO "delayed_jobs" ("handler", "run_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["handler", "--- !ruby/object:Observer::UserDeviceLogJob\nhttp_user_agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko)\n  Chrome/68.0.3440.106 Safari/537.36\nremote_ip: \"::1\"\nuser_id: 3\nfingerprint: \"-1992429858\"\ntype: session\n"], ["run_at", "2018-09-12 16:49:31.619624"], ["created_at", "2018-09-12 16:49:31.619000"], ["updated_at", "2018-09-12 16:49:31.619000"]]
D, [2018-09-12T22:19:31.628399 #11095] DEBUG -- :   [1m[35m (6.8ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:19:38.642053 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:19:38.643436 #11095]  INFO -- : Completed 200 OK in 7029ms (Views: 0.5ms | ActiveRecord: 9.6ms)


D, [2018-09-12T22:19:38.647260 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:19:38.651679 #11095] DEBUG -- :   [1m[35mSQL (0.8ms)[0m  [1m[33mUPDATE "sessions" SET "data" = $1, "updated_at" = $2 WHERE "sessions"."id" = $3[0m  [["data", "BAh7D0kiCXBpbmcGOgZFRkkiGTIwMTgtMDktMTJUMTY6MDk6MjZaBjsAVEki\nD3VzZXJfYWdlbnQGOwBGIm5Nb3ppbGxhLzUuMCAoWDExOyBMaW51eCB4ODZf\nNjQpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENo\ncm9tZS82OC4wLjM0NDAuMTA2IFNhZmFyaS81MzcuMzZJIhBfY3NyZl90b2tl\nbgY7AEZJIjE1SzlmTEZWTnRwVFYydjArWGQ1M21QMjFWbDAzT1RSeEp2cUpm\nbitDRDUwPQY7AEZJIgx1c2VyX2lkBjsARmkISSIadXNlcl9kZXZpY2VfcmVt\nb3RlX2lwBjsARiIIOjoxSSIcdXNlcl9kZXZpY2VfZmluZ2VycHJpbnQGOwBG\nSSIQLTE5OTI0Mjk4NTgGOwBUSSIbdXNlcl9kZXZpY2VfdXBkYXRlZF9hdAY7\nAEZVOiBBY3RpdmVTdXBwb3J0OjpUaW1lV2l0aFpvbmVbCEl1OglUaW1lDZCh\nHcAqcPnFCToJem9uZUkiCFVUQwY7AEY6DW5hbm9fbnVtaQI1AjoNbmFub19k\nZW5pBjoNc3VibWljcm8iB1ZQSSIIVVRDBjsAVEAWSSIPcGVyc2lzdGVudAY7\nAEZUSSIOcmVtb3RlX2lwBjsARiIIOjoxSSIIZ2VvBjsARnsA\n"], ["updated_at", "2018-09-12 16:49:38.648172"], ["id", 33]]
D, [2018-09-12T22:19:38.659843 #11095] DEBUG -- :   [1m[35m (7.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:19:38.669627 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:19:38 +0530
I, [2018-09-12T22:19:38.700387 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:19:38.700490 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:19:38.704490 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:19:38.707336 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:19:45.721667 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:19:45.723166 #11095]  INFO -- : Completed 200 OK in 7022ms (Views: 0.4ms | ActiveRecord: 2.5ms)


D, [2018-09-12T22:19:45.725744 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:19:45.728000 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:19:45.737587 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:19:45 +0530
I, [2018-09-12T22:19:45.750475 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:19:45.750538 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:19:45.752823 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:19:45.754755 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T22:19:48.358399 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:19:48 +0530
I, [2018-09-12T22:19:48.371283 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:19:48.371361 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T22:19:48.373203 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:19:48.374466 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:19:48.375465 #11095] DEBUG -- :   [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:19:48.376718 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:19:48.377950 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:19:48.378566 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:19:48.379009 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:19:48.380711 #11095] DEBUG -- :   [1m[35mSQL (0.4ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:49:48.378000"], ["id", 1]]
D, [2018-09-12T22:19:48.388471 #11095] DEBUG -- :   [1m[35m (7.0ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:19:48.389709 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 08:49:48.388965')[0m
D, [2018-09-12T22:19:48.390915 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:19:48.391271 #11095]  INFO -- : Completed 200 OK in 20ms (Views: 0.1ms | ActiveRecord: 9.8ms)


D, [2018-09-12T22:19:48.392278 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:19:48.392896 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:19:48.760051 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T22:19:48.761356 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:19:48.761714 #11095]  INFO -- : Completed 200 OK in 3011ms (Views: 0.2ms | ActiveRecord: 1.4ms)


D, [2018-09-12T22:19:48.762419 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:19:48.763164 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:19:48.767452 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:19:48 +0530
I, [2018-09-12T22:19:48.775534 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:19:48 +0530
I, [2018-09-12T22:19:48.790286 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:19:48.790384 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
I, [2018-09-12T22:19:48.792536 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:19:48.792959 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:19:48.795616 #11095] DEBUG -- :   [1m[35m (1.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:19:48.796519 #11095] DEBUG -- :   [1m[35m (1.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:19:48.797535 #11095] DEBUG -- :   [1m[35m (1.1ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:19:48.798999 #11095] DEBUG -- :   [1m[35m (1.4ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:19:48.800629 #11095] DEBUG -- :   [1m[36mUser Load (1.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:19:48.802459 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:19:48.803855 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:19:48.804505 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:19:48.804855 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:19:48.805217 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:19:48.806376 #11095] DEBUG -- :   [1m[35mSQL (0.2ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:49:48.804000"], ["id", 1]]
D, [2018-09-12T22:19:48.809145 #11095] DEBUG -- :   [1m[35m (2.5ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:19:48.810152 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.2ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:19:48.810862 #11095] DEBUG -- :   [1m[36mChat Load (0.2ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T22:19:48.812292 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:47:48.811776')[0m  [["active", "t"]]
D, [2018-09-12T22:19:48.814322 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:19:48.816520 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:19:48.818063 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:19:48.819413 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:19:48.820433 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:47:48.819683')[0m  [["active", "t"]]
D, [2018-09-12T22:19:48.821169 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:47:48.820581')[0m  [["active", "t"]]
D, [2018-09-12T22:19:48.822111 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T22:19:48.822875 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:47:48.822281')[0m  [["active", "t"]]
D, [2018-09-12T22:19:48.823416 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:19:48.824158 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:19:48.826342 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:19:48.826679 #11095]  INFO -- : Completed 200 OK in 36ms (Views: 0.1ms | ActiveRecord: 12.1ms)


D, [2018-09-12T22:19:48.827676 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:19:48.828331 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:19:49.805308 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T22:19:49.808678 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:19:49.809149 #11095]  INFO -- : Completed 200 OK in 1015ms (Views: 1.6ms | ActiveRecord: 3.0ms)


D, [2018-09-12T22:19:49.810125 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:19:49.810942 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:19:49.815299 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:19:49 +0530
I, [2018-09-12T22:19:49.832553 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:19:49.832651 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:19:49.838483 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:19:49.840788 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:19:56.854224 #11095] DEBUG -- :   [1m[36mSetting Load (1.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:19:56.855731 #11095]  INFO -- : Completed 200 OK in 7023ms (Views: 0.5ms | ActiveRecord: 2.8ms)


D, [2018-09-12T22:19:56.858868 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:19:56.861397 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:19:56.872334 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:19:56 +0530
I, [2018-09-12T22:19:56.899102 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:19:56.899226 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:19:56.901738 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:19:56.903230 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:20:03.918035 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:20:03.919404 #11095]  INFO -- : Completed 200 OK in 7020ms (Views: 0.5ms | ActiveRecord: 2.1ms)


D, [2018-09-12T22:20:03.922278 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:20:03.924668 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:20:03.934521 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:20:03 +0530
I, [2018-09-12T22:20:03.965431 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:20:03.965526 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:20:03.968446 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:20:03.971233 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:20:10.984782 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:20:10.986124 #11095]  INFO -- : Completed 200 OK in 7020ms (Views: 0.4ms | ActiveRecord: 2.4ms)


D, [2018-09-12T22:20:10.989042 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:20:10.992032 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:20:11.001833 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:20:11 +0530
I, [2018-09-12T22:20:11.029832 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:20:11.029925 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:20:11.032715 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:20:11.034337 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:20:18.046194 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:20:18.047654 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T22:20:18.050556 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:20:18.053358 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:20:18.063191 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:20:18 +0530
I, [2018-09-12T22:20:18.092428 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:20:18.092523 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:20:18.104046 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:20:18.105670 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:20:25.115699 #11095] DEBUG -- :   [1m[36mSetting Load (0.6ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:20:25.116650 #11095]  INFO -- : Completed 200 OK in 7024ms (Views: 0.4ms | ActiveRecord: 1.7ms)


D, [2018-09-12T22:20:25.118491 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:20:25.120199 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:20:25.125225 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:20:25 +0530
I, [2018-09-12T22:20:25.140733 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:20:25.140809 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:20:25.143057 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:20:25.145400 #11095] DEBUG -- :   [1m[35m (1.1ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:20:32.156674 #11095] DEBUG -- :   [1m[36mSetting Load (1.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:20:32.158437 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.6ms | ActiveRecord: 2.8ms)


D, [2018-09-12T22:20:32.168266 #11095] DEBUG -- :   [1m[35m (7.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:20:32.169806 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:20:32.174751 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:20:32 +0530
I, [2018-09-12T22:20:32.191466 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:20:32.191563 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:20:32.194197 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:20:32.195723 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:20:39.207266 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:20:39.208850 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T22:20:39.211680 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:20:39.214003 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:20:39.224486 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:20:39 +0530
I, [2018-09-12T22:20:39.254552 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:20:39.254657 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:20:39.257822 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:20:39.259324 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T22:20:43.365334 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:20:43 +0530
I, [2018-09-12T22:20:43.400023 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:20:43.400141 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T22:20:43.402914 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:20:43.404564 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:20:43.405872 #11095] DEBUG -- :   [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:20:43.407443 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:20:43.408883 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:20:43.409713 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:20:43.410264 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:20:43.411723 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:50:43.409000"], ["id", 1]]
D, [2018-09-12T22:20:43.413327 #11095] DEBUG -- :   [1m[35m (1.3ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:20:43.414469 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 08:50:43.413800')[0m
D, [2018-09-12T22:20:43.415874 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:20:43.416246 #11095]  INFO -- : Completed 200 OK in 16ms (Views: 0.1ms | ActiveRecord: 4.6ms)


D, [2018-09-12T22:20:43.417437 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:20:43.418149 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:20:44.264763 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T22:20:44.269021 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:20:44.270321 #11095]  INFO -- : Completed 200 OK in 5015ms (Views: 0.6ms | ActiveRecord: 2.1ms)


D, [2018-09-12T22:20:44.273112 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:20:44.275451 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:20:44.288913 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:20:44 +0530
I, [2018-09-12T22:20:44.317457 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:20:44 +0530
I, [2018-09-12T22:20:44.335092 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:20:44.335251 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
I, [2018-09-12T22:20:44.337859 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:20:44.338026 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
D, [2018-09-12T22:20:44.342666 #11095] DEBUG -- :   [1m[35m (2.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:20:44.344632 #11095] DEBUG -- :   [1m[35m (2.2ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:20:44.345883 #11095] DEBUG -- :   [1m[35m (1.4ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:20:44.347103 #11095] DEBUG -- :   [1m[35m (1.3ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:20:44.347885 #11095] DEBUG -- :   [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:20:44.349988 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:20:44.352295 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:20:44.353473 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:20:44.354037 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:20:44.354507 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:20:44.356693 #11095] DEBUG -- :   [1m[35mSQL (0.4ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:50:44.354000"], ["id", 1]]
D, [2018-09-12T22:20:44.359227 #11095] DEBUG -- :   [1m[35m (1.3ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:20:44.362897 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.7ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:20:44.364518 #11095] DEBUG -- :   [1m[36mChat Load (0.4ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T22:20:44.366946 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:48:44.366058')[0m  [["active", "t"]]
D, [2018-09-12T22:20:44.369808 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:20:44.370748 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:20:44.371467 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:20:44.372352 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:20:44.373433 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:48:44.372549')[0m  [["active", "t"]]
D, [2018-09-12T22:20:44.374446 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:48:44.373610')[0m  [["active", "t"]]
D, [2018-09-12T22:20:44.376651 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T22:20:44.378401 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:48:44.377351')[0m  [["active", "t"]]
D, [2018-09-12T22:20:44.379524 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:20:44.380843 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.4ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:20:44.383356 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:20:44.383812 #11095]  INFO -- : Completed 200 OK in 46ms (Views: 0.1ms | ActiveRecord: 13.2ms)


D, [2018-09-12T22:20:44.385082 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:20:44.387013 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:20:45.351399 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T22:20:45.355298 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:20:45.355808 #11095]  INFO -- : Completed 200 OK in 1018ms (Views: 2.6ms | ActiveRecord: 3.9ms)


D, [2018-09-12T22:20:45.357118 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:20:45.357836 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:20:45.361418 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:20:45 +0530
I, [2018-09-12T22:20:45.373336 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:20:45.373410 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:20:45.375603 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:20:45.377012 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:20:52.386442 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:20:52.387855 #11095]  INFO -- : Completed 200 OK in 7014ms (Views: 0.5ms | ActiveRecord: 2.0ms)


D, [2018-09-12T22:20:52.390687 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:20:52.393163 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:20:52.403113 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:20:52 +0530
I, [2018-09-12T22:20:52.434344 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:20:52.434458 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:20:52.437118 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:20:52.438934 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:20:59.450684 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:20:59.452086 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.5ms | ActiveRecord: 2.3ms)


D, [2018-09-12T22:20:59.454830 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:20:59.457179 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:20:59.466707 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:20:59 +0530
I, [2018-09-12T22:20:59.494644 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:20:59.494769 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:20:59.497516 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:20:59.499018 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:21:06.508906 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:21:06.510325 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.5ms | ActiveRecord: 2.1ms)


D, [2018-09-12T22:21:06.513110 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:21:06.515386 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:21:06.525237 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:21:06 +0530
I, [2018-09-12T22:21:06.556682 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:21:06.556777 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:21:06.559708 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:21:06.561306 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:21:13.573389 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:21:13.573878 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.3ms | ActiveRecord: 1.6ms)


D, [2018-09-12T22:21:13.574838 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:21:13.575659 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:21:13.579347 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:21:13 +0530
I, [2018-09-12T22:21:13.592134 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:21:13.592209 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:21:13.594492 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:21:13.595992 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:21:20.609815 #11095] DEBUG -- :   [1m[36mSetting Load (1.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:21:20.611934 #11095]  INFO -- : Completed 200 OK in 7019ms (Views: 0.5ms | ActiveRecord: 2.3ms)


D, [2018-09-12T22:21:20.616082 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:21:20.620410 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:21:20.631171 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:21:20 +0530
I, [2018-09-12T22:21:20.653223 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:21:20.653299 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:21:20.655605 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:21:20.657139 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:21:27.668309 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:21:27.669741 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.5ms | ActiveRecord: 2.0ms)


D, [2018-09-12T22:21:27.672543 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:21:27.674772 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:21:27.684315 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:21:27 +0530
I, [2018-09-12T22:21:27.704452 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:21:27.704550 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:21:27.706843 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:21:27.708386 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:21:34.717944 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:21:34.719174 #11095]  INFO -- : Completed 200 OK in 7014ms (Views: 0.4ms | ActiveRecord: 2.0ms)


D, [2018-09-12T22:21:34.721620 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:21:34.723578 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:21:34.732363 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:21:34 +0530
I, [2018-09-12T22:21:34.762376 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:21:34.762481 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:21:34.765597 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:21:34.767575 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T22:21:38.366000 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:21:38 +0530
I, [2018-09-12T22:21:38.397007 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:21:38.397108 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T22:21:38.400288 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:21:38.401991 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:21:38.403371 #11095] DEBUG -- :   [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:21:38.404995 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:21:38.406426 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:21:38.407267 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:21:38.407828 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:21:38.409258 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:51:38.407000"], ["id", 1]]
D, [2018-09-12T22:21:38.412461 #11095] DEBUG -- :   [1m[35m (2.7ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:21:38.415847 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.8ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 08:51:38.413861')[0m
D, [2018-09-12T22:21:38.418578 #11095] DEBUG -- :   [1m[36mSetting Load (0.6ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:21:38.419374 #11095]  INFO -- : Completed 200 OK in 22ms (Views: 0.2ms | ActiveRecord: 6.9ms)


D, [2018-09-12T22:21:38.421549 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:21:38.423296 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:21:39.774405 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T22:21:39.778254 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:21:39.779012 #11095]  INFO -- : Completed 200 OK in 5016ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T22:21:39.779822 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:21:39.780437 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:21:39.784438 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:21:39 +0530
I, [2018-09-12T22:21:39.795150 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:21:39 +0530
I, [2018-09-12T22:21:39.807467 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:21:39.809050 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:21:39.809172 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
I, [2018-09-12T22:21:39.809315 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:21:39.813056 #11095] DEBUG -- :   [1m[35m (1.1ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:21:39.814183 #11095] DEBUG -- :   [1m[35m (1.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:21:39.815225 #11095] DEBUG -- :   [1m[35m (1.1ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:21:39.815914 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:21:39.817087 #11095] DEBUG -- :   [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:21:39.818587 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:21:39.819946 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:21:39.820712 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:21:39.821091 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:21:39.821567 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:21:39.822927 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:51:39.821000"], ["id", 1]]
D, [2018-09-12T22:21:39.826054 #11095] DEBUG -- :   [1m[35m (2.8ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:21:39.827313 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:21:39.828216 #11095] DEBUG -- :   [1m[36mChat Load (0.3ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T22:21:39.830019 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:49:39.829333')[0m  [["active", "t"]]
D, [2018-09-12T22:21:39.832308 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:21:39.833087 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:21:39.833707 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:21:39.834424 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:21:39.835339 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:49:39.834608')[0m  [["active", "t"]]
D, [2018-09-12T22:21:39.836595 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:49:39.835670')[0m  [["active", "t"]]
D, [2018-09-12T22:21:39.837516 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T22:21:39.838309 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:49:39.837688')[0m  [["active", "t"]]
D, [2018-09-12T22:21:39.838923 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:21:39.839764 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:21:39.842481 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:21:39.842894 #11095]  INFO -- : Completed 200 OK in 33ms (Views: 0.1ms | ActiveRecord: 10.4ms)


D, [2018-09-12T22:21:39.844352 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:21:39.845729 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:21:40.820327 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T22:21:40.828773 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:21:40.830112 #11095]  INFO -- : Completed 200 OK in 1020ms (Views: 4.9ms | ActiveRecord: 3.4ms)


D, [2018-09-12T22:21:40.833038 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:21:40.835741 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:21:40.848198 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:21:40 +0530
I, [2018-09-12T22:21:40.874196 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:21:40.874285 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:21:40.878630 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:21:40.881479 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:21:47.892939 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:21:47.894295 #11095]  INFO -- : Completed 200 OK in 7020ms (Views: 0.6ms | ActiveRecord: 2.9ms)


D, [2018-09-12T22:21:47.897073 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:21:47.899346 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:21:47.911154 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:21:47 +0530
I, [2018-09-12T22:21:47.938962 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:21:47.939053 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:21:47.941596 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:21:47.943141 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:21:54.955417 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:21:54.956954 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.7ms | ActiveRecord: 2.2ms)


D, [2018-09-12T22:21:54.959809 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:21:54.962105 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:21:54.973465 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:21:54 +0530
I, [2018-09-12T22:21:54.997699 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:21:54.997785 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:21:55.001049 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:21:55.002652 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:22:02.013363 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:22:02.014772 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.5ms | ActiveRecord: 2.0ms)


D, [2018-09-12T22:22:02.017586 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:22:02.019917 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:22:02.030630 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:22:02 +0530
I, [2018-09-12T22:22:02.062281 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:22:02.062420 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:22:02.065326 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:22:02.067099 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:22:09.077880 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:22:09.079331 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.5ms | ActiveRecord: 2.1ms)


D, [2018-09-12T22:22:09.082218 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:22:09.084654 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:22:09.094087 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:22:09 +0530
I, [2018-09-12T22:22:09.124373 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:22:09.124453 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:22:09.135325 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:22:09.137071 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:22:16.147302 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:22:16.148522 #11095]  INFO -- : Completed 200 OK in 7024ms (Views: 0.5ms | ActiveRecord: 2.0ms)


D, [2018-09-12T22:22:16.150933 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:22:16.152974 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:22:16.162123 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:22:16 +0530
I, [2018-09-12T22:22:16.193286 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:22:16.193375 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:22:16.195945 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:22:16.197671 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:22:23.208539 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:22:23.209888 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.6ms | ActiveRecord: 2.3ms)


D, [2018-09-12T22:22:23.212727 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:22:23.215000 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:22:23.224628 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:22:23 +0530
I, [2018-09-12T22:22:23.254817 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:22:23.254907 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:22:23.257593 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:22:23.259392 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:22:30.269922 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:22:30.272826 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.4ms | ActiveRecord: 2.3ms)


D, [2018-09-12T22:22:30.276168 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:22:30.278937 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:22:30.289373 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:22:30 +0530
I, [2018-09-12T22:22:30.313122 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:22:30.313213 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:22:30.315404 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:22:30.316822 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T22:22:33.364383 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:22:33 +0530
I, [2018-09-12T22:22:33.396347 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:22:33.396447 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T22:22:33.399439 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:22:33.400969 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:22:33.402210 #11095] DEBUG -- :   [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:22:33.404208 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:22:33.407467 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:22:33.408660 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:22:33.409292 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:22:33.410751 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:52:33.408000"], ["id", 1]]
D, [2018-09-12T22:22:33.413648 #11095] DEBUG -- :   [1m[35m (2.6ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:22:33.414762 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 08:52:33.414113')[0m
D, [2018-09-12T22:22:33.416856 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:22:33.417250 #11095]  INFO -- : Completed 200 OK in 21ms (Views: 0.2ms | ActiveRecord: 5.9ms)


D, [2018-09-12T22:22:33.418393 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:22:33.419439 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:22:35.322627 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T22:22:35.326889 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:22:35.328225 #11095]  INFO -- : Completed 200 OK in 5015ms (Views: 0.6ms | ActiveRecord: 2.0ms)


D, [2018-09-12T22:22:35.331054 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:22:35.333650 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:22:35.344831 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:22:35 +0530
I, [2018-09-12T22:22:35.375078 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:22:35 +0530
I, [2018-09-12T22:22:35.390113 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:22:35.390211 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
I, [2018-09-12T22:22:35.393809 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
D, [2018-09-12T22:22:35.394024 #11095] DEBUG -- :   [1m[35m (1.7ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
I, [2018-09-12T22:22:35.395024 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:22:35.396891 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:22:35.397922 #11095] DEBUG -- :   [1m[35m (1.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:22:35.398954 #11095] DEBUG -- :   [1m[36mUser Load (1.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:22:35.400683 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:22:35.401478 #11095] DEBUG -- :   [1m[35m (1.8ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:22:35.402075 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:22:35.402790 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:22:35.403182 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:22:35.403594 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:22:35.404877 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:52:35.403000"], ["id", 1]]
D, [2018-09-12T22:22:35.406078 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:22:35.407431 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:22:35.408336 #11095] DEBUG -- :   [1m[36mChat Load (0.3ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T22:22:35.410104 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:50:35.409427')[0m  [["active", "t"]]
D, [2018-09-12T22:22:35.412490 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:22:35.413231 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:22:35.413842 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.2ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:22:35.414545 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:22:35.415415 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:50:35.414703')[0m  [["active", "t"]]
D, [2018-09-12T22:22:35.416679 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:50:35.415684')[0m  [["active", "t"]]
D, [2018-09-12T22:22:35.417580 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T22:22:35.418303 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:50:35.417732')[0m  [["active", "t"]]
D, [2018-09-12T22:22:35.418852 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:22:35.419668 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:22:35.421832 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:22:35.422234 #11095]  INFO -- : Completed 200 OK in 32ms (Views: 0.1ms | ActiveRecord: 9.4ms)


D, [2018-09-12T22:22:35.423463 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:22:35.424209 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:22:36.406962 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T22:22:36.414268 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:22:36.415567 #11095]  INFO -- : Completed 200 OK in 1020ms (Views: 3.7ms | ActiveRecord: 4.0ms)


D, [2018-09-12T22:22:36.418270 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:22:36.420549 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:22:36.431438 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:22:36 +0530
I, [2018-09-12T22:22:36.464533 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:22:36.464642 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:22:36.467895 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:22:36.469736 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:22:43.481966 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:22:43.483359 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.5ms | ActiveRecord: 2.4ms)


D, [2018-09-12T22:22:43.486072 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:22:43.488556 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:22:43.499016 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:22:43 +0530
I, [2018-09-12T22:22:43.526203 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:22:43.526293 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:22:43.528971 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:22:43.530515 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:22:50.539467 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:22:50.540005 #11095]  INFO -- : Completed 200 OK in 7014ms (Views: 0.2ms | ActiveRecord: 1.4ms)


D, [2018-09-12T22:22:50.540859 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:22:50.541565 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:22:50.545396 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:22:50 +0530
I, [2018-09-12T22:22:50.558364 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:22:50.558448 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:22:50.560668 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:22:50.562160 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:22:57.574078 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:22:57.575438 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.5ms | ActiveRecord: 2.0ms)


D, [2018-09-12T22:22:57.578273 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:22:57.580609 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:22:57.590642 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:22:57 +0530
I, [2018-09-12T22:22:57.618986 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:22:57.619081 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:22:57.621781 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:22:57.623375 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:23:04.635010 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:23:04.636432 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.5ms | ActiveRecord: 2.0ms)


D, [2018-09-12T22:23:04.639173 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:23:04.641446 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:23:04.651945 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:23:04 +0530
I, [2018-09-12T22:23:04.681576 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:23:04.681685 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:23:04.684376 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:23:04.686350 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:23:11.698378 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:23:11.699812 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.5ms | ActiveRecord: 2.3ms)


D, [2018-09-12T22:23:11.702554 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:23:11.704824 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:23:11.712620 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:23:11 +0530
I, [2018-09-12T22:23:11.725567 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:23:11.725666 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:23:11.727939 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:23:11.730019 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:23:18.741413 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:23:18.742745 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.5ms | ActiveRecord: 2.3ms)


D, [2018-09-12T22:23:18.745487 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:23:18.747758 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:23:18.757593 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:23:18 +0530
I, [2018-09-12T22:23:18.788075 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:23:18.788182 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:23:18.791077 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:23:18.792853 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:23:25.803380 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:23:25.804785 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.5ms | ActiveRecord: 2.0ms)


D, [2018-09-12T22:23:25.807320 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:23:25.809356 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:23:25.819436 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:23:25 +0530
I, [2018-09-12T22:23:25.849264 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:23:25.849352 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:23:25.852009 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:23:25.853782 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T22:23:28.364113 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:23:28 +0530
I, [2018-09-12T22:23:28.380613 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:23:28.380717 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T22:23:28.382956 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:23:28.384471 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:23:28.385811 #11095] DEBUG -- :   [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:23:28.387362 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:23:28.388784 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:23:28.389594 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:23:28.390218 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:23:28.391792 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:53:28.389000"], ["id", 1]]
D, [2018-09-12T22:23:28.393068 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:23:28.394476 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 08:53:28.393597')[0m
D, [2018-09-12T22:23:28.396570 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:23:28.397015 #11095]  INFO -- : Completed 200 OK in 16ms (Views: 0.1ms | ActiveRecord: 4.1ms)


D, [2018-09-12T22:23:28.398349 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:23:28.399453 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:23:28.859199 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T22:23:28.863256 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:23:28.864542 #11095]  INFO -- : Completed 200 OK in 3015ms (Views: 0.6ms | ActiveRecord: 2.2ms)


D, [2018-09-12T22:23:28.867269 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:23:28.869541 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:23:28.879705 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:23:28 +0530
I, [2018-09-12T22:23:28.911177 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:23:28 +0530
I, [2018-09-12T22:23:28.930120 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:23:28.930681 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
I, [2018-09-12T22:23:28.935660 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:23:28.935767 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:23:28.938363 #11095] DEBUG -- :   [1m[35m (4.8ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:23:28.940002 #11095] DEBUG -- :   [1m[35m (1.8ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:23:28.941649 #11095] DEBUG -- :   [1m[35m (1.8ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:23:28.943169 #11095] DEBUG -- :   [1m[35m (1.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:23:28.944098 #11095] DEBUG -- :   [1m[36mUser Load (1.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:23:28.946500 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:23:28.948685 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:23:28.949885 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.5ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:23:28.950541 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:23:28.951261 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:23:28.953961 #11095] DEBUG -- :   [1m[35mSQL (0.4ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:53:28.950000"], ["id", 1]]
D, [2018-09-12T22:23:28.964243 #11095] DEBUG -- :   [1m[35m (9.7ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:23:28.966636 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.6ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:23:28.968013 #11095] DEBUG -- :   [1m[36mChat Load (0.4ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T22:23:28.970816 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:51:28.969760')[0m  [["active", "t"]]
D, [2018-09-12T22:23:28.974338 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.4ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:23:28.975574 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:23:28.976563 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.4ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:23:28.977686 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:23:28.979057 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:51:28.977940')[0m  [["active", "t"]]
D, [2018-09-12T22:23:28.980281 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:51:28.979283')[0m  [["active", "t"]]
D, [2018-09-12T22:23:28.981975 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T22:23:28.983746 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.7ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:51:28.982238')[0m  [["active", "t"]]
D, [2018-09-12T22:23:28.984784 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:23:28.986225 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.4ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:23:28.990596 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:23:28.991279 #11095]  INFO -- : Completed 200 OK in 60ms (Views: 0.2ms | ActiveRecord: 25.5ms)


D, [2018-09-12T22:23:28.993266 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:23:28.994450 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:23:29.948837 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T22:23:29.955378 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:23:29.955849 #11095]  INFO -- : Completed 200 OK in 1020ms (Views: 4.1ms | ActiveRecord: 3.9ms)


D, [2018-09-12T22:23:29.956728 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:23:29.957421 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:23:29.961409 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:23:29 +0530
I, [2018-09-12T22:23:29.975764 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:23:29.975839 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:23:29.978309 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:23:29.980087 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:23:36.990988 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:23:36.993048 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.5ms | ActiveRecord: 2.0ms)


D, [2018-09-12T22:23:36.996645 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:23:36.999407 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:23:37.008997 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:23:37 +0530
I, [2018-09-12T22:23:37.041539 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:23:37.041652 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:23:37.045707 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:23:37.047575 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:23:44.058358 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:23:44.059876 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.4ms | ActiveRecord: 2.2ms)


D, [2018-09-12T22:23:44.063201 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:23:44.065271 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:23:44.074349 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:23:44 +0530
I, [2018-09-12T22:23:44.098070 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:23:44.098166 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:23:44.100594 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:23:44.102038 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:23:51.111715 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:23:51.112931 #11095]  INFO -- : Completed 200 OK in 7014ms (Views: 0.4ms | ActiveRecord: 1.8ms)


D, [2018-09-12T22:23:51.115431 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:23:51.116908 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:23:51.120483 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:23:51 +0530
I, [2018-09-12T22:23:51.131511 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:23:51.131576 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:23:51.133510 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:23:51.134789 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:23:58.143853 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:23:58.145221 #11095]  INFO -- : Completed 200 OK in 7013ms (Views: 0.5ms | ActiveRecord: 1.8ms)


D, [2018-09-12T22:23:58.147845 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:23:58.149880 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:23:58.158552 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:23:58 +0530
I, [2018-09-12T22:23:58.184204 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:23:58.184308 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:23:58.187035 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:23:58.195906 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:24:05.208112 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:24:05.209475 #11095]  INFO -- : Completed 200 OK in 7025ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T22:24:05.212272 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:24:05.215135 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:24:05.225637 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:24:05 +0530
I, [2018-09-12T22:24:05.255850 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:24:05.255948 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:24:05.258634 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:24:05.260405 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:24:12.270701 #11095] DEBUG -- :   [1m[36mSetting Load (0.9ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:24:12.271893 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.4ms | ActiveRecord: 1.9ms)


D, [2018-09-12T22:24:12.273225 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:24:12.274112 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:24:12.277297 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:24:12 +0530
I, [2018-09-12T22:24:12.288819 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:24:12.288885 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:24:12.290945 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:24:12.292301 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:24:19.303731 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:24:19.305194 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.5ms | ActiveRecord: 2.0ms)


D, [2018-09-12T22:24:19.307828 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:24:19.311198 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:24:19.321206 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:24:19 +0530
I, [2018-09-12T22:24:19.351713 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:24:19.351823 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:24:19.354783 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:24:19.356928 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T22:24:23.362451 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:24:23 +0530
I, [2018-09-12T22:24:23.376060 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:24:23.376143 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T22:24:23.378370 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:24:23.379815 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:24:23.381085 #11095] DEBUG -- :   [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:24:23.382611 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:24:23.383983 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:24:23.384796 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:24:23.385348 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:24:23.386780 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:54:23.384000"], ["id", 1]]
D, [2018-09-12T22:24:23.389789 #11095] DEBUG -- :   [1m[35m (2.7ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:24:23.391093 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 08:54:23.390251')[0m
D, [2018-09-12T22:24:23.393180 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:24:23.393703 #11095]  INFO -- : Completed 200 OK in 17ms (Views: 0.1ms | ActiveRecord: 6.0ms)


D, [2018-09-12T22:24:23.395112 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:24:23.396391 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:24:24.362954 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T22:24:24.365725 #11095] DEBUG -- :   [1m[36mSetting Load (0.8ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:24:24.366996 #11095]  INFO -- : Completed 200 OK in 5015ms (Views: 0.3ms | ActiveRecord: 2.0ms)


D, [2018-09-12T22:24:24.369780 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:24:24.371210 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:24:24.376489 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:24:24 +0530
I, [2018-09-12T22:24:24.393055 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:24:24 +0530
I, [2018-09-12T22:24:24.410909 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:24:24.411047 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
I, [2018-09-12T22:24:24.416500 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:24:24.416616 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:24:24.419182 #11095] DEBUG -- :   [1m[35m (4.9ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:24:24.420927 #11095] DEBUG -- :   [1m[35m (1.9ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:24:24.422560 #11095] DEBUG -- :   [1m[35m (1.8ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:24:24.424657 #11095] DEBUG -- :   [1m[35m (2.2ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:24:24.425605 #11095] DEBUG -- :   [1m[36mUser Load (1.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:24:24.428225 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:24:24.430381 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:24:24.431517 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:24:24.432107 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:24:24.432841 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:24:24.434909 #11095] DEBUG -- :   [1m[35mSQL (0.4ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:54:24.432000"], ["id", 1]]
D, [2018-09-12T22:24:24.438245 #11095] DEBUG -- :   [1m[35m (2.9ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:24:24.440213 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.5ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:24:24.441562 #11095] DEBUG -- :   [1m[36mChat Load (0.4ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T22:24:24.444344 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:52:24.443311')[0m  [["active", "t"]]
D, [2018-09-12T22:24:24.447911 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.4ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:24:24.449048 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:24:24.450057 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.4ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:24:24.451197 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:24:24.452615 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:52:24.451452')[0m  [["active", "t"]]
D, [2018-09-12T22:24:24.453855 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:52:24.452862')[0m  [["active", "t"]]
D, [2018-09-12T22:24:24.455568 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T22:24:24.456667 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:52:24.455785')[0m  [["active", "t"]]
D, [2018-09-12T22:24:24.457437 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:24:24.458539 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.4ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:24:24.461148 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:24:24.461558 #11095]  INFO -- : Completed 200 OK in 50ms (Views: 0.1ms | ActiveRecord: 17.8ms)


D, [2018-09-12T22:24:24.462789 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:24:24.464581 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:24:25.430273 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T22:24:25.433639 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:24:25.434116 #11095]  INFO -- : Completed 200 OK in 1017ms (Views: 1.9ms | ActiveRecord: 4.6ms)


D, [2018-09-12T22:24:25.435195 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:24:25.436145 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:24:25.441638 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:24:25 +0530
I, [2018-09-12T22:24:25.459555 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:24:25.459660 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:24:25.463757 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:24:25.465699 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:24:32.477537 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:24:32.478640 #11095]  INFO -- : Completed 200 OK in 7019ms (Views: 0.5ms | ActiveRecord: 2.5ms)


D, [2018-09-12T22:24:32.479620 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:24:32.480388 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:24:32.484418 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:24:32 +0530
I, [2018-09-12T22:24:32.499313 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:24:32.499400 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:24:32.502108 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:24:32.503933 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:24:39.516038 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:24:39.517392 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.5ms | ActiveRecord: 2.4ms)


D, [2018-09-12T22:24:39.520254 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:24:39.522529 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:24:39.534040 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:24:39 +0530
I, [2018-09-12T22:24:39.564915 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:24:39.565021 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:24:39.567923 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:24:39.569659 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:24:46.581629 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:24:46.583013 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T22:24:46.585763 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:24:46.589150 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:24:46.599855 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:24:46 +0530
I, [2018-09-12T22:24:46.616296 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:24:46.616370 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:24:46.618656 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:24:46.620196 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:24:53.631749 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:24:53.633133 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.5ms | ActiveRecord: 2.1ms)


D, [2018-09-12T22:24:53.635965 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:24:53.638580 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:24:53.649098 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:24:53 +0530
I, [2018-09-12T22:24:53.678608 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:24:53.678719 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:24:53.681489 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:24:53.683257 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:25:00.695454 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:25:00.696874 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T22:25:00.699564 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:25:00.700776 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:25:00.704730 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:25:00 +0530
I, [2018-09-12T22:25:00.718823 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:25:00.718905 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:25:00.721383 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:25:00.723001 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:25:07.734458 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:25:07.735831 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.4ms | ActiveRecord: 1.9ms)


D, [2018-09-12T22:25:07.738380 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:25:07.741038 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:25:07.750216 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:25:07 +0530
I, [2018-09-12T22:25:07.779426 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:25:07.779632 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:25:07.782590 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:25:07.784338 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:25:14.794394 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:25:14.795697 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.4ms | ActiveRecord: 2.2ms)


D, [2018-09-12T22:25:14.798206 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:25:14.800260 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:25:14.809771 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:25:14 +0530
I, [2018-09-12T22:25:14.839231 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:25:14.839362 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:25:14.842356 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:25:14.844077 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T22:25:18.361663 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:25:18 +0530
I, [2018-09-12T22:25:18.372293 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:25:18.372361 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T22:25:18.374524 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:25:18.375808 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:25:18.376943 #11095] DEBUG -- :   [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:25:18.378216 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:25:18.379357 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:25:18.380042 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:25:18.380529 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:25:18.381708 #11095] DEBUG -- :   [1m[35mSQL (0.2ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:55:18.380000"], ["id", 1]]
D, [2018-09-12T22:25:18.382816 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:25:18.383775 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 08:55:18.383189')[0m
D, [2018-09-12T22:25:18.384999 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:25:18.385340 #11095]  INFO -- : Completed 200 OK in 13ms (Views: 0.1ms | ActiveRecord: 3.7ms)


D, [2018-09-12T22:25:18.386403 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:25:18.387031 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:25:19.852041 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T22:25:19.857326 #11095] DEBUG -- :   [1m[36mSetting Load (1.6ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:25:19.858719 #11095]  INFO -- : Completed 200 OK in 5019ms (Views: 0.7ms | ActiveRecord: 2.6ms)


D, [2018-09-12T22:25:19.862054 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:25:19.864568 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:25:19.878191 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:25:19 +0530
I, [2018-09-12T22:25:19.899016 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:25:19 +0530
I, [2018-09-12T22:25:19.914080 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:25:19.914176 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
I, [2018-09-12T22:25:19.918158 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:25:19.918257 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:25:19.920387 #11095] DEBUG -- :   [1m[35m (4.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:25:19.921715 #11095] DEBUG -- :   [1m[35m (1.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:25:19.922985 #11095] DEBUG -- :   [1m[35m (1.4ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:25:19.924192 #11095] DEBUG -- :   [1m[35m (1.3ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:25:19.924958 #11095] DEBUG -- :   [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:25:19.926950 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:25:19.928640 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:25:19.929467 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:25:19.929970 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:25:19.930425 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:25:19.932007 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:55:19.930000"], ["id", 1]]
D, [2018-09-12T22:25:19.935214 #11095] DEBUG -- :   [1m[35m (2.7ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:25:19.938595 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.7ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:25:19.940860 #11095] DEBUG -- :   [1m[36mChat Load (0.6ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T22:25:19.945091 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:53:19.943868')[0m  [["active", "t"]]
D, [2018-09-12T22:25:19.949700 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.4ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:25:19.950770 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:25:19.951584 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:25:19.952529 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:25:19.953755 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:53:19.952795')[0m  [["active", "t"]]
D, [2018-09-12T22:25:19.954575 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:53:19.953918')[0m  [["active", "t"]]
D, [2018-09-12T22:25:19.955516 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T22:25:19.956379 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:53:19.955699')[0m  [["active", "t"]]
D, [2018-09-12T22:25:19.956997 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:25:19.957947 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:25:19.960332 #11095] DEBUG -- :   [1m[36mSetting Load (0.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:25:19.960706 #11095]  INFO -- : Completed 200 OK in 46ms (Views: 0.1ms | ActiveRecord: 14.9ms)


D, [2018-09-12T22:25:19.961810 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:25:19.962525 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:25:20.929433 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T22:25:20.933210 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:25:20.933658 #11095]  INFO -- : Completed 200 OK in 1015ms (Views: 2.2ms | ActiveRecord: 3.2ms)


D, [2018-09-12T22:25:20.934644 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:25:20.935515 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:25:20.943647 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:25:20 +0530
I, [2018-09-12T22:25:20.965159 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:25:20.965286 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:25:20.969277 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:25:20.971898 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:25:27.983642 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:25:27.984979 #11095]  INFO -- : Completed 200 OK in 7019ms (Views: 0.5ms | ActiveRecord: 2.8ms)


D, [2018-09-12T22:25:27.987729 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:25:27.989167 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:25:27.993420 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:25:27 +0530
I, [2018-09-12T22:25:28.008262 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:25:28.008348 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:25:28.011032 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:25:28.012848 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:25:35.023058 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:25:35.024929 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.4ms | ActiveRecord: 2.3ms)


D, [2018-09-12T22:25:35.027636 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:25:35.030286 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:25:35.039789 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:25:35 +0530
I, [2018-09-12T22:25:35.066018 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:25:35.066106 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:25:35.068620 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:25:35.070300 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:25:42.081701 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:25:42.084602 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T22:25:42.089568 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:25:42.092590 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:25:42.106495 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:25:42 +0530
I, [2018-09-12T22:25:42.164606 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:25:42.164752 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:25:42.170843 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:25:42.173649 #11095] DEBUG -- :   [1m[35m (1.1ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:25:49.184446 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:25:49.185890 #11095]  INFO -- : Completed 200 OK in 7021ms (Views: 0.5ms | ActiveRecord: 3.1ms)


D, [2018-09-12T22:25:49.188709 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:25:49.191147 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:25:49.201783 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:25:49 +0530
I, [2018-09-12T22:25:49.233115 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:25:49.233228 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:25:49.236404 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:25:49.247574 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:25:56.257148 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:25:56.258399 #11095]  INFO -- : Completed 200 OK in 7025ms (Views: 0.6ms | ActiveRecord: 2.1ms)


D, [2018-09-12T22:25:56.260974 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:25:56.263132 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:25:56.271966 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:25:56 +0530
I, [2018-09-12T22:25:56.305639 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:25:56.305740 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:25:56.308822 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:25:56.311018 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:26:03.319215 #11095] DEBUG -- :   [1m[36mSetting Load (0.8ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:26:03.321341 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.2ms | ActiveRecord: 1.9ms)


D, [2018-09-12T22:26:03.322930 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:26:03.324314 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:26:03.328851 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:26:03 +0530
I, [2018-09-12T22:26:03.343708 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:26:03.343782 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:26:03.345988 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:26:03.347590 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:26:10.359377 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:26:10.360987 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.4ms | ActiveRecord: 2.3ms)


D, [2018-09-12T22:26:10.363840 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:26:10.365788 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:26:10.375086 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:26:10 +0530
I, [2018-09-12T22:26:10.404327 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:26:10.404425 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:26:10.407182 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:26:10.408862 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T22:26:13.361362 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:26:13 +0530
I, [2018-09-12T22:26:13.388219 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:26:13.388526 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T22:26:13.392209 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:26:13.395139 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:26:13.397326 #11095] DEBUG -- :   [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:26:13.400448 #11095] DEBUG -- :   [1m[35mCACHE  (0.1ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:26:13.402789 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:26:13.404279 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:26:13.405401 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:26:13.408892 #11095] DEBUG -- :   [1m[35mSQL (0.7ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:56:13.404000"], ["id", 1]]
D, [2018-09-12T22:26:13.411998 #11095] DEBUG -- :   [1m[35m (1.4ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:26:13.414069 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 08:56:13.412885')[0m
D, [2018-09-12T22:26:13.416488 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:26:13.419702 #11095]  INFO -- : Completed 200 OK in 29ms (Views: 0.2ms | ActiveRecord: 6.3ms)


D, [2018-09-12T22:26:13.423992 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:26:13.425513 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:26:15.414349 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T22:26:15.419126 #11095] DEBUG -- :   [1m[36mSetting Load (1.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:26:15.420805 #11095]  INFO -- : Completed 200 OK in 5016ms (Views: 0.6ms | ActiveRecord: 2.2ms)


D, [2018-09-12T22:26:15.424165 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:26:15.428776 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:26:15.449708 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:26:15 +0530
I, [2018-09-12T22:26:15.483348 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:26:15 +0530
I, [2018-09-12T22:26:15.511357 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:26:15.512634 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
I, [2018-09-12T22:26:15.522621 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:26:15.522908 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:26:15.524323 #11095] DEBUG -- :   [1m[35m (1.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:26:15.527846 #11095] DEBUG -- :   [1m[35m (1.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:26:15.530512 #11095] DEBUG -- :   [1m[35m (3.0ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:26:15.532187 #11095] DEBUG -- :   [1m[35m (2.2ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:26:15.532857 #11095] DEBUG -- :   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:26:15.534646 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:26:15.537838 #11095] DEBUG -- :   [1m[35m (1.1ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:26:15.538948 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:26:15.540058 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.1ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:26:15.540664 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:26:15.542340 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:56:15.540000"], ["id", 1]]
D, [2018-09-12T22:26:15.543819 #11095] DEBUG -- :   [1m[35m (1.0ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:26:15.545930 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.5ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:26:15.547243 #11095] DEBUG -- :   [1m[36mChat Load (0.3ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T22:26:15.549232 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:54:15.548518')[0m  [["active", "t"]]
D, [2018-09-12T22:26:15.551607 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.2ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:26:15.553069 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:26:15.554873 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.5ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:26:15.555890 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:26:15.557020 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:54:15.556123')[0m  [["active", "t"]]
D, [2018-09-12T22:26:15.558461 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.5ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:54:15.557224')[0m  [["active", "t"]]
D, [2018-09-12T22:26:15.560104 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T22:26:15.561807 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:54:15.560573')[0m  [["active", "t"]]
D, [2018-09-12T22:26:15.562560 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:26:15.563577 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:26:15.566662 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:26:15.567168 #11095]  INFO -- : Completed 200 OK in 54ms (Views: 0.1ms | ActiveRecord: 14.0ms)


D, [2018-09-12T22:26:15.568985 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:26:15.570827 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:26:16.537495 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T22:26:16.544716 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:26:16.545994 #11095]  INFO -- : Completed 200 OK in 1023ms (Views: 3.6ms | ActiveRecord: 5.0ms)


D, [2018-09-12T22:26:16.548852 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:26:16.551247 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:26:16.563661 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:26:16 +0530
I, [2018-09-12T22:26:16.588922 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:26:16.589009 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:26:16.591331 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:26:16.592819 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:26:23.602958 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:26:23.604546 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.5ms | ActiveRecord: 1.9ms)


D, [2018-09-12T22:26:23.607121 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:26:23.609140 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:26:23.617766 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:26:23 +0530
I, [2018-09-12T22:26:23.645968 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:26:23.646056 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:26:23.648717 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:26:23.650455 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:26:30.660845 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:26:30.662062 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.4ms | ActiveRecord: 2.1ms)


D, [2018-09-12T22:26:30.664631 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:26:30.666542 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:26:30.675681 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:26:30 +0530
I, [2018-09-12T22:26:30.708029 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:26:30.708133 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:26:30.711123 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:26:30.712934 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:26:37.722655 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:26:37.723985 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.5ms | ActiveRecord: 2.1ms)


D, [2018-09-12T22:26:37.726624 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:26:37.727850 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:26:37.734905 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:26:37 +0530
I, [2018-09-12T22:26:37.750518 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:26:37.750599 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:26:37.753178 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:26:37.755220 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:26:44.764317 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:26:44.765652 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T22:26:44.768541 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:26:44.771115 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:26:44.782223 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:26:44 +0530
I, [2018-09-12T22:26:44.810092 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:26:44.810186 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:26:44.812927 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:26:44.814596 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:26:51.826252 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:26:51.827634 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.5ms | ActiveRecord: 2.3ms)


D, [2018-09-12T22:26:51.830359 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:26:51.832657 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:26:51.842631 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:26:51 +0530
I, [2018-09-12T22:26:51.870593 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:26:51.870684 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:26:51.873405 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:26:51.875108 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:26:58.886902 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:26:58.889023 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.5ms | ActiveRecord: 2.3ms)


D, [2018-09-12T22:26:58.893101 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:26:58.896115 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:26:58.913414 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:26:58 +0530
I, [2018-09-12T22:26:58.934061 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:26:58.934133 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:26:58.936266 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:26:58.938602 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:27:05.948721 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:27:05.949896 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.4ms | ActiveRecord: 2.4ms)


D, [2018-09-12T22:27:05.952255 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:27:05.954304 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:27:05.963314 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:27:05 +0530
I, [2018-09-12T22:27:05.989454 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:27:05.989551 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:27:05.992368 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:27:05.993799 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T22:27:08.365298 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:27:08 +0530
I, [2018-09-12T22:27:08.399343 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:27:08.399470 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T22:27:08.403011 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:27:08.405326 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:27:08.407221 #11095] DEBUG -- :   [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:27:08.409647 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:27:08.411753 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:27:08.413001 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:27:08.413798 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:27:08.415767 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:57:08.413000"], ["id", 1]]
D, [2018-09-12T22:27:08.418786 #11095] DEBUG -- :   [1m[35m (2.5ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:27:08.420470 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 08:57:08.419521')[0m
D, [2018-09-12T22:27:08.422530 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:27:08.423149 #11095]  INFO -- : Completed 200 OK in 23ms (Views: 0.2ms | ActiveRecord: 6.8ms)


D, [2018-09-12T22:27:08.424995 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:27:08.426200 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:27:08.998747 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T22:27:09.002703 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:27:09.004123 #11095]  INFO -- : Completed 200 OK in 3014ms (Views: 0.5ms | ActiveRecord: 2.0ms)


D, [2018-09-12T22:27:09.006785 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:27:09.009141 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:27:09.017465 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:27:09 +0530
I, [2018-09-12T22:27:09.029259 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:27:09 +0530
I, [2018-09-12T22:27:09.044432 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:27:09.046222 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:27:09.046365 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
I, [2018-09-12T22:27:09.046455 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:27:09.049428 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:27:09.051772 #11095] DEBUG -- :   [1m[35m (1.1ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:27:09.052840 #11095] DEBUG -- :   [1m[35m (1.2ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:27:09.053600 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:27:09.054800 #11095] DEBUG -- :   [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:27:09.056175 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:27:09.057447 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:27:09.058119 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:27:09.058524 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:27:09.058886 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:27:09.060607 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:57:09.058000"], ["id", 1]]
D, [2018-09-12T22:27:09.067521 #11095] DEBUG -- :   [1m[35m (6.6ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:27:09.068567 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.2ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:27:09.069251 #11095] DEBUG -- :   [1m[36mChat Load (0.2ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T22:27:09.070687 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:55:09.070196')[0m  [["active", "t"]]
D, [2018-09-12T22:27:09.072557 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.2ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:27:09.073107 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:27:09.073527 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.1ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:27:09.074053 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:27:09.074682 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:55:09.074173')[0m  [["active", "t"]]
D, [2018-09-12T22:27:09.075209 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:55:09.074790')[0m  [["active", "t"]]
D, [2018-09-12T22:27:09.075856 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T22:27:09.076421 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:55:09.075976')[0m  [["active", "t"]]
D, [2018-09-12T22:27:09.076835 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.1ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:27:09.077466 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.2ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:27:09.079265 #11095] DEBUG -- :   [1m[36mSetting Load (0.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:27:09.079608 #11095]  INFO -- : Completed 200 OK in 33ms (Views: 0.1ms | ActiveRecord: 12.3ms)


D, [2018-09-12T22:27:09.080514 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:27:09.081555 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:27:10.057785 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T22:27:10.061771 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:27:10.062220 #11095]  INFO -- : Completed 200 OK in 1015ms (Views: 2.4ms | ActiveRecord: 2.2ms)


D, [2018-09-12T22:27:10.063171 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:27:10.064090 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:27:10.069071 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:27:10 +0530
I, [2018-09-12T22:27:10.084222 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:27:10.084309 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:27:10.087938 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:27:10.090340 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:27:17.101082 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:27:17.102446 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.5ms | ActiveRecord: 2.7ms)


D, [2018-09-12T22:27:17.105188 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:27:17.107512 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:27:17.117456 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:27:17 +0530
I, [2018-09-12T22:27:17.148151 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:27:17.148274 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:27:17.150942 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:27:17.152746 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:27:24.165620 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:27:24.167038 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T22:27:24.170219 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:27:24.173250 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:27:24.184253 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:27:24 +0530
I, [2018-09-12T22:27:24.211536 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:27:24.211629 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:27:24.214397 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:27:24.215944 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:27:31.226797 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:27:31.228057 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.5ms | ActiveRecord: 2.0ms)


D, [2018-09-12T22:27:31.230517 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:27:31.232579 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:27:31.243130 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:27:31 +0530
I, [2018-09-12T22:27:31.273954 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:27:31.274059 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:27:31.277000 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:27:31.279138 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:27:38.289650 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:27:38.291103 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.6ms | ActiveRecord: 2.2ms)


D, [2018-09-12T22:27:38.294554 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:27:38.296955 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:27:38.309168 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:27:38 +0530
I, [2018-09-12T22:27:38.342116 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:27:38.342254 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:27:38.345999 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:27:38.348134 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:27:45.364350 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:27:45.365803 #11095]  INFO -- : Completed 200 OK in 7023ms (Views: 0.5ms | ActiveRecord: 2.6ms)


D, [2018-09-12T22:27:45.368467 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:27:45.370550 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:27:45.379396 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:27:45 +0530
I, [2018-09-12T22:27:45.407138 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:27:45.407247 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:27:45.410163 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:27:45.411920 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:27:52.427725 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:27:52.429710 #11095]  INFO -- : Completed 200 OK in 7022ms (Views: 0.5ms | ActiveRecord: 2.3ms)


D, [2018-09-12T22:27:52.432517 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:27:52.434644 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:27:52.442231 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:27:52 +0530
I, [2018-09-12T22:27:52.461923 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:27:52.461999 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:27:52.464446 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:27:52.466038 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:27:59.475858 #11095] DEBUG -- :   [1m[36mSetting Load (0.8ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:27:59.477012 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.4ms | ActiveRecord: 1.8ms)


D, [2018-09-12T22:27:59.478554 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:27:59.480053 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:27:59.483834 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:27:59 +0530
I, [2018-09-12T22:27:59.498692 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:27:59.498782 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:27:59.501691 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:27:59.504001 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T22:28:03.363810 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:28:03 +0530
I, [2018-09-12T22:28:03.396245 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:28:03.396345 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T22:28:03.399125 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:28:03.400673 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:28:03.402064 #11095] DEBUG -- :   [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:28:03.403819 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:28:03.405256 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:28:03.406008 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:28:03.406479 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:28:03.407743 #11095] DEBUG -- :   [1m[35mSQL (0.2ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:58:03.406000"], ["id", 1]]
D, [2018-09-12T22:28:03.410996 #11095] DEBUG -- :   [1m[35m (2.7ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:28:03.414311 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.6ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 08:58:03.412465')[0m
D, [2018-09-12T22:28:03.416992 #11095] DEBUG -- :   [1m[36mSetting Load (0.6ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:28:03.417774 #11095]  INFO -- : Completed 200 OK in 21ms (Views: 0.2ms | ActiveRecord: 6.4ms)


D, [2018-09-12T22:28:03.419946 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:28:03.423032 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:28:04.511738 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T22:28:04.515206 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:28:04.516921 #11095]  INFO -- : Completed 200 OK in 5018ms (Views: 0.5ms | ActiveRecord: 2.1ms)


D, [2018-09-12T22:28:04.519689 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:28:04.521636 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:28:04.533218 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:28:04 +0530
I, [2018-09-12T22:28:04.557464 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:28:04 +0530
I, [2018-09-12T22:28:04.571813 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:28:04.573084 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:28:04.573163 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
I, [2018-09-12T22:28:04.573353 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:28:04.576268 #11095] DEBUG -- :   [1m[35m (1.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:28:04.577185 #11095] DEBUG -- :   [1m[35m (1.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:28:04.577936 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:28:04.578723 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:28:04.579163 #11095] DEBUG -- :   [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:28:04.580454 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:28:04.581614 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:28:04.582231 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:28:04.582569 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:28:04.582926 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:28:04.584168 #11095] DEBUG -- :   [1m[35mSQL (0.2ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:58:04.582000"], ["id", 1]]
D, [2018-09-12T22:28:04.585241 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:28:04.586294 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.2ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:28:04.586982 #11095] DEBUG -- :   [1m[36mChat Load (0.2ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T22:28:04.588457 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:56:04.587940')[0m  [["active", "t"]]
D, [2018-09-12T22:28:04.590342 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.2ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:28:04.590873 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:28:04.591293 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.1ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:28:04.591813 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:28:04.592398 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:56:04.591933')[0m  [["active", "t"]]
D, [2018-09-12T22:28:04.592906 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.1ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:56:04.592522')[0m  [["active", "t"]]
D, [2018-09-12T22:28:04.593486 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T22:28:04.594022 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.1ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:56:04.593604')[0m  [["active", "t"]]
D, [2018-09-12T22:28:04.594397 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.1ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:28:04.594985 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.2ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:28:04.597067 #11095] DEBUG -- :   [1m[36mSetting Load (0.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:28:04.597396 #11095]  INFO -- : Completed 200 OK in 24ms (Views: 0.1ms | ActiveRecord: 6.3ms)


D, [2018-09-12T22:28:04.598277 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:28:04.598871 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:28:05.582733 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T22:28:05.589283 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:28:05.590410 #11095]  INFO -- : Completed 200 OK in 1017ms (Views: 3.3ms | ActiveRecord: 2.9ms)


D, [2018-09-12T22:28:05.592833 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:28:05.594863 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:28:05.605214 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:28:05 +0530
I, [2018-09-12T22:28:05.633057 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:28:05.633162 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:28:05.635866 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:28:05.637689 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:28:12.648243 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:28:12.649695 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.4ms | ActiveRecord: 2.1ms)


D, [2018-09-12T22:28:12.652787 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:28:12.656024 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:28:12.666446 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:28:12 +0530
I, [2018-09-12T22:28:12.694451 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:28:12.694535 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:28:12.697513 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:28:12.700009 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:28:19.711902 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:28:19.713453 #11095]  INFO -- : Completed 200 OK in 7019ms (Views: 0.6ms | ActiveRecord: 2.6ms)


D, [2018-09-12T22:28:19.716462 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:28:19.718922 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:28:19.729942 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:28:19 +0530
I, [2018-09-12T22:28:19.756706 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:28:19.756798 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:28:19.759315 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:28:19.760838 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:28:26.773077 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:28:26.774489 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T22:28:26.777257 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:28:26.779683 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:28:26.790391 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:28:26 +0530
I, [2018-09-12T22:28:26.820521 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:28:26.820660 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:28:26.824479 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:28:26.827268 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:28:33.840009 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:28:33.841413 #11095]  INFO -- : Completed 200 OK in 7020ms (Views: 0.5ms | ActiveRecord: 2.6ms)


D, [2018-09-12T22:28:33.844340 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:28:33.846597 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:28:33.856691 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:28:33 +0530
I, [2018-09-12T22:28:33.882482 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:28:33.882573 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:28:33.884922 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:28:33.886439 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:28:40.897899 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:28:40.899281 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.5ms | ActiveRecord: 2.0ms)


D, [2018-09-12T22:28:40.902043 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:28:40.904376 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:28:40.914277 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:28:40 +0530
I, [2018-09-12T22:28:40.943958 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:28:40.944061 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:28:40.946776 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:28:40.948647 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:28:47.959683 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:28:47.960921 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.4ms | ActiveRecord: 2.1ms)


D, [2018-09-12T22:28:47.963328 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:28:47.965361 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:28:47.975223 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:28:47 +0530
I, [2018-09-12T22:28:48.006493 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:28:48.006595 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:28:48.009716 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:28:48.011863 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:28:55.024430 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:28:55.025816 #11095]  INFO -- : Completed 200 OK in 7019ms (Views: 0.6ms | ActiveRecord: 2.5ms)


D, [2018-09-12T22:28:55.028648 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:28:55.030044 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:28:55.033837 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:28:55 +0530
I, [2018-09-12T22:28:55.047917 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:28:55.048000 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:28:55.050476 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:28:55.052120 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T22:28:58.364348 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:28:58 +0530
I, [2018-09-12T22:28:58.378101 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:28:58.378205 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T22:28:58.380497 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:28:58.382037 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:28:58.383397 #11095] DEBUG -- :   [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:28:58.385195 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:28:58.387128 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:28:58.388210 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:28:58.389018 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:28:58.391021 #11095] DEBUG -- :   [1m[35mSQL (0.4ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:58:58.388000"], ["id", 1]]
D, [2018-09-12T22:28:58.392213 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:28:58.393563 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 08:58:58.392730')[0m
D, [2018-09-12T22:28:58.395190 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:28:58.395821 #11095]  INFO -- : Completed 200 OK in 17ms (Views: 0.1ms | ActiveRecord: 4.5ms)


D, [2018-09-12T22:28:58.397252 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:28:58.398325 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:29:00.061050 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T22:29:00.065061 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:29:00.066362 #11095]  INFO -- : Completed 200 OK in 5018ms (Views: 0.6ms | ActiveRecord: 2.0ms)


D, [2018-09-12T22:29:00.069037 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:29:00.071398 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:29:00.079244 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:29:00 +0530
I, [2018-09-12T22:29:00.091392 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:29:00 +0530
I, [2018-09-12T22:29:00.104650 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:29:00.105029 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
I, [2018-09-12T22:29:00.108722 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
D, [2018-09-12T22:29:00.108909 #11095] DEBUG -- :   [1m[35m (1.8ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
I, [2018-09-12T22:29:00.109046 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:29:00.110810 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:29:00.113083 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:29:00.114160 #11095] DEBUG -- :   [1m[36mUser Load (1.2ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:29:00.115974 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:29:00.117419 #11095] DEBUG -- :   [1m[35m (3.3ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:29:00.118250 #11095] DEBUG -- :   [1m[35m (1.0ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:29:00.119304 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:29:00.119874 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:29:00.120347 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:29:00.122074 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:59:00.120000"], ["id", 1]]
D, [2018-09-12T22:29:00.125379 #11095] DEBUG -- :   [1m[35m (2.7ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:29:00.129897 #11095] DEBUG -- :   [1m[36mChat::Session Load (1.0ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:29:00.133324 #11095] DEBUG -- :   [1m[36mChat Load (0.9ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T22:29:00.140061 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.9ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:57:00.137783')[0m  [["active", "t"]]
D, [2018-09-12T22:29:00.146650 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.7ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:29:00.149051 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:29:00.150815 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.6ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:29:00.152671 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:29:00.155321 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:57:00.153080')[0m  [["active", "t"]]
D, [2018-09-12T22:29:00.158141 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.6ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:57:00.155918')[0m  [["active", "t"]]
D, [2018-09-12T22:29:00.160185 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T22:29:00.161903 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.5ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:57:00.160556')[0m  [["active", "t"]]
D, [2018-09-12T22:29:00.163176 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.5ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:29:00.165023 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.6ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:29:00.170070 #11095] DEBUG -- :   [1m[36mSetting Load (0.6ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:29:00.170970 #11095]  INFO -- : Completed 200 OK in 66ms (Views: 0.2ms | ActiveRecord: 18.0ms)


D, [2018-09-12T22:29:00.173541 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:29:00.175274 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:29:01.123650 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T22:29:01.126510 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:29:01.126984 #11095]  INFO -- : Completed 200 OK in 1017ms (Views: 1.4ms | ActiveRecord: 4.7ms)


D, [2018-09-12T22:29:01.127994 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:29:01.128773 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:29:01.134450 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:29:01 +0530
I, [2018-09-12T22:29:01.147546 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:29:01.147619 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:29:01.149890 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:29:01.151533 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:29:08.163471 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:29:08.164601 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T22:29:08.165450 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:29:08.166164 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:29:08.169986 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:29:08 +0530
I, [2018-09-12T22:29:08.182757 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:29:08.182830 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:29:08.185063 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:29:08.186540 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:29:15.197769 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:29:15.199096 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.4ms | ActiveRecord: 1.9ms)


D, [2018-09-12T22:29:15.201880 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:29:15.203910 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:29:15.213628 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:29:15 +0530
I, [2018-09-12T22:29:15.238805 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:29:15.238893 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:29:15.241285 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:29:15.242813 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:29:22.257092 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:29:22.258523 #11095]  INFO -- : Completed 200 OK in 7019ms (Views: 0.7ms | ActiveRecord: 2.1ms)


D, [2018-09-12T22:29:22.262184 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:29:22.264647 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:29:22.275668 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:29:22 +0530
I, [2018-09-12T22:29:22.298023 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:29:22.298101 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:29:22.300789 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:29:22.302598 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:29:29.313410 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:29:29.314818 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.4ms | ActiveRecord: 2.1ms)


D, [2018-09-12T22:29:29.317565 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:29:29.319870 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:29:29.329363 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:29:29 +0530
I, [2018-09-12T22:29:29.365674 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:29:29.365748 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:29:29.367957 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:29:29.369394 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:29:36.378717 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:29:36.380056 #11095]  INFO -- : Completed 200 OK in 7014ms (Views: 0.4ms | ActiveRecord: 1.8ms)


D, [2018-09-12T22:29:36.382740 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:29:36.385125 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:29:36.394642 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:29:36 +0530
I, [2018-09-12T22:29:36.429680 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:29:36.429781 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:29:36.433885 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:29:36.436247 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:29:36.437712 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:29:36.439521 #11095] DEBUG -- :   [1m[35mSQL (0.5ms)[0m  [1m[32mINSERT INTO "delayed_jobs" ("handler", "run_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["handler", "--- !ruby/object:Observer::UserDeviceLogJob\nhttp_user_agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko)\n  Chrome/68.0.3440.106 Safari/537.36\nremote_ip: \"::1\"\nuser_id: 3\nfingerprint: \"-1992429858\"\ntype: session\n"], ["run_at", "2018-09-12 16:59:36.437945"], ["created_at", "2018-09-12 16:59:36.438000"], ["updated_at", "2018-09-12 16:59:36.438000"]]
D, [2018-09-12T22:29:36.440909 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:29:43.452862 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:29:43.454817 #11095]  INFO -- : Completed 200 OK in 7025ms (Views: 0.6ms | ActiveRecord: 4.6ms)


D, [2018-09-12T22:29:43.459952 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:29:43.466864 #11095] DEBUG -- :   [1m[35mSQL (1.2ms)[0m  [1m[33mUPDATE "sessions" SET "data" = $1, "updated_at" = $2 WHERE "sessions"."id" = $3[0m  [["data", "BAh7D0kiCXBpbmcGOgZFRkkiGTIwMTgtMDktMTJUMTY6MDk6MjZaBjsAVEki\nD3VzZXJfYWdlbnQGOwBGIm5Nb3ppbGxhLzUuMCAoWDExOyBMaW51eCB4ODZf\nNjQpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENo\ncm9tZS82OC4wLjM0NDAuMTA2IFNhZmFyaS81MzcuMzZJIhBfY3NyZl90b2tl\nbgY7AEZJIjE1SzlmTEZWTnRwVFYydjArWGQ1M21QMjFWbDAzT1RSeEp2cUpm\nbitDRDUwPQY7AEZJIgx1c2VyX2lkBjsARmkISSIadXNlcl9kZXZpY2VfcmVt\nb3RlX2lwBjsARiIIOjoxSSIcdXNlcl9kZXZpY2VfZmluZ2VycHJpbnQGOwBG\nSSIQLTE5OTI0Mjk4NTgGOwBUSSIbdXNlcl9kZXZpY2VfdXBkYXRlZF9hdAY7\nAEZVOiBBY3RpdmVTdXBwb3J0OjpUaW1lV2l0aFpvbmVbCEl1OglUaW1lDZCh\nHcCYqUbuCToJem9uZUkiCFVUQwY7AEY6DW5hbm9fbnVtaQJWAzoNbmFub19k\nZW5pBjoNc3VibWljcm8iB4VASSIIVVRDBjsAVEAWSSIPcGVyc2lzdGVudAY7\nAEZUSSIOcmVtb3RlX2lwBjsARiIIOjoxSSIIZ2VvBjsARnsA\n"], ["updated_at", "2018-09-12 16:59:43.461392"], ["id", 33]]
D, [2018-09-12T22:29:43.471249 #11095] DEBUG -- :   [1m[35m (2.9ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:29:43.481958 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:29:43 +0530
I, [2018-09-12T22:29:43.505830 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:29:43.505912 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:29:43.508863 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:29:43.510740 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:29:50.521401 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:29:50.522875 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.5ms | ActiveRecord: 2.4ms)


D, [2018-09-12T22:29:50.526427 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:29:50.530983 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:29:50.541870 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:29:50 +0530
I, [2018-09-12T22:29:50.563611 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:29:50.563708 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:29:50.567317 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:29:50.569206 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T22:29:53.363903 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:29:53 +0530
I, [2018-09-12T22:29:53.396609 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:29:53.396779 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T22:29:53.400430 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:29:53.402565 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:29:53.404195 #11095] DEBUG -- :   [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:29:53.406030 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:29:53.407666 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:29:53.408544 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:29:53.409092 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:29:53.410531 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:59:53.408000"], ["id", 1]]
D, [2018-09-12T22:29:53.418103 #11095] DEBUG -- :   [1m[35m (7.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:29:53.421217 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.7ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 08:59:53.419355')[0m
D, [2018-09-12T22:29:53.424429 #11095] DEBUG -- :   [1m[36mSetting Load (0.6ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:29:53.425358 #11095]  INFO -- : Completed 200 OK in 28ms (Views: 0.3ms | ActiveRecord: 11.4ms)


D, [2018-09-12T22:29:53.428335 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:29:53.429468 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:29:53.575090 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T22:29:53.580296 #11095] DEBUG -- :   [1m[36mSetting Load (1.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:29:53.581677 #11095]  INFO -- : Completed 200 OK in 3018ms (Views: 0.7ms | ActiveRecord: 2.7ms)


D, [2018-09-12T22:29:53.584802 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:29:53.587354 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:29:53.594997 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:29:53 +0530
I, [2018-09-12T22:29:53.606519 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:29:53 +0530
I, [2018-09-12T22:29:53.619093 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:29:53.619215 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
I, [2018-09-12T22:29:53.620866 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:29:53.621408 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:29:53.624447 #11095] DEBUG -- :   [1m[35m (1.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:29:53.625569 #11095] DEBUG -- :   [1m[35m (1.2ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:29:53.626596 #11095] DEBUG -- :   [1m[35m (1.1ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:29:53.627728 #11095] DEBUG -- :   [1m[35m (1.2ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:29:53.628334 #11095] DEBUG -- :   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:29:53.629920 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:29:53.631345 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:29:53.632234 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:29:53.632654 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:29:53.633159 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:29:53.634962 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 16:59:53.632000"], ["id", 1]]
D, [2018-09-12T22:29:53.638083 #11095] DEBUG -- :   [1m[35m (2.8ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:29:53.639646 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.4ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:29:53.640643 #11095] DEBUG -- :   [1m[36mChat Load (0.3ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T22:29:53.642696 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:57:53.641949')[0m  [["active", "t"]]
D, [2018-09-12T22:29:53.645102 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:29:53.645915 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:29:53.646579 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:29:53.647353 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:29:53.648267 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:57:53.647547')[0m  [["active", "t"]]
D, [2018-09-12T22:29:53.649030 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:57:53.648422')[0m  [["active", "t"]]
D, [2018-09-12T22:29:53.649897 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T22:29:53.650689 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:57:53.650064')[0m  [["active", "t"]]
D, [2018-09-12T22:29:53.651380 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:29:53.652304 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:29:53.654881 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:29:53.655289 #11095]  INFO -- : Completed 200 OK in 36ms (Views: 0.1ms | ActiveRecord: 11.4ms)


D, [2018-09-12T22:29:53.656545 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:29:53.657348 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:29:54.633734 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T22:29:54.637125 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:29:54.637634 #11095]  INFO -- : Completed 200 OK in 1015ms (Views: 1.8ms | ActiveRecord: 3.0ms)


D, [2018-09-12T22:29:54.638671 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:29:54.640755 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:29:54.646922 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:29:54 +0530
I, [2018-09-12T22:29:54.666107 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:29:54.666197 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:29:54.668995 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:29:54.670613 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:30:01.682365 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:30:01.683828 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T22:30:01.686600 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:30:01.688921 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:30:01.699676 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:30:01 +0530
I, [2018-09-12T22:30:01.729714 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:30:01.729825 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:30:01.732732 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:30:01.734900 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:30:08.746559 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:30:08.747875 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T22:30:08.750529 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:30:08.755002 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:30:08.764749 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:30:08 +0530
I, [2018-09-12T22:30:08.789999 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:30:08.790076 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:30:08.792466 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:30:08.794058 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:30:15.806190 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:30:15.807618 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.5ms | ActiveRecord: 2.1ms)


D, [2018-09-12T22:30:15.810389 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:30:15.811893 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:30:15.815774 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:30:15 +0530
I, [2018-09-12T22:30:15.830859 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:30:15.830947 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:30:15.833684 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:30:15.835484 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:30:22.847812 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:30:22.849201 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.5ms | ActiveRecord: 2.1ms)


D, [2018-09-12T22:30:22.851709 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:30:22.853287 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:30:22.857472 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:30:22 +0530
I, [2018-09-12T22:30:22.872405 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:30:22.872489 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:30:22.875106 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:30:22.877089 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:30:29.887553 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:30:29.888754 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.4ms | ActiveRecord: 2.2ms)


D, [2018-09-12T22:30:29.891247 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:30:29.892855 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:30:29.900114 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:30:29 +0530
I, [2018-09-12T22:30:29.913628 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:30:29.913691 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:30:29.915646 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:30:29.917192 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:30:36.923815 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:30:36.924198 #11095]  INFO -- : Completed 200 OK in 7010ms (Views: 0.2ms | ActiveRecord: 1.4ms)


D, [2018-09-12T22:30:36.924935 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:30:36.925677 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:30:36.928712 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:30:36 +0530
I, [2018-09-12T22:30:36.937840 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:30:36.937894 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:30:36.939620 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:30:36.940713 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:30:43.949978 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:30:43.951399 #11095]  INFO -- : Completed 200 OK in 7013ms (Views: 0.5ms | ActiveRecord: 1.8ms)


D, [2018-09-12T22:30:43.954337 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:30:43.956642 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:30:43.965458 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:30:43 +0530
I, [2018-09-12T22:30:43.978529 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:30:43.978609 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:30:43.981138 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:30:43.982846 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T22:30:48.364167 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:30:48 +0530
I, [2018-09-12T22:30:48.397978 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:30:48.398116 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T22:30:48.401409 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:30:48.403145 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:30:48.404690 #11095] DEBUG -- :   [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:30:48.406381 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:30:48.407748 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:30:48.408516 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:30:48.409079 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:30:48.410485 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:00:48.408000"], ["id", 1]]
D, [2018-09-12T22:30:48.411657 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:30:48.412685 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 09:00:48.412081')[0m
D, [2018-09-12T22:30:48.413977 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:30:48.414344 #11095]  INFO -- : Completed 200 OK in 16ms (Views: 0.1ms | ActiveRecord: 3.8ms)


D, [2018-09-12T22:30:48.415444 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:30:48.416109 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:30:48.988391 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T22:30:48.991921 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:30:48.993066 #11095]  INFO -- : Completed 200 OK in 5014ms (Views: 0.4ms | ActiveRecord: 2.1ms)


D, [2018-09-12T22:30:48.995648 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:30:48.997832 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:30:49.007974 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:30:49 +0530
I, [2018-09-12T22:30:49.035280 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:30:49 +0530
I, [2018-09-12T22:30:49.050506 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:30:49.050985 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
I, [2018-09-12T22:30:49.055108 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:30:49.055188 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:30:49.057264 #11095] DEBUG -- :   [1m[35m (3.9ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:30:49.058531 #11095] DEBUG -- :   [1m[35m (1.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:30:49.059788 #11095] DEBUG -- :   [1m[35m (1.3ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:30:49.060962 #11095] DEBUG -- :   [1m[35m (1.3ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:30:49.061642 #11095] DEBUG -- :   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:30:49.063411 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:30:49.065027 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:30:49.065923 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:30:49.066395 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:30:49.066911 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:30:49.068534 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:00:49.066000"], ["id", 1]]
D, [2018-09-12T22:30:49.075755 #11095] DEBUG -- :   [1m[35m (6.8ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:30:49.077432 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.4ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:30:49.078487 #11095] DEBUG -- :   [1m[36mChat Load (0.3ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T22:30:49.081283 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.8ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:58:49.079900')[0m  [["active", "t"]]
D, [2018-09-12T22:30:49.084247 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:30:49.085178 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:30:49.085921 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:30:49.086773 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:30:49.087864 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:58:49.086985')[0m  [["active", "t"]]
D, [2018-09-12T22:30:49.088774 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:58:49.088035')[0m  [["active", "t"]]
D, [2018-09-12T22:30:49.089824 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T22:30:49.090748 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:58:49.090009')[0m  [["active", "t"]]
D, [2018-09-12T22:30:49.091477 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:30:49.092581 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.4ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:30:49.095559 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:30:49.095998 #11095]  INFO -- : Completed 200 OK in 45ms (Views: 0.2ms | ActiveRecord: 19.3ms)


D, [2018-09-12T22:30:49.097457 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:30:49.098328 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:30:50.065989 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T22:30:50.070226 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:30:50.070751 #11095]  INFO -- : Completed 200 OK in 1015ms (Views: 2.7ms | ActiveRecord: 3.3ms)


D, [2018-09-12T22:30:50.071863 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:30:50.072854 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:30:50.077804 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:30:50 +0530
I, [2018-09-12T22:30:50.092954 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:30:50.093038 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:30:50.096263 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:30:50.098298 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:30:57.110628 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:30:57.112080 #11095]  INFO -- : Completed 200 OK in 7019ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T22:30:57.114819 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:30:57.115880 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:30:57.120503 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:30:57 +0530
I, [2018-09-12T22:30:57.135354 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:30:57.135462 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:30:57.138109 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:30:57.139958 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:31:04.151330 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:31:04.152778 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T22:31:04.155620 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:31:04.157951 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:31:04.167982 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:31:04 +0530
I, [2018-09-12T22:31:04.205998 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:31:04.206177 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:31:04.209885 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:31:04.211891 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:31:11.223430 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:31:11.224692 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T22:31:11.227178 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:31:11.229256 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:31:11.239277 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:31:11 +0530
I, [2018-09-12T22:31:11.273222 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:31:11.273359 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:31:11.276892 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:31:11.279089 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:31:18.290249 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:31:18.291546 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.5ms | ActiveRecord: 2.3ms)


D, [2018-09-12T22:31:18.294078 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:31:18.296220 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:31:18.305269 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:31:18 +0530
I, [2018-09-12T22:31:18.326872 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:31:18.326957 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:31:18.329054 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:31:18.330473 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:31:25.340577 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:31:25.341324 #11095]  INFO -- : Completed 200 OK in 7014ms (Views: 0.3ms | ActiveRecord: 1.9ms)


D, [2018-09-12T22:31:25.342414 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:31:25.343174 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:31:25.347746 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:31:25 +0530
I, [2018-09-12T22:31:25.363135 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:31:25.363205 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:31:25.365487 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:31:25.366951 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:31:32.377334 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:31:32.378112 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.4ms | ActiveRecord: 1.9ms)


D, [2018-09-12T22:31:32.381402 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:31:32.382702 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:31:32.386278 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:31:32 +0530
I, [2018-09-12T22:31:32.402296 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:31:32.402371 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:31:32.404621 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:31:32.406219 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:31:39.418325 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:31:39.419768 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.5ms | ActiveRecord: 2.1ms)


D, [2018-09-12T22:31:39.422498 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:31:39.424789 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:31:39.434676 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:31:39 +0530
I, [2018-09-12T22:31:39.463075 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:31:39.463166 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:31:39.465927 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:31:39.467674 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T22:31:43.363992 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:31:43 +0530
I, [2018-09-12T22:31:43.378255 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:31:43.378343 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T22:31:43.380643 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:31:43.382170 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:31:43.383558 #11095] DEBUG -- :   [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:31:43.385134 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:31:43.386539 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:31:43.387327 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:31:43.387947 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:31:43.389375 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:01:43.387000"], ["id", 1]]
D, [2018-09-12T22:31:43.392342 #11095] DEBUG -- :   [1m[35m (2.6ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:31:43.393889 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 09:01:43.393030')[0m
D, [2018-09-12T22:31:43.396037 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:31:43.396471 #11095]  INFO -- : Completed 200 OK in 18ms (Views: 0.1ms | ActiveRecord: 6.0ms)


D, [2018-09-12T22:31:43.397787 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:31:43.398626 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:31:44.475845 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T22:31:44.480009 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:31:44.481491 #11095]  INFO -- : Completed 200 OK in 5018ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T22:31:44.484321 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:31:44.486576 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:31:44.498559 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:31:44 +0530
I, [2018-09-12T22:31:44.525399 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:31:44 +0530
I, [2018-09-12T22:31:44.541882 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:31:44.541982 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
I, [2018-09-12T22:31:44.545915 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:31:44.546026 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:31:44.548134 #11095] DEBUG -- :   [1m[35m (3.9ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:31:44.549416 #11095] DEBUG -- :   [1m[35m (1.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:31:44.550625 #11095] DEBUG -- :   [1m[35m (1.3ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:31:44.551871 #11095] DEBUG -- :   [1m[35m (1.4ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:31:44.552590 #11095] DEBUG -- :   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:31:44.554507 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:31:44.556197 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:31:44.557145 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:31:44.557616 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:31:44.558162 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:31:44.559904 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:01:44.557000"], ["id", 1]]
D, [2018-09-12T22:31:44.565149 #11095] DEBUG -- :   [1m[35m (4.9ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:31:44.566847 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.4ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:31:44.568454 #11095] DEBUG -- :   [1m[36mChat Load (0.7ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T22:31:44.570878 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:59:44.569986')[0m  [["active", "t"]]
D, [2018-09-12T22:31:44.573792 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:31:44.574735 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:31:44.575536 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:31:44.576438 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:31:44.577522 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:59:44.576656')[0m  [["active", "t"]]
D, [2018-09-12T22:31:44.578427 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:59:44.577699')[0m  [["active", "t"]]
D, [2018-09-12T22:31:44.579482 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T22:31:44.580418 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 16:59:44.579683')[0m  [["active", "t"]]
D, [2018-09-12T22:31:44.581137 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:31:44.582172 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:31:44.585456 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:31:44.585880 #11095]  INFO -- : Completed 200 OK in 44ms (Views: 0.1ms | ActiveRecord: 17.3ms)


D, [2018-09-12T22:31:44.587101 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:31:44.587901 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:31:45.556322 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T22:31:45.559985 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:31:45.560460 #11095]  INFO -- : Completed 200 OK in 1014ms (Views: 2.2ms | ActiveRecord: 3.3ms)


D, [2018-09-12T22:31:45.561408 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:31:45.562193 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:31:45.566668 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:31:45 +0530
I, [2018-09-12T22:31:45.580918 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:31:45.580999 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:31:45.583593 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:31:45.585376 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:31:52.598217 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:31:52.599819 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T22:31:52.602716 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:31:52.605121 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:31:52.616770 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:31:52 +0530
I, [2018-09-12T22:31:52.644143 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:31:52.644234 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:31:52.646822 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:31:52.648353 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:31:59.659275 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:31:59.660492 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.4ms | ActiveRecord: 1.9ms)


D, [2018-09-12T22:31:59.661560 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:31:59.662344 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:31:59.666549 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:31:59 +0530
I, [2018-09-12T22:31:59.677882 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:31:59.677948 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:31:59.680047 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:31:59.681404 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:32:06.693471 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:32:06.694644 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.4ms | ActiveRecord: 1.8ms)


D, [2018-09-12T22:32:06.697054 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:32:06.698939 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:32:06.708173 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:32:06 +0530
I, [2018-09-12T22:32:06.722135 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:32:06.722259 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:32:06.724558 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:32:06.726429 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:32:13.739051 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:32:13.740469 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T22:32:13.743218 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:32:13.745545 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:32:13.755030 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:32:13 +0530
I, [2018-09-12T22:32:13.789392 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:32:13.789502 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:32:13.792773 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:32:13.794830 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:32:20.807364 #11095] DEBUG -- :   [1m[36mSetting Load (1.6ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:32:20.808259 #11095]  INFO -- : Completed 200 OK in 7019ms (Views: 0.5ms | ActiveRecord: 2.8ms)


D, [2018-09-12T22:32:20.809309 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:32:20.810047 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:32:20.814107 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:32:20 +0530
I, [2018-09-12T22:32:20.830274 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:32:20.830364 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:32:20.833016 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:32:20.834830 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:32:27.845460 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:32:27.846701 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.4ms | ActiveRecord: 2.1ms)


D, [2018-09-12T22:32:27.849178 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:32:27.851136 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:32:27.860070 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:32:27 +0530
I, [2018-09-12T22:32:27.889228 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:32:27.889344 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:32:27.892394 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:32:27.894072 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:32:34.904966 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:32:34.906421 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.6ms | ActiveRecord: 2.3ms)


D, [2018-09-12T22:32:34.909497 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:32:34.913837 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:32:34.925990 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:32:34 +0530
I, [2018-09-12T22:32:34.971777 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:32:34.971925 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:32:34.976362 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:32:34.978508 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T22:32:38.364473 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:32:38 +0530
I, [2018-09-12T22:32:38.379947 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:32:38.380029 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T22:32:38.382168 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:32:38.383679 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:32:38.384951 #11095] DEBUG -- :   [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:32:38.386525 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:32:38.387993 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:32:38.388825 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:32:38.389401 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:32:38.390814 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:02:38.389000"], ["id", 1]]
D, [2018-09-12T22:32:38.391938 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:32:38.393171 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 09:02:38.392424')[0m
D, [2018-09-12T22:32:38.394716 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:32:38.395603 #11095]  INFO -- : Completed 200 OK in 15ms (Views: 0.1ms | ActiveRecord: 4.2ms)


D, [2018-09-12T22:32:38.397124 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:32:38.397933 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:32:39.984399 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T22:32:39.988437 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:32:39.989717 #11095]  INFO -- : Completed 200 OK in 5017ms (Views: 0.5ms | ActiveRecord: 2.7ms)


D, [2018-09-12T22:32:39.992397 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:32:39.993619 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:32:39.999520 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:32:39 +0530
I, [2018-09-12T22:32:40.013816 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:32:40 +0530
I, [2018-09-12T22:32:40.028350 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:32:40.028438 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
I, [2018-09-12T22:32:40.031975 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:32:40.032048 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:32:40.033791 #11095] DEBUG -- :   [1m[35m (3.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:32:40.034892 #11095] DEBUG -- :   [1m[35m (1.2ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:32:40.035922 #11095] DEBUG -- :   [1m[35m (1.1ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:32:40.036950 #11095] DEBUG -- :   [1m[35m (1.1ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:32:40.037578 #11095] DEBUG -- :   [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:32:40.039134 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:32:40.040578 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:32:40.041383 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:32:40.041798 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:32:40.042296 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:32:40.043842 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:02:40.041000"], ["id", 1]]
D, [2018-09-12T22:32:40.051162 #11095] DEBUG -- :   [1m[35m (6.9ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:32:40.052953 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.5ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:32:40.053933 #11095] DEBUG -- :   [1m[36mChat Load (0.3ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T22:32:40.055853 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:00:40.055127')[0m  [["active", "t"]]
D, [2018-09-12T22:32:40.058183 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:32:40.058983 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:32:40.059610 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.2ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:32:40.060359 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:32:40.061272 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:00:40.060526')[0m  [["active", "t"]]
D, [2018-09-12T22:32:40.062114 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:00:40.061431')[0m  [["active", "t"]]
D, [2018-09-12T22:32:40.063019 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T22:32:40.063854 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:00:40.063185')[0m  [["active", "t"]]
D, [2018-09-12T22:32:40.064471 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:32:40.065345 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:32:40.067849 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:32:40.068252 #11095]  INFO -- : Completed 200 OK in 40ms (Views: 0.1ms | ActiveRecord: 17.5ms)


D, [2018-09-12T22:32:40.069623 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:32:40.070399 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:32:41.041313 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T22:32:41.044967 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:32:41.045566 #11095]  INFO -- : Completed 200 OK in 1013ms (Views: 1.8ms | ActiveRecord: 2.9ms)


D, [2018-09-12T22:32:41.047097 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:32:41.048153 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:32:41.059912 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:32:41 +0530
I, [2018-09-12T22:32:41.075966 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:32:41.076047 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:32:41.078753 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:32:41.080690 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:32:48.091022 #11095] DEBUG -- :   [1m[36mSetting Load (1.7ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:32:48.093288 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.7ms | ActiveRecord: 3.0ms)


D, [2018-09-12T22:32:48.096841 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:32:48.099505 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:32:48.111327 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:32:48 +0530
I, [2018-09-12T22:32:48.136652 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:32:48.136727 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:32:48.139812 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:32:48.142192 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:32:55.153541 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:32:55.154821 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.5ms | ActiveRecord: 2.6ms)


D, [2018-09-12T22:32:55.157371 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:32:55.160156 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:32:55.168696 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:32:55 +0530
I, [2018-09-12T22:32:55.196969 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:32:55.197055 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:32:55.199685 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:32:55.201294 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:33:02.212841 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:33:02.214612 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T22:33:02.217756 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:33:02.220388 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:33:02.232225 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:33:02 +0530
I, [2018-09-12T22:33:02.255551 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:33:02.255629 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:33:02.257956 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:33:02.259501 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:33:09.267645 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:33:09.268245 #11095]  INFO -- : Completed 200 OK in 7012ms (Views: 0.2ms | ActiveRecord: 1.2ms)


D, [2018-09-12T22:33:09.269356 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:33:09.270299 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:33:09.273554 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:33:09 +0530
I, [2018-09-12T22:33:09.297802 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:33:09.297912 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:33:09.300851 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:33:09.302450 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:33:16.313881 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:33:16.315333 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.6ms | ActiveRecord: 2.4ms)


D, [2018-09-12T22:33:16.318160 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:33:16.320557 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:33:16.332133 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:33:16 +0530
I, [2018-09-12T22:33:16.361575 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:33:16.361657 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:33:16.364438 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:33:16.366079 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:33:23.374843 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:33:23.376069 #11095]  INFO -- : Completed 200 OK in 7014ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T22:33:23.378574 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:33:23.380664 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:33:23.389762 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:33:23 +0530
I, [2018-09-12T22:33:23.416356 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:33:23.416458 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:33:23.419054 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:33:23.420725 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:33:30.431383 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:33:30.432617 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.5ms | ActiveRecord: 1.9ms)


D, [2018-09-12T22:33:30.435007 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:33:30.437027 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:33:30.453984 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:33:30 +0530
I, [2018-09-12T22:33:30.478596 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:33:30.478682 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:33:30.481242 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:33:30.482851 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T22:33:33.366538 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:33:33 +0530
I, [2018-09-12T22:33:33.399482 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:33:33.399630 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T22:33:33.402422 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:33:33.404347 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:33:33.405709 #11095] DEBUG -- :   [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:33:33.407346 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:33:33.409212 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:33:33.410906 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.6ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:33:33.412379 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:33:33.414186 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:03:33.411000"], ["id", 1]]
D, [2018-09-12T22:33:33.415373 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:33:33.416710 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 09:03:33.415877')[0m
D, [2018-09-12T22:33:33.418550 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:33:33.418965 #11095]  INFO -- : Completed 200 OK in 19ms (Views: 0.2ms | ActiveRecord: 4.8ms)


D, [2018-09-12T22:33:33.420233 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:33:33.421026 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:33:33.487545 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T22:33:33.491236 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:33:33.492524 #11095]  INFO -- : Completed 200 OK in 3013ms (Views: 0.4ms | ActiveRecord: 2.1ms)


D, [2018-09-12T22:33:33.495706 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:33:33.499355 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:33:33.509298 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:33:33 +0530
I, [2018-09-12T22:33:33.509749 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:33:33 +0530
I, [2018-09-12T22:33:33.539467 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:33:33.541004 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:33:33.541137 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
I, [2018-09-12T22:33:33.541272 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
D, [2018-09-12T22:33:33.546039 #11095] DEBUG -- :   [1m[35m (1.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:33:33.548493 #11095] DEBUG -- :   [1m[35m (2.8ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:33:33.550105 #11095] DEBUG -- :   [1m[35m (1.8ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:33:33.551758 #11095] DEBUG -- :   [1m[35m (2.0ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:33:33.552657 #11095] DEBUG -- :   [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:33:33.554716 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:33:33.556358 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:33:33.557138 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:33:33.557579 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:33:33.557989 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:33:33.559325 #11095] DEBUG -- :   [1m[35mSQL (0.2ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:03:33.557000"], ["id", 1]]
D, [2018-09-12T22:33:33.562359 #11095] DEBUG -- :   [1m[35m (2.6ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:33:33.564585 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.6ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:33:33.565699 #11095] DEBUG -- :   [1m[36mChat Load (0.3ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T22:33:33.567747 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:01:33.566993')[0m  [["active", "t"]]
D, [2018-09-12T22:33:33.570671 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.4ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:33:33.571539 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:33:33.572209 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:33:33.572970 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:33:33.573941 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:01:33.573150')[0m  [["active", "t"]]
D, [2018-09-12T22:33:33.574721 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:01:33.574095')[0m  [["active", "t"]]
D, [2018-09-12T22:33:33.575551 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T22:33:33.576344 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:01:33.575712')[0m  [["active", "t"]]
D, [2018-09-12T22:33:33.576951 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:33:33.577804 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:33:33.581109 #11095] DEBUG -- :   [1m[36mSetting Load (0.6ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:33:33.581713 #11095]  INFO -- : Completed 200 OK in 39ms (Views: 0.1ms | ActiveRecord: 12.8ms)


D, [2018-09-12T22:33:33.583668 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:33:33.584506 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:33:34.554169 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T22:33:34.557918 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:33:34.558614 #11095]  INFO -- : Completed 200 OK in 1017ms (Views: 2.4ms | ActiveRecord: 5.2ms)


D, [2018-09-12T22:33:34.560277 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:33:34.561981 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:33:34.566441 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:33:34 +0530
I, [2018-09-12T22:33:34.577773 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:33:34.577836 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:33:34.580092 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:33:34.581627 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:33:41.592786 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:33:41.594054 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.5ms | ActiveRecord: 2.1ms)


D, [2018-09-12T22:33:41.596564 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:33:41.598591 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:33:41.607590 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:33:41 +0530
I, [2018-09-12T22:33:41.637632 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:33:41.637717 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:33:41.640299 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:33:41.641895 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:33:48.652352 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:33:48.653739 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.4ms | ActiveRecord: 2.1ms)


D, [2018-09-12T22:33:48.656441 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:33:48.658699 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:33:48.668683 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:33:48 +0530
I, [2018-09-12T22:33:48.702457 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:33:48.702594 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:33:48.705370 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:33:48.706961 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:33:55.718064 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:33:55.719412 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.5ms | ActiveRecord: 2.1ms)


D, [2018-09-12T22:33:55.722213 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:33:55.723427 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:33:55.727346 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:33:55 +0530
I, [2018-09-12T22:33:55.742320 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:33:55.742419 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:33:55.745318 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:33:55.747189 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:34:02.759676 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:34:02.760866 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.4ms | ActiveRecord: 2.2ms)


D, [2018-09-12T22:34:02.763305 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:34:02.765112 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:34:02.768655 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:34:02 +0530
I, [2018-09-12T22:34:02.779435 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:34:02.779505 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:34:02.781445 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:34:02.782776 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:34:09.795457 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:34:09.796851 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.6ms | ActiveRecord: 2.0ms)


D, [2018-09-12T22:34:09.799623 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:34:09.800830 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:34:09.804699 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:34:09 +0530
I, [2018-09-12T22:34:09.819189 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:34:09.819275 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:34:09.822026 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:34:09.823844 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:34:16.835373 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:34:16.836716 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T22:34:16.839624 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:34:16.841045 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:34:16.844778 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:34:16 +0530
I, [2018-09-12T22:34:16.857904 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:34:16.857981 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:34:16.860322 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:34:16.861842 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:34:23.872716 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:34:23.874126 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.5ms | ActiveRecord: 2.1ms)


D, [2018-09-12T22:34:23.876865 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:34:23.878389 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:34:23.882194 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:34:23 +0530
I, [2018-09-12T22:34:23.896232 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:34:23.896314 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:34:23.898794 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:34:23.900463 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T22:34:28.366861 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:34:28 +0530
I, [2018-09-12T22:34:28.397415 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:34:28.397569 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T22:34:28.400992 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:34:28.403000 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:34:28.404805 #11095] DEBUG -- :   [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:34:28.406839 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:34:28.408712 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:34:28.409857 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:34:28.410447 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:34:28.412170 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:04:28.410000"], ["id", 1]]
D, [2018-09-12T22:34:28.413550 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:34:28.416171 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 09:04:28.414634')[0m
D, [2018-09-12T22:34:28.418936 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:34:28.419917 #11095]  INFO -- : Completed 200 OK in 22ms (Views: 0.2ms | ActiveRecord: 5.0ms)


D, [2018-09-12T22:34:28.422315 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:34:28.424964 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:34:28.908843 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T22:34:28.912816 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:34:28.914108 #11095]  INFO -- : Completed 200 OK in 5017ms (Views: 0.5ms | ActiveRecord: 2.0ms)


D, [2018-09-12T22:34:28.916904 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:34:28.919222 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:34:28.929546 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:34:28 +0530
I, [2018-09-12T22:34:28.957103 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:34:28 +0530
I, [2018-09-12T22:34:28.973104 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:34:28.973216 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
I, [2018-09-12T22:34:28.977212 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:34:28.977335 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:34:28.979424 #11095] DEBUG -- :   [1m[35m (3.9ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:34:28.980838 #11095] DEBUG -- :   [1m[35m (1.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:34:28.982080 #11095] DEBUG -- :   [1m[35m (1.3ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:34:28.983422 #11095] DEBUG -- :   [1m[35m (1.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:34:28.984133 #11095] DEBUG -- :   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:34:28.985999 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:34:28.987692 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:34:28.988598 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:34:28.989090 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:34:28.989636 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:34:28.991296 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:04:28.989000"], ["id", 1]]
D, [2018-09-12T22:34:28.998701 #11095] DEBUG -- :   [1m[35m (6.9ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:34:29.000664 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.5ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:34:29.002281 #11095] DEBUG -- :   [1m[36mChat Load (0.4ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T22:34:29.004714 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:02:29.003796')[0m  [["active", "t"]]
D, [2018-09-12T22:34:29.007558 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:34:29.008506 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:34:29.009297 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:34:29.010225 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:34:29.011275 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:02:29.010427')[0m  [["active", "t"]]
D, [2018-09-12T22:34:29.012188 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:02:29.011445')[0m  [["active", "t"]]
D, [2018-09-12T22:34:29.013196 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T22:34:29.014136 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:02:29.013381')[0m  [["active", "t"]]
D, [2018-09-12T22:34:29.014828 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:34:29.015920 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.4ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:34:29.019147 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:34:29.019610 #11095]  INFO -- : Completed 200 OK in 46ms (Views: 0.2ms | ActiveRecord: 19.2ms)


D, [2018-09-12T22:34:29.020957 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:34:29.021762 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:34:29.988317 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T22:34:29.996772 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:34:29.998119 #11095]  INFO -- : Completed 200 OK in 1020ms (Views: 4.9ms | ActiveRecord: 4.4ms)


D, [2018-09-12T22:34:30.000906 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:34:30.003220 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:34:30.014067 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:34:30 +0530
I, [2018-09-12T22:34:30.030884 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:34:30.030959 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:34:30.033318 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:34:30.035278 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:34:37.047582 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:34:37.049000 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.5ms | ActiveRecord: 2.1ms)


D, [2018-09-12T22:34:37.051707 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:34:37.052800 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:34:37.056741 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:34:37 +0530
I, [2018-09-12T22:34:37.072040 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:34:37.072124 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:34:37.074693 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:34:37.076553 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:34:44.088338 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:34:44.089593 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.4ms | ActiveRecord: 2.2ms)


D, [2018-09-12T22:34:44.092111 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:34:44.094259 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:34:44.103170 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:34:44 +0530
I, [2018-09-12T22:34:44.134176 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:34:44.134277 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:34:44.137310 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:34:44.139146 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:34:51.148049 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:34:51.149457 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.4ms | ActiveRecord: 2.1ms)


D, [2018-09-12T22:34:51.153127 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:34:51.154799 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:34:51.161038 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:34:51 +0530
I, [2018-09-12T22:34:51.177261 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:34:51.177344 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:34:51.180335 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:34:51.192339 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:34:58.201140 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:34:58.202532 #11095]  INFO -- : Completed 200 OK in 7025ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T22:34:58.204949 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:34:58.207793 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:34:58.217494 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:34:58 +0530
I, [2018-09-12T22:34:58.254776 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:34:58.254879 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:34:58.257814 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:34:58.259426 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:35:05.277509 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:35:05.278703 #11095]  INFO -- : Completed 200 OK in 7024ms (Views: 0.5ms | ActiveRecord: 2.0ms)


D, [2018-09-12T22:35:05.281175 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:35:05.284080 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:35:05.294425 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:35:05 +0530
I, [2018-09-12T22:35:05.319126 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:35:05.319206 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:35:05.321550 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:35:05.323026 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:35:12.329088 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:35:12.329721 #11095]  INFO -- : Completed 200 OK in 7010ms (Views: 0.4ms | ActiveRecord: 1.3ms)


D, [2018-09-12T22:35:12.331899 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:35:12.332848 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:35:12.338474 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:35:12 +0530
I, [2018-09-12T22:35:12.351234 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:35:12.351317 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:35:12.353478 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:35:12.354992 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:35:19.364560 #11095] DEBUG -- :   [1m[36mSetting Load (1.9ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:35:19.366478 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.5ms | ActiveRecord: 2.7ms)


D, [2018-09-12T22:35:19.367526 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:35:19.368343 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:35:19.372334 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:35:19 +0530
I, [2018-09-12T22:35:19.390122 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:35:19.390231 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:35:19.394842 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:35:19.399122 #11095] DEBUG -- :   [1m[35m (1.3ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T22:35:23.361360 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:35:23 +0530
I, [2018-09-12T22:35:23.378654 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:35:23.378752 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T22:35:23.381320 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:35:23.383119 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:35:23.384636 #11095] DEBUG -- :   [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:35:23.386953 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:35:23.389316 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:35:23.391208 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:35:23.393287 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:35:23.396990 #11095] DEBUG -- :   [1m[35mSQL (0.8ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:05:23.391000"], ["id", 1]]
D, [2018-09-12T22:35:23.398366 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:35:23.399682 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 09:05:23.398931')[0m
D, [2018-09-12T22:35:23.401309 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:35:23.401744 #11095]  INFO -- : Completed 200 OK in 23ms (Views: 0.1ms | ActiveRecord: 5.3ms)


D, [2018-09-12T22:35:23.403004 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:35:23.403786 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:35:24.403589 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T22:35:24.405716 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:35:24.406344 #11095]  INFO -- : Completed 200 OK in 5016ms (Views: 0.3ms | ActiveRecord: 2.4ms)


D, [2018-09-12T22:35:24.409562 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:35:24.411149 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:35:24.415433 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:35:24 +0530
I, [2018-09-12T22:35:24.428552 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:35:24 +0530
I, [2018-09-12T22:35:24.443360 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:35:24.445020 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:35:24.445111 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
I, [2018-09-12T22:35:24.445346 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:35:24.449003 #11095] DEBUG -- :   [1m[35m (1.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:35:24.450216 #11095] DEBUG -- :   [1m[35m (1.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:35:24.451136 #11095] DEBUG -- :   [1m[35m (1.0ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:35:24.452182 #11095] DEBUG -- :   [1m[35m (1.1ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:35:24.452838 #11095] DEBUG -- :   [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:35:24.455808 #11095] DEBUG -- :   [1m[35mCACHE  (0.1ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:35:24.458214 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:35:24.459067 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:35:24.459509 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:35:24.459988 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:35:24.461428 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:05:24.459000"], ["id", 1]]
D, [2018-09-12T22:35:24.462510 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:35:24.464026 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:35:24.465186 #11095] DEBUG -- :   [1m[36mChat Load (0.3ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T22:35:24.467878 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:03:24.467026')[0m  [["active", "t"]]
D, [2018-09-12T22:35:24.473237 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.6ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:35:24.474471 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:35:24.475135 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.2ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:35:24.476205 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:35:24.477350 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:03:24.476473')[0m  [["active", "t"]]
D, [2018-09-12T22:35:24.478230 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:03:24.477516')[0m  [["active", "t"]]
D, [2018-09-12T22:35:24.479843 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T22:35:24.481320 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:03:24.480206')[0m  [["active", "t"]]
D, [2018-09-12T22:35:24.482152 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:35:24.483428 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.4ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:35:24.491341 #11095] DEBUG -- :   [1m[36mSetting Load (0.9ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:35:24.492161 #11095]  INFO -- : Completed 200 OK in 47ms (Views: 0.5ms | ActiveRecord: 11.4ms)


D, [2018-09-12T22:35:24.495080 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:35:24.496251 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:35:25.454848 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T22:35:25.458471 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:35:25.458997 #11095]  INFO -- : Completed 200 OK in 1013ms (Views: 1.8ms | ActiveRecord: 3.0ms)


D, [2018-09-12T22:35:25.460076 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:35:25.461028 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:35:25.465825 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:35:25 +0530
I, [2018-09-12T22:35:25.483370 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:35:25.483476 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:35:25.488743 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:35:25.491009 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:35:32.496138 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:35:32.496561 #11095]  INFO -- : Completed 200 OK in 7013ms (Views: 0.2ms | ActiveRecord: 1.8ms)


D, [2018-09-12T22:35:32.497382 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:35:32.498185 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:35:32.501559 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:35:32 +0530
I, [2018-09-12T22:35:32.516450 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:35:32.516519 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:35:32.519135 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:35:32.520504 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:35:39.527016 #11095] DEBUG -- :   [1m[36mSetting Load (0.6ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:35:39.527809 #11095]  INFO -- : Completed 200 OK in 7011ms (Views: 0.3ms | ActiveRecord: 1.5ms)


D, [2018-09-12T22:35:39.529304 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:35:39.530548 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:35:39.535887 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:35:39 +0530
I, [2018-09-12T22:35:39.556083 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:35:39.556174 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:35:39.559294 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:35:39.560947 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:35:46.566681 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:35:46.567151 #11095]  INFO -- : Completed 200 OK in 7011ms (Views: 0.2ms | ActiveRecord: 1.6ms)


D, [2018-09-12T22:35:46.568114 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:35:46.569071 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:35:46.574621 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:35:46 +0530
I, [2018-09-12T22:35:46.587481 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:35:46.587581 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:35:46.589907 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:35:46.591365 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:35:53.597284 #11095] DEBUG -- :   [1m[36mSetting Load (0.6ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:35:53.597904 #11095]  INFO -- : Completed 200 OK in 7010ms (Views: 0.3ms | ActiveRecord: 1.4ms)


D, [2018-09-12T22:35:53.599173 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:35:53.600279 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:35:53.604775 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:35:53 +0530
I, [2018-09-12T22:35:53.621826 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:35:53.621906 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:35:53.624031 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:35:53.625436 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:36:00.631043 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:36:00.631540 #11095]  INFO -- : Completed 200 OK in 7009ms (Views: 0.2ms | ActiveRecord: 1.2ms)


D, [2018-09-12T22:36:00.632588 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:36:00.633329 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:36:00.638148 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:36:00 +0530
I, [2018-09-12T22:36:00.658460 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:36:00.658531 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:36:00.661592 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:36:00.663413 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:36:07.669074 #11095] DEBUG -- :   [1m[36mSetting Load (0.6ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:36:07.669786 #11095]  INFO -- : Completed 200 OK in 7011ms (Views: 0.2ms | ActiveRecord: 1.7ms)


D, [2018-09-12T22:36:07.671098 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:36:07.672346 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:36:07.677405 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:36:07 +0530
I, [2018-09-12T22:36:07.698596 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:36:07.698774 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:36:07.702095 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:36:07.703929 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:36:14.709691 #11095] DEBUG -- :   [1m[36mSetting Load (0.6ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:36:14.710304 #11095]  INFO -- : Completed 200 OK in 7011ms (Views: 0.3ms | ActiveRecord: 1.6ms)


D, [2018-09-12T22:36:14.711592 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:36:14.713105 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:36:14.721489 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:36:14 +0530
I, [2018-09-12T22:36:14.737622 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:36:14.737893 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:36:14.743366 #11095] DEBUG -- :   [1m[35m (1.1ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:36:14.746687 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T22:36:18.362757 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:36:18 +0530
I, [2018-09-12T22:36:18.378406 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:36:18.378521 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T22:36:18.382444 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:36:18.384244 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:36:18.385697 #11095] DEBUG -- :   [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:36:18.387435 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:36:18.390679 #11095] DEBUG -- :   [1m[35m (1.4ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:36:18.392499 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.6ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:36:18.393461 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:36:18.396010 #11095] DEBUG -- :   [1m[35mSQL (0.7ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:06:18.392000"], ["id", 1]]
D, [2018-09-12T22:36:18.397616 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:36:18.399391 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 09:06:18.398415')[0m
D, [2018-09-12T22:36:18.401083 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:36:18.401513 #11095]  INFO -- : Completed 200 OK in 23ms (Views: 0.1ms | ActiveRecord: 6.1ms)


D, [2018-09-12T22:36:18.402809 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:36:18.403906 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:36:19.750637 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T22:36:19.752381 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:36:19.752908 #11095]  INFO -- : Completed 200 OK in 5015ms (Views: 0.3ms | ActiveRecord: 2.4ms)


D, [2018-09-12T22:36:19.753891 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:36:19.754593 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:36:19.759564 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:36:19 +0530
I, [2018-09-12T22:36:19.770890 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:36:19 +0530
I, [2018-09-12T22:36:19.786309 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:36:19.786591 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
I, [2018-09-12T22:36:19.791314 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:36:19.791680 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:36:19.794625 #11095] DEBUG -- :   [1m[35m (3.2ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:36:19.795993 #11095] DEBUG -- :   [1m[35m (1.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:36:19.797058 #11095] DEBUG -- :   [1m[35m (1.2ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:36:19.798209 #11095] DEBUG -- :   [1m[35m (1.2ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:36:19.798824 #11095] DEBUG -- :   [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:36:19.800665 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:36:19.802066 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:36:19.802792 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:36:19.803179 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:36:19.803566 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:36:19.804893 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:06:19.803000"], ["id", 1]]
D, [2018-09-12T22:36:19.805975 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:36:19.807275 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:36:19.808307 #11095] DEBUG -- :   [1m[36mChat Load (0.3ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T22:36:19.810272 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:04:19.809481')[0m  [["active", "t"]]
D, [2018-09-12T22:36:19.813160 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.4ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:36:19.814725 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:36:19.815633 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:36:19.817810 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:36:19.820499 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:04:19.818783')[0m  [["active", "t"]]
D, [2018-09-12T22:36:19.821630 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:04:19.820745')[0m  [["active", "t"]]
D, [2018-09-12T22:36:19.822767 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T22:36:19.823853 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:04:19.822990')[0m  [["active", "t"]]
D, [2018-09-12T22:36:19.824592 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:36:19.826282 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.6ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:36:19.830068 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:36:19.830539 #11095]  INFO -- : Completed 200 OK in 44ms (Views: 0.2ms | ActiveRecord: 12.3ms)


D, [2018-09-12T22:36:19.831774 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:36:19.832536 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:36:20.801369 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T22:36:20.804264 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:36:20.804748 #11095]  INFO -- : Completed 200 OK in 1013ms (Views: 1.5ms | ActiveRecord: 3.2ms)


D, [2018-09-12T22:36:20.806024 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:36:20.807280 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:36:20.812680 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:36:20 +0530
I, [2018-09-12T22:36:20.830895 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:36:20.830978 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:36:20.834072 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:36:20.835924 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:36:27.844231 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:36:27.844954 #11095]  INFO -- : Completed 200 OK in 7014ms (Views: 0.3ms | ActiveRecord: 2.1ms)


D, [2018-09-12T22:36:27.846643 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:36:27.847844 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:36:27.853578 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:36:27 +0530
I, [2018-09-12T22:36:27.877392 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:36:27.877533 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:36:27.881677 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:36:27.883550 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:36:34.893680 #11095] DEBUG -- :   [1m[36mSetting Load (0.8ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:36:34.895107 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.4ms | ActiveRecord: 2.1ms)


D, [2018-09-12T22:36:34.896470 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:36:34.897608 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:36:34.901473 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:36:34 +0530
I, [2018-09-12T22:36:34.918203 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:36:34.918334 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:36:34.925067 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:36:34.927834 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:36:41.934836 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:36:41.935410 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.3ms | ActiveRecord: 2.0ms)


D, [2018-09-12T22:36:41.936752 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:36:41.937944 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:36:41.943298 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:36:41 +0530
I, [2018-09-12T22:36:41.972656 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:36:41.972757 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:36:41.975216 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:36:41.976795 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:36:48.983161 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:36:48.983765 #11095]  INFO -- : Completed 200 OK in 7011ms (Views: 0.2ms | ActiveRecord: 1.3ms)


D, [2018-09-12T22:36:48.985023 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:36:48.985972 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:36:48.990793 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:36:48 +0530
I, [2018-09-12T22:36:49.008402 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:36:49.008515 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:36:49.011311 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:36:49.013188 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:36:56.019896 #11095] DEBUG -- :   [1m[36mSetting Load (0.6ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:36:56.020686 #11095]  INFO -- : Completed 200 OK in 7012ms (Views: 0.3ms | ActiveRecord: 1.6ms)


D, [2018-09-12T22:36:56.022357 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:36:56.024915 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:36:56.031517 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:36:56 +0530
I, [2018-09-12T22:36:56.052940 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:36:56.053041 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:36:56.056454 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:36:56.058818 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:37:03.065616 #11095] DEBUG -- :   [1m[36mSetting Load (0.6ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:37:03.067098 #11095]  INFO -- : Completed 200 OK in 7014ms (Views: 0.2ms | ActiveRecord: 1.9ms)


D, [2018-09-12T22:37:03.069408 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:37:03.071750 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:37:03.078387 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:37:03 +0530
I, [2018-09-12T22:37:03.094305 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:37:03.094383 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:37:03.099848 #11095] DEBUG -- :   [1m[35m (1.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:37:03.103694 #11095] DEBUG -- :   [1m[35m (1.1ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:37:10.111650 #11095] DEBUG -- :   [1m[36mSetting Load (0.7ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:37:10.112532 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.3ms | ActiveRecord: 3.1ms)


D, [2018-09-12T22:37:10.115121 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:37:10.116515 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:37:10.121670 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:37:10 +0530
I, [2018-09-12T22:37:10.138528 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:37:10.138603 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:37:10.141083 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:37:10.142948 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T22:37:13.360492 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:37:13 +0530
I, [2018-09-12T22:37:13.381462 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:37:13.381551 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T22:37:13.384302 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:37:13.385995 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:37:13.387353 #11095] DEBUG -- :   [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:37:13.389202 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:37:13.391066 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:37:13.392286 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:37:13.392908 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:37:13.395994 #11095] DEBUG -- :   [1m[35mSQL (0.5ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:07:13.392000"], ["id", 1]]
D, [2018-09-12T22:37:13.397435 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:37:13.398858 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 09:07:13.397933')[0m
D, [2018-09-12T22:37:13.400637 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:37:13.401364 #11095]  INFO -- : Completed 200 OK in 20ms (Views: 0.1ms | ActiveRecord: 4.9ms)


D, [2018-09-12T22:37:13.404478 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:37:13.406104 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:37:15.147000 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T22:37:15.148925 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:37:15.149605 #11095]  INFO -- : Completed 200 OK in 5011ms (Views: 0.2ms | ActiveRecord: 1.6ms)


D, [2018-09-12T22:37:15.150855 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:37:15.151889 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:37:15.157437 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:37:15 +0530
I, [2018-09-12T22:37:15.173127 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:37:15 +0530
I, [2018-09-12T22:37:15.187513 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:37:15.189130 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:37:15.189237 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
I, [2018-09-12T22:37:15.189503 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:37:15.192991 #11095] DEBUG -- :   [1m[35m (1.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:37:15.194125 #11095] DEBUG -- :   [1m[35m (1.2ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:37:15.195173 #11095] DEBUG -- :   [1m[35m (1.1ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:37:15.196317 #11095] DEBUG -- :   [1m[35m (1.3ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:37:15.196942 #11095] DEBUG -- :   [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:37:15.198586 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:37:15.200006 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:37:15.200775 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:37:15.201227 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:37:15.201668 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:37:15.203037 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:07:15.201000"], ["id", 1]]
D, [2018-09-12T22:37:15.204295 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:37:15.207928 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.9ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:37:15.209376 #11095] DEBUG -- :   [1m[36mChat Load (0.4ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T22:37:15.212838 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:05:15.211735')[0m  [["active", "t"]]
D, [2018-09-12T22:37:15.215919 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:37:15.216857 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:37:15.217475 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.2ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:37:15.218158 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:37:15.219089 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:05:15.218324')[0m  [["active", "t"]]
D, [2018-09-12T22:37:15.219842 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:05:15.219231')[0m  [["active", "t"]]
D, [2018-09-12T22:37:15.220728 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T22:37:15.221496 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:05:15.220879')[0m  [["active", "t"]]
D, [2018-09-12T22:37:15.222063 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:37:15.222838 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.2ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:37:15.224892 #11095] DEBUG -- :   [1m[36mSetting Load (0.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:37:15.225267 #11095]  INFO -- : Completed 200 OK in 36ms (Views: 0.1ms | ActiveRecord: 9.9ms)


D, [2018-09-12T22:37:15.226350 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:37:15.227368 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:37:16.199007 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T22:37:16.202839 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:37:16.203463 #11095]  INFO -- : Completed 200 OK in 1013ms (Views: 1.9ms | ActiveRecord: 3.0ms)


D, [2018-09-12T22:37:16.205008 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:37:16.205868 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:37:16.212059 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:37:16 +0530
I, [2018-09-12T22:37:16.226998 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:37:16.227102 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:37:16.231163 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:37:16.233347 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:37:23.238798 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:37:23.239307 #11095]  INFO -- : Completed 200 OK in 7012ms (Views: 0.2ms | ActiveRecord: 1.9ms)


D, [2018-09-12T22:37:23.240252 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:37:23.242193 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:37:23.251036 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:37:23 +0530
I, [2018-09-12T22:37:23.266525 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:37:23.266591 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:37:23.268747 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:37:23.270274 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:37:30.278600 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:37:30.279855 #11095]  INFO -- : Completed 200 OK in 7013ms (Views: 0.4ms | ActiveRecord: 2.0ms)


D, [2018-09-12T22:37:30.282658 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:37:30.285714 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:37:30.295139 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:37:30 +0530
I, [2018-09-12T22:37:30.324767 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:37:30.324872 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:37:30.327515 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:37:30.329311 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:37:37.336307 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:37:37.336820 #11095]  INFO -- : Completed 200 OK in 7012ms (Views: 0.2ms | ActiveRecord: 1.5ms)


D, [2018-09-12T22:37:37.337769 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:37:37.338539 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:37:37.342329 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:37:37 +0530
I, [2018-09-12T22:37:37.355444 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:37:37.355536 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:37:37.358473 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:37:37.360264 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:37:44.369227 #11095] DEBUG -- :   [1m[36mSetting Load (0.9ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:37:44.370394 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.6ms | ActiveRecord: 2.0ms)


D, [2018-09-12T22:37:44.372698 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:37:44.375004 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:37:44.379291 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:37:44 +0530
I, [2018-09-12T22:37:44.393251 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:37:44.393332 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:37:44.395848 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:37:44.397477 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:37:51.404410 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:37:51.404820 #11095]  INFO -- : Completed 200 OK in 7011ms (Views: 0.2ms | ActiveRecord: 1.5ms)


D, [2018-09-12T22:37:51.405632 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:37:51.406442 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:37:51.409633 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:37:51 +0530
I, [2018-09-12T22:37:51.420851 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:37:51.420922 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:37:51.422955 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:37:51.424351 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:37:58.435080 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:37:58.436554 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.8ms | ActiveRecord: 2.1ms)


D, [2018-09-12T22:37:58.439270 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:37:58.441656 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:37:58.452026 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:37:58 +0530
I, [2018-09-12T22:37:58.475680 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:37:58.475757 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:37:58.478586 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:37:58.480200 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:38:05.490904 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:38:05.492653 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.6ms | ActiveRecord: 2.3ms)


D, [2018-09-12T22:38:05.496187 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:38:05.499737 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:38:05.511233 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:38:05 +0530
I, [2018-09-12T22:38:05.539973 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:38:05.540069 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:38:05.543686 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:38:05.545865 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T22:38:08.363651 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:38:08 +0530
I, [2018-09-12T22:38:08.389455 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:38:08.389553 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T22:38:08.391971 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:38:08.394502 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:38:08.396594 #11095] DEBUG -- :   [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:38:08.398374 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:38:08.399992 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:38:08.401068 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:38:08.401730 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:38:08.403269 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:08:08.401000"], ["id", 1]]
D, [2018-09-12T22:38:08.404466 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:38:08.405698 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 09:08:08.404943')[0m
D, [2018-09-12T22:38:08.407137 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:38:08.407569 #11095]  INFO -- : Completed 200 OK in 18ms (Views: 0.1ms | ActiveRecord: 4.5ms)


D, [2018-09-12T22:38:08.408789 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:38:08.409922 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:38:08.550861 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T22:38:08.555247 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:38:08.556817 #11095]  INFO -- : Completed 200 OK in 3016ms (Views: 1.0ms | ActiveRecord: 2.2ms)


D, [2018-09-12T22:38:08.559803 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:38:08.562201 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:38:08.575962 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:38:08 +0530
I, [2018-09-12T22:38:08.576146 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:38:08 +0530
I, [2018-09-12T22:38:08.608018 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:38:08.609644 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:38:08.609735 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
I, [2018-09-12T22:38:08.609959 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:38:08.613254 #11095] DEBUG -- :   [1m[35m (1.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:38:08.614369 #11095] DEBUG -- :   [1m[35m (1.2ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:38:08.615267 #11095] DEBUG -- :   [1m[35m (1.0ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:38:08.616216 #11095] DEBUG -- :   [1m[35m (1.0ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:38:08.616708 #11095] DEBUG -- :   [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:38:08.618310 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:38:08.620262 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:38:08.621301 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:38:08.621895 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:38:08.622532 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:38:08.625088 #11095] DEBUG -- :   [1m[35mSQL (0.4ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:08:08.622000"], ["id", 1]]
D, [2018-09-12T22:38:08.628114 #11095] DEBUG -- :   [1m[35m (2.7ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:38:08.629663 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:38:08.630571 #11095] DEBUG -- :   [1m[36mChat Load (0.2ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T22:38:08.632369 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:06:08.631754')[0m  [["active", "t"]]
D, [2018-09-12T22:38:08.634859 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:38:08.635615 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:38:08.636396 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:38:08.637384 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:38:08.638836 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:06:08.637613')[0m  [["active", "t"]]
D, [2018-09-12T22:38:08.640319 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.5ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:06:08.639145')[0m  [["active", "t"]]
D, [2018-09-12T22:38:08.641978 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T22:38:08.643926 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:06:08.642324')[0m  [["active", "t"]]
D, [2018-09-12T22:38:08.644691 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:38:08.645770 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:38:08.648750 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:38:08.649154 #11095]  INFO -- : Completed 200 OK in 39ms (Views: 0.1ms | ActiveRecord: 11.5ms)


D, [2018-09-12T22:38:08.650462 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:38:08.651259 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:38:09.620575 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T22:38:09.627856 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:38:09.629125 #11095]  INFO -- : Completed 200 OK in 1019ms (Views: 3.4ms | ActiveRecord: 3.3ms)


D, [2018-09-12T22:38:09.632158 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:38:09.635555 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:38:09.647437 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:38:09 +0530
I, [2018-09-12T22:38:09.666622 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:38:09.666711 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:38:09.669634 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:38:09.671352 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:38:16.681014 #11095] DEBUG -- :   [1m[36mSetting Load (0.8ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:38:16.682075 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.4ms | ActiveRecord: 1.7ms)


D, [2018-09-12T22:38:16.684102 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:38:16.686249 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:38:16.693631 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:38:16 +0530
I, [2018-09-12T22:38:16.720818 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:38:16.720899 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:38:16.724416 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:38:16.727113 #11095] DEBUG -- :   [1m[35m (1.0ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:38:23.738347 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:38:23.739875 #11095]  INFO -- : Completed 200 OK in 7019ms (Views: 0.5ms | ActiveRecord: 2.9ms)


D, [2018-09-12T22:38:23.742848 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:38:23.745995 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:38:23.755992 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:38:23 +0530
I, [2018-09-12T22:38:23.787546 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:38:23.787677 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:38:23.791899 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:38:23.793550 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:38:30.802979 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:38:30.804365 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.5ms | ActiveRecord: 2.0ms)


D, [2018-09-12T22:38:30.806952 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:38:30.809352 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:38:30.818454 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:38:30 +0530
I, [2018-09-12T22:38:30.855666 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:38:30.855759 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:38:30.858359 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:38:30.860334 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:38:37.867506 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:38:37.868086 #11095]  INFO -- : Completed 200 OK in 7012ms (Views: 0.2ms | ActiveRecord: 1.5ms)


D, [2018-09-12T22:38:37.869309 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:38:37.870125 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:38:37.873911 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:38:37 +0530
I, [2018-09-12T22:38:37.887275 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:38:37.887397 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:38:37.891551 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:38:37.893327 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:38:44.899639 #11095] DEBUG -- :   [1m[36mSetting Load (0.6ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:38:44.900302 #11095]  INFO -- : Completed 200 OK in 7013ms (Views: 0.3ms | ActiveRecord: 1.9ms)


D, [2018-09-12T22:38:44.901405 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:38:44.902954 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:38:44.906470 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:38:44 +0530
I, [2018-09-12T22:38:44.922169 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:38:44.922240 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:38:44.924655 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:38:44.926353 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:38:51.937982 #11095] DEBUG -- :   [1m[36mSetting Load (1.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:38:51.939819 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.6ms | ActiveRecord: 2.4ms)


D, [2018-09-12T22:38:51.942726 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:38:51.945007 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:38:51.956718 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:38:51 +0530
I, [2018-09-12T22:38:51.998749 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:38:51.999143 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:38:52.011047 #11095] DEBUG -- :   [1m[35m (1.1ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:38:52.017578 #11095] DEBUG -- :   [1m[35m (2.0ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:38:59.025541 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:38:59.026038 #11095]  INFO -- : Completed 200 OK in 7027ms (Views: 0.2ms | ActiveRecord: 3.7ms)


D, [2018-09-12T22:38:59.026983 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:38:59.028595 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:38:59.033102 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:38:59 +0530
I, [2018-09-12T22:38:59.046363 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:38:59.046472 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:38:59.050063 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:38:59.051916 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T22:39:03.362409 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:39:03 +0530
I, [2018-09-12T22:39:03.385676 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:39:03.385766 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T22:39:03.388326 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:39:03.389964 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:39:03.391569 #11095] DEBUG -- :   [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:39:03.393756 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:39:03.395466 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:39:03.396326 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:39:03.396876 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:39:03.398284 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:09:03.396000"], ["id", 1]]
D, [2018-09-12T22:39:03.399500 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:39:03.400845 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 09:09:03.399950')[0m
D, [2018-09-12T22:39:03.402989 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:39:03.403446 #11095]  INFO -- : Completed 200 OK in 18ms (Views: 0.2ms | ActiveRecord: 4.3ms)


D, [2018-09-12T22:39:03.404721 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:39:03.405446 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:39:04.057159 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T22:39:04.063670 #11095] DEBUG -- :   [1m[36mSetting Load (1.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:39:04.065008 #11095]  INFO -- : Completed 200 OK in 5018ms (Views: 1.1ms | ActiveRecord: 2.8ms)


D, [2018-09-12T22:39:04.067868 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:39:04.069525 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:39:04.077712 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:39:04 +0530
I, [2018-09-12T22:39:04.092075 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:39:04 +0530
I, [2018-09-12T22:39:04.106852 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:39:04.108669 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:39:04.108825 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
I, [2018-09-12T22:39:04.108998 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
D, [2018-09-12T22:39:04.113210 #11095] DEBUG -- :   [1m[35m (1.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:39:04.114919 #11095] DEBUG -- :   [1m[35m (1.7ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:39:04.119436 #11095] DEBUG -- :   [1m[35m (4.0ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:39:04.120939 #11095] DEBUG -- :   [1m[35m (2.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:39:04.122694 #11095] DEBUG -- :   [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:39:04.124573 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:39:04.126030 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:39:04.126790 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:39:04.127233 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:39:04.127694 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:39:04.129236 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:09:04.127000"], ["id", 1]]
D, [2018-09-12T22:39:04.132087 #11095] DEBUG -- :   [1m[35m (2.4ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:39:04.134707 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.6ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:39:04.136410 #11095] DEBUG -- :   [1m[36mChat Load (0.3ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T22:39:04.138404 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:07:04.137712')[0m  [["active", "t"]]
D, [2018-09-12T22:39:04.140755 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.2ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:39:04.141483 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:39:04.142080 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.2ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:39:04.142777 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:39:04.143790 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:07:04.142954')[0m  [["active", "t"]]
D, [2018-09-12T22:39:04.144697 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:07:04.143970')[0m  [["active", "t"]]
D, [2018-09-12T22:39:04.145915 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T22:39:04.147438 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:07:04.146293')[0m  [["active", "t"]]
D, [2018-09-12T22:39:04.148897 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:39:04.151047 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.5ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:39:04.155174 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:39:04.155656 #11095]  INFO -- : Completed 200 OK in 46ms (Views: 0.2ms | ActiveRecord: 12.9ms)


D, [2018-09-12T22:39:04.157037 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:39:04.157898 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:39:05.124312 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T22:39:05.132003 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:39:05.133517 #11095]  INFO -- : Completed 200 OK in 1024ms (Views: 4.3ms | ActiveRecord: 6.5ms)


D, [2018-09-12T22:39:05.136042 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:39:05.138462 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:39:05.149249 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:39:05 +0530
I, [2018-09-12T22:39:05.169539 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:39:05.169609 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:39:05.172615 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:39:05.176946 #11095] DEBUG -- :   [1m[35m (1.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:39:12.185684 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:39:12.186986 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.5ms | ActiveRecord: 3.3ms)


D, [2018-09-12T22:39:12.189465 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:39:12.191850 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:39:12.201299 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:39:12 +0530
I, [2018-09-12T22:39:12.229873 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:39:12.229985 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:39:12.232700 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:39:12.234433 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:39:19.243632 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:39:19.245017 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.4ms | ActiveRecord: 2.2ms)


D, [2018-09-12T22:39:19.247447 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:39:19.249858 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:39:19.258602 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:39:19 +0530
I, [2018-09-12T22:39:19.284215 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:39:19.284309 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:39:19.286976 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:39:19.288605 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:39:26.298314 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:39:26.299570 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.5ms | ActiveRecord: 2.0ms)


D, [2018-09-12T22:39:26.302154 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:39:26.304214 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:39:26.313349 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:39:26 +0530
I, [2018-09-12T22:39:26.341107 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:39:26.341190 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:39:26.343662 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:39:26.345231 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:39:33.355013 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:39:33.356796 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.4ms | ActiveRecord: 2.0ms)


D, [2018-09-12T22:39:33.361113 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:39:33.364704 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:39:33.377614 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:39:33 +0530
I, [2018-09-12T22:39:33.407290 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:39:33.407379 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:39:33.410093 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:39:33.411834 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:39:40.420696 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:39:40.423255 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.4ms | ActiveRecord: 2.3ms)


D, [2018-09-12T22:39:40.427510 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:39:40.430913 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:39:40.442366 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:39:40 +0530
I, [2018-09-12T22:39:40.470762 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:39:40.470872 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:39:40.473718 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:39:40.475343 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:39:40.476453 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:39:40.478073 #11095] DEBUG -- :   [1m[35mSQL (0.4ms)[0m  [1m[32mINSERT INTO "delayed_jobs" ("handler", "run_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["handler", "--- !ruby/object:Observer::UserDeviceLogJob\nhttp_user_agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko)\n  Chrome/68.0.3440.106 Safari/537.36\nremote_ip: \"::1\"\nuser_id: 3\nfingerprint: \"-1992429858\"\ntype: session\n"], ["run_at", "2018-09-12 17:09:40.476613"], ["created_at", "2018-09-12 17:09:40.476000"], ["updated_at", "2018-09-12 17:09:40.476000"]]
D, [2018-09-12T22:39:40.481582 #11095] DEBUG -- :   [1m[35m (2.9ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:39:47.492228 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:39:47.493560 #11095]  INFO -- : Completed 200 OK in 7022ms (Views: 0.4ms | ActiveRecord: 5.5ms)


D, [2018-09-12T22:39:47.497107 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:39:47.500832 #11095] DEBUG -- :   [1m[35mSQL (0.8ms)[0m  [1m[33mUPDATE "sessions" SET "data" = $1, "updated_at" = $2 WHERE "sessions"."id" = $3[0m  [["data", "BAh7D0kiCXBpbmcGOgZFRkkiGTIwMTgtMDktMTJUMTY6MDk6MjZaBjsAVEki\nD3VzZXJfYWdlbnQGOwBGIm5Nb3ppbGxhLzUuMCAoWDExOyBMaW51eCB4ODZf\nNjQpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENo\ncm9tZS82OC4wLjM0NDAuMTA2IFNhZmFyaS81MzcuMzZJIhBfY3NyZl90b2tl\nbgY7AEZJIjE1SzlmTEZWTnRwVFYydjArWGQ1M21QMjFWbDAzT1RSeEp2cUpm\nbitDRDUwPQY7AEZJIgx1c2VyX2lkBjsARmkISSIadXNlcl9kZXZpY2VfcmVt\nb3RlX2lwBjsARiIIOjoxSSIcdXNlcl9kZXZpY2VfZmluZ2VycHJpbnQGOwBG\nSSIQLTE5OTI0Mjk4NTgGOwBUSSIbdXNlcl9kZXZpY2VfdXBkYXRlZF9hdAY7\nAEZVOiBBY3RpdmVTdXBwb3J0OjpUaW1lV2l0aFpvbmVbCEl1OglUaW1lDZGh\nHcD7QYcmCToJem9uZUkiCFVUQwY7AEY6DW5hbm9fbnVtaQKiAjoNbmFub19k\nZW5pBjoNc3VibWljcm8iB2dASSIIVVRDBjsAVEAWSSIPcGVyc2lzdGVudAY7\nAEZUSSIOcmVtb3RlX2lwBjsARiIIOjoxSSIIZ2VvBjsARnsA\n"], ["updated_at", "2018-09-12 17:09:47.497950"], ["id", 33]]
D, [2018-09-12T22:39:47.504695 #11095] DEBUG -- :   [1m[35m (3.0ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:39:47.514573 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:39:47 +0530
I, [2018-09-12T22:39:47.544591 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:39:47.544683 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:39:47.547392 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:39:47.549325 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:39:54.558471 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:39:54.559843 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.6ms | ActiveRecord: 1.9ms)


D, [2018-09-12T22:39:54.562790 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:39:54.565151 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:39:54.574758 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:39:54 +0530
I, [2018-09-12T22:39:54.599962 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:39:54.600050 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:39:54.602643 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:39:54.604274 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T22:39:58.363932 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:39:58 +0530
I, [2018-09-12T22:39:58.393751 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:39:58.393857 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T22:39:58.396902 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:39:58.398717 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:39:58.400267 #11095] DEBUG -- :   [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:39:58.402369 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:39:58.404043 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:39:58.404939 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:39:58.405675 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:39:58.407477 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:09:58.405000"], ["id", 1]]
D, [2018-09-12T22:39:58.408697 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:39:58.410165 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 09:09:58.409353')[0m
D, [2018-09-12T22:39:58.411874 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:39:58.412378 #11095]  INFO -- : Completed 200 OK in 18ms (Views: 0.1ms | ActiveRecord: 4.4ms)


D, [2018-09-12T22:39:58.414021 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:39:58.415041 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:39:59.610268 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T22:39:59.613856 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:39:59.615261 #11095]  INFO -- : Completed 200 OK in 5015ms (Views: 0.5ms | ActiveRecord: 2.0ms)


D, [2018-09-12T22:39:59.617974 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:39:59.620217 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:39:59.630451 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:39:59 +0530
I, [2018-09-12T22:39:59.632204 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:39:59 +0530
I, [2018-09-12T22:39:59.668322 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:39:59.669974 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:39:59.670091 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
I, [2018-09-12T22:39:59.672786 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:39:59.675064 #11095] DEBUG -- :   [1m[35m (2.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:39:59.676226 #11095] DEBUG -- :   [1m[35m (1.2ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:39:59.677315 #11095] DEBUG -- :   [1m[35m (1.2ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:39:59.678449 #11095] DEBUG -- :   [1m[35m (1.2ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:39:59.679090 #11095] DEBUG -- :   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:39:59.680662 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:39:59.682181 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:39:59.682998 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:39:59.683412 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:39:59.683908 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:39:59.685296 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:09:59.683000"], ["id", 1]]
D, [2018-09-12T22:39:59.688143 #11095] DEBUG -- :   [1m[35m (2.6ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:39:59.689636 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:39:59.690887 #11095] DEBUG -- :   [1m[36mChat Load (0.4ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T22:39:59.692765 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:07:59.692057')[0m  [["active", "t"]]
D, [2018-09-12T22:39:59.695187 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:39:59.696172 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:39:59.696868 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.2ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:39:59.697637 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:39:59.698505 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:07:59.697842')[0m  [["active", "t"]]
D, [2018-09-12T22:39:59.699180 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:07:59.698672')[0m  [["active", "t"]]
D, [2018-09-12T22:39:59.700072 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T22:39:59.701033 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:07:59.700297')[0m  [["active", "t"]]
D, [2018-09-12T22:39:59.701617 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:39:59.702612 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:39:59.705299 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:39:59.705803 #11095]  INFO -- : Completed 200 OK in 36ms (Views: 0.1ms | ActiveRecord: 11.9ms)


D, [2018-09-12T22:39:59.706963 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:39:59.707656 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:40:00.684621 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T22:40:00.692376 #11095] DEBUG -- :   [1m[36mSetting Load (1.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:40:00.693915 #11095]  INFO -- : Completed 200 OK in 1021ms (Views: 3.8ms | ActiveRecord: 3.8ms)


D, [2018-09-12T22:40:00.697533 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:40:00.700111 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:40:00.711728 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:40:00 +0530
I, [2018-09-12T22:40:00.731478 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:40:00.731567 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:40:00.734210 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:40:00.735746 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:40:07.746481 #11095] DEBUG -- :   [1m[36mSetting Load (1.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:40:07.747964 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.6ms | ActiveRecord: 2.3ms)


D, [2018-09-12T22:40:07.750865 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:40:07.753412 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:40:07.764859 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:40:07 +0530
I, [2018-09-12T22:40:07.795645 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:40:07.795740 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:40:07.798622 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:40:07.800369 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:40:14.810192 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:40:14.811438 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.4ms | ActiveRecord: 2.1ms)


D, [2018-09-12T22:40:14.814221 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:40:14.816308 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:40:14.825125 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:40:14 +0530
I, [2018-09-12T22:40:14.860408 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:40:14.860482 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:40:14.862740 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:40:14.864323 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:40:21.873876 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:40:21.875261 #11095]  INFO -- : Completed 200 OK in 7014ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T22:40:21.877925 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:40:21.880282 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:40:21.890592 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:40:21 +0530
I, [2018-09-12T22:40:21.919053 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:40:21.919137 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:40:21.921899 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:40:21.924187 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:40:28.933733 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:40:28.935044 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T22:40:28.937600 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:40:28.939546 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:40:28.951082 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:40:28 +0530
I, [2018-09-12T22:40:28.973612 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:40:28.973705 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:40:28.976886 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:40:28.979072 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:40:35.989673 #11095] DEBUG -- :   [1m[36mSetting Load (1.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:40:35.991516 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.4ms | ActiveRecord: 2.6ms)


D, [2018-09-12T22:40:35.995575 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:40:35.999544 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:40:36.009839 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:40:36 +0530
I, [2018-09-12T22:40:36.037298 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:40:36.037421 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:40:36.043749 #11095] DEBUG -- :   [1m[35m (1.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:40:36.046322 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:40:43.059235 #11095] DEBUG -- :   [1m[36mSetting Load (0.6ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:40:43.060207 #11095]  INFO -- : Completed 200 OK in 7023ms (Views: 1.4ms | ActiveRecord: 3.1ms)


D, [2018-09-12T22:40:43.061595 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:40:43.062667 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:40:43.066440 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:40:43 +0530
I, [2018-09-12T22:40:43.080624 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:40:43.080723 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:40:43.083206 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:40:43.084674 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:40:50.096468 #11095] DEBUG -- :   [1m[36mSetting Load (1.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:40:50.098667 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.6ms | ActiveRecord: 2.3ms)


D, [2018-09-12T22:40:50.104182 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:40:50.109705 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:40:50.123916 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:40:50 +0530
I, [2018-09-12T22:40:50.167205 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:40:50.167464 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:40:50.174344 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:40:50.177482 #11095] DEBUG -- :   [1m[35m (1.0ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T22:40:53.362843 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:40:53 +0530
I, [2018-09-12T22:40:53.393092 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:40:53.393220 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T22:40:53.396388 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:40:53.397991 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:40:53.399377 #11095] DEBUG -- :   [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:40:53.401088 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:40:53.402351 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:40:53.403178 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:40:53.403681 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:40:53.404872 #11095] DEBUG -- :   [1m[35mSQL (0.2ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:10:53.403000"], ["id", 1]]
D, [2018-09-12T22:40:53.406268 #11095] DEBUG -- :   [1m[35m (1.0ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:40:53.409804 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.7ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 09:10:53.407813')[0m
D, [2018-09-12T22:40:53.413266 #11095] DEBUG -- :   [1m[36mSetting Load (0.6ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:40:53.414202 #11095]  INFO -- : Completed 200 OK in 21ms (Views: 0.3ms | ActiveRecord: 4.6ms)


D, [2018-09-12T22:40:53.416403 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:40:53.417544 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:40:55.183102 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T22:40:55.186899 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:40:55.188122 #11095]  INFO -- : Completed 200 OK in 5020ms (Views: 0.6ms | ActiveRecord: 3.0ms)


D, [2018-09-12T22:40:55.190922 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:40:55.193382 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:40:55.203952 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:40:55 +0530
I, [2018-09-12T22:40:55.216931 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:40:55 +0530
I, [2018-09-12T22:40:55.241304 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:40:55.241416 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
I, [2018-09-12T22:40:55.246312 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:40:55.246459 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
D, [2018-09-12T22:40:55.246678 #11095] DEBUG -- :   [1m[35m (2.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:40:55.250166 #11095] DEBUG -- :   [1m[35m (1.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:40:55.250966 #11095] DEBUG -- :   [1m[35m (1.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:40:55.252585 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:40:55.254035 #11095] DEBUG -- :   [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:40:55.256049 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:40:55.257738 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:40:55.258551 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:40:55.259026 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:40:55.259457 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:40:55.260997 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:10:55.259000"], ["id", 1]]
D, [2018-09-12T22:40:55.268309 #11095] DEBUG -- :   [1m[35m (6.9ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:40:55.271908 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.8ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:40:55.274772 #11095] DEBUG -- :   [1m[36mChat Load (0.7ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T22:40:55.280651 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.9ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:08:55.278400')[0m  [["active", "t"]]
D, [2018-09-12T22:40:55.286079 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.5ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:40:55.287321 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:40:55.288249 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.4ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:40:55.289393 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:40:55.290758 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:08:55.289638')[0m  [["active", "t"]]
D, [2018-09-12T22:40:55.291898 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:08:55.290968')[0m  [["active", "t"]]
D, [2018-09-12T22:40:55.292972 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T22:40:55.293958 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:08:55.293198')[0m  [["active", "t"]]
D, [2018-09-12T22:40:55.294671 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:40:55.295660 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:40:55.298563 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:40:55.299005 #11095]  INFO -- : Completed 200 OK in 52ms (Views: 0.1ms | ActiveRecord: 16.4ms)


D, [2018-09-12T22:40:55.300275 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:40:55.301132 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:40:56.254710 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T22:40:56.262061 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:40:56.263397 #11095]  INFO -- : Completed 200 OK in 1022ms (Views: 3.8ms | ActiveRecord: 5.0ms)


D, [2018-09-12T22:40:56.266337 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:40:56.268682 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:40:56.279109 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:40:56 +0530
I, [2018-09-12T22:40:56.301860 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:40:56.301942 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:40:56.304251 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:40:56.305701 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:41:03.317016 #11095] DEBUG -- :   [1m[36mSetting Load (1.6ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:41:03.318980 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.5ms | ActiveRecord: 2.4ms)


D, [2018-09-12T22:41:03.321983 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:41:03.324160 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:41:03.336581 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:41:03 +0530
I, [2018-09-12T22:41:03.363193 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:41:03.363301 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:41:03.366956 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:41:03.368668 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:41:10.379061 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:41:10.380543 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.4ms | ActiveRecord: 2.2ms)


D, [2018-09-12T22:41:10.383258 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:41:10.385398 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:41:10.397743 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:41:10 +0530
I, [2018-09-12T22:41:10.421601 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:41:10.421698 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:41:10.424215 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:41:10.426018 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:41:17.432928 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:41:17.433367 #11095]  INFO -- : Completed 200 OK in 7012ms (Views: 0.2ms | ActiveRecord: 1.4ms)


D, [2018-09-12T22:41:17.434346 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:41:17.435015 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:41:17.438435 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:41:17 +0530
I, [2018-09-12T22:41:17.453497 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:41:17.453632 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:41:17.456794 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:41:17.459439 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:41:24.470615 #11095] DEBUG -- :   [1m[36mSetting Load (1.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:41:24.472951 #11095]  INFO -- : Completed 200 OK in 7019ms (Views: 0.5ms | ActiveRecord: 2.6ms)


D, [2018-09-12T22:41:24.477527 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:41:24.479877 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:41:24.486295 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:41:24 +0530
I, [2018-09-12T22:41:24.502516 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:41:24.502618 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:41:24.505096 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:41:24.506602 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:41:31.516400 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:41:31.517895 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.6ms | ActiveRecord: 2.2ms)


D, [2018-09-12T22:41:31.521271 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:41:31.524389 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:41:31.548983 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:41:31 +0530
I, [2018-09-12T22:41:31.570951 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:41:31.571097 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:41:31.575896 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:41:31.577865 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:41:38.587024 #11095] DEBUG -- :   [1m[36mSetting Load (0.8ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:41:38.587954 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.4ms | ActiveRecord: 2.0ms)


D, [2018-09-12T22:41:38.590125 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:41:38.593041 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:41:38.600141 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:41:38 +0530
I, [2018-09-12T22:41:38.621154 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:41:38.621226 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:41:38.623472 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:41:38.624997 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:41:45.636756 #11095] DEBUG -- :   [1m[36mSetting Load (1.8ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:41:45.638399 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.9ms | ActiveRecord: 2.6ms)


D, [2018-09-12T22:41:45.641878 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:41:45.646816 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:41:45.655132 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:41:45 +0530
I, [2018-09-12T22:41:45.672086 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:41:45.672167 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:41:45.674998 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:41:45.677242 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T22:41:48.364486 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:41:48 +0530
I, [2018-09-12T22:41:48.416314 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:41:48.416676 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T22:41:48.422664 #11095] DEBUG -- :   [1m[35m (1.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:41:48.427794 #11095] DEBUG -- :   [1m[35m (1.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:41:48.432912 #11095] DEBUG -- :   [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:41:48.435957 #11095] DEBUG -- :   [1m[35mCACHE  (0.1ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:41:48.438397 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:41:48.439582 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:41:48.440433 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:41:48.443645 #11095] DEBUG -- :   [1m[35mSQL (0.7ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:11:48.439000"], ["id", 1]]
D, [2018-09-12T22:41:48.446039 #11095] DEBUG -- :   [1m[35m (1.5ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:41:48.448111 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 09:11:48.446990')[0m
D, [2018-09-12T22:41:48.450206 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:41:48.450743 #11095]  INFO -- : Completed 200 OK in 34ms (Views: 0.1ms | ActiveRecord: 8.0ms)


D, [2018-09-12T22:41:48.453715 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:41:48.456826 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:41:48.683532 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T22:41:48.687147 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:41:48.688426 #11095]  INFO -- : Completed 200 OK in 3016ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T22:41:48.690743 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:41:48.693108 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:41:48.704057 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:41:48 +0530
I, [2018-09-12T22:41:48.725664 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:41:48 +0530
I, [2018-09-12T22:41:48.738874 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:41:48.738964 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
I, [2018-09-12T22:41:48.742064 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:41:48.742147 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:41:48.744528 #11095] DEBUG -- :   [1m[35m (3.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:41:48.746071 #11095] DEBUG -- :   [1m[35m (2.2ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:41:48.747028 #11095] DEBUG -- :   [1m[35m (1.1ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:41:48.748149 #11095] DEBUG -- :   [1m[35m (1.2ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:41:48.748691 #11095] DEBUG -- :   [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:41:48.750133 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:41:48.751378 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:41:48.752250 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:41:48.752730 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:41:48.753320 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:41:48.754538 #11095] DEBUG -- :   [1m[35mSQL (0.2ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:11:48.752000"], ["id", 1]]
D, [2018-09-12T22:41:48.757445 #11095] DEBUG -- :   [1m[35m (2.7ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:41:48.758661 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:41:48.759619 #11095] DEBUG -- :   [1m[36mChat Load (0.3ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T22:41:48.761259 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:09:48.760648')[0m  [["active", "t"]]
D, [2018-09-12T22:41:48.763426 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.2ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:41:48.764152 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:41:48.764766 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.2ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:41:48.765581 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:41:48.766394 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:09:48.765724')[0m  [["active", "t"]]
D, [2018-09-12T22:41:48.767088 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:09:48.766513')[0m  [["active", "t"]]
D, [2018-09-12T22:41:48.767838 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T22:41:48.768523 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:09:48.767974')[0m  [["active", "t"]]
D, [2018-09-12T22:41:48.769053 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:41:48.769961 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.4ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:41:48.772965 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:41:48.773389 #11095]  INFO -- : Completed 200 OK in 34ms (Views: 0.1ms | ActiveRecord: 12.5ms)


D, [2018-09-12T22:41:48.774649 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:41:48.776188 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:41:49.753399 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T22:41:49.760431 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:41:49.761736 #11095]  INFO -- : Completed 200 OK in 1019ms (Views: 3.4ms | ActiveRecord: 4.5ms)


D, [2018-09-12T22:41:49.764371 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:41:49.766943 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:41:49.781515 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:41:49 +0530
I, [2018-09-12T22:41:49.808870 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:41:49.808957 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:41:49.811812 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:41:49.814118 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:41:56.824909 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:41:56.826377 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.6ms | ActiveRecord: 2.3ms)


D, [2018-09-12T22:41:56.829388 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:41:56.831716 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:41:56.843556 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:41:56 +0530
I, [2018-09-12T22:41:56.865982 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:41:56.866064 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:41:56.869682 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:41:56.872534 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:42:03.883158 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:42:03.884638 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.5ms | ActiveRecord: 2.6ms)


D, [2018-09-12T22:42:03.887696 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:42:03.890114 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:42:03.901433 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:42:03 +0530
I, [2018-09-12T22:42:03.932230 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:42:03.932328 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:42:03.934606 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:42:03.936105 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:42:10.945621 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:42:10.946915 #11095]  INFO -- : Completed 200 OK in 7014ms (Views: 0.5ms | ActiveRecord: 1.9ms)


D, [2018-09-12T22:42:10.949660 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:42:10.951872 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:42:10.962804 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:42:10 +0530
I, [2018-09-12T22:42:10.990275 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:42:10.990358 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:42:10.993164 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:42:10.994839 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:42:18.004821 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:42:18.006279 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T22:42:18.009575 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:42:18.012151 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:42:18.020597 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:42:18 +0530
I, [2018-09-12T22:42:18.046268 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:42:18.046348 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:42:18.048768 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:42:18.050131 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:42:25.060365 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:42:25.061832 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.5ms | ActiveRecord: 1.9ms)


D, [2018-09-12T22:42:25.064703 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:42:25.067153 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:42:25.079094 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:42:25 +0530
I, [2018-09-12T22:42:25.122780 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:42:25.122895 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:42:25.127430 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:42:25.130331 #11095] DEBUG -- :   [1m[35m (1.1ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:42:32.139966 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:42:32.141241 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.5ms | ActiveRecord: 2.8ms)


D, [2018-09-12T22:42:32.144199 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:42:32.146255 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:42:32.156014 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:42:32 +0530
I, [2018-09-12T22:42:32.180045 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:42:32.180132 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:42:32.182598 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:42:32.184082 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:42:39.193544 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:42:39.194860 #11095]  INFO -- : Completed 200 OK in 7014ms (Views: 0.5ms | ActiveRecord: 2.0ms)


D, [2018-09-12T22:42:39.197568 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:42:39.199974 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:42:39.208803 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:42:39 +0530
I, [2018-09-12T22:42:39.231779 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:42:39.231866 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:42:39.234279 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:42:39.235827 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T22:42:43.363218 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:42:43 +0530
I, [2018-09-12T22:42:43.393792 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:42:43.394217 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T22:42:43.397113 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:42:43.398626 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:42:43.399869 #11095] DEBUG -- :   [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:42:43.401752 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:42:43.402988 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:42:43.403679 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:42:43.404208 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:42:43.405445 #11095] DEBUG -- :   [1m[35mSQL (0.2ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:12:43.403000"], ["id", 1]]
D, [2018-09-12T22:42:43.406461 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:42:43.407590 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 09:12:43.406890')[0m
D, [2018-09-12T22:42:43.409006 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:42:43.409407 #11095]  INFO -- : Completed 200 OK in 15ms (Views: 0.1ms | ActiveRecord: 3.9ms)


D, [2018-09-12T22:42:43.410564 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:42:43.411540 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:42:44.241624 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T22:42:44.246994 #11095] DEBUG -- :   [1m[36mSetting Load (1.9ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:42:44.249639 #11095]  INFO -- : Completed 200 OK in 5017ms (Views: 0.6ms | ActiveRecord: 2.8ms)


D, [2018-09-12T22:42:44.252697 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:42:44.255730 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:42:44.268310 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:42:44 +0530
I, [2018-09-12T22:42:44.286315 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:42:44 +0530
I, [2018-09-12T22:42:44.303762 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:42:44.303873 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
I, [2018-09-12T22:42:44.307661 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:42:44.307787 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:42:44.309489 #11095] DEBUG -- :   [1m[35m (1.8ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:42:44.310608 #11095] DEBUG -- :   [1m[35m (1.2ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:42:44.311627 #11095] DEBUG -- :   [1m[35m (1.1ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:42:44.312689 #11095] DEBUG -- :   [1m[35m (1.2ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:42:44.313362 #11095] DEBUG -- :   [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:42:44.315666 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:42:44.318071 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:42:44.319747 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:42:44.320232 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:42:44.320726 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:42:44.322277 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:12:44.320000"], ["id", 1]]
D, [2018-09-12T22:42:44.329491 #11095] DEBUG -- :   [1m[35m (6.9ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:42:44.331115 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.4ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:42:44.333058 #11095] DEBUG -- :   [1m[36mChat Load (0.6ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T22:42:44.336550 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:10:44.335438')[0m  [["active", "t"]]
D, [2018-09-12T22:42:44.339639 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.4ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:42:44.340588 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:42:44.341273 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:42:44.342101 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:42:44.343105 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:10:44.342284')[0m  [["active", "t"]]
D, [2018-09-12T22:42:44.343918 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:10:44.343253')[0m  [["active", "t"]]
D, [2018-09-12T22:42:44.344845 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T22:42:44.345728 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:10:44.345049')[0m  [["active", "t"]]
D, [2018-09-12T22:42:44.346401 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:42:44.347426 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:42:44.351997 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:42:44.352705 #11095]  INFO -- : Completed 200 OK in 47ms (Views: 0.3ms | ActiveRecord: 17.5ms)


D, [2018-09-12T22:42:44.354052 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:42:44.354788 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:42:45.317149 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T22:42:45.324719 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:42:45.326178 #11095]  INFO -- : Completed 200 OK in 1018ms (Views: 4.1ms | ActiveRecord: 3.6ms)


D, [2018-09-12T22:42:45.328824 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:42:45.331372 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:42:45.341727 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:42:45 +0530
I, [2018-09-12T22:42:45.365386 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:42:45.365499 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:42:45.367850 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:42:45.369490 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:42:52.379257 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:42:52.380591 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.4ms | ActiveRecord: 1.9ms)


D, [2018-09-12T22:42:52.383335 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:42:52.385487 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:42:52.392899 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:42:52 +0530
I, [2018-09-12T22:42:52.412629 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:42:52.412718 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:42:52.414998 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:42:52.416442 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:42:59.426510 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:42:59.427955 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.4ms | ActiveRecord: 2.1ms)


D, [2018-09-12T22:42:59.430553 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:42:59.432763 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:42:59.441765 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:42:59 +0530
I, [2018-09-12T22:42:59.468530 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:42:59.468622 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:42:59.471771 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:42:59.473486 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:43:06.483786 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:43:06.485230 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.4ms | ActiveRecord: 2.4ms)


D, [2018-09-12T22:43:06.488146 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:43:06.491134 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:43:06.502080 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:43:06 +0530
I, [2018-09-12T22:43:06.517536 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:43:06.517661 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:43:06.520130 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:43:06.521647 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:43:13.531538 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:43:13.532993 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.5ms | ActiveRecord: 2.0ms)


D, [2018-09-12T22:43:13.535932 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:43:13.539730 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:43:13.563885 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:43:13 +0530
I, [2018-09-12T22:43:13.583097 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:43:13.583215 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:43:13.586739 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:43:13.588831 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:43:20.599813 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:43:20.600640 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.5ms | ActiveRecord: 2.4ms)


D, [2018-09-12T22:43:20.602309 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:43:20.603666 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:43:20.608699 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:43:20 +0530
I, [2018-09-12T22:43:20.629296 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:43:20.629522 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:43:20.634067 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:43:20.635704 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:43:27.645004 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:43:27.646648 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.5ms | ActiveRecord: 2.4ms)


D, [2018-09-12T22:43:27.650115 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:43:27.652500 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:43:27.666077 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:43:27 +0530
I, [2018-09-12T22:43:27.713782 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:43:27.714009 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:43:27.720711 #11095] DEBUG -- :   [1m[35m (1.1ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:43:27.725769 #11095] DEBUG -- :   [1m[35m (1.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:43:34.738636 #11095] DEBUG -- :   [1m[36mSetting Load (2.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:43:34.741018 #11095]  INFO -- : Completed 200 OK in 7026ms (Views: 0.6ms | ActiveRecord: 5.0ms)


D, [2018-09-12T22:43:34.744553 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:43:34.747120 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:43:34.757486 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:43:34 +0530
I, [2018-09-12T22:43:34.779810 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:43:34.779933 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:43:34.782416 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:43:34.784436 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T22:43:38.368441 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:43:38 +0530
I, [2018-09-12T22:43:38.394209 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:43:38.394297 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T22:43:38.396835 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:43:38.399057 #11095] DEBUG -- :   [1m[35m (1.0ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:43:38.400646 #11095] DEBUG -- :   [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:43:38.402604 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:43:38.404277 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:43:38.405065 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:43:38.405692 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:43:38.407137 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:13:38.405000"], ["id", 1]]
D, [2018-09-12T22:43:38.408380 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:43:38.409538 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 09:13:38.408828')[0m
D, [2018-09-12T22:43:38.410938 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:43:38.411369 #11095]  INFO -- : Completed 200 OK in 17ms (Views: 0.1ms | ActiveRecord: 4.7ms)


D, [2018-09-12T22:43:38.412651 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:43:38.413503 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:43:39.791898 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T22:43:39.795649 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:43:39.796833 #11095]  INFO -- : Completed 200 OK in 5017ms (Views: 0.4ms | ActiveRecord: 2.3ms)


D, [2018-09-12T22:43:39.799244 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:43:39.801773 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:43:39.811851 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:43:39 +0530
I, [2018-09-12T22:43:39.831136 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:43:39 +0530
I, [2018-09-12T22:43:39.844380 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:43:39.844876 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
I, [2018-09-12T22:43:39.847166 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:43:39.848582 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:43:39.850353 #11095] DEBUG -- :   [1m[35m (1.7ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:43:39.851623 #11095] DEBUG -- :   [1m[35m (1.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:43:39.853184 #11095] DEBUG -- :   [1m[35m (1.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:43:39.854292 #11095] DEBUG -- :   [1m[35m (1.3ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:43:39.854873 #11095] DEBUG -- :   [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:43:39.856497 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:43:39.857853 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:43:39.858634 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:43:39.859161 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:43:39.859728 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:43:39.861132 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:13:39.859000"], ["id", 1]]
D, [2018-09-12T22:43:39.862219 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:43:39.863390 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:43:39.864367 #11095] DEBUG -- :   [1m[36mChat Load (0.2ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T22:43:39.866274 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:11:39.865466')[0m  [["active", "t"]]
D, [2018-09-12T22:43:39.868773 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:43:39.869573 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:43:39.870223 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:43:39.870978 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:43:39.871941 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:11:39.871142')[0m  [["active", "t"]]
D, [2018-09-12T22:43:39.872765 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:11:39.872106')[0m  [["active", "t"]]
D, [2018-09-12T22:43:39.873666 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T22:43:39.874455 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:11:39.873818')[0m  [["active", "t"]]
D, [2018-09-12T22:43:39.875070 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:43:39.875945 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:43:39.878786 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:43:39.879189 #11095]  INFO -- : Completed 200 OK in 34ms (Views: 0.1ms | ActiveRecord: 9.8ms)


D, [2018-09-12T22:43:39.880376 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:43:39.881173 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:43:40.861612 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T22:43:40.868814 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:43:40.870034 #11095]  INFO -- : Completed 200 OK in 1021ms (Views: 3.7ms | ActiveRecord: 3.8ms)


D, [2018-09-12T22:43:40.872882 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:43:40.877077 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:43:40.885016 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:43:40 +0530
I, [2018-09-12T22:43:40.907804 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:43:40.908193 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:43:40.915552 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:43:40.917276 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:43:47.927145 #11095] DEBUG -- :   [1m[36mSetting Load (1.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:43:47.928557 #11095]  INFO -- : Completed 200 OK in 7020ms (Views: 0.5ms | ActiveRecord: 2.3ms)


D, [2018-09-12T22:43:47.931152 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:43:47.933348 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:43:47.944418 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:43:47 +0530
I, [2018-09-12T22:43:47.981366 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:43:47.981441 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:43:47.983671 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:43:47.985222 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:43:54.996350 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:43:54.997871 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.5ms | ActiveRecord: 2.1ms)


D, [2018-09-12T22:43:55.001078 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:43:55.003424 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:43:55.015699 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:43:55 +0530
I, [2018-09-12T22:43:55.042904 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:43:55.042991 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:43:55.045597 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:43:55.047099 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:44:02.056854 #11095] DEBUG -- :   [1m[36mSetting Load (1.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:44:02.058362 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.4ms | ActiveRecord: 2.4ms)


D, [2018-09-12T22:44:02.061496 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:44:02.064199 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:44:02.072712 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:44:02 +0530
I, [2018-09-12T22:44:02.089782 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:44:02.089914 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:44:02.094041 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:44:02.095980 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:44:09.103573 #11095] DEBUG -- :   [1m[36mSetting Load (0.7ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:44:09.104354 #11095]  INFO -- : Completed 200 OK in 7014ms (Views: 0.3ms | ActiveRecord: 2.2ms)


D, [2018-09-12T22:44:09.105968 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:44:09.107703 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:44:09.113370 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:44:09 +0530
I, [2018-09-12T22:44:09.138996 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:44:09.139097 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:44:09.142867 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:44:09.144484 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:44:16.154079 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:44:16.155261 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T22:44:16.157760 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:44:16.159786 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:44:16.168361 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:44:16 +0530
I, [2018-09-12T22:44:16.198131 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:44:16.198216 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:44:16.201070 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:44:16.202791 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:44:23.212108 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:44:23.213382 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.4ms | ActiveRecord: 2.1ms)


D, [2018-09-12T22:44:23.215811 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:44:23.217863 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:44:23.227253 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:44:23 +0530
I, [2018-09-12T22:44:23.253430 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:44:23.253517 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:44:23.256098 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:44:23.257763 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:44:30.265196 #11095] DEBUG -- :   [1m[36mSetting Load (0.6ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:44:30.265876 #11095]  INFO -- : Completed 200 OK in 7012ms (Views: 0.3ms | ActiveRecord: 1.6ms)


D, [2018-09-12T22:44:30.267254 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:44:30.268609 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:44:30.274811 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:44:30 +0530
I, [2018-09-12T22:44:30.294548 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:44:30.294639 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:44:30.297639 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:44:30.299161 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T22:44:33.367088 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:44:33 +0530
I, [2018-09-12T22:44:33.392815 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:44:33.392927 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T22:44:33.395630 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:44:33.397739 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:44:33.400321 #11095] DEBUG -- :   [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:44:33.402515 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:44:33.404258 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:44:33.405162 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:44:33.405827 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:44:33.407443 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:14:33.405000"], ["id", 1]]
D, [2018-09-12T22:44:33.408705 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:44:33.410269 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 09:14:33.409278')[0m
D, [2018-09-12T22:44:33.412283 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:44:33.412786 #11095]  INFO -- : Completed 200 OK in 20ms (Views: 0.2ms | ActiveRecord: 4.7ms)


D, [2018-09-12T22:44:33.414368 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:44:33.415344 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:44:35.303883 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T22:44:35.308078 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:44:35.309246 #11095]  INFO -- : Completed 200 OK in 5014ms (Views: 0.5ms | ActiveRecord: 2.0ms)


D, [2018-09-12T22:44:35.311595 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:44:35.313537 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:44:35.326164 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:44:35 +0530
I, [2018-09-12T22:44:35.350190 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:44:35 +0530
I, [2018-09-12T22:44:35.366979 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:44:35.368544 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:44:35.368626 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
I, [2018-09-12T22:44:35.368828 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
D, [2018-09-12T22:44:35.372675 #11095] DEBUG -- :   [1m[35m (1.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:44:35.373724 #11095] DEBUG -- :   [1m[35m (1.2ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:44:35.374700 #11095] DEBUG -- :   [1m[35m (1.0ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:44:35.375519 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:44:35.376897 #11095] DEBUG -- :   [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:44:35.378684 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:44:35.380274 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:44:35.381108 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:44:35.381624 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:44:35.382080 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:44:35.383370 #11095] DEBUG -- :   [1m[35mSQL (0.2ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:14:35.381000"], ["id", 1]]
D, [2018-09-12T22:44:35.386223 #11095] DEBUG -- :   [1m[35m (2.5ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:44:35.387477 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:44:35.388401 #11095] DEBUG -- :   [1m[36mChat Load (0.2ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T22:44:35.390279 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:12:35.389571')[0m  [["active", "t"]]
D, [2018-09-12T22:44:35.392973 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:44:35.393663 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:44:35.394419 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.2ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:44:35.395214 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:44:35.396400 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:12:35.395434')[0m  [["active", "t"]]
D, [2018-09-12T22:44:35.397098 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:12:35.396556')[0m  [["active", "t"]]
D, [2018-09-12T22:44:35.397897 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T22:44:35.398527 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:12:35.398025')[0m  [["active", "t"]]
D, [2018-09-12T22:44:35.399238 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:44:35.400096 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.2ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:44:35.402258 #11095] DEBUG -- :   [1m[36mSetting Load (0.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:44:35.402613 #11095]  INFO -- : Completed 200 OK in 34ms (Views: 0.1ms | ActiveRecord: 9.5ms)


D, [2018-09-12T22:44:35.403674 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:44:35.404273 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:44:36.380163 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T22:44:36.385344 #11095] DEBUG -- :   [1m[36mSetting Load (0.8ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:44:36.386789 #11095]  INFO -- : Completed 200 OK in 1018ms (Views: 2.6ms | ActiveRecord: 3.3ms)


D, [2018-09-12T22:44:36.389446 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:44:36.391035 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:44:36.397589 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:44:36 +0530
I, [2018-09-12T22:44:36.413933 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:44:36.414008 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:44:36.416447 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:44:36.419964 #11095] DEBUG -- :   [1m[35m (1.2ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:44:43.430741 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:44:43.432187 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.6ms | ActiveRecord: 2.6ms)


D, [2018-09-12T22:44:43.434784 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:44:43.436945 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:44:43.446740 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:44:43 +0530
I, [2018-09-12T22:44:43.476186 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:44:43.476298 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:44:43.479015 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:44:43.481151 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:44:50.491842 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:44:50.493063 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.5ms | ActiveRecord: 2.4ms)


D, [2018-09-12T22:44:50.495531 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:44:50.497680 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:44:50.506811 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:44:50 +0530
I, [2018-09-12T22:44:50.531003 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:44:50.531095 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:44:50.533558 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:44:50.535021 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:44:57.545119 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:44:57.546905 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.5ms | ActiveRecord: 2.0ms)


D, [2018-09-12T22:44:57.550372 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:44:57.552597 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:44:57.561183 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:44:57 +0530
I, [2018-09-12T22:44:57.589720 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:44:57.589806 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:44:57.592408 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:44:57.594165 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:45:04.602914 #11095] DEBUG -- :   [1m[36mSetting Load (0.8ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:45:04.603872 #11095]  INFO -- : Completed 200 OK in 7014ms (Views: 0.3ms | ActiveRecord: 1.9ms)


D, [2018-09-12T22:45:04.605926 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:45:04.607321 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:45:04.613874 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:45:04 +0530
I, [2018-09-12T22:45:04.637008 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:45:04.637172 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:45:04.639789 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:45:04.641253 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:45:11.650690 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:45:11.652068 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.5ms | ActiveRecord: 1.9ms)


D, [2018-09-12T22:45:11.654610 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:45:11.656768 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:45:11.665765 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:45:11 +0530
I, [2018-09-12T22:45:11.693290 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:45:11.693375 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:45:11.695986 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:45:11.697557 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:45:18.704545 #11095] DEBUG -- :   [1m[36mSetting Load (0.6ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:45:18.705349 #11095]  INFO -- : Completed 200 OK in 7012ms (Views: 0.2ms | ActiveRecord: 1.5ms)


D, [2018-09-12T22:45:18.706741 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:45:18.707883 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:45:18.717031 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:45:18 +0530
I, [2018-09-12T22:45:18.750500 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:45:18.750698 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:45:18.756279 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:45:18.761043 #11095] DEBUG -- :   [1m[35m (2.3ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:45:25.769906 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:45:25.771190 #11095]  INFO -- : Completed 200 OK in 7020ms (Views: 0.5ms | ActiveRecord: 4.2ms)


D, [2018-09-12T22:45:25.773755 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:45:25.775791 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:45:25.804456 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:45:25 +0530
I, [2018-09-12T22:45:25.827577 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:45:25.827685 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:45:25.831634 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:45:25.833580 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T22:45:28.369219 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:45:28 +0530
I, [2018-09-12T22:45:28.395825 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:45:28.395922 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T22:45:28.398604 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:45:28.400951 #11095] DEBUG -- :   [1m[35m (1.0ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:45:28.402550 #11095] DEBUG -- :   [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:45:28.404377 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:45:28.405871 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:45:28.406671 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:45:28.407242 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:45:28.408742 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:15:28.406000"], ["id", 1]]
D, [2018-09-12T22:45:28.410333 #11095] DEBUG -- :   [1m[35m (1.3ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:45:28.411741 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 09:15:28.410798')[0m
D, [2018-09-12T22:45:28.413361 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:45:28.413792 #11095]  INFO -- : Completed 200 OK in 18ms (Views: 0.2ms | ActiveRecord: 5.1ms)


D, [2018-09-12T22:45:28.415092 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:45:28.416236 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:45:28.838518 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T22:45:28.842833 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:45:28.844320 #11095]  INFO -- : Completed 200 OK in 3016ms (Views: 0.6ms | ActiveRecord: 2.7ms)


D, [2018-09-12T22:45:28.847329 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:45:28.850112 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:45:28.862320 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:45:28 +0530
I, [2018-09-12T22:45:28.879125 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:45:28 +0530
I, [2018-09-12T22:45:28.892082 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:45:28.892486 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
I, [2018-09-12T22:45:28.896262 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:45:28.896362 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:45:28.898432 #11095] DEBUG -- :   [1m[35m (3.7ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:45:28.900945 #11095] DEBUG -- :   [1m[35m (2.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:45:28.902465 #11095] DEBUG -- :   [1m[35m (1.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:45:28.904713 #11095] DEBUG -- :   [1m[35m (2.3ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:45:28.906241 #11095] DEBUG -- :   [1m[36mUser Load (1.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:45:28.908189 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:45:28.909728 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:45:28.910518 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:45:28.910942 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:45:28.911342 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:45:28.912750 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:15:28.911000"], ["id", 1]]
D, [2018-09-12T22:45:28.920354 #11095] DEBUG -- :   [1m[35m (7.0ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:45:28.922316 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.5ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:45:28.923364 #11095] DEBUG -- :   [1m[36mChat Load (0.3ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T22:45:28.925356 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:13:28.924637')[0m  [["active", "t"]]
D, [2018-09-12T22:45:28.927914 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:45:28.928903 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:45:28.929621 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:45:28.930437 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:45:28.931880 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:13:28.930646')[0m  [["active", "t"]]
D, [2018-09-12T22:45:28.933125 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:13:28.932154')[0m  [["active", "t"]]
D, [2018-09-12T22:45:28.934264 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T22:45:28.935411 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:13:28.934476')[0m  [["active", "t"]]
D, [2018-09-12T22:45:28.936343 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:45:28.938390 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.6ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:45:28.941989 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:45:28.942488 #11095]  INFO -- : Completed 200 OK in 50ms (Views: 0.2ms | ActiveRecord: 20.6ms)


D, [2018-09-12T22:45:28.943864 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:45:28.944732 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:45:29.910470 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T22:45:29.917470 #11095] DEBUG -- :   [1m[36mSetting Load (0.9ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:45:29.918680 #11095]  INFO -- : Completed 200 OK in 1022ms (Views: 3.9ms | ActiveRecord: 5.8ms)


D, [2018-09-12T22:45:29.921333 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:45:29.923854 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:45:29.933812 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:45:29 +0530
I, [2018-09-12T22:45:29.957015 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:45:29.957106 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:45:29.959465 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:45:29.961095 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:45:36.971190 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:45:36.972541 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.5ms | ActiveRecord: 2.0ms)


D, [2018-09-12T22:45:36.975147 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:45:36.977141 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:45:36.986784 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:45:36 +0530
I, [2018-09-12T22:45:37.024630 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:45:37.024709 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:45:37.027087 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:45:37.028692 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:45:44.038790 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:45:44.040073 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T22:45:44.043100 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:45:44.045536 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:45:44.056681 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:45:44 +0530
I, [2018-09-12T22:45:44.087052 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:45:44.087132 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:45:44.089761 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:45:44.091268 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:45:51.100721 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:45:51.101916 #11095]  INFO -- : Completed 200 OK in 7014ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T22:45:51.104534 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:45:51.106762 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:45:51.115980 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:45:51 +0530
I, [2018-09-12T22:45:51.146742 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:45:51.146873 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:45:51.149668 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:45:51.151505 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:45:58.160766 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:45:58.162058 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.4ms | ActiveRecord: 2.0ms)


D, [2018-09-12T22:45:58.164652 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:45:58.166657 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:45:58.175516 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:45:58 +0530
I, [2018-09-12T22:45:58.204145 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:45:58.204250 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:45:58.206929 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:45:58.208634 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:46:05.219351 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:46:05.220629 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.6ms | ActiveRecord: 2.1ms)


D, [2018-09-12T22:46:05.223304 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:46:05.225276 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:46:05.234441 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:46:05 +0530
I, [2018-09-12T22:46:05.263461 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:46:05.263658 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:46:05.266496 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:46:05.268174 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:46:12.277823 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:46:12.279104 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.4ms | ActiveRecord: 2.0ms)


D, [2018-09-12T22:46:12.281797 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:46:12.283752 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:46:12.292631 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:46:12 +0530
I, [2018-09-12T22:46:12.319331 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:46:12.319418 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:46:12.322065 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:46:12.323761 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:46:19.334231 #11095] DEBUG -- :   [1m[36mSetting Load (1.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:46:19.335650 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.5ms | ActiveRecord: 2.3ms)


D, [2018-09-12T22:46:19.339406 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:46:19.343586 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:46:19.354718 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:46:19 +0530
I, [2018-09-12T22:46:19.383925 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:46:19.384003 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:46:19.386420 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:46:19.387989 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T22:46:23.363970 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:46:23 +0530
I, [2018-09-12T22:46:23.391990 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:46:23.392084 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T22:46:23.395313 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:46:23.397118 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:46:23.398431 #11095] DEBUG -- :   [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:46:23.400175 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:46:23.401528 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:46:23.402269 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:46:23.402803 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:46:23.404163 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:16:23.402000"], ["id", 1]]
D, [2018-09-12T22:46:23.407599 #11095] DEBUG -- :   [1m[35m (3.0ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:46:23.410655 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.7ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 09:16:23.408921')[0m
D, [2018-09-12T22:46:23.413582 #11095] DEBUG -- :   [1m[36mSetting Load (0.6ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:46:23.414349 #11095]  INFO -- : Completed 200 OK in 22ms (Views: 0.3ms | ActiveRecord: 6.9ms)


D, [2018-09-12T22:46:23.416433 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:46:23.418005 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:46:24.392975 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T22:46:24.397090 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:46:24.398444 #11095]  INFO -- : Completed 200 OK in 5014ms (Views: 0.5ms | ActiveRecord: 2.0ms)


D, [2018-09-12T22:46:24.401027 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:46:24.403453 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:46:24.412878 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:46:24 +0530
I, [2018-09-12T22:46:24.439310 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:46:24 +0530
I, [2018-09-12T22:46:24.453710 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:46:24.453807 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
I, [2018-09-12T22:46:24.455981 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:46:24.457250 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:46:24.458748 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:46:24.459743 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:46:24.460537 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:46:24.461351 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:46:24.461824 #11095] DEBUG -- :   [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:46:24.463166 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:46:24.464540 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:46:24.465197 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:46:24.465562 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:46:24.465936 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:46:24.467231 #11095] DEBUG -- :   [1m[35mSQL (0.2ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:16:24.465000"], ["id", 1]]
D, [2018-09-12T22:46:24.468278 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:46:24.469386 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.2ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:46:24.470145 #11095] DEBUG -- :   [1m[36mChat Load (0.2ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T22:46:24.471783 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:14:24.471206')[0m  [["active", "t"]]
D, [2018-09-12T22:46:24.473961 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.2ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:46:24.474655 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:46:24.475148 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.2ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:46:24.475815 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:46:24.476597 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:14:24.475955')[0m  [["active", "t"]]
D, [2018-09-12T22:46:24.477238 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:14:24.476719')[0m  [["active", "t"]]
D, [2018-09-12T22:46:24.477961 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T22:46:24.478623 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:14:24.478095')[0m  [["active", "t"]]
D, [2018-09-12T22:46:24.479077 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:46:24.479794 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.2ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:46:24.482946 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:46:24.483379 #11095]  INFO -- : Completed 200 OK in 29ms (Views: 0.1ms | ActiveRecord: 6.8ms)


D, [2018-09-12T22:46:24.485142 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:46:24.485890 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:46:25.466463 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T22:46:25.475300 #11095] DEBUG -- :   [1m[36mSetting Load (1.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:46:25.476646 #11095]  INFO -- : Completed 200 OK in 1019ms (Views: 5.0ms | ActiveRecord: 3.2ms)


D, [2018-09-12T22:46:25.479609 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:46:25.482068 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:46:25.491610 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:46:25 +0530
I, [2018-09-12T22:46:25.508106 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:46:25.508192 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:46:25.510390 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:46:25.511920 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:46:32.522370 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:46:32.523832 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.5ms | ActiveRecord: 2.1ms)


D, [2018-09-12T22:46:32.526661 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:46:32.529121 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:46:32.539846 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:46:32 +0530
I, [2018-09-12T22:46:32.568668 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:46:32.568781 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:46:32.571637 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:46:32.573215 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:46:39.583935 #11095] DEBUG -- :   [1m[36mSetting Load (1.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:46:39.585561 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.6ms | ActiveRecord: 2.4ms)


D, [2018-09-12T22:46:39.588950 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:46:39.591687 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:46:39.605282 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:46:39 +0530
I, [2018-09-12T22:46:39.627902 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:46:39.627986 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:46:39.630926 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:46:39.632913 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:46:46.642571 #11095] DEBUG -- :   [1m[36mSetting Load (1.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:46:46.644216 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.5ms | ActiveRecord: 2.6ms)


D, [2018-09-12T22:46:46.647536 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:46:46.649884 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:46:46.660999 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:46:46 +0530
I, [2018-09-12T22:46:46.684978 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:46:46.685056 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:46:46.687526 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:46:46.689014 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:46:53.699234 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:46:53.700667 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.6ms | ActiveRecord: 2.0ms)


D, [2018-09-12T22:46:53.703583 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:46:53.705786 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:46:53.716030 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:46:53 +0530
I, [2018-09-12T22:46:53.745900 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:46:53.746045 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:46:53.749330 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:46:53.751122 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:47:00.760198 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:47:00.761776 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.4ms | ActiveRecord: 2.1ms)


D, [2018-09-12T22:47:00.764608 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:47:00.766721 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:47:00.775553 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:47:00 +0530
I, [2018-09-12T22:47:00.799783 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:47:00.799871 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:47:00.802204 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:47:00.803744 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:47:07.813098 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:47:07.814286 #11095]  INFO -- : Completed 200 OK in 7014ms (Views: 0.4ms | ActiveRecord: 2.0ms)


D, [2018-09-12T22:47:07.816754 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:47:07.819058 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:47:07.827698 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:47:07 +0530
I, [2018-09-12T22:47:07.856555 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:47:07.856670 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:47:07.859630 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:47:07.861303 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:47:14.871776 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:47:14.873283 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.4ms | ActiveRecord: 2.2ms)


D, [2018-09-12T22:47:14.875891 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:47:14.877986 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:47:14.887095 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:47:14 +0530
I, [2018-09-12T22:47:14.911935 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:47:14.912022 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:47:14.914578 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:47:14.915994 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T22:47:18.364184 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:47:18 +0530
I, [2018-09-12T22:47:18.386946 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:47:18.387040 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T22:47:18.389480 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:47:18.390866 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:47:18.392201 #11095] DEBUG -- :   [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:47:18.394170 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:47:18.395834 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:47:18.396628 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:47:18.397065 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:47:18.398348 #11095] DEBUG -- :   [1m[35mSQL (0.2ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:17:18.396000"], ["id", 1]]
D, [2018-09-12T22:47:18.401262 #11095] DEBUG -- :   [1m[35m (2.7ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:47:18.402272 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 09:17:18.401698')[0m
D, [2018-09-12T22:47:18.403497 #11095] DEBUG -- :   [1m[36mSetting Load (0.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:47:18.403845 #11095]  INFO -- : Completed 200 OK in 17ms (Views: 0.1ms | ActiveRecord: 5.4ms)


D, [2018-09-12T22:47:18.404814 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:47:18.406000 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:47:19.921294 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T22:47:19.925123 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:47:19.926313 #11095]  INFO -- : Completed 200 OK in 5014ms (Views: 0.5ms | ActiveRecord: 1.9ms)


D, [2018-09-12T22:47:19.929045 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:47:19.931272 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:47:19.941096 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:47:19 +0530
I, [2018-09-12T22:47:19.965819 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:47:19 +0530
I, [2018-09-12T22:47:19.978675 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:47:19.978763 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
I, [2018-09-12T22:47:19.982297 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
D, [2018-09-12T22:47:19.982515 #11095] DEBUG -- :   [1m[35m (1.7ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
I, [2018-09-12T22:47:19.983989 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:47:19.985992 #11095] DEBUG -- :   [1m[35m (1.9ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:47:19.986916 #11095] DEBUG -- :   [1m[35m (1.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:47:19.987900 #11095] DEBUG -- :   [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:47:19.989358 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:47:19.990267 #11095] DEBUG -- :   [1m[35m (2.4ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:47:19.990823 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:47:19.991520 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:47:19.991878 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:47:19.992289 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:47:19.993597 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:17:19.991000"], ["id", 1]]
D, [2018-09-12T22:47:19.996322 #11095] DEBUG -- :   [1m[35m (2.5ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:47:19.997495 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:47:19.998287 #11095] DEBUG -- :   [1m[36mChat Load (0.2ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T22:47:19.999973 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:15:19.999332')[0m  [["active", "t"]]
D, [2018-09-12T22:47:20.002194 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:47:20.002994 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:47:20.003612 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:47:20.004311 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:47:20.005124 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:15:20.004458')[0m  [["active", "t"]]
D, [2018-09-12T22:47:20.005828 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:15:20.005264')[0m  [["active", "t"]]
D, [2018-09-12T22:47:20.006607 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T22:47:20.007264 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:15:20.006747')[0m  [["active", "t"]]
D, [2018-09-12T22:47:20.007771 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:47:20.008501 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.2ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:47:20.010776 #11095] DEBUG -- :   [1m[36mSetting Load (0.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:47:20.011179 #11095]  INFO -- : Completed 200 OK in 32ms (Views: 0.1ms | ActiveRecord: 12.0ms)


D, [2018-09-12T22:47:20.012412 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:47:20.013232 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:47:20.996907 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T22:47:21.006037 #11095] DEBUG -- :   [1m[36mSetting Load (1.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:47:21.007470 #11095]  INFO -- : Completed 200 OK in 1023ms (Views: 5.3ms | ActiveRecord: 4.8ms)


D, [2018-09-12T22:47:21.010517 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:47:21.013362 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:47:21.024739 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:47:21 +0530
I, [2018-09-12T22:47:21.058118 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:47:21.058223 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:47:21.060739 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:47:21.062320 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:47:28.071932 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:47:28.073178 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.5ms | ActiveRecord: 2.0ms)


D, [2018-09-12T22:47:28.075979 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:47:28.078002 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:47:28.087043 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:47:28 +0530
I, [2018-09-12T22:47:28.109413 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:47:28.109490 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:47:28.111857 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:47:28.113313 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:47:35.124581 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:47:35.126056 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T22:47:35.128771 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:47:35.130871 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:47:35.140360 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:47:35 +0530
I, [2018-09-12T22:47:35.162638 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:47:35.162724 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:47:35.165337 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:47:35.167223 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:47:42.176826 #11095] DEBUG -- :   [1m[36mSetting Load (0.7ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:47:42.177673 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.3ms | ActiveRecord: 1.8ms)


D, [2018-09-12T22:47:42.178800 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:47:42.179546 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:47:42.184764 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:47:42 +0530
I, [2018-09-12T22:47:42.202330 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:47:42.202407 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:47:42.205239 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:47:42.209135 #11095] DEBUG -- :   [1m[35m (1.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:47:49.220841 #11095] DEBUG -- :   [1m[36mSetting Load (1.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:47:49.222634 #11095]  INFO -- : Completed 200 OK in 7020ms (Views: 0.5ms | ActiveRecord: 3.6ms)


D, [2018-09-12T22:47:49.226627 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:47:49.229246 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:47:49.235712 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:47:49 +0530
I, [2018-09-12T22:47:49.253395 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:47:49.253491 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:47:49.256464 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:47:49.259109 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:47:56.269140 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:47:56.270449 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.4ms | ActiveRecord: 2.4ms)


D, [2018-09-12T22:47:56.274187 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:47:56.276770 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:47:56.285347 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:47:56 +0530
I, [2018-09-12T22:47:56.313138 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:47:56.313231 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:47:56.316519 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:47:56.318834 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:48:03.329323 #11095] DEBUG -- :   [1m[36mSetting Load (1.8ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:48:03.331609 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.5ms | ActiveRecord: 3.1ms)


D, [2018-09-12T22:48:03.334434 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:48:03.336433 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:48:03.345246 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:48:03 +0530
I, [2018-09-12T22:48:03.367168 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:48:03.367246 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:48:03.370605 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:48:03.372314 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:48:10.381469 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:48:10.383011 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.6ms | ActiveRecord: 2.3ms)


D, [2018-09-12T22:48:10.386348 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:48:10.388708 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:48:10.399936 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:48:10 +0530
I, [2018-09-12T22:48:10.425528 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:48:10.425604 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:48:10.427951 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:48:10.429443 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T22:48:13.364312 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:48:13 +0530
I, [2018-09-12T22:48:13.386917 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:48:13.387005 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T22:48:13.389658 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:48:13.391897 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:48:13.396166 #11095] DEBUG -- :   [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:48:13.398949 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:48:13.400685 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:48:13.401556 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:48:13.402243 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:48:13.403742 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:18:13.401000"], ["id", 1]]
D, [2018-09-12T22:48:13.404891 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:48:13.406174 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 09:18:13.405400')[0m
D, [2018-09-12T22:48:13.407763 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:48:13.408189 #11095]  INFO -- : Completed 200 OK in 21ms (Views: 0.1ms | ActiveRecord: 4.9ms)


D, [2018-09-12T22:48:13.409362 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:48:13.410080 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:48:13.432859 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T22:48:13.434313 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:48:13.434746 #11095]  INFO -- : Completed 200 OK in 3009ms (Views: 0.2ms | ActiveRecord: 1.4ms)


D, [2018-09-12T22:48:13.435604 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:48:13.436345 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:48:13.440783 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:48:13 +0530
I, [2018-09-12T22:48:13.453643 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:48:13 +0530
I, [2018-09-12T22:48:13.467249 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:48:13.467623 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
I, [2018-09-12T22:48:13.471216 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
D, [2018-09-12T22:48:13.471463 #11095] DEBUG -- :   [1m[35m (1.7ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
I, [2018-09-12T22:48:13.472479 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:48:13.474334 #11095] DEBUG -- :   [1m[35m (1.8ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:48:13.475357 #11095] DEBUG -- :   [1m[35m (1.1ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:48:13.476453 #11095] DEBUG -- :   [1m[36mUser Load (1.2ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:48:13.478303 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:48:13.478819 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:48:13.480345 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:48:13.481256 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:48:13.481723 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:48:13.482284 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:48:13.484127 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:18:13.481000"], ["id", 1]]
D, [2018-09-12T22:48:13.485293 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:48:13.486875 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.4ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:48:13.487878 #11095] DEBUG -- :   [1m[36mChat Load (0.3ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T22:48:13.489801 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:16:13.489100')[0m  [["active", "t"]]
D, [2018-09-12T22:48:13.492219 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:48:13.493071 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:48:13.493636 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.2ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:48:13.494265 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:48:13.495164 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:16:13.494416')[0m  [["active", "t"]]
D, [2018-09-12T22:48:13.496317 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:16:13.495306')[0m  [["active", "t"]]
D, [2018-09-12T22:48:13.497928 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T22:48:13.499777 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.8ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:16:13.498302')[0m  [["active", "t"]]
D, [2018-09-12T22:48:13.500413 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:48:13.501329 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:48:13.503896 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:48:13.504276 #11095]  INFO -- : Completed 200 OK in 37ms (Views: 0.1ms | ActiveRecord: 11.6ms)


D, [2018-09-12T22:48:13.505459 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:48:13.506218 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:48:14.485592 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T22:48:14.494064 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:48:14.495428 #11095]  INFO -- : Completed 200 OK in 1023ms (Views: 4.6ms | ActiveRecord: 2.8ms)


D, [2018-09-12T22:48:14.498888 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:48:14.502435 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:48:14.514221 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:48:14 +0530
I, [2018-09-12T22:48:14.542989 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:48:14.543104 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:48:14.546197 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:48:14.548197 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:48:21.561194 #11095] DEBUG -- :   [1m[36mSetting Load (1.7ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:48:21.564024 #11095]  INFO -- : Completed 200 OK in 7020ms (Views: 0.9ms | ActiveRecord: 2.9ms)


D, [2018-09-12T22:48:21.566869 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:48:21.569841 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:48:21.580710 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:48:21 +0530
I, [2018-09-12T22:48:21.605148 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:48:21.605253 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:48:21.608133 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:48:21.609888 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:48:28.618069 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:48:28.618505 #11095]  INFO -- : Completed 200 OK in 7013ms (Views: 0.2ms | ActiveRecord: 1.5ms)


D, [2018-09-12T22:48:28.619400 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:48:28.620117 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:48:28.623460 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:48:28 +0530
I, [2018-09-12T22:48:28.635155 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:48:28.635214 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:48:28.637277 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:48:28.638528 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:48:35.645292 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:48:35.645753 #11095]  INFO -- : Completed 200 OK in 7010ms (Views: 0.2ms | ActiveRecord: 1.2ms)


D, [2018-09-12T22:48:35.646723 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:48:35.647800 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:48:35.651249 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:48:35 +0530
I, [2018-09-12T22:48:35.665280 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:48:35.665350 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:48:35.667836 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:48:35.669301 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:48:42.679124 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:48:42.681735 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.8ms | ActiveRecord: 2.0ms)


D, [2018-09-12T22:48:42.685524 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:48:42.688196 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:48:42.698959 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:48:42 +0530
I, [2018-09-12T22:48:42.717621 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:48:42.717742 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:48:42.720097 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:48:42.721635 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:48:49.730324 #11095] DEBUG -- :   [1m[36mSetting Load (0.9ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:48:49.731680 #11095]  INFO -- : Completed 200 OK in 7014ms (Views: 0.4ms | ActiveRecord: 1.8ms)


D, [2018-09-12T22:48:49.734272 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:48:49.736506 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:48:49.747803 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:48:49 +0530
I, [2018-09-12T22:48:49.782104 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:48:49.782203 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:48:49.785483 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:48:49.788659 #11095] DEBUG -- :   [1m[35m (1.0ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:48:56.798015 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:48:56.799229 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.4ms | ActiveRecord: 2.5ms)


D, [2018-09-12T22:48:56.801737 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:48:56.804034 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:48:56.812655 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:48:56 +0530
I, [2018-09-12T22:48:56.843047 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:48:56.843131 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:48:56.845577 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:48:56.847142 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:49:03.856549 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:49:03.858272 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T22:49:03.860987 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:49:03.863189 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:49:03.874775 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:49:03 +0530
I, [2018-09-12T22:49:03.898900 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:49:03.898974 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:49:03.901449 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:49:03.903015 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T22:49:08.364481 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:49:08 +0530
I, [2018-09-12T22:49:08.388336 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:49:08.388442 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T22:49:08.391777 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:49:08.394441 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:49:08.398290 #11095] DEBUG -- :   [1m[36mUser Load (1.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:49:08.402720 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:49:08.404547 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:49:08.405404 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:49:08.406130 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:49:08.408811 #11095] DEBUG -- :   [1m[35mSQL (0.7ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:19:08.405000"], ["id", 1]]
D, [2018-09-12T22:49:08.412357 #11095] DEBUG -- :   [1m[35m (3.0ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:49:08.414312 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 09:19:08.413141')[0m
D, [2018-09-12T22:49:08.415913 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:49:08.416382 #11095]  INFO -- : Completed 200 OK in 28ms (Views: 0.1ms | ActiveRecord: 8.2ms)


D, [2018-09-12T22:49:08.417691 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:49:08.418465 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:49:08.908486 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T22:49:08.909964 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:49:08.910454 #11095]  INFO -- : Completed 200 OK in 5011ms (Views: 0.2ms | ActiveRecord: 1.3ms)


D, [2018-09-12T22:49:08.911368 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:49:08.912084 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:49:08.916051 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:49:08 +0530
I, [2018-09-12T22:49:08.930241 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:49:08 +0530
I, [2018-09-12T22:49:08.945197 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:49:08.945251 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:49:08.945354 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
I, [2018-09-12T22:49:08.945455 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:49:08.949528 #11095] DEBUG -- :   [1m[35m (1.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:49:08.950686 #11095] DEBUG -- :   [1m[35m (1.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:49:08.951757 #11095] DEBUG -- :   [1m[35m (1.1ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:49:08.952983 #11095] DEBUG -- :   [1m[35m (1.3ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:49:08.953597 #11095] DEBUG -- :   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:49:08.955259 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:49:08.956597 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:49:08.957296 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:49:08.957666 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:49:08.958142 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:49:08.959533 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:19:08.957000"], ["id", 1]]
D, [2018-09-12T22:49:08.966565 #11095] DEBUG -- :   [1m[35m (6.7ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:49:08.968169 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.4ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:49:08.969569 #11095] DEBUG -- :   [1m[36mChat Load (0.4ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T22:49:08.971786 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:17:08.970970')[0m  [["active", "t"]]
D, [2018-09-12T22:49:08.974303 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:49:08.975482 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:49:08.976880 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.5ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:49:08.978459 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:49:08.979914 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:17:08.978938')[0m  [["active", "t"]]
D, [2018-09-12T22:49:08.980774 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:17:08.980097')[0m  [["active", "t"]]
D, [2018-09-12T22:49:08.981784 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T22:49:08.982702 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:17:08.981986')[0m  [["active", "t"]]
D, [2018-09-12T22:49:08.983380 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:49:08.984366 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:49:08.987344 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:49:08.987795 #11095]  INFO -- : Completed 200 OK in 42ms (Views: 0.1ms | ActiveRecord: 15.9ms)


D, [2018-09-12T22:49:08.989010 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:49:08.989793 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:49:09.957427 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T22:49:09.982603 #11095] DEBUG -- :   [1m[36mSetting Load (0.7ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:49:09.983507 #11095]  INFO -- : Completed 200 OK in 1038ms (Views: 22.4ms | ActiveRecord: 3.4ms)


D, [2018-09-12T22:49:09.985284 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:49:09.986746 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:49:09.994406 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:49:09 +0530
I, [2018-09-12T22:49:10.017617 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:49:10.017743 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:49:10.021518 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:49:10.023372 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:49:17.032906 #11095] DEBUG -- :   [1m[36mSetting Load (0.9ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:49:17.034639 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.6ms | ActiveRecord: 2.1ms)


D, [2018-09-12T22:49:17.037177 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:49:17.039099 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:49:17.047897 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:49:17 +0530
I, [2018-09-12T22:49:17.063636 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:49:17.063719 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:49:17.066350 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:49:17.067962 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:49:24.077751 #11095] DEBUG -- :   [1m[36mSetting Load (1.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:49:24.079388 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.7ms | ActiveRecord: 2.4ms)


D, [2018-09-12T22:49:24.083215 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:49:24.086515 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:49:24.095164 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:49:24 +0530
I, [2018-09-12T22:49:24.125717 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:49:24.125798 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:49:24.128390 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:49:24.130969 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:49:31.140656 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:49:31.142442 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.5ms | ActiveRecord: 2.5ms)


D, [2018-09-12T22:49:31.145186 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:49:31.147592 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:49:31.156342 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:49:31 +0530
I, [2018-09-12T22:49:31.180476 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:49:31.180560 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:49:31.183095 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:49:31.184580 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:49:38.195858 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:49:38.197101 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.4ms | ActiveRecord: 1.9ms)


D, [2018-09-12T22:49:38.199699 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:49:38.201749 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:49:38.213676 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:49:38 +0530
I, [2018-09-12T22:49:38.243822 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:49:38.243930 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:49:38.246608 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:49:38.248371 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:49:45.258232 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:49:45.259518 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.5ms | ActiveRecord: 2.1ms)


D, [2018-09-12T22:49:45.262271 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:49:45.264324 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:49:45.273055 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:49:45 +0530
I, [2018-09-12T22:49:45.303838 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:49:45.303923 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:49:45.306507 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:49:45.308219 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:49:45.309423 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:49:45.310794 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[32mINSERT INTO "delayed_jobs" ("handler", "run_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["handler", "--- !ruby/object:Observer::UserDeviceLogJob\nhttp_user_agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko)\n  Chrome/68.0.3440.106 Safari/537.36\nremote_ip: \"::1\"\nuser_id: 3\nfingerprint: \"-1992429858\"\ntype: session\n"], ["run_at", "2018-09-12 17:19:45.309587"], ["created_at", "2018-09-12 17:19:45.309000"], ["updated_at", "2018-09-12 17:19:45.309000"]]
D, [2018-09-12T22:49:45.312355 #11095] DEBUG -- :   [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:49:52.322178 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:49:52.323823 #11095]  INFO -- : Completed 200 OK in 7019ms (Views: 0.6ms | ActiveRecord: 3.7ms)


D, [2018-09-12T22:49:52.328960 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:49:52.332875 #11095] DEBUG -- :   [1m[35mSQL (0.8ms)[0m  [1m[33mUPDATE "sessions" SET "data" = $1, "updated_at" = $2 WHERE "sessions"."id" = $3[0m  [["data", "BAh7D0kiCXBpbmcGOgZFRkkiGTIwMTgtMDktMTJUMTY6MDk6MjZaBjsAVEki\nD3VzZXJfYWdlbnQGOwBGIm5Nb3ppbGxhLzUuMCAoWDExOyBMaW51eCB4ODZf\nNjQpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENo\ncm9tZS82OC4wLjM0NDAuMTA2IFNhZmFyaS81MzcuMzZJIhBfY3NyZl90b2tl\nbgY7AEZJIjE1SzlmTEZWTnRwVFYydjArWGQ1M21QMjFWbDAzT1RSeEp2cUpm\nbitDRDUwPQY7AEZJIgx1c2VyX2lkBjsARmkISSIadXNlcl9kZXZpY2VfcmVt\nb3RlX2lwBjsARiIIOjoxSSIcdXNlcl9kZXZpY2VfZmluZ2VycHJpbnQGOwBG\nSSIQLTE5OTI0Mjk4NTgGOwBUSSIbdXNlcl9kZXZpY2VfdXBkYXRlZF9hdAY7\nAEZVOiBBY3RpdmVTdXBwb3J0OjpUaW1lV2l0aFpvbmVbCEl1OglUaW1lDZGh\nHcA9tdROCToJem9uZUkiCFVUQwY7AEY6DW5hbm9fbnVtaQLhAToNbmFub19k\nZW5pBjoNc3VibWljcm8iB0gQSSIIVVRDBjsAVEAWSSIPcGVyc2lzdGVudAY7\nAEZUSSIOcmVtb3RlX2lwBjsARiIIOjoxSSIIZ2VvBjsARnsA\n"], ["updated_at", "2018-09-12 17:19:52.329793"], ["id", 33]]
D, [2018-09-12T22:49:52.341042 #11095] DEBUG -- :   [1m[35m (7.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:49:52.352037 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:49:52 +0530
I, [2018-09-12T22:49:52.371186 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:49:52.371283 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:49:52.377289 #11095] DEBUG -- :   [1m[35m (1.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:49:52.379227 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:49:59.388671 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:49:59.390424 #11095]  INFO -- : Completed 200 OK in 7019ms (Views: 0.5ms | ActiveRecord: 3.3ms)


D, [2018-09-12T22:49:59.393446 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:49:59.395707 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:49:59.417174 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:49:59 +0530
I, [2018-09-12T22:49:59.435058 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:49:59.435147 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:49:59.437916 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:49:59.439796 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T22:50:03.368101 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:50:03 +0530
I, [2018-09-12T22:50:03.399038 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:50:03.399170 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T22:50:03.402241 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:50:03.403767 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:50:03.405129 #11095] DEBUG -- :   [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:50:03.406799 #11095] DEBUG -- :   [1m[35mCACHE  (0.1ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:50:03.408481 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:50:03.409333 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:50:03.409894 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:50:03.411753 #11095] DEBUG -- :   [1m[35mSQL (0.4ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:20:03.409000"], ["id", 1]]
D, [2018-09-12T22:50:03.414796 #11095] DEBUG -- :   [1m[35m (2.7ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:50:03.416083 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 09:20:03.415351')[0m
D, [2018-09-12T22:50:03.417513 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:50:03.418047 #11095]  INFO -- : Completed 200 OK in 19ms (Views: 0.1ms | ActiveRecord: 6.1ms)


D, [2018-09-12T22:50:03.419767 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:50:03.420710 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:50:04.444706 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T22:50:04.446174 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:50:04.446619 #11095]  INFO -- : Completed 200 OK in 5011ms (Views: 0.2ms | ActiveRecord: 1.5ms)


D, [2018-09-12T22:50:04.447539 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:50:04.448432 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:50:04.456641 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:50:04 +0530
I, [2018-09-12T22:50:04.469118 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:50:04 +0530
I, [2018-09-12T22:50:04.482288 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:50:04.483826 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:50:04.483911 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
I, [2018-09-12T22:50:04.484139 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:50:04.487222 #11095] DEBUG -- :   [1m[35m (1.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:50:04.488214 #11095] DEBUG -- :   [1m[35m (1.1ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:50:04.489082 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:50:04.489701 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:50:04.490851 #11095] DEBUG -- :   [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:50:04.492352 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:50:04.493660 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:50:04.494385 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:50:04.494762 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:50:04.495190 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:50:04.496504 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:20:04.494000"], ["id", 1]]
D, [2018-09-12T22:50:04.497704 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:50:04.498971 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:50:04.499799 #11095] DEBUG -- :   [1m[36mChat Load (0.3ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T22:50:04.503112 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.9ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:18:04.501206')[0m  [["active", "t"]]
D, [2018-09-12T22:50:04.507328 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.4ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:50:04.508451 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:50:04.509038 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.2ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:50:04.509683 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:50:04.510747 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:18:04.509859')[0m  [["active", "t"]]
D, [2018-09-12T22:50:04.511622 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:18:04.510939')[0m  [["active", "t"]]
D, [2018-09-12T22:50:04.512605 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T22:50:04.513770 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:18:04.512871')[0m  [["active", "t"]]
D, [2018-09-12T22:50:04.514558 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:50:04.515982 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.5ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:50:04.521393 #11095] DEBUG -- :   [1m[36mSetting Load (0.8ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:50:04.522589 #11095]  INFO -- : Completed 200 OK in 38ms (Views: 0.4ms | ActiveRecord: 9.4ms)


D, [2018-09-12T22:50:04.524627 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:50:04.525471 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:50:05.492064 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T22:50:05.494581 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:50:05.495007 #11095]  INFO -- : Completed 200 OK in 1011ms (Views: 1.2ms | ActiveRecord: 2.4ms)


D, [2018-09-12T22:50:05.496053 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:50:05.496912 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:50:05.502003 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:50:05 +0530
I, [2018-09-12T22:50:05.516121 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:50:05.516236 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:50:05.518904 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:50:05.520654 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:50:12.530007 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:50:12.531347 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.4ms | ActiveRecord: 2.1ms)


D, [2018-09-12T22:50:12.533932 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:50:12.537945 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:50:12.547033 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:50:12 +0530
I, [2018-09-12T22:50:12.570783 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:50:12.570866 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:50:12.573217 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:50:12.574598 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:50:19.583863 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:50:19.585089 #11095]  INFO -- : Completed 200 OK in 7014ms (Views: 0.5ms | ActiveRecord: 1.8ms)


D, [2018-09-12T22:50:19.587688 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:50:19.590220 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:50:19.600314 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:50:19 +0530
I, [2018-09-12T22:50:19.624680 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:50:19.624807 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:50:19.627573 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:50:19.629022 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:50:26.636889 #11095] DEBUG -- :   [1m[36mSetting Load (0.7ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:50:26.637726 #11095]  INFO -- : Completed 200 OK in 7013ms (Views: 0.3ms | ActiveRecord: 1.6ms)


D, [2018-09-12T22:50:26.639475 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:50:26.640685 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:50:26.644930 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:50:26 +0530
I, [2018-09-12T22:50:26.656926 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:50:26.657018 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:50:26.659123 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:50:26.661062 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:50:33.669737 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:50:33.670948 #11095]  INFO -- : Completed 200 OK in 7014ms (Views: 0.4ms | ActiveRecord: 2.2ms)


D, [2018-09-12T22:50:33.673437 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:50:33.675886 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:50:33.685050 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:50:33 +0530
I, [2018-09-12T22:50:33.712527 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:50:33.712636 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:50:33.715676 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:50:33.717454 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:50:40.729380 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:50:40.730952 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 1.1ms | ActiveRecord: 2.3ms)


D, [2018-09-12T22:50:40.733823 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:50:40.735975 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:50:40.749726 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:50:40 +0530
I, [2018-09-12T22:50:40.775110 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:50:40.775240 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:50:40.777995 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:50:40.780374 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:50:47.789988 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:50:47.791223 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.4ms | ActiveRecord: 2.6ms)


D, [2018-09-12T22:50:47.793757 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:50:47.796410 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:50:47.805375 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:50:47 +0530
I, [2018-09-12T22:50:47.835292 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:50:47.835456 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:50:47.838569 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:50:47.840836 #11095] DEBUG -- :   [1m[35m (1.0ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:50:54.850161 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:50:54.851537 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.6ms | ActiveRecord: 2.5ms)


D, [2018-09-12T22:50:54.854160 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:50:54.856271 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:50:54.865820 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:50:54 +0530
I, [2018-09-12T22:50:54.893785 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:50:54.893911 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:50:54.896580 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:50:54.898297 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T22:50:58.362723 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:50:58 +0530
I, [2018-09-12T22:50:58.390522 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:50:58.390619 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T22:50:58.394192 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:50:58.395913 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:50:58.397180 #11095] DEBUG -- :   [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:50:58.398773 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:50:58.400082 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:50:58.400823 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:50:58.401297 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:50:58.402487 #11095] DEBUG -- :   [1m[35mSQL (0.2ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:20:58.401000"], ["id", 1]]
D, [2018-09-12T22:50:58.403587 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:50:58.404588 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 09:20:58.404004')[0m
D, [2018-09-12T22:50:58.405809 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:50:58.406158 #11095]  INFO -- : Completed 200 OK in 15ms (Views: 0.1ms | ActiveRecord: 3.8ms)


D, [2018-09-12T22:50:58.407223 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:50:58.408033 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:50:59.904194 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T22:50:59.908216 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:50:59.909940 #11095]  INFO -- : Completed 200 OK in 5016ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T22:50:59.918841 #11095] DEBUG -- :   [1m[35m (1.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:50:59.920327 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:50:59.928153 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:50:59 +0530
I, [2018-09-12T22:50:59.928338 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:50:59 +0530
I, [2018-09-12T22:50:59.953403 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:50:59.953502 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
I, [2018-09-12T22:50:59.957226 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:50:59.957313 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
D, [2018-09-12T22:50:59.959240 #11095] DEBUG -- :   [1m[35m (3.7ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:50:59.960497 #11095] DEBUG -- :   [1m[35m (1.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:50:59.961586 #11095] DEBUG -- :   [1m[35m (1.2ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:50:59.962480 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:50:59.964084 #11095] DEBUG -- :   [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:50:59.966418 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:50:59.968374 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:50:59.969306 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:50:59.969745 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:50:59.970189 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:50:59.971691 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:20:59.969000"], ["id", 1]]
D, [2018-09-12T22:50:59.978911 #11095] DEBUG -- :   [1m[35m (6.8ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:50:59.980408 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:50:59.981379 #11095] DEBUG -- :   [1m[36mChat Load (0.3ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T22:50:59.983726 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:18:59.982982')[0m  [["active", "t"]]
D, [2018-09-12T22:50:59.994613 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:50:59.995520 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:50:59.996397 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:50:59.997463 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:50:59.998438 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:18:59.997708')[0m  [["active", "t"]]
D, [2018-09-12T22:50:59.999180 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:18:59.998592')[0m  [["active", "t"]]
D, [2018-09-12T22:50:59.999992 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T22:51:00.000720 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:19:00.000135')[0m  [["active", "t"]]
D, [2018-09-12T22:51:00.001359 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:51:00.002199 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.2ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:51:00.005436 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:51:00.005832 #11095]  INFO -- : Completed 200 OK in 48ms (Views: 0.1ms | ActiveRecord: 14.6ms)


D, [2018-09-12T22:51:00.007105 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:51:00.007859 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:51:00.966298 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T22:51:00.972512 #11095] DEBUG -- :   [1m[36mSetting Load (0.8ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:51:00.973425 #11095]  INFO -- : Completed 200 OK in 1020ms (Views: 3.7ms | ActiveRecord: 5.7ms)


D, [2018-09-12T22:51:00.975282 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:51:00.976897 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:51:00.998068 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:51:00 +0530
I, [2018-09-12T22:51:01.011723 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:51:01.011817 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:51:01.015064 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:51:01.017787 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:51:08.029093 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:51:08.030371 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.5ms | ActiveRecord: 2.7ms)


D, [2018-09-12T22:51:08.033553 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:51:08.035724 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:51:08.044892 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:51:08 +0530
I, [2018-09-12T22:51:08.070656 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:51:08.070735 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:51:08.074371 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:51:08.076672 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:51:15.086263 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:51:15.087569 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T22:51:15.090530 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:51:15.092920 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:51:15.103605 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:51:15 +0530
I, [2018-09-12T22:51:15.126787 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:51:15.126878 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:51:15.129169 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:51:15.130672 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:51:22.138221 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:51:22.138838 #11095]  INFO -- : Completed 200 OK in 7012ms (Views: 0.3ms | ActiveRecord: 1.4ms)


D, [2018-09-12T22:51:22.140074 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:51:22.141051 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:51:22.145251 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:51:22 +0530
I, [2018-09-12T22:51:22.162350 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:51:22.162484 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:51:22.165847 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:51:22.169723 #11095] DEBUG -- :   [1m[35m (1.3ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:51:29.181084 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:51:29.182356 #11095]  INFO -- : Completed 200 OK in 7019ms (Views: 0.4ms | ActiveRecord: 3.0ms)


D, [2018-09-12T22:51:29.185086 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:51:29.187846 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:51:29.197040 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:51:29 +0530
I, [2018-09-12T22:51:29.219660 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:51:29.219740 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:51:29.223681 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:51:29.226539 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:51:36.236408 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:51:36.237937 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.4ms | ActiveRecord: 2.3ms)


D, [2018-09-12T22:51:36.240681 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:51:36.243893 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:51:36.253047 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:51:36 +0530
I, [2018-09-12T22:51:36.273988 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:51:36.274059 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:51:36.276245 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:51:36.277817 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:51:43.289152 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:51:43.290770 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.5ms | ActiveRecord: 2.1ms)


D, [2018-09-12T22:51:43.293609 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:51:43.295802 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:51:43.306660 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:51:43 +0530
I, [2018-09-12T22:51:43.334154 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:51:43.334241 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:51:43.336842 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:51:43.338512 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:51:50.347809 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:51:50.349068 #11095]  INFO -- : Completed 200 OK in 7014ms (Views: 0.4ms | ActiveRecord: 2.0ms)


D, [2018-09-12T22:51:50.351534 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:51:50.354637 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:51:50.364714 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:51:50 +0530
I, [2018-09-12T22:51:50.387226 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:51:50.387314 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:51:50.389716 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:51:50.391440 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T22:51:53.359637 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:51:53 +0530
I, [2018-09-12T22:51:53.376877 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:51:53.376957 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T22:51:53.379069 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:51:53.380461 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:51:53.381749 #11095] DEBUG -- :   [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:51:53.385987 #11095] DEBUG -- :   [1m[35mCACHE  (0.1ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:51:53.387840 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:51:53.389001 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:51:53.390010 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:51:53.391871 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:21:53.389000"], ["id", 1]]
D, [2018-09-12T22:51:53.395316 #11095] DEBUG -- :   [1m[35m (2.9ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:51:53.399593 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.8ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 09:21:53.397276')[0m
D, [2018-09-12T22:51:53.403091 #11095] DEBUG -- :   [1m[36mSetting Load (0.7ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:51:53.405942 #11095]  INFO -- : Completed 200 OK in 29ms (Views: 0.3ms | ActiveRecord: 7.2ms)


D, [2018-09-12T22:51:53.408060 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:51:53.409228 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:51:55.397515 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T22:51:55.401130 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:51:55.402380 #11095]  INFO -- : Completed 200 OK in 5015ms (Views: 0.5ms | ActiveRecord: 2.1ms)


D, [2018-09-12T22:51:55.405094 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:51:55.407262 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:51:55.417230 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:51:55 +0530
I, [2018-09-12T22:51:55.418766 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:51:55 +0530
I, [2018-09-12T22:51:55.453208 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:51:55.453313 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
I, [2018-09-12T22:51:55.456820 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:51:55.456913 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:51:55.459136 #11095] DEBUG -- :   [1m[35m (3.8ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:51:55.460285 #11095] DEBUG -- :   [1m[35m (1.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:51:55.461175 #11095] DEBUG -- :   [1m[35m (1.0ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:51:55.462167 #11095] DEBUG -- :   [1m[35m (1.0ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:51:55.462710 #11095] DEBUG -- :   [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:51:55.464164 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:51:55.465366 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:51:55.466104 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:51:55.466452 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:51:55.466869 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:51:55.468128 #11095] DEBUG -- :   [1m[35mSQL (0.2ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:21:55.466000"], ["id", 1]]
D, [2018-09-12T22:51:55.475169 #11095] DEBUG -- :   [1m[35m (6.7ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:51:55.476405 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:51:55.477228 #11095] DEBUG -- :   [1m[36mChat Load (0.3ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T22:51:55.478967 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:19:55.478314')[0m  [["active", "t"]]
D, [2018-09-12T22:51:55.481106 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:51:55.481804 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:51:55.482405 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.2ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:51:55.483063 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:51:55.483871 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:19:55.483202')[0m  [["active", "t"]]
D, [2018-09-12T22:51:55.484563 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:19:55.483989')[0m  [["active", "t"]]
D, [2018-09-12T22:51:55.485337 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T22:51:55.486009 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:19:55.485470')[0m  [["active", "t"]]
D, [2018-09-12T22:51:55.486540 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:51:55.487296 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:51:55.491098 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:51:55.491520 #11095]  INFO -- : Completed 200 OK in 38ms (Views: 0.2ms | ActiveRecord: 17.0ms)


D, [2018-09-12T22:51:55.492642 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:51:55.493783 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:51:56.466111 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T22:51:56.473030 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:51:56.474286 #11095]  INFO -- : Completed 200 OK in 1017ms (Views: 3.5ms | ActiveRecord: 3.6ms)


D, [2018-09-12T22:51:56.476704 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:51:56.478959 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:51:56.489031 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:51:56 +0530
I, [2018-09-12T22:51:56.510770 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:51:56.510873 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:51:56.513191 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:51:56.514709 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:52:03.524651 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:52:03.525848 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.7ms | ActiveRecord: 2.0ms)


D, [2018-09-12T22:52:03.529544 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:52:03.531605 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:52:03.540765 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:52:03 +0530
I, [2018-09-12T22:52:03.565327 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:52:03.565401 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:52:03.567683 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:52:03.569122 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:52:10.580279 #11095] DEBUG -- :   [1m[36mSetting Load (1.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:52:10.582153 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.8ms | ActiveRecord: 2.3ms)


D, [2018-09-12T22:52:10.585286 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:52:10.587322 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:52:10.593421 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:52:10 +0530
I, [2018-09-12T22:52:10.616404 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:52:10.616512 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:52:10.619472 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:52:10.621292 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:52:17.630288 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:52:17.631735 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.5ms | ActiveRecord: 2.1ms)


D, [2018-09-12T22:52:17.634323 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:52:17.636486 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:52:17.646142 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:52:17 +0530
I, [2018-09-12T22:52:17.677090 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:52:17.677196 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:52:17.680351 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:52:17.682393 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:52:24.693488 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:52:24.694866 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T22:52:24.697631 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:52:24.699734 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:52:24.710587 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:52:24 +0530
I, [2018-09-12T22:52:24.732187 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:52:24.732260 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:52:24.734431 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:52:24.735901 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:52:31.747051 #11095] DEBUG -- :   [1m[36mSetting Load (1.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:52:31.748724 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T22:52:31.751843 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:52:31.754011 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:52:31.765999 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:52:31 +0530
I, [2018-09-12T22:52:31.789165 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:52:31.789236 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:52:31.791483 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:52:31.793455 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:52:38.802895 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:52:38.804382 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.4ms | ActiveRecord: 2.1ms)


D, [2018-09-12T22:52:38.808141 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:52:38.810285 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:52:38.818725 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:52:38 +0530
I, [2018-09-12T22:52:38.839913 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:52:38.839986 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:52:38.842302 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:52:38.843784 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:52:45.855345 #11095] DEBUG -- :   [1m[36mSetting Load (1.6ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:52:45.857045 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.7ms | ActiveRecord: 2.4ms)


D, [2018-09-12T22:52:45.859690 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:52:45.861754 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:52:45.870883 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:52:45 +0530
I, [2018-09-12T22:52:45.899859 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:52:45.899963 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:52:45.902875 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:52:45.904587 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T22:52:48.365229 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:52:48 +0530
I, [2018-09-12T22:52:48.383954 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:52:48.384044 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T22:52:48.387618 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:52:48.389829 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:52:48.391379 #11095] DEBUG -- :   [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:52:48.393184 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:52:48.395032 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:52:48.396290 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.5ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:52:48.396863 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:52:48.398437 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:22:48.396000"], ["id", 1]]
D, [2018-09-12T22:52:48.405596 #11095] DEBUG -- :   [1m[35m (6.7ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:52:48.407047 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 09:22:48.406200')[0m
D, [2018-09-12T22:52:48.408737 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:52:48.409236 #11095]  INFO -- : Completed 200 OK in 25ms (Views: 0.2ms | ActiveRecord: 10.6ms)


D, [2018-09-12T22:52:48.410657 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:52:48.411452 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:52:48.908977 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T22:52:48.912660 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:52:48.914260 #11095]  INFO -- : Completed 200 OK in 3014ms (Views: 0.5ms | ActiveRecord: 1.9ms)


D, [2018-09-12T22:52:48.917032 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:52:48.919241 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:52:48.929600 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:52:48 +0530
I, [2018-09-12T22:52:48.957684 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:52:48 +0530
I, [2018-09-12T22:52:48.974534 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:52:48.976614 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:52:48.976755 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
I, [2018-09-12T22:52:48.976844 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:52:48.992706 #11095] DEBUG -- :   [1m[35m (1.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:52:48.993961 #11095] DEBUG -- :   [1m[35m (1.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:52:48.994978 #11095] DEBUG -- :   [1m[35m (1.2ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:52:48.995678 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:52:48.996964 #11095] DEBUG -- :   [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:52:48.999142 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:52:49.001065 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:52:49.002693 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.6ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:52:49.003443 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:52:49.004226 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:52:49.006052 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:22:49.003000"], ["id", 1]]
D, [2018-09-12T22:52:49.013668 #11095] DEBUG -- :   [1m[35m (7.0ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:52:49.019362 #11095] DEBUG -- :   [1m[36mChat::Session Load (1.2ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:52:49.023843 #11095] DEBUG -- :   [1m[36mChat Load (0.6ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T22:52:49.027833 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.6ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:20:49.026305')[0m  [["active", "t"]]
D, [2018-09-12T22:52:49.032174 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.6ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:52:49.033484 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:52:49.034342 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:52:49.035433 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:52:49.037445 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:20:49.035777')[0m  [["active", "t"]]
D, [2018-09-12T22:52:49.039080 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.5ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:20:49.037788')[0m  [["active", "t"]]
D, [2018-09-12T22:52:49.040089 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T22:52:49.040959 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:20:49.040283')[0m  [["active", "t"]]
D, [2018-09-12T22:52:49.041532 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:52:49.042438 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:52:49.045395 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:52:49.045872 #11095]  INFO -- : Completed 200 OK in 69ms (Views: 0.1ms | ActiveRecord: 17.7ms)


D, [2018-09-12T22:52:49.047011 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:52:49.048036 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:52:49.999934 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T22:52:50.007155 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:52:50.008400 #11095]  INFO -- : Completed 200 OK in 1031ms (Views: 3.7ms | ActiveRecord: 3.5ms)


D, [2018-09-12T22:52:50.010799 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:52:50.013169 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:52:50.022876 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:52:50 +0530
I, [2018-09-12T22:52:50.049445 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:52:50.049530 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:52:50.052230 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:52:50.053961 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:52:57.064286 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:52:57.065567 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.4ms | ActiveRecord: 2.2ms)


D, [2018-09-12T22:52:57.068578 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:52:57.070629 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:52:57.079425 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:52:57 +0530
I, [2018-09-12T22:52:57.104105 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:52:57.104193 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:52:57.106770 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:52:57.108266 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:53:04.118464 #11095] DEBUG -- :   [1m[36mSetting Load (1.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:53:04.120248 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.4ms | ActiveRecord: 2.4ms)


D, [2018-09-12T22:53:04.123941 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:53:04.126682 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:53:04.136708 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:53:04 +0530
I, [2018-09-12T22:53:04.162089 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:53:04.162202 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:53:04.164757 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:53:04.166352 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:53:11.175732 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:53:11.177070 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.4ms | ActiveRecord: 2.1ms)


D, [2018-09-12T22:53:11.179869 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:53:11.183389 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:53:11.193841 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:53:11 +0530
I, [2018-09-12T22:53:11.221800 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:53:11.221886 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:53:11.224435 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:53:11.226205 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:53:18.236265 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:53:18.237633 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.5ms | ActiveRecord: 2.1ms)


D, [2018-09-12T22:53:18.239965 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:53:18.241670 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:53:18.249009 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:53:18 +0530
I, [2018-09-12T22:53:18.264523 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:53:18.264598 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:53:18.267591 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:53:18.269735 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:53:25.280214 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:53:25.281654 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.4ms | ActiveRecord: 2.4ms)


D, [2018-09-12T22:53:25.284512 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:53:25.288903 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:53:25.298779 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:53:25 +0530
I, [2018-09-12T22:53:25.328091 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:53:25.328167 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:53:25.330458 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:53:25.332004 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:53:32.341313 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:53:32.342578 #11095]  INFO -- : Completed 200 OK in 7014ms (Views: 0.5ms | ActiveRecord: 2.0ms)


D, [2018-09-12T22:53:32.345198 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:53:32.347263 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:53:32.355854 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:53:32 +0530
I, [2018-09-12T22:53:32.386594 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:53:32.386686 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:53:32.389215 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:53:32.390703 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:53:39.399781 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:53:39.401057 #11095]  INFO -- : Completed 200 OK in 7014ms (Views: 0.4ms | ActiveRecord: 2.1ms)


D, [2018-09-12T22:53:39.404012 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:53:39.406173 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:53:39.414936 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:53:39 +0530
I, [2018-09-12T22:53:39.442845 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:53:39.442927 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:53:39.445473 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:53:39.447380 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T22:53:43.364250 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:53:43 +0530
I, [2018-09-12T22:53:43.389780 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:53:43.389904 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T22:53:43.392509 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:53:43.394176 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:53:43.396084 #11095] DEBUG -- :   [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:53:43.398006 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:53:43.399431 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:53:43.400146 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:53:43.400628 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:53:43.401898 #11095] DEBUG -- :   [1m[35mSQL (0.2ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:23:43.400000"], ["id", 1]]
D, [2018-09-12T22:53:43.402964 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:53:43.404139 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 09:23:43.403408')[0m
D, [2018-09-12T22:53:43.405491 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:53:43.405850 #11095]  INFO -- : Completed 200 OK in 16ms (Views: 0.1ms | ActiveRecord: 4.0ms)


D, [2018-09-12T22:53:43.407110 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:53:43.407902 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:53:44.452828 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T22:53:44.457504 #11095] DEBUG -- :   [1m[36mSetting Load (1.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:53:44.460138 #11095]  INFO -- : Completed 200 OK in 5017ms (Views: 0.3ms | ActiveRecord: 2.4ms)


D, [2018-09-12T22:53:44.462343 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:53:44.463962 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:53:44.474091 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:53:44 +0530
I, [2018-09-12T22:53:44.490930 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:53:44 +0530
I, [2018-09-12T22:53:44.509400 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:53:44.513170 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:53:44.513407 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
I, [2018-09-12T22:53:44.513921 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:53:44.518897 #11095] DEBUG -- :   [1m[35m (1.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:53:44.521904 #11095] DEBUG -- :   [1m[35m (1.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:53:44.522962 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:53:44.526197 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:53:44.528597 #11095] DEBUG -- :   [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:53:44.532039 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:53:44.535109 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:53:44.536041 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:53:44.536504 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:53:44.537010 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:53:44.539282 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:23:44.536000"], ["id", 1]]
D, [2018-09-12T22:53:44.542293 #11095] DEBUG -- :   [1m[35m (2.6ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:53:44.544110 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.4ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:53:44.545680 #11095] DEBUG -- :   [1m[36mChat Load (0.3ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T22:53:44.548036 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:21:44.547122')[0m  [["active", "t"]]
D, [2018-09-12T22:53:44.550848 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:53:44.551717 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:53:44.552518 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.2ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:53:44.553519 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:53:44.554505 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:21:44.553712')[0m  [["active", "t"]]
D, [2018-09-12T22:53:44.555430 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:21:44.554699')[0m  [["active", "t"]]
D, [2018-09-12T22:53:44.556424 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T22:53:44.557312 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:21:44.556647')[0m  [["active", "t"]]
D, [2018-09-12T22:53:44.557978 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:53:44.559132 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:53:44.562036 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:53:44.562519 #11095]  INFO -- : Completed 200 OK in 49ms (Views: 0.2ms | ActiveRecord: 10.3ms)


D, [2018-09-12T22:53:44.563965 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:53:44.565196 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:53:45.525743 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T22:53:45.532400 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:53:45.533236 #11095]  INFO -- : Completed 200 OK in 1019ms (Views: 2.8ms | ActiveRecord: 3.8ms)


D, [2018-09-12T22:53:45.534555 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:53:45.535471 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:53:45.541461 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:53:45 +0530
I, [2018-09-12T22:53:45.560273 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:53:45.560362 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:53:45.563970 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:53:45.565805 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:53:52.575424 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:53:52.576730 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.4ms | ActiveRecord: 2.4ms)


D, [2018-09-12T22:53:52.579273 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:53:52.581750 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:53:52.590564 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:53:52 +0530
I, [2018-09-12T22:53:52.615662 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:53:52.615771 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:53:52.618297 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:53:52.619853 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:53:59.631817 #11095] DEBUG -- :   [1m[36mSetting Load (1.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:53:59.633718 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.7ms | ActiveRecord: 2.5ms)


D, [2018-09-12T22:53:59.636757 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:53:59.639314 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:53:59.650529 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:53:59 +0530
I, [2018-09-12T22:53:59.678082 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:53:59.678174 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:53:59.680586 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:53:59.682426 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:54:06.690902 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:54:06.692289 #11095]  INFO -- : Completed 200 OK in 7014ms (Views: 0.5ms | ActiveRecord: 2.3ms)


D, [2018-09-12T22:54:06.694910 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:54:06.697489 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:54:06.706181 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:54:06 +0530
I, [2018-09-12T22:54:06.729538 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:54:06.729634 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:54:06.731932 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:54:06.733406 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:54:13.742271 #11095] DEBUG -- :   [1m[36mSetting Load (0.8ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:54:13.743436 #11095]  INFO -- : Completed 200 OK in 7014ms (Views: 0.4ms | ActiveRecord: 1.7ms)


D, [2018-09-12T22:54:13.745476 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:54:13.746933 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:54:13.753636 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:54:13 +0530
I, [2018-09-12T22:54:13.775067 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:54:13.775195 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:54:13.777715 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:54:13.779245 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:54:20.788468 #11095] DEBUG -- :   [1m[36mSetting Load (1.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:54:20.789856 #11095]  INFO -- : Completed 200 OK in 7014ms (Views: 0.4ms | ActiveRecord: 2.4ms)


D, [2018-09-12T22:54:20.792657 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:54:20.795567 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:54:20.805283 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:54:20 +0530
I, [2018-09-12T22:54:20.828728 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:54:20.828817 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:54:20.831266 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:54:20.832778 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:54:27.839824 #11095] DEBUG -- :   [1m[36mSetting Load (0.9ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:54:27.840654 #11095]  INFO -- : Completed 200 OK in 7012ms (Views: 0.2ms | ActiveRecord: 1.8ms)


D, [2018-09-12T22:54:27.843102 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:54:27.844596 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:54:27.848272 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:54:27 +0530
I, [2018-09-12T22:54:27.865616 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:54:27.865693 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:54:27.868391 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:54:27.870523 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:54:34.881995 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:54:34.883248 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T22:54:34.885873 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:54:34.888182 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:54:34.897001 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:54:34 +0530
I, [2018-09-12T22:54:34.927499 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:54:34.927652 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:54:34.930946 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:54:34.932743 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T22:54:38.363681 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:54:38 +0530
I, [2018-09-12T22:54:38.388022 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:54:38.388187 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T22:54:38.391392 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:54:38.394046 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:54:38.396475 #11095] DEBUG -- :   [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:54:38.398672 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:54:38.400213 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:54:38.401129 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:54:38.401747 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:54:38.403557 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:24:38.401000"], ["id", 1]]
D, [2018-09-12T22:54:38.411025 #11095] DEBUG -- :   [1m[35m (6.9ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:54:38.412970 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 09:24:38.411920')[0m
D, [2018-09-12T22:54:38.415442 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:54:38.416109 #11095]  INFO -- : Completed 200 OK in 28ms (Views: 0.2ms | ActiveRecord: 10.6ms)


D, [2018-09-12T22:54:38.417803 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:54:38.418622 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:54:39.938948 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T22:54:39.941160 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:54:39.941906 #11095]  INFO -- : Completed 200 OK in 5014ms (Views: 0.3ms | ActiveRecord: 1.6ms)


D, [2018-09-12T22:54:39.943334 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:54:39.944595 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:54:39.951214 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:54:39 +0530
I, [2018-09-12T22:54:39.951862 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:54:39 +0530
I, [2018-09-12T22:54:39.994399 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:54:39.997439 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
I, [2018-09-12T22:54:39.997735 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:54:39.998326 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:54:40.002561 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:54:40.003876 #11095] DEBUG -- :   [1m[35m (1.2ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:54:40.005077 #11095] DEBUG -- :   [1m[35m (1.3ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:54:40.006315 #11095] DEBUG -- :   [1m[35m (1.4ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:54:40.006983 #11095] DEBUG -- :   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:54:40.008968 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:54:40.011795 #11095] DEBUG -- :   [1m[35m (1.3ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:54:40.013363 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:54:40.013831 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:54:40.014352 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:54:40.015878 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:24:40.013000"], ["id", 1]]
D, [2018-09-12T22:54:40.023397 #11095] DEBUG -- :   [1m[35m (7.0ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:54:40.027264 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.9ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:54:40.030521 #11095] DEBUG -- :   [1m[36mChat Load (0.7ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T22:54:40.039024 #11095] DEBUG -- :   [1m[36mChat::Agent Load (1.0ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:22:40.036458')[0m  [["active", "t"]]
D, [2018-09-12T22:54:40.046526 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.8ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:54:40.051310 #11095] DEBUG -- :   [1m[35m (2.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:54:40.055108 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.8ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:54:40.058116 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:54:40.061052 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:22:40.058752')[0m  [["active", "t"]]
D, [2018-09-12T22:54:40.063537 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.8ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:22:40.061508')[0m  [["active", "t"]]
D, [2018-09-12T22:54:40.066769 #11095] DEBUG -- :   [1m[35m (1.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T22:54:40.070934 #11095] DEBUG -- :   [1m[36mChat::Agent Load (1.1ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:22:40.067588')[0m  [["active", "t"]]
D, [2018-09-12T22:54:40.073963 #11095] DEBUG -- :   [1m[36mChat::Agent Load (1.2ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:54:40.077717 #11095] DEBUG -- :   [1m[36mChat::Session Load (1.4ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:54:40.087717 #11095] DEBUG -- :   [1m[36mSetting Load (0.9ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:54:40.089006 #11095]  INFO -- : Completed 200 OK in 91ms (Views: 0.5ms | ActiveRecord: 26.7ms)


D, [2018-09-12T22:54:40.092895 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:54:40.095207 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:54:41.010535 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T22:54:41.016379 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:54:41.017263 #11095]  INFO -- : Completed 200 OK in 1017ms (Views: 2.9ms | ActiveRecord: 3.5ms)


D, [2018-09-12T22:54:41.019082 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:54:41.020567 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:54:41.027177 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:54:41 +0530
I, [2018-09-12T22:54:41.047854 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:54:41.048008 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:54:41.051708 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:54:41.053285 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:54:48.062640 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:54:48.064951 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T22:54:48.069052 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:54:48.071267 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:54:48.080441 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:54:48 +0530
I, [2018-09-12T22:54:48.105736 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:54:48.105825 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:54:48.109076 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:54:48.110508 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:54:55.121295 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:54:55.123307 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.5ms | ActiveRecord: 2.1ms)


D, [2018-09-12T22:54:55.126999 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:54:55.130739 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:54:55.142130 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:54:55 +0530
I, [2018-09-12T22:54:55.162018 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:54:55.162094 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:54:55.164419 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:54:55.165932 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:55:02.177278 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:55:02.179122 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.7ms | ActiveRecord: 2.2ms)


D, [2018-09-12T22:55:02.182230 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:55:02.185053 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:55:02.196047 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:55:02 +0530
I, [2018-09-12T22:55:02.219187 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:55:02.219283 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:55:02.221619 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:55:02.224139 #11095] DEBUG -- :   [1m[35m (1.0ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:55:09.235284 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:55:09.237047 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.4ms | ActiveRecord: 2.5ms)


D, [2018-09-12T22:55:09.240064 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:55:09.242738 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:55:09.254461 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:55:09 +0530
I, [2018-09-12T22:55:09.280972 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:55:09.281046 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:55:09.283370 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:55:09.284950 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:55:16.294160 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:55:16.295414 #11095]  INFO -- : Completed 200 OK in 7014ms (Views: 0.5ms | ActiveRecord: 2.1ms)


D, [2018-09-12T22:55:16.297804 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:55:16.299828 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:55:16.310300 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:55:16 +0530
I, [2018-09-12T22:55:16.338075 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:55:16.338162 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:55:16.340785 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:55:16.342365 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:55:23.351664 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:55:23.352946 #11095]  INFO -- : Completed 200 OK in 7014ms (Views: 0.5ms | ActiveRecord: 2.1ms)


D, [2018-09-12T22:55:23.355526 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:55:23.358413 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:55:23.386246 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:55:23 +0530
I, [2018-09-12T22:55:23.400653 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:55:23.400747 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:55:23.403982 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:55:23.406145 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:55:30.414559 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:55:30.415033 #11095]  INFO -- : Completed 200 OK in 7014ms (Views: 0.3ms | ActiveRecord: 1.7ms)


D, [2018-09-12T22:55:30.415936 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:55:30.416666 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:55:30.421511 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:55:30 +0530
I, [2018-09-12T22:55:30.436610 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:55:30.436759 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:55:30.440676 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:55:30.442440 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T22:55:33.365478 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:55:33 +0530
I, [2018-09-12T22:55:33.392093 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:55:33.392214 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T22:55:33.394699 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:55:33.396877 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:55:33.398358 #11095] DEBUG -- :   [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:55:33.400317 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:55:33.402641 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:55:33.404176 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.6ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:55:33.404938 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:55:33.406528 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:25:33.404000"], ["id", 1]]
D, [2018-09-12T22:55:33.407835 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:55:33.409101 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 09:25:33.408305')[0m
D, [2018-09-12T22:55:33.410564 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:55:33.410963 #11095]  INFO -- : Completed 200 OK in 19ms (Views: 0.1ms | ActiveRecord: 4.9ms)


D, [2018-09-12T22:55:33.412196 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:55:33.413104 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:55:33.445947 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T22:55:33.450795 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:55:33.452254 #11095]  INFO -- : Completed 200 OK in 3015ms (Views: 0.8ms | ActiveRecord: 2.6ms)


D, [2018-09-12T22:55:33.456451 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:55:33.460443 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:55:33.471734 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:55:33 +0530
I, [2018-09-12T22:55:33.489725 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:55:33 +0530
I, [2018-09-12T22:55:33.503337 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:55:33.504981 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:55:33.505090 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
I, [2018-09-12T22:55:33.505248 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
D, [2018-09-12T22:55:33.508861 #11095] DEBUG -- :   [1m[35m (1.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:55:33.509890 #11095] DEBUG -- :   [1m[35m (1.1ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:55:33.510850 #11095] DEBUG -- :   [1m[35m (1.0ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:55:33.511886 #11095] DEBUG -- :   [1m[35m (1.1ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:55:33.512462 #11095] DEBUG -- :   [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:55:33.514622 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:55:33.519098 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:55:33.520284 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:55:33.520745 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:55:33.521308 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:55:33.523152 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:25:33.520000"], ["id", 1]]
D, [2018-09-12T22:55:33.526208 #11095] DEBUG -- :   [1m[35m (2.7ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:55:33.527591 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:55:33.528634 #11095] DEBUG -- :   [1m[36mChat Load (0.3ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T22:55:33.530587 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:23:33.529815')[0m  [["active", "t"]]
D, [2018-09-12T22:55:33.534378 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.4ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:55:33.535659 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:55:33.536581 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:55:33.537416 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:55:33.538439 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:23:33.537599')[0m  [["active", "t"]]
D, [2018-09-12T22:55:33.539258 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:23:33.538588')[0m  [["active", "t"]]
D, [2018-09-12T22:55:33.540177 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T22:55:33.541015 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:23:33.540368')[0m  [["active", "t"]]
D, [2018-09-12T22:55:33.541675 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:55:33.542572 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:55:33.545312 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:55:33.545709 #11095]  INFO -- : Completed 200 OK in 40ms (Views: 0.1ms | ActiveRecord: 11.7ms)


D, [2018-09-12T22:55:33.546990 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:55:33.549420 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:55:34.515668 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T22:55:34.518596 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:55:34.519250 #11095]  INFO -- : Completed 200 OK in 1014ms (Views: 1.3ms | ActiveRecord: 2.8ms)


D, [2018-09-12T22:55:34.520473 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:55:34.521441 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:55:34.525377 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:55:34 +0530
I, [2018-09-12T22:55:34.536919 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:55:34.536981 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:55:34.539309 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:55:34.540991 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:55:41.548755 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:55:41.549292 #11095]  INFO -- : Completed 200 OK in 7012ms (Views: 0.2ms | ActiveRecord: 1.6ms)


D, [2018-09-12T22:55:41.550360 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:55:41.551268 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:55:41.555150 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:55:41 +0530
I, [2018-09-12T22:55:41.570602 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:55:41.570688 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:55:41.573448 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:55:41.576298 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:55:48.585203 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:55:48.586486 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.4ms | ActiveRecord: 2.8ms)


D, [2018-09-12T22:55:48.589173 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:55:48.592110 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:55:48.601349 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:55:48 +0530
I, [2018-09-12T22:55:48.626263 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:55:48.626348 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:55:48.629048 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:55:48.630606 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:55:55.639346 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:55:55.640918 #11095]  INFO -- : Completed 200 OK in 7014ms (Views: 0.4ms | ActiveRecord: 2.1ms)


D, [2018-09-12T22:55:55.643571 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:55:55.647132 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:55:55.657216 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:55:55 +0530
I, [2018-09-12T22:55:55.679536 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:55:55.679625 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:55:55.681884 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:55:55.683459 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:56:02.692486 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:56:02.693748 #11095]  INFO -- : Completed 200 OK in 7014ms (Views: 0.4ms | ActiveRecord: 2.0ms)


D, [2018-09-12T22:56:02.696557 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:56:02.699667 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:56:02.708857 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:56:02 +0530
I, [2018-09-12T22:56:02.735550 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:56:02.735636 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:56:02.738252 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:56:02.739983 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:56:09.749667 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:56:09.750840 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.4ms | ActiveRecord: 2.1ms)


D, [2018-09-12T22:56:09.753690 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:56:09.755662 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:56:09.764669 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:56:09 +0530
I, [2018-09-12T22:56:09.797270 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:56:09.797423 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:56:09.800902 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:56:09.802653 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:56:16.812989 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:56:16.814270 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T22:56:16.816928 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:56:16.819548 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:56:16.829990 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:56:16 +0530
I, [2018-09-12T22:56:16.853282 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:56:16.853368 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:56:16.855875 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:56:16.857503 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:56:23.868405 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:56:23.869647 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.4ms | ActiveRecord: 2.2ms)


D, [2018-09-12T22:56:23.872210 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:56:23.874491 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:56:23.884530 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:56:23 +0530
I, [2018-09-12T22:56:23.911517 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:56:23.911591 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:56:23.914041 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:56:23.915632 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T22:56:28.362950 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:56:28 +0530
I, [2018-09-12T22:56:28.392254 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:56:28.392362 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T22:56:28.395907 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:56:28.397548 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:56:28.399091 #11095] DEBUG -- :   [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:56:28.401474 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:56:28.412187 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:56:28.413110 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:56:28.413674 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:56:28.415199 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:26:28.413000"], ["id", 1]]
D, [2018-09-12T22:56:28.418126 #11095] DEBUG -- :   [1m[35m (2.6ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:56:28.419436 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 09:26:28.418656')[0m
D, [2018-09-12T22:56:28.423163 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:56:28.423876 #11095]  INFO -- : Completed 200 OK in 31ms (Views: 0.2ms | ActiveRecord: 6.9ms)


D, [2018-09-12T22:56:28.425943 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:56:28.427145 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:56:28.921189 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T22:56:28.924759 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:56:28.925954 #11095]  INFO -- : Completed 200 OK in 5014ms (Views: 0.5ms | ActiveRecord: 2.0ms)


D, [2018-09-12T22:56:28.928472 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:56:28.931017 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:56:28.940774 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:56:28 +0530
I, [2018-09-12T22:56:28.961768 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:56:28 +0530
I, [2018-09-12T22:56:28.974190 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:56:28.974274 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
I, [2018-09-12T22:56:28.977133 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:56:28.977190 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:56:28.978602 #11095] DEBUG -- :   [1m[35m (2.7ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:56:28.979819 #11095] DEBUG -- :   [1m[35m (1.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:56:28.981076 #11095] DEBUG -- :   [1m[35m (1.4ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:56:28.982618 #11095] DEBUG -- :   [1m[35m (1.3ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:56:28.983253 #11095] DEBUG -- :   [1m[36mUser Load (1.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:56:28.984913 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:56:28.986219 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:56:28.986920 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:56:28.987280 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:56:28.987711 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:56:28.988936 #11095] DEBUG -- :   [1m[35mSQL (0.2ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:26:28.987000"], ["id", 1]]
D, [2018-09-12T22:56:28.996261 #11095] DEBUG -- :   [1m[35m (6.8ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:56:28.999824 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.8ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:56:29.002674 #11095] DEBUG -- :   [1m[36mChat Load (0.7ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T22:56:29.008138 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.8ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:24:29.006129')[0m  [["active", "t"]]
D, [2018-09-12T22:56:29.015998 #11095] DEBUG -- :   [1m[36mChat::Session Load (1.2ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:56:29.018429 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:56:29.020612 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.7ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:56:29.023026 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:56:29.025734 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:24:29.023702')[0m  [["active", "t"]]
D, [2018-09-12T22:56:29.027308 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.6ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:24:29.026019')[0m  [["active", "t"]]
D, [2018-09-12T22:56:29.029266 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T22:56:29.030838 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:24:29.029616')[0m  [["active", "t"]]
D, [2018-09-12T22:56:29.031711 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:56:29.033226 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.5ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:56:29.036942 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:56:29.037421 #11095]  INFO -- : Completed 200 OK in 63ms (Views: 0.2ms | ActiveRecord: 22.3ms)


D, [2018-09-12T22:56:29.038923 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:56:29.039885 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:56:29.987959 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T22:56:29.996447 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:56:29.997662 #11095]  INFO -- : Completed 200 OK in 1020ms (Views: 5.1ms | ActiveRecord: 3.8ms)


D, [2018-09-12T22:56:30.000392 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:56:30.002894 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:56:30.013024 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:56:30 +0530
I, [2018-09-12T22:56:30.038532 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:56:30.038657 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:56:30.042425 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:56:30.044167 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:56:37.054425 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:56:37.055756 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.4ms | ActiveRecord: 2.3ms)


D, [2018-09-12T22:56:37.058426 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:56:37.060583 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:56:37.069210 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:56:37 +0530
I, [2018-09-12T22:56:37.094668 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:56:37.094755 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:56:37.097512 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:56:37.099110 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:56:44.110459 #11095] DEBUG -- :   [1m[36mSetting Load (1.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:56:44.112175 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.6ms | ActiveRecord: 2.3ms)


D, [2018-09-12T22:56:44.115423 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:56:44.118530 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:56:44.132755 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:56:44 +0530
I, [2018-09-12T22:56:44.151132 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:56:44.151232 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:56:44.153633 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:56:44.155145 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:56:51.164433 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:56:51.165718 #11095]  INFO -- : Completed 200 OK in 7014ms (Views: 0.5ms | ActiveRecord: 2.0ms)


D, [2018-09-12T22:56:51.168883 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:56:51.170855 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:56:51.179847 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:56:51 +0530
I, [2018-09-12T22:56:51.208612 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:56:51.208732 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:56:51.211469 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:56:51.213259 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:56:58.223124 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:56:58.224807 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.5ms | ActiveRecord: 2.4ms)


D, [2018-09-12T22:56:58.227622 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:56:58.229865 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:56:58.240142 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:56:58 +0530
I, [2018-09-12T22:56:58.264691 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:56:58.264769 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:56:58.267192 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:56:58.268781 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:57:05.279962 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:57:05.281395 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.6ms | ActiveRecord: 2.2ms)


D, [2018-09-12T22:57:05.284432 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:57:05.286704 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:57:05.317356 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:57:05 +0530
I, [2018-09-12T22:57:05.346799 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:57:05.346903 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:57:05.350110 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:57:05.351820 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:57:12.361966 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:57:12.363374 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.6ms | ActiveRecord: 2.0ms)


D, [2018-09-12T22:57:12.366273 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:57:12.369057 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:57:12.379441 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:57:12 +0530
I, [2018-09-12T22:57:12.403733 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:57:12.403817 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:57:12.406287 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:57:12.407704 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:57:19.417047 #11095] DEBUG -- :   [1m[36mSetting Load (1.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:57:19.418395 #11095]  INFO -- : Completed 200 OK in 7014ms (Views: 0.6ms | ActiveRecord: 2.3ms)


D, [2018-09-12T22:57:19.421149 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:57:19.423128 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:57:19.432418 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:57:19 +0530
I, [2018-09-12T22:57:19.451876 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:57:19.451964 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:57:19.454237 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:57:19.455769 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T22:57:23.363235 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:57:23 +0530
I, [2018-09-12T22:57:23.396713 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:57:23.396844 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T22:57:23.402531 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:57:23.404630 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:57:23.406005 #11095] DEBUG -- :   [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:57:23.407679 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:57:23.409270 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:57:23.410111 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:57:23.410666 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:57:23.412152 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:27:23.410000"], ["id", 1]]
D, [2018-09-12T22:57:23.418681 #11095] DEBUG -- :   [1m[35m (6.0ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:57:23.421256 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.8ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 09:27:23.419442')[0m
D, [2018-09-12T22:57:23.423248 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:57:23.423824 #11095]  INFO -- : Completed 200 OK in 27ms (Views: 0.1ms | ActiveRecord: 10.3ms)


D, [2018-09-12T22:57:23.425412 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:57:23.426708 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:57:24.460718 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T22:57:24.464448 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:57:24.465659 #11095]  INFO -- : Completed 200 OK in 5013ms (Views: 0.6ms | ActiveRecord: 2.0ms)


D, [2018-09-12T22:57:24.468111 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:57:24.470458 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:57:24.482718 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:57:24 +0530
I, [2018-09-12T22:57:24.498445 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:57:24 +0530
I, [2018-09-12T22:57:24.510348 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:57:24.511738 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:57:24.511822 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
I, [2018-09-12T22:57:24.512021 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:57:24.514995 #11095] DEBUG -- :   [1m[35m (1.2ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:57:24.515928 #11095] DEBUG -- :   [1m[35m (1.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:57:24.516778 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:57:24.517634 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:57:24.518176 #11095] DEBUG -- :   [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:57:24.519831 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:57:24.521747 #11095] DEBUG -- :   [1m[35m (1.0ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:57:24.522607 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:57:24.522968 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:57:24.523345 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:57:24.524619 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:27:24.523000"], ["id", 1]]
D, [2018-09-12T22:57:24.526053 #11095] DEBUG -- :   [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:57:24.527164 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:57:24.528062 #11095] DEBUG -- :   [1m[36mChat Load (0.3ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T22:57:24.529795 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:25:24.529162')[0m  [["active", "t"]]
D, [2018-09-12T22:57:24.531878 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:57:24.532576 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:57:24.533086 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.2ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:57:24.533711 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:57:24.534464 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:25:24.533840')[0m  [["active", "t"]]
D, [2018-09-12T22:57:24.535045 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:25:24.534582')[0m  [["active", "t"]]
D, [2018-09-12T22:57:24.535730 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T22:57:24.536365 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:25:24.535862')[0m  [["active", "t"]]
D, [2018-09-12T22:57:24.536832 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:57:24.537471 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.2ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:57:24.539918 #11095] DEBUG -- :   [1m[36mSetting Load (0.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:57:24.540261 #11095]  INFO -- : Completed 200 OK in 28ms (Views: 0.1ms | ActiveRecord: 8.6ms)


D, [2018-09-12T22:57:24.541285 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:57:24.541908 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:57:25.523025 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T22:57:25.529837 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:57:25.531052 #11095]  INFO -- : Completed 200 OK in 1019ms (Views: 3.4ms | ActiveRecord: 3.0ms)


D, [2018-09-12T22:57:25.533660 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:57:25.536231 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:57:25.546394 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:57:25 +0530
I, [2018-09-12T22:57:25.573992 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:57:25.574095 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:57:25.576800 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:57:25.578589 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:57:32.588483 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:57:32.590529 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.4ms | ActiveRecord: 2.1ms)


D, [2018-09-12T22:57:32.593344 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:57:32.595401 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:57:32.604651 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:57:32 +0530
I, [2018-09-12T22:57:32.634686 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:57:32.634879 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:57:32.637525 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:57:32.639286 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:57:39.649834 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:57:39.651271 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.6ms | ActiveRecord: 2.3ms)


D, [2018-09-12T22:57:39.654109 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:57:39.656070 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:57:39.666951 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:57:39 +0530
I, [2018-09-12T22:57:39.694331 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:57:39.694417 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:57:39.697365 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:57:39.699298 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:57:46.709477 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:57:46.711136 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.5ms | ActiveRecord: 2.4ms)


D, [2018-09-12T22:57:46.714639 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:57:46.717769 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:57:46.728688 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:57:46 +0530
I, [2018-09-12T22:57:46.756032 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:57:46.756132 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:57:46.758566 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:57:46.760139 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:57:53.770275 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:57:53.772204 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.6ms | ActiveRecord: 2.1ms)


D, [2018-09-12T22:57:53.775202 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:57:53.777522 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:57:53.787174 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:57:53 +0530
I, [2018-09-12T22:57:53.812383 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:57:53.812470 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:57:53.815073 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:57:53.816598 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:58:00.826901 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:58:00.828209 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.4ms | ActiveRecord: 2.0ms)


D, [2018-09-12T22:58:00.830590 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:58:00.832559 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:58:00.841241 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:58:00 +0530
I, [2018-09-12T22:58:00.867588 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:58:00.867686 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:58:00.870167 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:58:00.871661 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:58:07.880927 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:58:07.882270 #11095]  INFO -- : Completed 200 OK in 7014ms (Views: 0.5ms | ActiveRecord: 1.9ms)


D, [2018-09-12T22:58:07.884967 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:58:07.887015 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:58:07.896033 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:58:07 +0530
I, [2018-09-12T22:58:07.918819 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:58:07.918915 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:58:07.921293 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:58:07.922715 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:58:14.932863 #11095] DEBUG -- :   [1m[36mSetting Load (1.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:58:14.934674 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T22:58:14.937627 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:58:14.940138 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:58:14.950684 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:58:14 +0530
I, [2018-09-12T22:58:14.976236 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:58:14.976319 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:58:14.986497 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:58:14.988084 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T22:58:18.363793 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:58:18 +0530
I, [2018-09-12T22:58:18.394336 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:58:18.394459 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T22:58:18.397731 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:58:18.399572 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:58:18.401121 #11095] DEBUG -- :   [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:58:18.403038 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:58:18.404921 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:58:18.405805 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:58:18.406470 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:58:18.408189 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:28:18.406000"], ["id", 1]]
D, [2018-09-12T22:58:18.412859 #11095] DEBUG -- :   [1m[35m (4.3ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:58:18.414392 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 09:28:18.413503')[0m
D, [2018-09-12T22:58:18.416054 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:58:18.416548 #11095]  INFO -- : Completed 200 OK in 22ms (Views: 0.1ms | ActiveRecord: 7.9ms)


D, [2018-09-12T22:58:18.417964 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:58:18.419356 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:58:19.993315 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T22:58:19.997428 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:58:19.998855 #11095]  INFO -- : Completed 200 OK in 5022ms (Views: 0.5ms | ActiveRecord: 2.1ms)


D, [2018-09-12T22:58:20.001805 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:58:20.004128 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:58:20.015210 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:58:20 +0530
I, [2018-09-12T22:58:20.041756 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:58:20 +0530
I, [2018-09-12T22:58:20.054980 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:58:20.055388 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
I, [2018-09-12T22:58:20.059413 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:58:20.059528 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:58:20.062407 #11095] DEBUG -- :   [1m[35m (4.8ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:58:20.064562 #11095] DEBUG -- :   [1m[35m (2.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:58:20.065819 #11095] DEBUG -- :   [1m[35m (1.4ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:58:20.066924 #11095] DEBUG -- :   [1m[35m (1.3ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:58:20.067566 #11095] DEBUG -- :   [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:58:20.069352 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:58:20.070846 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:58:20.071622 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:58:20.072021 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:58:20.072500 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:58:20.073976 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:28:20.072000"], ["id", 1]]
D, [2018-09-12T22:58:20.081177 #11095] DEBUG -- :   [1m[35m (6.8ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:58:20.082578 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.4ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:58:20.083624 #11095] DEBUG -- :   [1m[36mChat Load (0.3ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T22:58:20.086500 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:26:20.085549')[0m  [["active", "t"]]
D, [2018-09-12T22:58:20.089064 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.2ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:58:20.089904 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:58:20.090580 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.2ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:58:20.091343 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:58:20.092339 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:26:20.091572')[0m  [["active", "t"]]
D, [2018-09-12T22:58:20.093189 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:26:20.092530')[0m  [["active", "t"]]
D, [2018-09-12T22:58:20.094134 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T22:58:20.095005 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:26:20.094339')[0m  [["active", "t"]]
D, [2018-09-12T22:58:20.095640 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:58:20.096534 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:58:20.099558 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:58:20.099998 #11095]  INFO -- : Completed 200 OK in 44ms (Views: 0.1ms | ActiveRecord: 18.8ms)


D, [2018-09-12T22:58:20.101348 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:58:20.102205 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:58:21.071364 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T22:58:21.079419 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:58:21.080844 #11095]  INFO -- : Completed 200 OK in 1021ms (Views: 4.4ms | ActiveRecord: 5.0ms)


D, [2018-09-12T22:58:21.083940 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:58:21.086556 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:58:21.098270 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:58:21 +0530
I, [2018-09-12T22:58:21.125951 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:58:21.126043 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:58:21.128803 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:58:21.130541 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:58:28.141011 #11095] DEBUG -- :   [1m[36mSetting Load (1.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:58:28.142360 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.4ms | ActiveRecord: 2.5ms)


D, [2018-09-12T22:58:28.145062 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:58:28.147466 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:58:28.156619 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:58:28 +0530
I, [2018-09-12T22:58:28.182088 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:58:28.182211 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:58:28.185876 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:58:28.187396 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:58:35.197461 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:58:35.198910 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.5ms | ActiveRecord: 2.3ms)


D, [2018-09-12T22:58:35.201949 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:58:35.204456 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:58:35.214116 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:58:35 +0530
I, [2018-09-12T22:58:35.239922 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:58:35.240034 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:58:35.242602 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:58:35.244082 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:58:42.254130 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:58:42.255330 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.6ms | ActiveRecord: 1.9ms)


D, [2018-09-12T22:58:42.257971 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:58:42.260381 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:58:42.270853 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:58:42 +0530
I, [2018-09-12T22:58:42.306109 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:58:42.306294 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:58:42.310042 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:58:42.312348 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:58:49.322182 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:58:49.323924 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.5ms | ActiveRecord: 2.4ms)


D, [2018-09-12T22:58:49.327780 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:58:49.331350 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:58:49.340761 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:58:49 +0530
I, [2018-09-12T22:58:49.357654 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:58:49.357735 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:58:49.360166 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:58:49.361689 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:58:56.371883 #11095] DEBUG -- :   [1m[36mSetting Load (1.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:58:56.373943 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.5ms | ActiveRecord: 2.3ms)


D, [2018-09-12T22:58:56.377106 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:58:56.378893 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:58:56.384877 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:58:56 +0530
I, [2018-09-12T22:58:56.399428 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:58:56.399544 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:58:56.402144 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:58:56.404078 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:59:03.414647 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:59:03.416174 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.7ms | ActiveRecord: 2.3ms)


D, [2018-09-12T22:59:03.419418 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:59:03.421540 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:59:03.430487 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:59:03 +0530
I, [2018-09-12T22:59:03.457215 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:59:03.457328 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:59:03.460092 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:59:03.461929 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:59:10.470843 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:59:10.472216 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.4ms | ActiveRecord: 2.3ms)


D, [2018-09-12T22:59:10.474903 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:59:10.477145 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:59:10.487734 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:59:10 +0530
I, [2018-09-12T22:59:10.513835 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:59:10.513918 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:59:10.516412 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:59:10.517808 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T22:59:13.364655 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:59:13 +0530
I, [2018-09-12T22:59:13.408151 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:59:13.408279 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T22:59:13.411643 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:59:13.413978 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:59:13.415994 #11095] DEBUG -- :   [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:59:13.418552 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:59:13.421469 #11095] DEBUG -- :   [1m[35m (1.1ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:59:13.423239 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.5ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:59:13.425053 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:59:13.429243 #11095] DEBUG -- :   [1m[35mSQL (0.5ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:29:13.423000"], ["id", 1]]
D, [2018-09-12T22:59:13.431019 #11095] DEBUG -- :   [1m[35m (1.0ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:59:13.432951 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 09:29:13.431818')[0m
D, [2018-09-12T22:59:13.435137 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:59:13.435857 #11095]  INFO -- : Completed 200 OK in 27ms (Views: 0.2ms | ActiveRecord: 6.0ms)


D, [2018-09-12T22:59:13.437691 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:59:13.439084 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:59:13.521263 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T22:59:13.523139 #11095] DEBUG -- :   [1m[36mSetting Load (0.6ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:59:13.523726 #11095]  INFO -- : Completed 200 OK in 3010ms (Views: 0.2ms | ActiveRecord: 1.3ms)


D, [2018-09-12T22:59:13.524897 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:59:13.525779 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:59:13.529754 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 22:59:13 +0530
I, [2018-09-12T22:59:13.539858 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:59:13 +0530
I, [2018-09-12T22:59:13.551748 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T22:59:13.551850 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
D, [2018-09-12T22:59:13.554547 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
I, [2018-09-12T22:59:13.557395 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:59:13.557463 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:59:13.559333 #11095] DEBUG -- :   [1m[35m (3.8ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:59:13.560333 #11095] DEBUG -- :   [1m[35m (1.1ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:59:13.561357 #11095] DEBUG -- :   [1m[36mUser Load (1.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:59:13.562864 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:59:13.563886 #11095] DEBUG -- :   [1m[35m (2.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:59:13.564507 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T22:59:13.565300 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:59:13.565676 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:59:13.566098 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:59:13.567397 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:29:13.565000"], ["id", 1]]
D, [2018-09-12T22:59:13.570391 #11095] DEBUG -- :   [1m[35m (2.7ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:59:13.571659 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:59:13.572500 #11095] DEBUG -- :   [1m[36mChat Load (0.3ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T22:59:13.574249 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:27:13.573598')[0m  [["active", "t"]]
D, [2018-09-12T22:59:13.576510 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:59:13.577251 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:59:13.577863 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T22:59:13.578584 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T22:59:13.579558 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:27:13.578755')[0m  [["active", "t"]]
D, [2018-09-12T22:59:13.580369 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:27:13.579702')[0m  [["active", "t"]]
D, [2018-09-12T22:59:13.582111 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T22:59:13.582946 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:27:13.582298')[0m  [["active", "t"]]
D, [2018-09-12T22:59:13.583461 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T22:59:13.584283 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T22:59:13.587234 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:59:13.587614 #11095]  INFO -- : Completed 200 OK in 36ms (Views: 0.1ms | ActiveRecord: 13.2ms)


D, [2018-09-12T22:59:13.588780 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:59:13.589481 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:59:14.568170 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T22:59:14.575045 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:59:14.576439 #11095]  INFO -- : Completed 200 OK in 1019ms (Views: 3.5ms | ActiveRecord: 4.9ms)


D, [2018-09-12T22:59:14.578922 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:59:14.581602 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:59:14.591214 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:59:14 +0530
I, [2018-09-12T22:59:14.615462 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:59:14.615566 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:59:14.618188 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:59:14.619645 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:59:21.629604 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:59:21.631029 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.4ms | ActiveRecord: 1.9ms)


D, [2018-09-12T22:59:21.634188 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:59:21.636886 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:59:21.647440 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:59:21 +0530
I, [2018-09-12T22:59:21.674199 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:59:21.674284 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:59:21.676924 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:59:21.678646 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:59:28.688317 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:59:28.689952 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.5ms | ActiveRecord: 2.0ms)


D, [2018-09-12T22:59:28.693566 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:59:28.695860 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:59:28.704918 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:59:28 +0530
I, [2018-09-12T22:59:28.726492 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:59:28.726567 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:59:28.728968 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:59:28.730599 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:59:35.742138 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:59:35.743336 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.4ms | ActiveRecord: 1.9ms)


D, [2018-09-12T22:59:35.746101 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:59:35.748158 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:59:35.757787 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:59:35 +0530
I, [2018-09-12T22:59:35.783981 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:59:35.784068 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:59:35.786706 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:59:35.788659 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:59:42.799084 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:59:42.800560 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.5ms | ActiveRecord: 2.0ms)


D, [2018-09-12T22:59:42.803389 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:59:42.805697 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:59:42.815373 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:59:42 +0530
I, [2018-09-12T22:59:42.841216 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:59:42.841302 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:59:42.843956 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:59:42.845478 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:59:49.861920 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:59:49.863251 #11095]  INFO -- : Completed 200 OK in 7022ms (Views: 0.6ms | ActiveRecord: 2.1ms)


D, [2018-09-12T22:59:49.865884 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:59:49.868615 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:59:49.877178 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:59:49 +0530
I, [2018-09-12T22:59:49.899394 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:59:49.899466 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:59:49.901858 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:59:49.903391 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T22:59:49.904482 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:59:49.905817 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[32mINSERT INTO "delayed_jobs" ("handler", "run_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["handler", "--- !ruby/object:Observer::UserDeviceLogJob\nhttp_user_agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko)\n  Chrome/68.0.3440.106 Safari/537.36\nremote_ip: \"::1\"\nuser_id: 3\nfingerprint: \"-1992429858\"\ntype: session\n"], ["run_at", "2018-09-12 17:29:49.904627"], ["created_at", "2018-09-12 17:29:49.904000"], ["updated_at", "2018-09-12 17:29:49.904000"]]
D, [2018-09-12T22:59:49.912980 #11095] DEBUG -- :   [1m[35m (6.8ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T22:59:56.924109 #11095] DEBUG -- :   [1m[36mSetting Load (1.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T22:59:56.926586 #11095]  INFO -- : Completed 200 OK in 7027ms (Views: 0.6ms | ActiveRecord: 9.5ms)


D, [2018-09-12T22:59:56.930985 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T22:59:56.938146 #11095] DEBUG -- :   [1m[35mSQL (1.2ms)[0m  [1m[33mUPDATE "sessions" SET "data" = $1, "updated_at" = $2 WHERE "sessions"."id" = $3[0m  [["data", "BAh7D0kiCXBpbmcGOgZFRkkiGTIwMTgtMDktMTJUMTY6MDk6MjZaBjsAVEki\nD3VzZXJfYWdlbnQGOwBGIm5Nb3ppbGxhLzUuMCAoWDExOyBMaW51eCB4ODZf\nNjQpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENo\ncm9tZS82OC4wLjM0NDAuMTA2IFNhZmFyaS81MzcuMzZJIhBfY3NyZl90b2tl\nbgY7AEZJIjE1SzlmTEZWTnRwVFYydjArWGQ1M21QMjFWbDAzT1RSeEp2cUpm\nbitDRDUwPQY7AEZJIgx1c2VyX2lkBjsARmkISSIadXNlcl9kZXZpY2VfcmVt\nb3RlX2lwBjsARiIIOjoxSSIcdXNlcl9kZXZpY2VfZmluZ2VycHJpbnQGOwBG\nSSIQLTE5OTI0Mjk4NTgGOwBUSSIbdXNlcl9kZXZpY2VfdXBkYXRlZF9hdAY7\nAEZVOiBBY3RpdmVTdXBwb3J0OjpUaW1lV2l0aFpvbmVbCEl1OglUaW1lDZGh\nHcAGyh13CToJem9uZUkiCFVUQwY7AEY6DW5hbm9fbnVtaQJhAToNbmFub19k\nZW5pBjoNc3VibWljcm8iBzUwSSIIVVRDBjsAVEAWSSIPcGVyc2lzdGVudAY7\nAEZUSSIOcmVtb3RlX2lwBjsARiIIOjoxSSIIZ2VvBjsARnsA\n"], ["updated_at", "2018-09-12 17:29:56.932480"], ["id", 33]]
D, [2018-09-12T22:59:56.951315 #11095] DEBUG -- :   [1m[35m (10.8ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T22:59:56.963387 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 22:59:56 +0530
I, [2018-09-12T22:59:56.993022 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T22:59:56.993092 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T22:59:56.995498 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T22:59:56.997067 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:00:04.006639 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:00:04.008170 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T23:00:04.011013 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:00:04.014161 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:00:04.024483 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:00:04 +0530
I, [2018-09-12T23:00:04.049362 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:00:04.049462 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:00:04.051802 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:00:04.053399 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T23:00:08.362338 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 23:00:08 +0530
I, [2018-09-12T23:00:08.384433 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T23:00:08.384533 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T23:00:08.387901 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:00:08.390399 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:00:08.392056 #11095] DEBUG -- :   [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:00:08.394132 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:00:08.395699 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T23:00:08.396518 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:00:08.397119 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:00:08.398591 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:30:08.396000"], ["id", 1]]
D, [2018-09-12T23:00:08.399832 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:00:08.401359 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 09:30:08.400361')[0m
D, [2018-09-12T23:00:08.404196 #11095] DEBUG -- :   [1m[36mSetting Load (0.6ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:00:08.404942 #11095]  INFO -- : Completed 200 OK in 20ms (Views: 0.2ms | ActiveRecord: 4.9ms)


D, [2018-09-12T23:00:08.406332 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:00:08.407150 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:00:09.059358 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T23:00:09.063680 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:00:09.065067 #11095]  INFO -- : Completed 200 OK in 5015ms (Views: 0.6ms | ActiveRecord: 2.0ms)


D, [2018-09-12T23:00:09.067743 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:00:09.070283 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:00:09.080826 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 23:00:09 +0530
I, [2018-09-12T23:00:09.107453 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:00:09 +0530
I, [2018-09-12T23:00:09.123009 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T23:00:09.123112 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
I, [2018-09-12T23:00:09.126499 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:00:09.126803 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:00:09.127048 #11095] DEBUG -- :   [1m[35m (1.7ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:00:09.129506 #11095] DEBUG -- :   [1m[35m (1.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:00:09.130423 #11095] DEBUG -- :   [1m[35m (1.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:00:09.131418 #11095] DEBUG -- :   [1m[36mUser Load (1.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:00:09.132905 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:00:09.133840 #11095] DEBUG -- :   [1m[35m (2.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:00:09.134449 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T23:00:09.135148 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:00:09.135551 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:00:09.135984 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:00:09.137348 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:30:09.135000"], ["id", 1]]
D, [2018-09-12T23:00:09.144285 #11095] DEBUG -- :   [1m[35m (6.6ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:00:09.145531 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T23:00:09.146394 #11095] DEBUG -- :   [1m[36mChat Load (0.3ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T23:00:09.148257 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:28:09.147531')[0m  [["active", "t"]]
D, [2018-09-12T23:00:09.150611 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T23:00:09.151533 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T23:00:09.152612 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T23:00:09.153325 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T23:00:09.154307 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:28:09.153483')[0m  [["active", "t"]]
D, [2018-09-12T23:00:09.155109 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:28:09.154434')[0m  [["active", "t"]]
D, [2018-09-12T23:00:09.155961 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T23:00:09.156682 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:28:09.156102')[0m  [["active", "t"]]
D, [2018-09-12T23:00:09.157239 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:00:09.158045 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T23:00:09.160903 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:00:09.161273 #11095]  INFO -- : Completed 200 OK in 38ms (Views: 0.1ms | ActiveRecord: 16.3ms)


D, [2018-09-12T23:00:09.162400 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:00:09.163170 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:00:10.138134 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T23:00:10.145071 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:00:10.146430 #11095]  INFO -- : Completed 200 OK in 1019ms (Views: 3.5ms | ActiveRecord: 4.8ms)


D, [2018-09-12T23:00:10.149046 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:00:10.151305 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:00:10.161572 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:00:10 +0530
I, [2018-09-12T23:00:10.186726 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:00:10.186813 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:00:10.189525 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:00:10.191071 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:00:17.200960 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:00:17.202257 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.4ms | ActiveRecord: 2.2ms)


D, [2018-09-12T23:00:17.205245 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:00:17.208361 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:00:17.218582 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:00:17 +0530
I, [2018-09-12T23:00:17.236706 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:00:17.236801 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:00:17.240476 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:00:17.242208 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:00:24.252658 #11095] DEBUG -- :   [1m[36mSetting Load (1.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:00:24.254462 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.5ms | ActiveRecord: 2.5ms)


D, [2018-09-12T23:00:24.258791 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:00:24.265024 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:00:24.273542 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:00:24 +0530
I, [2018-09-12T23:00:24.290103 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:00:24.290189 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:00:24.292753 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:00:24.294310 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:00:31.303929 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:00:31.305657 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.4ms | ActiveRecord: 2.1ms)


D, [2018-09-12T23:00:31.308502 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:00:31.310871 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:00:31.321275 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:00:31 +0530
I, [2018-09-12T23:00:31.342819 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:00:31.342894 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:00:31.345470 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:00:31.347151 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:00:38.358866 #11095] DEBUG -- :   [1m[36mSetting Load (1.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:00:38.360415 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.4ms | ActiveRecord: 2.4ms)


D, [2018-09-12T23:00:38.363638 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:00:38.367360 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:00:38.376447 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:00:38 +0530
I, [2018-09-12T23:00:38.395642 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:00:38.395726 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:00:38.399445 #11095] DEBUG -- :   [1m[35m (1.1ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:00:38.401488 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:00:45.411195 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:00:45.412682 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.5ms | ActiveRecord: 2.9ms)


D, [2018-09-12T23:00:45.415286 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:00:45.417784 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:00:45.426241 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:00:45 +0530
I, [2018-09-12T23:00:45.456283 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:00:45.456426 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:00:45.459758 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:00:45.461960 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:00:52.472086 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:00:52.475064 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.5ms | ActiveRecord: 2.6ms)


D, [2018-09-12T23:00:52.478546 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:00:52.481109 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:00:52.491180 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:00:52 +0530
I, [2018-09-12T23:00:52.538588 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:00:52.538945 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:00:52.546936 #11095] DEBUG -- :   [1m[35m (1.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:00:52.553738 #11095] DEBUG -- :   [1m[35m (2.4ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:00:59.563101 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:00:59.563597 #11095]  INFO -- : Completed 200 OK in 7024ms (Views: 0.2ms | ActiveRecord: 4.2ms)


D, [2018-09-12T23:00:59.564630 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:00:59.565452 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:00:59.569174 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:00:59 +0530
I, [2018-09-12T23:00:59.584964 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:00:59.585043 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:00:59.587519 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:00:59.589247 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T23:01:03.362877 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 23:01:03 +0530
I, [2018-09-12T23:01:03.392876 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T23:01:03.392972 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T23:01:03.396450 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:01:03.399244 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:01:03.401140 #11095] DEBUG -- :   [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:01:03.403056 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:01:03.404575 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T23:01:03.405395 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:01:03.406001 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:01:03.407422 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:31:03.405000"], ["id", 1]]
D, [2018-09-12T23:01:03.408940 #11095] DEBUG -- :   [1m[35m (1.0ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:01:03.412877 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.9ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 09:31:03.410346')[0m
D, [2018-09-12T23:01:03.418293 #11095] DEBUG -- :   [1m[36mSetting Load (0.8ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:01:03.419184 #11095]  INFO -- : Completed 200 OK in 26ms (Views: 0.4ms | ActiveRecord: 6.0ms)


D, [2018-09-12T23:01:03.421327 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:01:03.422511 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:01:04.595869 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T23:01:04.599935 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:01:04.601267 #11095]  INFO -- : Completed 200 OK in 5016ms (Views: 0.5ms | ActiveRecord: 2.4ms)


D, [2018-09-12T23:01:04.604489 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:01:04.606689 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:01:04.617339 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 23:01:04 +0530
I, [2018-09-12T23:01:04.640423 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:01:04 +0530
I, [2018-09-12T23:01:04.655117 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T23:01:04.655238 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
I, [2018-09-12T23:01:04.658889 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:01:04.659006 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:01:04.660718 #11095] DEBUG -- :   [1m[35m (1.8ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:01:04.661946 #11095] DEBUG -- :   [1m[35m (1.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:01:04.662881 #11095] DEBUG -- :   [1m[35m (1.1ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:01:04.663782 #11095] DEBUG -- :   [1m[35m (1.0ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:01:04.664305 #11095] DEBUG -- :   [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:01:04.665765 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:01:04.666991 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T23:01:04.667703 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:01:04.668081 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:01:04.668501 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:01:04.669789 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:31:04.668000"], ["id", 1]]
D, [2018-09-12T23:01:04.672606 #11095] DEBUG -- :   [1m[35m (2.6ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:01:04.673797 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T23:01:04.674604 #11095] DEBUG -- :   [1m[36mChat Load (0.2ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T23:01:04.676566 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:29:04.675842')[0m  [["active", "t"]]
D, [2018-09-12T23:01:04.678598 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.2ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T23:01:04.679226 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T23:01:04.679678 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.2ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T23:01:04.680294 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T23:01:04.681181 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:29:04.680446')[0m  [["active", "t"]]
D, [2018-09-12T23:01:04.681898 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:29:04.681310')[0m  [["active", "t"]]
D, [2018-09-12T23:01:04.682671 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T23:01:04.683355 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:29:04.682807')[0m  [["active", "t"]]
D, [2018-09-12T23:01:04.683947 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:01:04.684773 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T23:01:04.689875 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:01:04.690273 #11095]  INFO -- : Completed 200 OK in 35ms (Views: 0.1ms | ActiveRecord: 10.5ms)


D, [2018-09-12T23:01:04.691338 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:01:04.692121 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:01:05.668120 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T23:01:05.675787 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:01:05.677203 #11095]  INFO -- : Completed 200 OK in 1018ms (Views: 4.0ms | ActiveRecord: 3.5ms)


D, [2018-09-12T23:01:05.680482 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:01:05.683250 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:01:05.694392 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:01:05 +0530
I, [2018-09-12T23:01:05.718456 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:01:05.718562 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:01:05.721112 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:01:05.722884 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:01:12.731740 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:01:12.733093 #11095]  INFO -- : Completed 200 OK in 7014ms (Views: 0.5ms | ActiveRecord: 2.0ms)


D, [2018-09-12T23:01:12.735978 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:01:12.738493 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:01:12.747672 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:01:12 +0530
I, [2018-09-12T23:01:12.772266 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:01:12.772358 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:01:12.774977 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:01:12.776610 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:01:19.787401 #11095] DEBUG -- :   [1m[36mSetting Load (1.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:01:19.788860 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.4ms | ActiveRecord: 2.5ms)


D, [2018-09-12T23:01:19.791756 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:01:19.793995 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:01:19.802925 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:01:19 +0530
I, [2018-09-12T23:01:19.830885 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:01:19.830974 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:01:19.833681 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:01:19.835371 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:01:26.845667 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:01:26.847179 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.4ms | ActiveRecord: 2.1ms)


D, [2018-09-12T23:01:26.849702 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:01:26.851875 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:01:26.861587 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:01:26 +0530
I, [2018-09-12T23:01:26.887802 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:01:26.887891 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:01:26.890707 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:01:26.892235 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:01:33.902873 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:01:33.904453 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T23:01:33.907748 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:01:33.910197 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:01:33.920938 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:01:33 +0530
I, [2018-09-12T23:01:33.953222 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:01:33.953328 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:01:33.956194 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:01:33.958137 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:01:40.967868 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:01:40.968485 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.3ms | ActiveRecord: 2.4ms)


D, [2018-09-12T23:01:40.969619 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:01:40.970437 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:01:40.974174 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:01:40 +0530
I, [2018-09-12T23:01:40.999659 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:01:40.999752 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:01:41.002474 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:01:41.004045 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:01:48.014105 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:01:48.016719 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.6ms | ActiveRecord: 2.2ms)


D, [2018-09-12T23:01:48.020200 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:01:48.023064 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:01:48.031928 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:01:48 +0530
I, [2018-09-12T23:01:48.050279 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:01:48.050376 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:01:48.053616 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:01:48.055227 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:01:55.066118 #11095] DEBUG -- :   [1m[36mSetting Load (2.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:01:55.068415 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.5ms | ActiveRecord: 3.2ms)


D, [2018-09-12T23:01:55.071380 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:01:55.073388 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:01:55.084201 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:01:55 +0530
I, [2018-09-12T23:01:55.103915 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:01:55.103989 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:01:55.106720 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:01:55.108508 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T23:01:58.365574 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 23:01:58 +0530
I, [2018-09-12T23:01:58.412237 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T23:01:58.412556 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T23:01:58.421646 #11095] DEBUG -- :   [1m[35m (1.9ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:01:58.428936 #11095] DEBUG -- :   [1m[35m (2.0ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:01:58.433418 #11095] DEBUG -- :   [1m[36mUser Load (1.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:01:58.439066 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:01:58.442501 #11095] DEBUG -- :   [1m[35m (1.1ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T23:01:58.444266 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.5ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:01:58.445565 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:01:58.449522 #11095] DEBUG -- :   [1m[35mSQL (0.9ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:31:58.444000"], ["id", 1]]
D, [2018-09-12T23:01:58.451788 #11095] DEBUG -- :   [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:01:58.456987 #11095] DEBUG -- :   [1m[36mChat::Agent Load (1.0ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 09:31:58.454156')[0m
D, [2018-09-12T23:01:58.461381 #11095] DEBUG -- :   [1m[36mSetting Load (0.8ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:01:58.462415 #11095]  INFO -- : Completed 200 OK in 50ms (Views: 0.3ms | ActiveRecord: 10.8ms)


D, [2018-09-12T23:01:58.465361 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:01:58.468092 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:02:00.113163 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T23:02:00.116834 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:02:00.118377 #11095]  INFO -- : Completed 200 OK in 5014ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T23:02:00.121258 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:02:00.123620 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:02:00.132819 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 23:02:00 +0530
I, [2018-09-12T23:02:00.156946 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:02:00 +0530
I, [2018-09-12T23:02:00.169462 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T23:02:00.169549 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
I, [2018-09-12T23:02:00.172814 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
D, [2018-09-12T23:02:00.173479 #11095] DEBUG -- :   [1m[35m (1.9ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
I, [2018-09-12T23:02:00.174511 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:02:00.176516 #11095] DEBUG -- :   [1m[35m (1.9ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:02:00.177445 #11095] DEBUG -- :   [1m[35m (1.1ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:02:00.178361 #11095] DEBUG -- :   [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:02:00.179910 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:02:00.180655 #11095] DEBUG -- :   [1m[35m (1.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:02:00.181260 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T23:02:00.181944 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:02:00.182306 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:02:00.182715 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:02:00.183992 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:32:00.182000"], ["id", 1]]
D, [2018-09-12T23:02:00.185086 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:02:00.186259 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T23:02:00.187063 #11095] DEBUG -- :   [1m[36mChat Load (0.3ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T23:02:00.188772 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:30:00.188136')[0m  [["active", "t"]]
D, [2018-09-12T23:02:00.190827 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.2ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T23:02:00.191422 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T23:02:00.192007 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.2ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T23:02:00.192658 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T23:02:00.193445 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:30:00.192795')[0m  [["active", "t"]]
D, [2018-09-12T23:02:00.194210 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:30:00.193618')[0m  [["active", "t"]]
D, [2018-09-12T23:02:00.194980 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T23:02:00.195681 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:30:00.195108')[0m  [["active", "t"]]
D, [2018-09-12T23:02:00.196214 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:02:00.196964 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T23:02:00.199482 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:02:00.199829 #11095]  INFO -- : Completed 200 OK in 30ms (Views: 0.1ms | ActiveRecord: 10.3ms)


D, [2018-09-12T23:02:00.200882 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:02:00.201594 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:02:01.184005 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T23:02:01.188123 #11095] DEBUG -- :   [1m[36mSetting Load (0.6ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:02:01.188779 #11095]  INFO -- : Completed 200 OK in 1014ms (Views: 2.2ms | ActiveRecord: 3.3ms)


D, [2018-09-12T23:02:01.190144 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:02:01.191464 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:02:01.198324 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:02:01 +0530
I, [2018-09-12T23:02:01.218694 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:02:01.218771 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:02:01.221232 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:02:01.222798 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:02:08.233141 #11095] DEBUG -- :   [1m[36mSetting Load (1.9ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:02:08.235124 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.5ms | ActiveRecord: 2.8ms)


D, [2018-09-12T23:02:08.238070 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:02:08.240246 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:02:08.251679 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:02:08 +0530
I, [2018-09-12T23:02:08.271159 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:02:08.271248 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:02:08.273539 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:02:08.275102 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:02:15.286110 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:02:15.287362 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.4ms | ActiveRecord: 2.1ms)


D, [2018-09-12T23:02:15.289874 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:02:15.292041 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:02:15.301051 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:02:15 +0530
I, [2018-09-12T23:02:15.333916 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:02:15.334060 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:02:15.337419 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:02:15.339109 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:02:22.348631 #11095] DEBUG -- :   [1m[36mSetting Load (1.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:02:22.350159 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.5ms | ActiveRecord: 2.4ms)


D, [2018-09-12T23:02:22.352883 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:02:22.355255 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:02:22.383376 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:02:22 +0530
I, [2018-09-12T23:02:22.398194 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:02:22.398264 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:02:22.400455 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:02:22.401881 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:02:29.411243 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:02:29.412567 #11095]  INFO -- : Completed 200 OK in 7014ms (Views: 0.5ms | ActiveRecord: 2.0ms)


D, [2018-09-12T23:02:29.415226 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:02:29.417690 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:02:29.426609 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:02:29 +0530
I, [2018-09-12T23:02:29.457611 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:02:29.457717 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:02:29.460955 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:02:29.462950 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:02:36.473704 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:02:36.475539 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.6ms | ActiveRecord: 2.4ms)


D, [2018-09-12T23:02:36.477532 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:02:36.478903 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:02:36.483903 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:02:36 +0530
I, [2018-09-12T23:02:36.497104 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:02:36.497202 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:02:36.499474 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:02:36.501063 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:02:43.509520 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:02:43.510787 #11095]  INFO -- : Completed 200 OK in 7013ms (Views: 0.5ms | ActiveRecord: 2.0ms)


D, [2018-09-12T23:02:43.513276 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:02:43.515298 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:02:43.525086 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:02:43 +0530
I, [2018-09-12T23:02:43.549367 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:02:43.549455 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:02:43.552304 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:02:43.553771 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:02:50.563210 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:02:50.564930 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T23:02:50.567280 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:02:50.570102 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:02:50.578738 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:02:50 +0530
I, [2018-09-12T23:02:50.603147 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:02:50.603219 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:02:50.605607 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:02:50.607175 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T23:02:53.365341 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 23:02:53 +0530
I, [2018-09-12T23:02:53.386541 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T23:02:53.386629 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T23:02:53.389065 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:02:53.390737 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:02:53.392502 #11095] DEBUG -- :   [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:02:53.395693 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:02:53.398320 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T23:02:53.399469 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:02:53.400204 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:02:53.401953 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:32:53.399000"], ["id", 1]]
D, [2018-09-12T23:02:53.404936 #11095] DEBUG -- :   [1m[35m (2.6ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:02:53.406282 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 09:32:53.405456')[0m
D, [2018-09-12T23:02:53.407899 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:02:53.408433 #11095]  INFO -- : Completed 200 OK in 22ms (Views: 0.2ms | ActiveRecord: 6.5ms)


D, [2018-09-12T23:02:53.409992 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:02:53.411340 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:02:53.611072 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T23:02:53.616041 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:02:53.618424 #11095]  INFO -- : Completed 200 OK in 3014ms (Views: 0.7ms | ActiveRecord: 2.2ms)


D, [2018-09-12T23:02:53.622411 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:02:53.625306 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:02:53.636807 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 23:02:53 +0530
I, [2018-09-12T23:02:53.657272 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:02:53 +0530
I, [2018-09-12T23:02:53.673715 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T23:02:53.673797 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
I, [2018-09-12T23:02:53.678319 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:02:53.678408 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:02:53.678632 #11095] DEBUG -- :   [1m[35m (2.8ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:02:53.683994 #11095] DEBUG -- :   [1m[35m (3.3ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:02:53.685828 #11095] DEBUG -- :   [1m[35m (2.2ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:02:53.687043 #11095] DEBUG -- :   [1m[36mUser Load (1.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:02:53.688851 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:02:53.689914 #11095] DEBUG -- :   [1m[35m (3.0ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:02:53.690643 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T23:02:53.691623 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:02:53.692285 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:02:53.692813 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:02:53.694354 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:32:53.692000"], ["id", 1]]
D, [2018-09-12T23:02:53.697347 #11095] DEBUG -- :   [1m[35m (2.7ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:02:53.698812 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T23:02:53.700015 #11095] DEBUG -- :   [1m[36mChat Load (0.3ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T23:02:53.702426 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.5ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:30:53.701337')[0m  [["active", "t"]]
D, [2018-09-12T23:02:53.705203 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T23:02:53.706077 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T23:02:53.706756 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T23:02:53.707572 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T23:02:53.708571 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:30:53.707793')[0m  [["active", "t"]]
D, [2018-09-12T23:02:53.709376 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:30:53.708718')[0m  [["active", "t"]]
D, [2018-09-12T23:02:53.710230 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T23:02:53.711060 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:30:53.710388')[0m  [["active", "t"]]
D, [2018-09-12T23:02:53.711750 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:02:53.712656 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T23:02:53.715092 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:02:53.715532 #11095]  INFO -- : Completed 200 OK in 42ms (Views: 0.1ms | ActiveRecord: 15.7ms)


D, [2018-09-12T23:02:53.716782 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:02:53.717548 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:02:54.697001 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T23:02:54.704250 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:02:54.705729 #11095]  INFO -- : Completed 200 OK in 1027ms (Views: 4.0ms | ActiveRecord: 6.3ms)


D, [2018-09-12T23:02:54.709116 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:02:54.711868 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:02:54.723357 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:02:54 +0530
I, [2018-09-12T23:02:54.743650 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:02:54.743724 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:02:54.745953 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:02:54.747338 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:03:01.757184 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:03:01.758508 #11095]  INFO -- : Completed 200 OK in 7014ms (Views: 0.5ms | ActiveRecord: 1.9ms)


D, [2018-09-12T23:03:01.761070 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:03:01.763787 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:03:01.773188 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:03:01 +0530
I, [2018-09-12T23:03:01.796351 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:03:01.796433 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:03:01.798739 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:03:01.800444 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:03:08.812845 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:03:08.814063 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T23:03:08.816592 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:03:08.818539 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:03:08.827788 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:03:08 +0530
I, [2018-09-12T23:03:08.853514 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:03:08.853619 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:03:08.856424 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:03:08.858080 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:03:15.868805 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:03:15.870148 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.5ms | ActiveRecord: 2.1ms)


D, [2018-09-12T23:03:15.872823 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:03:15.875234 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:03:15.885001 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:03:15 +0530
I, [2018-09-12T23:03:15.910843 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:03:15.910931 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:03:15.913628 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:03:15.915317 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:03:22.926866 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:03:22.947286 #11095]  INFO -- : Completed 200 OK in 7036ms (Views: 0.6ms | ActiveRecord: 2.1ms)


D, [2018-09-12T23:03:22.949663 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:03:22.951200 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:03:22.956992 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:03:22 +0530
I, [2018-09-12T23:03:22.970921 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:03:22.971030 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:03:22.973520 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:03:22.975182 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:03:29.985080 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:03:29.986424 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.4ms | ActiveRecord: 2.0ms)


D, [2018-09-12T23:03:29.989257 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:03:29.991707 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:03:30.000887 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:03:30 +0530
I, [2018-09-12T23:03:30.023778 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:03:30.023849 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:03:30.026164 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:03:30.027858 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:03:37.036190 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:03:37.036820 #11095]  INFO -- : Completed 200 OK in 7013ms (Views: 0.3ms | ActiveRecord: 1.5ms)


D, [2018-09-12T23:03:37.037835 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:03:37.038688 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:03:37.042212 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:03:37 +0530
I, [2018-09-12T23:03:37.060399 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:03:37.060495 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:03:37.063839 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:03:37.065844 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:03:44.073255 #11095] DEBUG -- :   [1m[36mSetting Load (0.8ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:03:44.074136 #11095]  INFO -- : Completed 200 OK in 7013ms (Views: 0.3ms | ActiveRecord: 1.9ms)


D, [2018-09-12T23:03:44.075863 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:03:44.077346 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:03:44.084810 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:03:44 +0530
I, [2018-09-12T23:03:44.107093 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:03:44.107188 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:03:44.109997 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:03:44.111590 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T23:03:48.365666 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 23:03:48 +0530
I, [2018-09-12T23:03:48.394611 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T23:03:48.394705 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T23:03:48.397680 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:03:48.399187 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:03:48.400521 #11095] DEBUG -- :   [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:03:48.402154 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:03:48.403640 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T23:03:48.404418 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:03:48.405029 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:03:48.406496 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:33:48.404000"], ["id", 1]]
D, [2018-09-12T23:03:48.407624 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:03:48.408768 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 09:33:48.408088')[0m
D, [2018-09-12T23:03:48.410103 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:03:48.410506 #11095]  INFO -- : Completed 200 OK in 16ms (Views: 0.1ms | ActiveRecord: 4.0ms)


D, [2018-09-12T23:03:48.411724 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:03:48.412477 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:03:49.139893 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T23:03:49.143529 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:03:49.144745 #11095]  INFO -- : Completed 200 OK in 5037ms (Views: 0.5ms | ActiveRecord: 2.1ms)


D, [2018-09-12T23:03:49.147178 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:03:49.149264 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:03:49.160855 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 23:03:49 +0530
I, [2018-09-12T23:03:49.178530 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:03:49 +0530
I, [2018-09-12T23:03:49.191837 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T23:03:49.191924 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
I, [2018-09-12T23:03:49.195396 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
D, [2018-09-12T23:03:49.195477 #11095] DEBUG -- :   [1m[35m (1.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
I, [2018-09-12T23:03:49.196479 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:03:49.198455 #11095] DEBUG -- :   [1m[35m (1.9ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:03:49.199627 #11095] DEBUG -- :   [1m[35m (1.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:03:49.201308 #11095] DEBUG -- :   [1m[36mUser Load (1.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:03:49.203107 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:03:49.204269 #11095] DEBUG -- :   [1m[35m (3.1ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:03:49.205062 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T23:03:49.205864 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:03:49.206274 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:03:49.206678 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:03:49.208101 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:33:49.206000"], ["id", 1]]
D, [2018-09-12T23:03:49.213519 #11095] DEBUG -- :   [1m[35m (4.9ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:03:49.217227 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.8ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T23:03:49.219878 #11095] DEBUG -- :   [1m[36mChat Load (0.8ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T23:03:49.225154 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.8ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:31:49.223156')[0m  [["active", "t"]]
D, [2018-09-12T23:03:49.232200 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.8ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T23:03:49.235014 #11095] DEBUG -- :   [1m[35m (1.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T23:03:49.236996 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.6ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T23:03:49.239025 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T23:03:49.241252 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:31:49.239535')[0m  [["active", "t"]]
D, [2018-09-12T23:03:49.242624 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:31:49.241522')[0m  [["active", "t"]]
D, [2018-09-12T23:03:49.244277 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T23:03:49.245755 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:31:49.244612')[0m  [["active", "t"]]
D, [2018-09-12T23:03:49.246565 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:03:49.247792 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.4ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T23:03:49.251412 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:03:49.251911 #11095]  INFO -- : Completed 200 OK in 60ms (Views: 0.2ms | ActiveRecord: 20.0ms)


D, [2018-09-12T23:03:49.253644 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:03:49.254535 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:03:50.209500 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T23:03:50.218393 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:03:50.219865 #11095]  INFO -- : Completed 200 OK in 1023ms (Views: 5.0ms | ActiveRecord: 5.4ms)


D, [2018-09-12T23:03:50.223579 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:03:50.227665 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:03:50.238812 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:03:50 +0530
I, [2018-09-12T23:03:50.282275 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:03:50.282551 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:03:50.290237 #11095] DEBUG -- :   [1m[35m (1.2ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:03:50.297330 #11095] DEBUG -- :   [1m[35m (2.0ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:03:57.307473 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:03:57.308766 #11095]  INFO -- : Completed 200 OK in 7026ms (Views: 0.5ms | ActiveRecord: 4.4ms)


D, [2018-09-12T23:03:57.311431 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:03:57.313812 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:03:57.323633 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:03:57 +0530
I, [2018-09-12T23:03:57.352818 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:03:57.352957 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:03:57.355822 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:03:57.358152 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:04:04.369142 #11095] DEBUG -- :   [1m[36mSetting Load (1.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:04:04.370631 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.4ms | ActiveRecord: 2.7ms)


D, [2018-09-12T23:04:04.373683 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:04:04.376857 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:04:04.388712 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:04:04 +0530
I, [2018-09-12T23:04:04.417896 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:04:04.417998 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:04:04.420735 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:04:04.422318 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:04:11.433200 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:04:11.434570 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.5ms | ActiveRecord: 2.1ms)


D, [2018-09-12T23:04:11.437327 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:04:11.439466 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:04:11.451572 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:04:11 +0530
I, [2018-09-12T23:04:11.481843 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:04:11.481928 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:04:11.484789 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:04:11.487613 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:04:18.498322 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:04:18.499780 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.5ms | ActiveRecord: 2.6ms)


D, [2018-09-12T23:04:18.502587 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:04:18.505082 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:04:18.514052 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:04:18 +0530
I, [2018-09-12T23:04:18.533706 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:04:18.533816 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:04:18.537621 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:04:18.539707 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:04:25.548953 #11095] DEBUG -- :   [1m[36mSetting Load (0.6ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:04:25.549524 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.2ms | ActiveRecord: 2.0ms)


D, [2018-09-12T23:04:25.550777 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:04:25.552486 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:04:25.556587 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:04:25 +0530
I, [2018-09-12T23:04:25.573133 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:04:25.573230 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:04:25.576136 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:04:25.578259 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:04:32.590326 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:04:32.591795 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.5ms | ActiveRecord: 2.4ms)


D, [2018-09-12T23:04:32.594570 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:04:32.596985 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:04:32.606105 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:04:32 +0530
I, [2018-09-12T23:04:32.634448 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:04:32.634568 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:04:32.638184 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:04:32.639788 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:04:39.649012 #11095] DEBUG -- :   [1m[36mSetting Load (0.7ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:04:39.649762 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.3ms | ActiveRecord: 1.8ms)


D, [2018-09-12T23:04:39.651199 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:04:39.652152 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:04:39.655962 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:04:39 +0530
I, [2018-09-12T23:04:39.669288 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:04:39.669380 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:04:39.671666 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:04:39.673170 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T23:04:43.368250 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 23:04:43 +0530
I, [2018-09-12T23:04:43.397532 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T23:04:43.397679 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T23:04:43.400532 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:04:43.402184 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:04:43.403619 #11095] DEBUG -- :   [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:04:43.405326 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:04:43.406766 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T23:04:43.407602 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:04:43.408162 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:04:43.409648 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:34:43.407000"], ["id", 1]]
D, [2018-09-12T23:04:43.412703 #11095] DEBUG -- :   [1m[35m (2.8ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:04:43.413921 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 09:34:43.413201')[0m
D, [2018-09-12T23:04:43.415353 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:04:43.415798 #11095]  INFO -- : Completed 200 OK in 18ms (Views: 0.1ms | ActiveRecord: 6.1ms)


D, [2018-09-12T23:04:43.417055 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:04:43.417799 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:04:44.678952 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T23:04:44.680944 #11095] DEBUG -- :   [1m[36mSetting Load (0.6ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:04:44.681606 #11095]  INFO -- : Completed 200 OK in 5012ms (Views: 0.3ms | ActiveRecord: 1.4ms)


D, [2018-09-12T23:04:44.682839 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:04:44.683842 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:04:44.689914 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 23:04:44 +0530
I, [2018-09-12T23:04:44.706151 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:04:44 +0530
I, [2018-09-12T23:04:44.722230 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T23:04:44.722312 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
D, [2018-09-12T23:04:44.724745 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
I, [2018-09-12T23:04:44.727312 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:04:44.727620 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:04:44.727707 #11095] DEBUG -- :   [1m[35m (1.8ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:04:44.730496 #11095] DEBUG -- :   [1m[35m (1.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:04:44.731531 #11095] DEBUG -- :   [1m[36mUser Load (1.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:04:44.732954 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:04:44.733163 #11095] DEBUG -- :   [1m[35m (1.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:04:44.734824 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T23:04:44.735544 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:04:44.735930 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:04:44.736350 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:04:44.737701 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:34:44.736000"], ["id", 1]]
D, [2018-09-12T23:04:44.738850 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:04:44.740644 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.4ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T23:04:44.741588 #11095] DEBUG -- :   [1m[36mChat Load (0.3ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T23:04:44.743369 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:32:44.742696')[0m  [["active", "t"]]
D, [2018-09-12T23:04:44.745478 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T23:04:44.746186 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T23:04:44.746750 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.2ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T23:04:44.747361 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T23:04:44.748137 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:32:44.747527')[0m  [["active", "t"]]
D, [2018-09-12T23:04:44.748810 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:32:44.748275')[0m  [["active", "t"]]
D, [2018-09-12T23:04:44.749553 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T23:04:44.750242 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:32:44.749698')[0m  [["active", "t"]]
D, [2018-09-12T23:04:44.750774 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:04:44.751553 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T23:04:44.753885 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:04:44.754227 #11095]  INFO -- : Completed 200 OK in 32ms (Views: 0.1ms | ActiveRecord: 9.2ms)


D, [2018-09-12T23:04:44.755315 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:04:44.756046 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:04:45.741238 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T23:04:45.749040 #11095] DEBUG -- :   [1m[36mSetting Load (1.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:04:45.749589 #11095]  INFO -- : Completed 200 OK in 1022ms (Views: 4.0ms | ActiveRecord: 4.2ms)


D, [2018-09-12T23:04:45.750735 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:04:45.751772 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:04:45.756865 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:04:45 +0530
I, [2018-09-12T23:04:45.771263 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:04:45.771361 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:04:45.773831 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:04:45.776025 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:04:52.788146 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:04:52.789570 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.5ms | ActiveRecord: 2.4ms)


D, [2018-09-12T23:04:52.792366 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:04:52.795380 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:04:52.806466 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:04:52 +0530
I, [2018-09-12T23:04:52.833695 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:04:52.833771 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:04:52.836163 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:04:52.837749 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:04:59.850037 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:04:59.851556 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T23:04:59.854683 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:04:59.857117 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:04:59.866414 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:04:59 +0530
I, [2018-09-12T23:04:59.908950 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:04:59.909030 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:04:59.911321 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:04:59.912834 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:05:06.923737 #11095] DEBUG -- :   [1m[36mSetting Load (0.9ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:05:06.924903 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.7ms | ActiveRecord: 1.8ms)


D, [2018-09-12T23:05:06.927619 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:05:06.929728 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:05:06.938330 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:05:06 +0530
I, [2018-09-12T23:05:06.966021 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:05:06.966124 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:05:06.968626 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:05:06.970375 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:05:13.979236 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:05:13.980531 #11095]  INFO -- : Completed 200 OK in 7014ms (Views: 0.4ms | ActiveRecord: 1.9ms)


D, [2018-09-12T23:05:13.982913 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:05:13.984575 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:05:13.988023 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:05:13 +0530
I, [2018-09-12T23:05:14.000825 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:05:14.000901 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:05:14.003332 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:05:14.004940 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:05:21.015951 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:05:21.017115 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.8ms | ActiveRecord: 2.1ms)


D, [2018-09-12T23:05:21.020286 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:05:21.022474 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:05:21.031120 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:05:21 +0530
I, [2018-09-12T23:05:21.058056 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:05:21.058142 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:05:21.060750 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:05:21.062328 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:05:28.072808 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:05:28.074295 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.6ms | ActiveRecord: 2.1ms)


D, [2018-09-12T23:05:28.077649 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:05:28.080531 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:05:28.119724 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:05:28 +0530
I, [2018-09-12T23:05:28.135189 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:05:28.135322 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:05:28.139873 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:05:28.141795 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:05:35.151067 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:05:35.152276 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.4ms | ActiveRecord: 2.5ms)


D, [2018-09-12T23:05:35.154742 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:05:35.156795 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:05:35.165668 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:05:35 +0530
I, [2018-09-12T23:05:35.193280 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:05:35.193381 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:05:35.196198 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:05:35.197846 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T23:05:38.363625 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 23:05:38 +0530
I, [2018-09-12T23:05:38.393541 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T23:05:38.393658 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T23:05:38.397583 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:05:38.399721 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:05:38.401577 #11095] DEBUG -- :   [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:05:38.403798 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:05:38.405765 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T23:05:38.406848 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:05:38.407534 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:05:38.409463 #11095] DEBUG -- :   [1m[35mSQL (0.4ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:35:38.407000"], ["id", 1]]
D, [2018-09-12T23:05:38.412810 #11095] DEBUG -- :   [1m[35m (2.9ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:05:38.414432 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 09:35:38.413475')[0m
D, [2018-09-12T23:05:38.416365 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:05:38.416928 #11095]  INFO -- : Completed 200 OK in 23ms (Views: 0.2ms | ActiveRecord: 7.2ms)


D, [2018-09-12T23:05:38.418648 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:05:38.419894 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:05:40.204234 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T23:05:40.209274 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:05:40.210597 #11095]  INFO -- : Completed 200 OK in 5017ms (Views: 0.7ms | ActiveRecord: 2.0ms)


D, [2018-09-12T23:05:40.213240 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:05:40.215395 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:05:40.227086 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 23:05:40 +0530
I, [2018-09-12T23:05:40.251210 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:05:40 +0530
I, [2018-09-12T23:05:40.265126 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T23:05:40.265221 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
I, [2018-09-12T23:05:40.268554 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:05:40.271029 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:05:40.271700 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:05:40.274633 #11095] DEBUG -- :   [1m[35m (1.1ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:05:40.275772 #11095] DEBUG -- :   [1m[35m (1.2ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:05:40.276847 #11095] DEBUG -- :   [1m[35m (1.1ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:05:40.277498 #11095] DEBUG -- :   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:05:40.279073 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:05:40.280507 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T23:05:40.281345 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:05:40.281775 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:05:40.282230 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:05:40.284187 #11095] DEBUG -- :   [1m[35mSQL (0.5ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:35:40.281000"], ["id", 1]]
D, [2018-09-12T23:05:40.292265 #11095] DEBUG -- :   [1m[35m (7.3ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:05:40.296559 #11095] DEBUG -- :   [1m[36mChat::Session Load (1.1ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T23:05:40.299850 #11095] DEBUG -- :   [1m[36mChat Load (1.0ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T23:05:40.307631 #11095] DEBUG -- :   [1m[36mChat::Agent Load (1.0ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:33:40.304790')[0m  [["active", "t"]]
D, [2018-09-12T23:05:40.313317 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.5ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T23:05:40.314830 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T23:05:40.315838 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.4ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T23:05:40.317352 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T23:05:40.320088 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:33:40.317913')[0m  [["active", "t"]]
D, [2018-09-12T23:05:40.321740 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.5ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:33:40.320516')[0m  [["active", "t"]]
D, [2018-09-12T23:05:40.323029 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T23:05:40.324111 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:33:40.323250')[0m  [["active", "t"]]
D, [2018-09-12T23:05:40.324824 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:05:40.325756 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T23:05:40.328724 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:05:40.329209 #11095]  INFO -- : Completed 200 OK in 64ms (Views: 0.1ms | ActiveRecord: 19.4ms)


D, [2018-09-12T23:05:40.330541 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:05:40.331335 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:05:41.282192 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T23:05:41.285298 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:05:41.285675 #11095]  INFO -- : Completed 200 OK in 1014ms (Views: 1.8ms | ActiveRecord: 2.6ms)


D, [2018-09-12T23:05:41.286418 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:05:41.287104 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:05:41.290832 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:05:41 +0530
I, [2018-09-12T23:05:41.302521 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:05:41.302588 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:05:41.304765 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:05:41.306120 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:05:48.316463 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:05:48.317838 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.4ms | ActiveRecord: 1.9ms)


D, [2018-09-12T23:05:48.320320 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:05:48.322195 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:05:48.331202 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:05:48 +0530
I, [2018-09-12T23:05:48.362955 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:05:48.363095 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:05:48.367612 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:05:48.370396 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:05:55.379529 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:05:55.380812 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.4ms | ActiveRecord: 2.6ms)


D, [2018-09-12T23:05:55.384369 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:05:55.386449 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:05:55.395022 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:05:55 +0530
I, [2018-09-12T23:05:55.422502 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:05:55.422591 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:05:55.425267 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:05:55.427114 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:06:02.435751 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:06:02.436334 #11095]  INFO -- : Completed 200 OK in 7014ms (Views: 0.4ms | ActiveRecord: 1.5ms)


D, [2018-09-12T23:06:02.437559 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:06:02.438557 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:06:02.442904 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:06:02 +0530
I, [2018-09-12T23:06:02.458099 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:06:02.458201 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:06:02.462226 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:06:02.465860 #11095] DEBUG -- :   [1m[35m (1.4ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:06:09.476360 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:06:09.477552 #11095]  INFO -- : Completed 200 OK in 7019ms (Views: 0.5ms | ActiveRecord: 3.2ms)


D, [2018-09-12T23:06:09.480173 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:06:09.482465 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:06:09.490893 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:06:09 +0530
I, [2018-09-12T23:06:09.520718 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:06:09.520827 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:06:09.523701 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:06:09.525386 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:06:16.538104 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:06:16.540025 #11095]  INFO -- : Completed 200 OK in 7019ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T23:06:16.543172 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:06:16.545907 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:06:16.556872 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:06:16 +0530
I, [2018-09-12T23:06:16.581088 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:06:16.581188 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:06:16.584460 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:06:16.586122 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:06:23.597975 #11095] DEBUG -- :   [1m[36mSetting Load (1.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:06:23.599378 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.5ms | ActiveRecord: 2.5ms)


D, [2018-09-12T23:06:23.602453 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:06:23.604913 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:06:23.615189 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:06:23 +0530
I, [2018-09-12T23:06:23.647685 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:06:23.647780 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:06:23.651130 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:06:23.652738 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:06:30.664735 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:06:30.666170 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 1.0ms | ActiveRecord: 2.4ms)


D, [2018-09-12T23:06:30.668879 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:06:30.671094 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:06:30.680491 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:06:30 +0530
I, [2018-09-12T23:06:30.709121 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:06:30.709207 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:06:30.711865 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:06:30.713480 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T23:06:33.364616 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 23:06:33 +0530
I, [2018-09-12T23:06:33.397871 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T23:06:33.397962 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T23:06:33.400411 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:06:33.401915 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:06:33.403301 #11095] DEBUG -- :   [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:06:33.404858 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:06:33.406197 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T23:06:33.406950 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:06:33.407445 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:06:33.408915 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:36:33.407000"], ["id", 1]]
D, [2018-09-12T23:06:33.411856 #11095] DEBUG -- :   [1m[35m (2.6ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:06:33.412954 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 09:36:33.412317')[0m
D, [2018-09-12T23:06:33.414284 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:06:33.414692 #11095]  INFO -- : Completed 200 OK in 17ms (Views: 0.1ms | ActiveRecord: 5.7ms)


D, [2018-09-12T23:06:33.415909 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:06:33.416675 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:06:33.716963 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T23:06:33.720530 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:06:33.721774 #11095]  INFO -- : Completed 200 OK in 3012ms (Views: 0.5ms | ActiveRecord: 2.1ms)


D, [2018-09-12T23:06:33.724174 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:06:33.726410 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:06:33.736349 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 23:06:33 +0530
I, [2018-09-12T23:06:33.745221 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:06:33 +0530
I, [2018-09-12T23:06:33.756206 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T23:06:33.757410 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:06:33.757536 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
I, [2018-09-12T23:06:33.757607 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:06:33.759991 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:06:33.761942 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:06:33.762816 #11095] DEBUG -- :   [1m[35m (1.0ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:06:33.763421 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:06:33.764418 #11095] DEBUG -- :   [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:06:33.765768 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:06:33.766909 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T23:06:33.767522 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:06:33.767864 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:06:33.768206 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:06:33.769465 #11095] DEBUG -- :   [1m[35mSQL (0.2ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:36:33.767000"], ["id", 1]]
D, [2018-09-12T23:06:33.770501 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:06:33.771572 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.2ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T23:06:33.772304 #11095] DEBUG -- :   [1m[36mChat Load (0.2ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T23:06:33.773835 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:34:33.773282')[0m  [["active", "t"]]
D, [2018-09-12T23:06:33.776074 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T23:06:33.777275 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T23:06:33.777890 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.2ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T23:06:33.778522 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T23:06:33.779299 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:34:33.778674')[0m  [["active", "t"]]
D, [2018-09-12T23:06:33.779947 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:34:33.779421')[0m  [["active", "t"]]
D, [2018-09-12T23:06:33.780676 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T23:06:33.781323 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:34:33.780809')[0m  [["active", "t"]]
D, [2018-09-12T23:06:33.781815 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:06:33.782534 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.2ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T23:06:33.785027 #11095] DEBUG -- :   [1m[36mSetting Load (0.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:06:33.785378 #11095]  INFO -- : Completed 200 OK in 28ms (Views: 0.1ms | ActiveRecord: 7.1ms)


D, [2018-09-12T23:06:33.786383 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:06:33.787746 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:06:34.766779 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T23:06:34.774615 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:06:34.776014 #11095]  INFO -- : Completed 200 OK in 1018ms (Views: 4.4ms | ActiveRecord: 2.6ms)


D, [2018-09-12T23:06:34.778732 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:06:34.780873 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:06:34.790569 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:06:34 +0530
I, [2018-09-12T23:06:34.820299 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:06:34.820409 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:06:34.823450 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:06:34.825443 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:06:41.836537 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:06:41.838012 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T23:06:41.840904 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:06:41.845199 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:06:41.856054 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:06:41 +0530
I, [2018-09-12T23:06:41.889233 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:06:41.889308 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:06:41.891543 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:06:41.893030 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:06:48.903053 #11095] DEBUG -- :   [1m[36mSetting Load (0.9ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:06:48.904027 #11095]  INFO -- : Completed 200 OK in 7014ms (Views: 0.6ms | ActiveRecord: 1.8ms)


D, [2018-09-12T23:06:48.906693 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:06:48.909685 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:06:48.914961 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:06:48 +0530
I, [2018-09-12T23:06:48.930343 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:06:48.930422 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:06:48.933027 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:06:48.934874 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:06:55.945545 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:06:55.946900 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.5ms | ActiveRecord: 2.0ms)


D, [2018-09-12T23:06:55.949552 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:06:55.950926 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:06:55.954923 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:06:55 +0530
I, [2018-09-12T23:06:55.968899 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:06:55.968982 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:06:55.971519 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:06:55.973609 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:07:02.983435 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:07:02.984740 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.4ms | ActiveRecord: 2.1ms)


D, [2018-09-12T23:07:02.987105 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:07:02.989007 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:07:02.998377 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:07:02 +0530
I, [2018-09-12T23:07:03.029711 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:07:03.029813 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:07:03.032897 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:07:03.034743 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:07:10.044135 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:07:10.046009 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.4ms | ActiveRecord: 2.1ms)


D, [2018-09-12T23:07:10.048517 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:07:10.050540 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:07:10.060144 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:07:10 +0530
I, [2018-09-12T23:07:10.088390 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:07:10.088512 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:07:10.091266 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:07:10.092928 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:07:17.101530 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:07:17.102701 #11095]  INFO -- : Completed 200 OK in 7014ms (Views: 0.4ms | ActiveRecord: 2.0ms)


D, [2018-09-12T23:07:17.105106 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:07:17.108617 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:07:17.117228 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:07:17 +0530
I, [2018-09-12T23:07:17.131755 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:07:17.131823 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:07:17.134273 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:07:17.135676 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:07:24.144692 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:07:24.145948 #11095]  INFO -- : Completed 200 OK in 7014ms (Views: 0.8ms | ActiveRecord: 1.9ms)


D, [2018-09-12T23:07:24.148637 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:07:24.151241 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:07:24.160244 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:07:24 +0530
I, [2018-09-12T23:07:24.173974 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:07:24.174033 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:07:24.176292 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:07:24.177847 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T23:07:28.363168 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 23:07:28 +0530
I, [2018-09-12T23:07:28.396282 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T23:07:28.396562 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T23:07:28.400882 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:07:28.403685 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:07:28.406044 #11095] DEBUG -- :   [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:07:28.409034 #11095] DEBUG -- :   [1m[35mCACHE  (0.1ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:07:28.411608 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T23:07:28.412997 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.5ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:07:28.414012 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:07:28.416543 #11095] DEBUG -- :   [1m[35mSQL (0.5ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:37:28.413000"], ["id", 1]]
D, [2018-09-12T23:07:28.418278 #11095] DEBUG -- :   [1m[35m (1.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:07:28.421373 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.7ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 09:37:28.419578')[0m
D, [2018-09-12T23:07:28.425585 #11095] DEBUG -- :   [1m[36mSetting Load (0.9ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:07:28.426801 #11095]  INFO -- : Completed 200 OK in 30ms (Views: 0.3ms | ActiveRecord: 7.2ms)


D, [2018-09-12T23:07:28.430318 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:07:28.432666 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:07:29.182775 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T23:07:29.186703 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:07:29.187993 #11095]  INFO -- : Completed 200 OK in 5014ms (Views: 0.6ms | ActiveRecord: 2.1ms)


D, [2018-09-12T23:07:29.190527 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:07:29.191928 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:07:29.195473 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 23:07:29 +0530
I, [2018-09-12T23:07:29.195887 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:07:29 +0530
I, [2018-09-12T23:07:29.215876 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T23:07:29.215949 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
I, [2018-09-12T23:07:29.219111 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
D, [2018-09-12T23:07:29.219253 #11095] DEBUG -- :   [1m[35m (1.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
I, [2018-09-12T23:07:29.219338 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:07:29.221586 #11095] DEBUG -- :   [1m[35m (1.4ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:07:29.222444 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:07:29.223293 #11095] DEBUG -- :   [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:07:29.224643 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:07:29.225759 #11095] DEBUG -- :   [1m[35m (2.4ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:07:29.226287 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T23:07:29.226882 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:07:29.227222 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:07:29.227577 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:07:29.228744 #11095] DEBUG -- :   [1m[35mSQL (0.2ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:37:29.227000"], ["id", 1]]
D, [2018-09-12T23:07:29.231542 #11095] DEBUG -- :   [1m[35m (2.5ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:07:29.232680 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.2ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T23:07:29.233423 #11095] DEBUG -- :   [1m[36mChat Load (0.2ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T23:07:29.234908 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:35:29.234392')[0m  [["active", "t"]]
D, [2018-09-12T23:07:29.236858 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.2ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T23:07:29.237461 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T23:07:29.237975 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.2ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T23:07:29.238622 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T23:07:29.239363 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:35:29.238771')[0m  [["active", "t"]]
D, [2018-09-12T23:07:29.240122 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:35:29.239541')[0m  [["active", "t"]]
D, [2018-09-12T23:07:29.240982 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T23:07:29.241663 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:35:29.241124')[0m  [["active", "t"]]
D, [2018-09-12T23:07:29.242169 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:07:29.243125 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T23:07:29.246263 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:07:29.246618 #11095]  INFO -- : Completed 200 OK in 31ms (Views: 0.1ms | ActiveRecord: 11.1ms)


D, [2018-09-12T23:07:29.247788 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:07:29.248508 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:07:30.231306 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T23:07:30.234494 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:07:30.234847 #11095]  INFO -- : Completed 200 OK in 1015ms (Views: 1.9ms | ActiveRecord: 3.7ms)


D, [2018-09-12T23:07:30.235679 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:07:30.236484 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:07:30.240231 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:07:30 +0530
I, [2018-09-12T23:07:30.251967 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:07:30.252031 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:07:30.254077 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:07:30.255417 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:07:37.265852 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:07:37.267265 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.4ms | ActiveRecord: 1.8ms)


D, [2018-09-12T23:07:37.270152 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:07:37.272575 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:07:37.280378 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:07:37 +0530
I, [2018-09-12T23:07:37.292778 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:07:37.292873 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:07:37.295192 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:07:37.296951 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:07:44.309432 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:07:44.311142 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.5ms | ActiveRecord: 2.0ms)


D, [2018-09-12T23:07:44.314201 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:07:44.316421 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:07:44.326796 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:07:44 +0530
I, [2018-09-12T23:07:44.348091 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:07:44.348178 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:07:44.350863 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:07:44.353779 #11095] DEBUG -- :   [1m[35m (1.2ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:07:51.364399 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:07:51.366185 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.7ms | ActiveRecord: 2.8ms)


D, [2018-09-12T23:07:51.370362 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:07:51.372841 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:07:51.382604 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:07:51 +0530
I, [2018-09-12T23:07:51.405606 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:07:51.405740 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:07:51.408035 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:07:51.409571 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:07:58.422051 #11095] DEBUG -- :   [1m[36mSetting Load (0.6ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:07:58.422588 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.8ms | ActiveRecord: 1.4ms)


D, [2018-09-12T23:07:58.423743 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:07:58.424563 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:07:58.428372 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:07:58 +0530
I, [2018-09-12T23:07:58.441110 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:07:58.441185 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:07:58.443585 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:07:58.445136 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:08:05.458425 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:08:05.459842 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.5ms | ActiveRecord: 2.1ms)


D, [2018-09-12T23:08:05.462638 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:08:05.464956 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:08:05.474722 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:08:05 +0530
I, [2018-09-12T23:08:05.504712 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:08:05.504813 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:08:05.507596 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:08:05.509489 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:08:12.523330 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:08:12.524610 #11095]  INFO -- : Completed 200 OK in 7020ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T23:08:12.525588 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:08:12.526394 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:08:12.530357 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:08:12 +0530
I, [2018-09-12T23:08:12.545363 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:08:12.545450 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:08:12.548290 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:08:12.550124 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:08:19.561695 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:08:19.563117 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.5ms | ActiveRecord: 2.3ms)


D, [2018-09-12T23:08:19.565954 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:08:19.569264 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:08:19.580087 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:08:19 +0530
I, [2018-09-12T23:08:19.595711 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:08:19.595794 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:08:19.598240 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:08:19.599840 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T23:08:23.365994 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 23:08:23 +0530
I, [2018-09-12T23:08:23.380225 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T23:08:23.380315 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T23:08:23.382678 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:08:23.384228 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:08:23.385579 #11095] DEBUG -- :   [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:08:23.387207 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:08:23.388722 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T23:08:23.389559 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:08:23.390116 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:08:23.391560 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:38:23.389000"], ["id", 1]]
D, [2018-09-12T23:08:23.392719 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:08:23.393877 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 09:38:23.393189')[0m
D, [2018-09-12T23:08:23.395662 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:08:23.396296 #11095]  INFO -- : Completed 200 OK in 16ms (Views: 0.1ms | ActiveRecord: 4.1ms)


D, [2018-09-12T23:08:23.398151 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:08:23.399029 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:08:24.607377 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T23:08:24.611366 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:08:24.612683 #11095]  INFO -- : Completed 200 OK in 5017ms (Views: 0.5ms | ActiveRecord: 2.1ms)


D, [2018-09-12T23:08:24.615413 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:08:24.617711 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:08:24.627842 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 23:08:24 +0530
I, [2018-09-12T23:08:24.653230 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:08:24 +0530
I, [2018-09-12T23:08:24.667371 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T23:08:24.667576 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
I, [2018-09-12T23:08:24.671550 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:08:24.671629 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:08:24.673385 #11095] DEBUG -- :   [1m[35m (3.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:08:24.674447 #11095] DEBUG -- :   [1m[35m (1.2ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:08:24.675396 #11095] DEBUG -- :   [1m[35m (1.1ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:08:24.676414 #11095] DEBUG -- :   [1m[35m (1.1ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:08:24.676993 #11095] DEBUG -- :   [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:08:24.678466 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:08:24.679763 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T23:08:24.680405 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:08:24.680751 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:08:24.681086 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:08:24.682257 #11095] DEBUG -- :   [1m[35mSQL (0.2ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:38:24.680000"], ["id", 1]]
D, [2018-09-12T23:08:24.685318 #11095] DEBUG -- :   [1m[35m (2.7ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:08:24.686972 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.4ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T23:08:24.687799 #11095] DEBUG -- :   [1m[36mChat Load (0.2ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T23:08:24.689551 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:36:24.688949')[0m  [["active", "t"]]
D, [2018-09-12T23:08:24.691751 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.2ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T23:08:24.692414 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T23:08:24.692935 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.2ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T23:08:24.693555 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T23:08:24.694324 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:36:24.693716')[0m  [["active", "t"]]
D, [2018-09-12T23:08:24.694985 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:36:24.694461')[0m  [["active", "t"]]
D, [2018-09-12T23:08:24.695765 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T23:08:24.696516 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:36:24.695929')[0m  [["active", "t"]]
D, [2018-09-12T23:08:24.697061 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:08:24.697899 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.2ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T23:08:24.701246 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:08:24.701688 #11095]  INFO -- : Completed 200 OK in 34ms (Views: 0.2ms | ActiveRecord: 11.9ms)


D, [2018-09-12T23:08:24.702813 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:08:24.703543 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:08:25.682561 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T23:08:25.695264 #11095] DEBUG -- :   [1m[36mSetting Load (0.6ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:08:25.695791 #11095]  INFO -- : Completed 200 OK in 1024ms (Views: 11.0ms | ActiveRecord: 2.8ms)


D, [2018-09-12T23:08:25.696884 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:08:25.697797 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:08:25.702308 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:08:25 +0530
I, [2018-09-12T23:08:25.716688 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:08:25.716794 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:08:25.719099 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:08:25.720624 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:08:32.732401 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:08:32.733740 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.5ms | ActiveRecord: 2.0ms)


D, [2018-09-12T23:08:32.736330 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:08:32.738408 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:08:32.748495 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:08:32 +0530
I, [2018-09-12T23:08:32.776075 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:08:32.776168 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:08:32.778840 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:08:32.780568 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:08:39.793445 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:08:39.794791 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.5ms | ActiveRecord: 2.3ms)


D, [2018-09-12T23:08:39.797517 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:08:39.800025 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:08:39.810703 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:08:39 +0530
I, [2018-09-12T23:08:39.839631 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:08:39.839738 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:08:39.842573 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:08:39.844356 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:08:46.856556 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:08:46.857996 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T23:08:46.860764 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:08:46.861892 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:08:46.865610 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:08:46 +0530
I, [2018-09-12T23:08:46.879076 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:08:46.879149 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:08:46.881557 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:08:46.883386 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:08:53.895006 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:08:53.896437 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.6ms | ActiveRecord: 2.2ms)


D, [2018-09-12T23:08:53.899155 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:08:53.900325 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:08:53.904680 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:08:53 +0530
I, [2018-09-12T23:08:53.921665 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:08:53.921767 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:08:53.925309 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:08:53.927984 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:09:00.939752 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:09:00.941072 #11095]  INFO -- : Completed 200 OK in 7019ms (Views: 0.4ms | ActiveRecord: 2.5ms)


D, [2018-09-12T23:09:00.943717 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:09:00.945104 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:09:00.948714 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:09:00 +0530
I, [2018-09-12T23:09:00.962520 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:09:00.962598 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:09:00.965081 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:09:00.966707 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:09:07.978445 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:09:07.979881 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.5ms | ActiveRecord: 2.1ms)


D, [2018-09-12T23:09:07.982553 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:09:07.983709 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:09:07.987660 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:09:07 +0530
I, [2018-09-12T23:09:08.002248 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:09:08.002335 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:09:08.005047 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:09:08.006819 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:09:15.016001 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:09:15.017233 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.5ms | ActiveRecord: 2.0ms)


D, [2018-09-12T23:09:15.019595 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:09:15.021333 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:09:15.029995 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:09:15 +0530
I, [2018-09-12T23:09:15.060929 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:09:15.061066 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:09:15.064376 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:09:15.066451 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T23:09:18.360563 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 23:09:18 +0530
I, [2018-09-12T23:09:18.378502 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T23:09:18.378603 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T23:09:18.381767 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:09:18.384210 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:09:18.385855 #11095] DEBUG -- :   [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:09:18.387755 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:09:18.389271 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T23:09:18.390154 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:09:18.390767 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:09:18.392977 #11095] DEBUG -- :   [1m[35mSQL (0.6ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:39:18.390000"], ["id", 1]]
D, [2018-09-12T23:09:18.395549 #11095] DEBUG -- :   [1m[35m (1.4ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:09:18.397247 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.5ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 09:39:18.396151')[0m
D, [2018-09-12T23:09:18.399438 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:09:18.400087 #11095]  INFO -- : Completed 200 OK in 21ms (Views: 0.2ms | ActiveRecord: 5.9ms)


D, [2018-09-12T23:09:18.401890 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:09:18.402749 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:09:20.073471 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T23:09:20.077544 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:09:20.078808 #11095]  INFO -- : Completed 200 OK in 5017ms (Views: 0.6ms | ActiveRecord: 2.4ms)


D, [2018-09-12T23:09:20.081516 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:09:20.083646 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:09:20.092338 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 23:09:20 +0530
I, [2018-09-12T23:09:20.103157 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:09:20 +0530
I, [2018-09-12T23:09:20.115968 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T23:09:20.117739 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:09:20.117844 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
I, [2018-09-12T23:09:20.118084 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:09:20.121491 #11095] DEBUG -- :   [1m[35m (1.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:09:20.122525 #11095] DEBUG -- :   [1m[35m (1.1ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:09:20.123482 #11095] DEBUG -- :   [1m[35m (1.0ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:09:20.124500 #11095] DEBUG -- :   [1m[35m (1.1ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:09:20.125033 #11095] DEBUG -- :   [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:09:20.126577 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:09:20.127940 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T23:09:20.128711 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:09:20.129092 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:09:20.129562 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:09:20.130939 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:39:20.129000"], ["id", 1]]
D, [2018-09-12T23:09:20.138064 #11095] DEBUG -- :   [1m[35m (6.8ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:09:20.139629 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.4ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T23:09:20.140552 #11095] DEBUG -- :   [1m[36mChat Load (0.3ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T23:09:20.142402 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:37:20.141720')[0m  [["active", "t"]]
D, [2018-09-12T23:09:20.144697 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T23:09:20.145462 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T23:09:20.146118 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T23:09:20.146850 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T23:09:20.147722 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:37:20.147008')[0m  [["active", "t"]]
D, [2018-09-12T23:09:20.148487 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:37:20.147874')[0m  [["active", "t"]]
D, [2018-09-12T23:09:20.149385 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T23:09:20.150208 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:37:20.149543')[0m  [["active", "t"]]
D, [2018-09-12T23:09:20.150791 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:09:20.151616 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T23:09:20.154055 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:09:20.154434 #11095]  INFO -- : Completed 200 OK in 36ms (Views: 0.1ms | ActiveRecord: 15.0ms)


D, [2018-09-12T23:09:20.155684 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:09:20.156470 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:09:21.127215 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T23:09:21.129210 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:09:21.129547 #11095]  INFO -- : Completed 200 OK in 1011ms (Views: 0.9ms | ActiveRecord: 2.6ms)


D, [2018-09-12T23:09:21.130233 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:09:21.130873 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:09:21.134474 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:09:21 +0530
I, [2018-09-12T23:09:21.145599 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:09:21.145658 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:09:21.147581 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:09:21.148830 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:09:28.161013 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:09:28.162178 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.4ms | ActiveRecord: 1.9ms)


D, [2018-09-12T23:09:28.164776 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:09:28.166783 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:09:28.177347 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:09:28 +0530
I, [2018-09-12T23:09:28.205565 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:09:28.205668 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:09:28.208427 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:09:28.210104 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:09:35.222721 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:09:35.224094 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.4ms | ActiveRecord: 2.1ms)


D, [2018-09-12T23:09:35.226839 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:09:35.229650 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:09:35.239375 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:09:35 +0530
I, [2018-09-12T23:09:35.254104 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:09:35.254174 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:09:35.257017 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:09:35.258540 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:09:42.270083 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:09:42.271533 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T23:09:42.274378 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:09:42.277106 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:09:42.287007 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:09:42 +0530
I, [2018-09-12T23:09:42.315986 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:09:42.316096 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:09:42.318677 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:09:42.320293 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:09:49.332342 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:09:49.333721 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T23:09:49.336469 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:09:49.338736 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:09:49.348552 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:09:49 +0530
I, [2018-09-12T23:09:49.379100 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:09:49.379210 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:09:49.381998 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:09:49.383721 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:09:56.394429 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:09:56.395824 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.5ms | ActiveRecord: 2.0ms)


D, [2018-09-12T23:09:56.398401 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:09:56.401761 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:09:56.411125 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:09:56 +0530
I, [2018-09-12T23:09:56.437252 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:09:56.437386 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:09:56.439999 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:09:56.441535 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:09:56.442608 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:09:56.443866 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[32mINSERT INTO "delayed_jobs" ("handler", "run_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["handler", "--- !ruby/object:Observer::UserDeviceLogJob\nhttp_user_agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko)\n  Chrome/68.0.3440.106 Safari/537.36\nremote_ip: \"::1\"\nuser_id: 3\nfingerprint: \"-1992429858\"\ntype: session\n"], ["run_at", "2018-09-12 17:39:56.442739"], ["created_at", "2018-09-12 17:39:56.442000"], ["updated_at", "2018-09-12 17:39:56.442000"]]
D, [2018-09-12T23:09:56.445122 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:10:03.456354 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:10:03.457757 #11095]  INFO -- : Completed 200 OK in 7020ms (Views: 0.4ms | ActiveRecord: 3.5ms)


D, [2018-09-12T23:10:03.462594 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:10:03.468064 #11095] DEBUG -- :   [1m[35mSQL (0.9ms)[0m  [1m[33mUPDATE "sessions" SET "data" = $1, "updated_at" = $2 WHERE "sessions"."id" = $3[0m  [["data", "BAh7D0kiCXBpbmcGOgZFRkkiGTIwMTgtMDktMTJUMTY6MDk6MjZaBjsAVEki\nD3VzZXJfYWdlbnQGOwBGIm5Nb3ppbGxhLzUuMCAoWDExOyBMaW51eCB4ODZf\nNjQpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENo\ncm9tZS82OC4wLjM0NDAuMTA2IFNhZmFyaS81MzcuMzZJIhBfY3NyZl90b2tl\nbgY7AEZJIjE1SzlmTEZWTnRwVFYydjArWGQ1M21QMjFWbDAzT1RSeEp2cUpm\nbitDRDUwPQY7AEZJIgx1c2VyX2lkBjsARmkISSIadXNlcl9kZXZpY2VfcmVt\nb3RlX2lwBjsARiIIOjoxSSIcdXNlcl9kZXZpY2VfZmluZ2VycHJpbnQGOwBG\nSSIQLTE5OTI0Mjk4NTgGOwBUSSIbdXNlcl9kZXZpY2VfdXBkYXRlZF9hdAY7\nAEZVOiBBY3RpdmVTdXBwb3J0OjpUaW1lV2l0aFpvbmVbCEl1OglUaW1lDZGh\nHcDTvYafCToJem9uZUkiCFVUQwY7AEY6DW5hbm9fbnVtaQIMAjoNbmFub19k\nZW5pBjoNc3VibWljcm8iB1JASSIIVVRDBjsAVEAWSSIPcGVyc2lzdGVudAY7\nAEZUSSIOcmVtb3RlX2lwBjsARiIIOjoxSSIIZ2VvBjsARnsA\n"], ["updated_at", "2018-09-12 17:40:03.464537"], ["id", 33]]
D, [2018-09-12T23:10:03.472461 #11095] DEBUG -- :   [1m[35m (3.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:10:03.482087 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:10:03 +0530
I, [2018-09-12T23:10:03.510140 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:10:03.510215 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:10:03.512599 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:10:03.514127 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:10:10.526699 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:10:10.528157 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.5ms | ActiveRecord: 2.1ms)


D, [2018-09-12T23:10:10.530971 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:10:10.532145 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:10:10.536275 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:10:10 +0530
I, [2018-09-12T23:10:10.552192 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:10:10.552286 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:10:10.555308 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:10:10.557345 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T23:10:13.364567 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 23:10:13 +0530
I, [2018-09-12T23:10:13.400420 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T23:10:13.400562 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T23:10:13.403556 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:10:13.405571 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:10:13.406918 #11095] DEBUG -- :   [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:10:13.408608 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:10:13.410094 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T23:10:13.410920 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:10:13.411461 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:10:13.412969 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:40:13.411000"], ["id", 1]]
D, [2018-09-12T23:10:13.414205 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:10:13.415316 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 09:40:13.414677')[0m
D, [2018-09-12T23:10:13.416724 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:10:13.417141 #11095]  INFO -- : Completed 200 OK in 16ms (Views: 0.1ms | ActiveRecord: 4.3ms)


D, [2018-09-12T23:10:13.418363 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:10:13.419135 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:10:13.561983 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T23:10:13.565929 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:10:13.567297 #11095]  INFO -- : Completed 200 OK in 3015ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T23:10:13.570145 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:10:13.572501 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:10:13.582695 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 23:10:13 +0530
I, [2018-09-12T23:10:13.614834 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:10:13 +0530
I, [2018-09-12T23:10:13.637533 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T23:10:13.637713 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
I, [2018-09-12T23:10:13.657784 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
D, [2018-09-12T23:10:13.658161 #11095] DEBUG -- :   [1m[35m (3.2ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
I, [2018-09-12T23:10:13.659465 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:10:13.662336 #11095] DEBUG -- :   [1m[35m (2.8ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:10:13.663579 #11095] DEBUG -- :   [1m[35m (1.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:10:13.664767 #11095] DEBUG -- :   [1m[36mUser Load (1.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:10:13.666878 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:10:13.668138 #11095] DEBUG -- :   [1m[35m (3.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:10:13.668857 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T23:10:13.669732 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:10:13.670494 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:10:13.671420 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:10:13.674237 #11095] DEBUG -- :   [1m[35mSQL (0.4ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:40:13.670000"], ["id", 1]]
D, [2018-09-12T23:10:13.677192 #11095] DEBUG -- :   [1m[35m (2.6ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:10:13.678576 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.4ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T23:10:13.679463 #11095] DEBUG -- :   [1m[36mChat Load (0.3ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T23:10:13.681429 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:38:13.680652')[0m  [["active", "t"]]
D, [2018-09-12T23:10:13.685198 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.4ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T23:10:13.687206 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T23:10:13.688821 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.6ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T23:10:13.690049 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T23:10:13.691104 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:38:13.690291')[0m  [["active", "t"]]
D, [2018-09-12T23:10:13.691944 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:38:13.691267')[0m  [["active", "t"]]
D, [2018-09-12T23:10:13.692924 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T23:10:13.693787 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:38:13.693108')[0m  [["active", "t"]]
D, [2018-09-12T23:10:13.694437 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:10:13.695644 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.5ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T23:10:13.699009 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:10:13.699648 #11095]  INFO -- : Completed 200 OK in 62ms (Views: 0.2ms | ActiveRecord: 17.2ms)


D, [2018-09-12T23:10:13.701394 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:10:13.702368 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:10:14.675429 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T23:10:14.682727 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:10:14.684110 #11095]  INFO -- : Completed 200 OK in 1024ms (Views: 3.7ms | ActiveRecord: 6.0ms)


D, [2018-09-12T23:10:14.686880 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:10:14.689228 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:10:14.702702 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:10:14 +0530
I, [2018-09-12T23:10:14.726172 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:10:14.726242 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:10:14.728728 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:10:14.730260 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:10:21.741846 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:10:21.743379 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.8ms | ActiveRecord: 2.0ms)


D, [2018-09-12T23:10:21.746454 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:10:21.748804 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:10:21.760441 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:10:21 +0530
I, [2018-09-12T23:10:21.788915 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:10:21.789055 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:10:21.792386 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:10:21.793880 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:10:28.804068 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:10:28.805441 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.5ms | ActiveRecord: 2.1ms)


D, [2018-09-12T23:10:28.808209 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:10:28.810618 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:10:28.821101 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:10:28 +0530
I, [2018-09-12T23:10:28.850585 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:10:28.850696 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:10:28.854560 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:10:28.856210 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:10:35.866081 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:10:35.866585 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.2ms | ActiveRecord: 1.4ms)


D, [2018-09-12T23:10:35.867483 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:10:35.868627 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:10:35.874600 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:10:35 +0530
I, [2018-09-12T23:10:35.892633 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:10:35.892741 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:10:35.896571 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:10:35.899684 #11095] DEBUG -- :   [1m[35m (1.2ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:10:42.907373 #11095] DEBUG -- :   [1m[36mSetting Load (0.6ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:10:42.908273 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.3ms | ActiveRecord: 2.6ms)


D, [2018-09-12T23:10:42.910268 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:10:42.912740 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:10:42.918989 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:10:42 +0530
I, [2018-09-12T23:10:42.934484 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:10:42.934640 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:10:42.941899 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:10:42.944489 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:10:49.955904 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:10:49.957141 #11095]  INFO -- : Completed 200 OK in 7022ms (Views: 0.5ms | ActiveRecord: 2.5ms)


D, [2018-09-12T23:10:49.959561 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:10:49.961688 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:10:49.970290 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:10:49 +0530
I, [2018-09-12T23:10:50.002384 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:10:50.002557 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:10:50.006067 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:10:50.008178 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:10:57.018507 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:10:57.019793 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T23:10:57.022258 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:10:57.024303 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:10:57.032881 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:10:57 +0530
I, [2018-09-12T23:10:57.061662 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:10:57.061781 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:10:57.064895 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:10:57.066621 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:11:04.076320 #11095] DEBUG -- :   [1m[36mSetting Load (0.7ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:11:04.077174 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.7ms | ActiveRecord: 1.8ms)


D, [2018-09-12T23:11:04.078553 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:11:04.079602 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:11:04.086665 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:11:04 +0530
I, [2018-09-12T23:11:04.103619 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:11:04.103721 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:11:04.106355 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:11:04.108104 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T23:11:08.365503 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 23:11:08 +0530
I, [2018-09-12T23:11:08.395463 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T23:11:08.395579 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T23:11:08.398861 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:11:08.400669 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:11:08.401974 #11095] DEBUG -- :   [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:11:08.403649 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:11:08.405182 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T23:11:08.405935 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:11:08.406468 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:11:08.407885 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:41:08.406000"], ["id", 1]]
D, [2018-09-12T23:11:08.409091 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:11:08.410317 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 09:41:08.409567')[0m
D, [2018-09-12T23:11:08.411765 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:11:08.412188 #11095]  INFO -- : Completed 200 OK in 16ms (Views: 0.1ms | ActiveRecord: 4.2ms)


D, [2018-09-12T23:11:08.413407 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:11:08.414114 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:11:09.112417 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T23:11:09.113884 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:11:09.114382 #11095]  INFO -- : Completed 200 OK in 5010ms (Views: 0.2ms | ActiveRecord: 1.3ms)


D, [2018-09-12T23:11:09.115531 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:11:09.118570 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:11:09.123935 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 23:11:09 +0530
I, [2018-09-12T23:11:09.144131 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:11:09 +0530
I, [2018-09-12T23:11:09.162865 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T23:11:09.163279 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
I, [2018-09-12T23:11:09.167738 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:11:09.171006 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:11:09.174958 #11095] DEBUG -- :   [1m[35m (3.8ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:11:09.177281 #11095] DEBUG -- :   [1m[35m (2.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:11:09.178590 #11095] DEBUG -- :   [1m[35m (1.4ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:11:09.179782 #11095] DEBUG -- :   [1m[35m (1.3ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:11:09.180462 #11095] DEBUG -- :   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:11:09.182897 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:11:09.185514 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T23:11:09.186683 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:11:09.187564 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:11:09.188152 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:11:09.191002 #11095] DEBUG -- :   [1m[35mSQL (0.5ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:41:09.187000"], ["id", 1]]
D, [2018-09-12T23:11:09.192962 #11095] DEBUG -- :   [1m[35m (1.0ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:11:09.195081 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.4ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T23:11:09.196143 #11095] DEBUG -- :   [1m[36mChat Load (0.2ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T23:11:09.198229 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:39:09.197423')[0m  [["active", "t"]]
D, [2018-09-12T23:11:09.203954 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.5ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T23:11:09.206179 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T23:11:09.207708 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.5ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T23:11:09.209447 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T23:11:09.210621 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:39:09.209731')[0m  [["active", "t"]]
D, [2018-09-12T23:11:09.211456 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:39:09.210811')[0m  [["active", "t"]]
D, [2018-09-12T23:11:09.212529 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T23:11:09.213413 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:39:09.212722')[0m  [["active", "t"]]
D, [2018-09-12T23:11:09.214059 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:11:09.215332 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.4ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T23:11:09.222140 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:11:09.222950 #11095]  INFO -- : Completed 200 OK in 59ms (Views: 0.2ms | ActiveRecord: 14.4ms)


D, [2018-09-12T23:11:09.225458 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:11:09.226368 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:11:10.184601 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T23:11:10.192061 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:11:10.193375 #11095]  INFO -- : Completed 200 OK in 1022ms (Views: 3.9ms | ActiveRecord: 5.0ms)


D, [2018-09-12T23:11:10.196027 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:11:10.198684 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:11:10.209194 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:11:10 +0530
I, [2018-09-12T23:11:10.236391 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:11:10.236478 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:11:10.238984 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:11:10.240736 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:11:17.252522 #11095] DEBUG -- :   [1m[36mSetting Load (1.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:11:17.253801 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.5ms | ActiveRecord: 2.4ms)


D, [2018-09-12T23:11:17.256774 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:11:17.258827 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:11:17.270186 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:11:17 +0530
I, [2018-09-12T23:11:17.293226 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:11:17.293317 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:11:17.295825 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:11:17.297683 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:11:24.307422 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:11:24.308828 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.5ms | ActiveRecord: 2.1ms)


D, [2018-09-12T23:11:24.311160 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:11:24.313054 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:11:24.322519 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:11:24 +0530
I, [2018-09-12T23:11:24.351767 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:11:24.351851 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:11:24.354362 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:11:24.356058 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:11:31.369684 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:11:31.370239 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.3ms | ActiveRecord: 1.4ms)


D, [2018-09-12T23:11:31.371325 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:11:31.372177 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:11:31.375378 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:11:31 +0530
I, [2018-09-12T23:11:31.385519 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:11:31.385577 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:11:31.387407 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:11:31.388608 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:11:38.398010 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:11:38.399444 #11095]  INFO -- : Completed 200 OK in 7014ms (Views: 0.4ms | ActiveRecord: 1.8ms)


D, [2018-09-12T23:11:38.401809 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:11:38.403667 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:11:38.411897 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:11:38 +0530
I, [2018-09-12T23:11:38.436732 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:11:38.436837 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:11:38.439766 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:11:38.441419 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:11:45.450260 #11095] DEBUG -- :   [1m[36mSetting Load (0.8ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:11:45.451141 #11095]  INFO -- : Completed 200 OK in 7014ms (Views: 0.3ms | ActiveRecord: 1.9ms)


D, [2018-09-12T23:11:45.452943 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:11:45.454679 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:11:45.463787 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:11:45 +0530
I, [2018-09-12T23:11:45.498280 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:11:45.498501 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:11:45.502131 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:11:45.504392 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:11:52.515691 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:11:52.517270 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.7ms | ActiveRecord: 2.6ms)


D, [2018-09-12T23:11:52.519906 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:11:52.521991 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:11:52.531279 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:11:52 +0530
I, [2018-09-12T23:11:52.547750 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:11:52.547828 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:11:52.550253 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:11:52.551823 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:11:59.562543 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:11:59.563856 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.4ms | ActiveRecord: 2.0ms)


D, [2018-09-12T23:11:59.566450 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:11:59.567876 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:11:59.571171 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:11:59 +0530
I, [2018-09-12T23:11:59.583751 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:11:59.583834 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:11:59.585916 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:11:59.587251 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T23:12:03.371411 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 23:12:03 +0530
I, [2018-09-12T23:12:03.383611 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T23:12:03.383685 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T23:12:03.385938 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:12:03.387383 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:12:03.388668 #11095] DEBUG -- :   [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:12:03.390108 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:12:03.391387 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T23:12:03.392135 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:12:03.392657 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:12:03.394089 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:42:03.392000"], ["id", 1]]
D, [2018-09-12T23:12:03.397213 #11095] DEBUG -- :   [1m[35m (2.8ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:12:03.398377 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 09:42:03.397698')[0m
D, [2018-09-12T23:12:03.407764 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:12:03.408226 #11095]  INFO -- : Completed 200 OK in 24ms (Views: 7.7ms | ActiveRecord: 6.0ms)


D, [2018-09-12T23:12:03.409513 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:12:03.410330 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:12:04.593419 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T23:12:04.597231 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:12:04.598037 #11095]  INFO -- : Completed 200 OK in 5014ms (Views: 0.3ms | ActiveRecord: 1.8ms)


D, [2018-09-12T23:12:04.599469 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:12:04.600636 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:12:04.606738 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:12:04 +0530
I, [2018-09-12T23:12:04.619172 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 23:12:04 +0530
I, [2018-09-12T23:12:04.633143 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:12:04.633243 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
I, [2018-09-12T23:12:04.637077 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T23:12:04.637168 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
D, [2018-09-12T23:12:04.638885 #11095] DEBUG -- :   [1m[35m (3.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:12:04.640086 #11095] DEBUG -- :   [1m[35m (1.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:12:04.641152 #11095] DEBUG -- :   [1m[35m (1.1ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:12:04.641927 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:12:04.643154 #11095] DEBUG -- :   [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:12:04.645175 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:12:04.647629 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T23:12:04.648520 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:12:04.648988 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:12:04.649475 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:12:04.650920 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:42:04.649000"], ["id", 1]]
D, [2018-09-12T23:12:04.654448 #11095] DEBUG -- :   [1m[35m (2.9ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:12:04.659349 #11095] DEBUG -- :   [1m[36mChat::Session Load (1.1ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T23:12:04.662807 #11095] DEBUG -- :   [1m[36mChat Load (0.9ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T23:12:04.667349 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.6ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:40:04.665756')[0m  [["active", "t"]]
D, [2018-09-12T23:12:04.672634 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.6ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T23:12:04.674336 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T23:12:04.675158 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T23:12:04.676035 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T23:12:04.677219 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:40:04.676248')[0m  [["active", "t"]]
D, [2018-09-12T23:12:04.678953 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.7ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:40:04.677430')[0m  [["active", "t"]]
D, [2018-09-12T23:12:04.681175 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T23:12:04.682427 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:40:04.681472')[0m  [["active", "t"]]
D, [2018-09-12T23:12:04.683129 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:12:04.684200 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T23:12:04.687657 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:12:04.688129 #11095]  INFO -- : Completed 200 OK in 51ms (Views: 0.2ms | ActiveRecord: 13.8ms)


D, [2018-09-12T23:12:04.689450 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:12:04.690334 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:12:05.646423 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T23:12:05.654614 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:12:05.656316 #11095]  INFO -- : Completed 200 OK in 1022ms (Views: 3.8ms | ActiveRecord: 5.5ms)


D, [2018-09-12T23:12:05.659463 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:12:05.663292 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:12:05.674669 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:12:05 +0530
I, [2018-09-12T23:12:05.705223 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:12:05.705325 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:12:05.708315 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:12:05.710201 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:12:12.720920 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:12:12.722181 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.4ms | ActiveRecord: 2.2ms)


D, [2018-09-12T23:12:12.724674 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:12:12.726712 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:12:12.736316 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:12:12 +0530
I, [2018-09-12T23:12:12.768557 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:12:12.768712 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:12:12.771837 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:12:12.773908 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:12:19.783741 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:12:19.784933 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.4ms | ActiveRecord: 2.4ms)


D, [2018-09-12T23:12:19.787414 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:12:19.789453 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:12:19.798747 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:12:19 +0530
I, [2018-09-12T23:12:19.825484 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:12:19.825590 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:12:19.828176 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:12:19.829785 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:12:26.836960 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:12:26.837435 #11095]  INFO -- : Completed 200 OK in 7012ms (Views: 0.2ms | ActiveRecord: 1.4ms)


D, [2018-09-12T23:12:26.838411 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:12:26.839140 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:12:26.842402 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:12:26 +0530
I, [2018-09-12T23:12:26.853944 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:12:26.854002 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:12:26.856115 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:12:26.857606 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:12:33.872382 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:12:33.873604 #11095]  INFO -- : Completed 200 OK in 7019ms (Views: 0.5ms | ActiveRecord: 1.9ms)


D, [2018-09-12T23:12:33.876595 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:12:33.878638 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:12:33.888628 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:12:33 +0530
I, [2018-09-12T23:12:33.916646 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:12:33.916726 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:12:33.919426 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:12:33.920878 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:12:40.931376 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:12:40.932823 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.8ms | ActiveRecord: 1.9ms)


D, [2018-09-12T23:12:40.935647 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:12:40.938086 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:12:40.949725 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:12:40 +0530
I, [2018-09-12T23:12:40.979282 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:12:40.979357 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:12:40.981986 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:12:40.984063 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:12:47.993687 #11095] DEBUG -- :   [1m[36mSetting Load (0.9ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:12:47.994521 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.4ms | ActiveRecord: 2.0ms)


D, [2018-09-12T23:12:47.995918 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:12:47.996962 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:12:48.001454 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:12:48 +0530
I, [2018-09-12T23:12:48.016877 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:12:48.016966 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:12:48.019734 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:12:48.021272 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:12:55.030967 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:12:55.032238 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.5ms | ActiveRecord: 2.0ms)


D, [2018-09-12T23:12:55.034657 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:12:55.038214 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:12:55.048053 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:12:55 +0530
I, [2018-09-12T23:12:55.075173 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:12:55.075276 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:12:55.077778 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:12:55.079424 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T23:12:58.364179 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 23:12:58 +0530
I, [2018-09-12T23:12:58.395947 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T23:12:58.396176 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T23:12:58.399742 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:12:58.401512 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:12:58.403048 #11095] DEBUG -- :   [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:12:58.404839 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:12:58.406330 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T23:12:58.407158 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:12:58.407750 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:12:58.409149 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:42:58.407000"], ["id", 1]]
D, [2018-09-12T23:12:58.410381 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:12:58.411375 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 09:42:58.410799')[0m
D, [2018-09-12T23:12:58.412647 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:12:58.413014 #11095]  INFO -- : Completed 200 OK in 17ms (Views: 0.1ms | ActiveRecord: 4.5ms)


D, [2018-09-12T23:12:58.414178 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:12:58.414847 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:13:00.085328 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T23:13:00.088893 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:13:00.090056 #11095]  INFO -- : Completed 200 OK in 5014ms (Views: 0.5ms | ActiveRecord: 1.9ms)


D, [2018-09-12T23:13:00.092480 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:13:00.094479 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:13:00.104280 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 23:13:00 +0530
I, [2018-09-12T23:13:00.129003 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:13:00 +0530
I, [2018-09-12T23:13:00.144611 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T23:13:00.146288 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:13:00.146353 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
I, [2018-09-12T23:13:00.146452 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:13:00.150056 #11095] DEBUG -- :   [1m[35m (1.2ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:13:00.151098 #11095] DEBUG -- :   [1m[35m (1.2ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:13:00.152024 #11095] DEBUG -- :   [1m[35m (1.0ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:13:00.152947 #11095] DEBUG -- :   [1m[35m (1.0ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:13:00.153507 #11095] DEBUG -- :   [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:13:00.154875 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:13:00.156038 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T23:13:00.156620 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:13:00.156974 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:13:00.157293 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:13:00.158491 #11095] DEBUG -- :   [1m[35mSQL (0.2ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:43:00.157000"], ["id", 1]]
D, [2018-09-12T23:13:00.161431 #11095] DEBUG -- :   [1m[35m (2.7ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:13:00.162433 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.2ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T23:13:00.163098 #11095] DEBUG -- :   [1m[36mChat Load (0.2ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T23:13:00.164533 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:41:00.164038')[0m  [["active", "t"]]
D, [2018-09-12T23:13:00.166377 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.2ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T23:13:00.166948 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T23:13:00.167392 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.2ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T23:13:00.167924 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T23:13:00.168583 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:41:00.168052')[0m  [["active", "t"]]
D, [2018-09-12T23:13:00.169147 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:41:00.168694')[0m  [["active", "t"]]
D, [2018-09-12T23:13:00.169788 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T23:13:00.170390 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:41:00.169914')[0m  [["active", "t"]]
D, [2018-09-12T23:13:00.170828 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:13:00.171495 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.2ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T23:13:00.173848 #11095] DEBUG -- :   [1m[36mSetting Load (0.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:13:00.174179 #11095]  INFO -- : Completed 200 OK in 28ms (Views: 0.1ms | ActiveRecord: 8.7ms)


D, [2018-09-12T23:13:00.175152 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:13:00.175857 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:13:01.159354 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T23:13:01.166326 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:13:01.167598 #11095]  INFO -- : Completed 200 OK in 1021ms (Views: 3.6ms | ActiveRecord: 3.2ms)


D, [2018-09-12T23:13:01.170291 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:13:01.172955 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:13:01.184122 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:13:01 +0530
I, [2018-09-12T23:13:01.205084 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:13:01.205182 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:13:01.207548 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:13:01.209231 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:13:08.219106 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:13:08.220353 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.4ms | ActiveRecord: 2.2ms)


D, [2018-09-12T23:13:08.222820 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:13:08.224870 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:13:08.233862 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:13:08 +0530
I, [2018-09-12T23:13:08.265496 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:13:08.265612 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:13:08.268663 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:13:08.270514 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:13:15.280895 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:13:15.282143 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.4ms | ActiveRecord: 2.5ms)


D, [2018-09-12T23:13:15.284909 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:13:15.287248 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:13:15.298835 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:13:15 +0530
I, [2018-09-12T23:13:15.327346 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:13:15.327430 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:13:15.330069 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:13:15.331651 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:13:22.340825 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:13:22.342085 #11095]  INFO -- : Completed 200 OK in 7014ms (Views: 0.5ms | ActiveRecord: 2.0ms)


D, [2018-09-12T23:13:22.344685 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:13:22.346716 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:13:22.355442 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:13:22 +0530
I, [2018-09-12T23:13:22.376150 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:13:22.376247 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:13:22.378639 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:13:22.380141 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:13:29.391550 #11095] DEBUG -- :   [1m[36mSetting Load (2.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:13:29.393047 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.4ms | ActiveRecord: 2.9ms)


D, [2018-09-12T23:13:29.396261 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:13:29.398514 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:13:29.408661 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:13:29 +0530
I, [2018-09-12T23:13:29.444384 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:13:29.444489 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:13:29.447900 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:13:29.449694 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:13:36.460306 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:13:36.461729 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.5ms | ActiveRecord: 2.4ms)


D, [2018-09-12T23:13:36.464553 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:13:36.466725 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:13:36.476494 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:13:36 +0530
I, [2018-09-12T23:13:36.506911 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:13:36.507024 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:13:36.509885 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:13:36.511556 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:13:43.523482 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:13:43.524900 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.5ms | ActiveRecord: 2.3ms)


D, [2018-09-12T23:13:43.527677 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:13:43.530122 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:13:43.539705 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:13:43 +0530
I, [2018-09-12T23:13:43.569963 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:13:43.570063 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:13:43.572747 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:13:43.574500 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:13:50.585899 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:13:50.587395 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.5ms | ActiveRecord: 2.1ms)


D, [2018-09-12T23:13:50.590319 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:13:50.592569 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:13:50.603614 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:13:50 +0530
I, [2018-09-12T23:13:50.643024 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:13:50.643100 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:13:50.645422 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:13:50.647116 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T23:13:53.365758 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 23:13:53 +0530
I, [2018-09-12T23:13:53.401131 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T23:13:53.401256 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T23:13:53.404902 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:13:53.406879 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:13:53.408567 #11095] DEBUG -- :   [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:13:53.410529 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:13:53.412163 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T23:13:53.412981 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:13:53.413555 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:13:53.415277 #11095] DEBUG -- :   [1m[35mSQL (0.4ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:43:53.413000"], ["id", 1]]
D, [2018-09-12T23:13:53.416699 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:13:53.418643 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 09:43:53.417594')[0m
D, [2018-09-12T23:13:53.420906 #11095] DEBUG -- :   [1m[36mSetting Load (0.6ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:13:53.421857 #11095]  INFO -- : Completed 200 OK in 20ms (Views: 0.2ms | ActiveRecord: 5.3ms)


D, [2018-09-12T23:13:53.423466 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:13:53.424474 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:13:53.651767 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T23:13:53.656169 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:13:53.658259 #11095]  INFO -- : Completed 200 OK in 3015ms (Views: 0.6ms | ActiveRecord: 2.2ms)


D, [2018-09-12T23:13:53.662309 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:13:53.665596 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:13:53.676292 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 23:13:53 +0530
I, [2018-09-12T23:13:53.701311 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:13:53 +0530
I, [2018-09-12T23:13:53.716252 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T23:13:53.716640 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
I, [2018-09-12T23:13:53.720770 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:13:53.720882 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:13:53.721268 #11095] DEBUG -- :   [1m[35m (2.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:13:53.724903 #11095] DEBUG -- :   [1m[35m (1.1ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:13:53.725909 #11095] DEBUG -- :   [1m[35m (1.1ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:13:53.726974 #11095] DEBUG -- :   [1m[35m (1.1ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:13:53.727570 #11095] DEBUG -- :   [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:13:53.729162 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:13:53.730551 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T23:13:53.731316 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:13:53.731735 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:13:53.732197 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:13:53.733625 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:43:53.731000"], ["id", 1]]
D, [2018-09-12T23:13:53.736864 #11095] DEBUG -- :   [1m[35m (2.7ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:13:53.740310 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.8ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T23:13:53.742105 #11095] DEBUG -- :   [1m[36mChat Load (0.5ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T23:13:53.745741 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.5ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:41:53.744438')[0m  [["active", "t"]]
D, [2018-09-12T23:13:53.749939 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.5ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T23:13:53.750960 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T23:13:53.751787 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T23:13:53.752678 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T23:13:53.753840 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:41:53.752917')[0m  [["active", "t"]]
D, [2018-09-12T23:13:53.754798 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:41:53.754058')[0m  [["active", "t"]]
D, [2018-09-12T23:13:53.755750 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T23:13:53.756581 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:41:53.755917')[0m  [["active", "t"]]
D, [2018-09-12T23:13:53.757226 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:13:53.758127 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T23:13:53.760823 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:13:53.761194 #11095]  INFO -- : Completed 200 OK in 44ms (Views: 0.1ms | ActiveRecord: 13.5ms)


D, [2018-09-12T23:13:53.762304 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:13:53.763042 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:13:54.731544 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T23:13:54.738793 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:13:54.740093 #11095]  INFO -- : Completed 200 OK in 1018ms (Views: 3.7ms | ActiveRecord: 3.5ms)


D, [2018-09-12T23:13:54.742973 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:13:54.745238 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:13:54.756016 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:13:54 +0530
I, [2018-09-12T23:13:54.782582 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:13:54.782670 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:13:54.785283 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:13:54.786855 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:14:01.796608 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:14:01.797828 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.4ms | ActiveRecord: 2.0ms)


D, [2018-09-12T23:14:01.800369 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:14:01.801750 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:14:01.804730 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:14:01 +0530
I, [2018-09-12T23:14:01.816144 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:14:01.816209 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:14:01.818271 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:14:01.819637 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:14:08.829886 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:14:08.831299 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.5ms | ActiveRecord: 1.9ms)


D, [2018-09-12T23:14:08.834715 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:14:08.837583 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:14:08.845931 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:14:08 +0530
I, [2018-09-12T23:14:08.873307 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:14:08.873393 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:14:08.875924 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:14:08.877662 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:14:15.887062 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:14:15.888480 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.5ms | ActiveRecord: 2.1ms)


D, [2018-09-12T23:14:15.890995 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:14:15.893018 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:14:15.903713 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:14:15 +0530
I, [2018-09-12T23:14:15.932103 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:14:15.932210 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:14:15.934989 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:14:15.936732 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:14:22.946455 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:14:22.947699 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.4ms | ActiveRecord: 2.1ms)


D, [2018-09-12T23:14:22.950132 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:14:22.952155 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:14:22.961264 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:14:22 +0530
I, [2018-09-12T23:14:22.994184 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:14:22.994287 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:14:22.997655 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:14:22.999321 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:14:30.009375 #11095] DEBUG -- :   [1m[36mSetting Load (0.8ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:14:30.010252 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.6ms | ActiveRecord: 1.8ms)


D, [2018-09-12T23:14:30.011903 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:14:30.013009 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:14:30.020102 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:14:30 +0530
I, [2018-09-12T23:14:30.039022 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:14:30.039115 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:14:30.042095 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:14:30.044348 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:14:37.054075 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:14:37.055529 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.4ms | ActiveRecord: 2.3ms)


D, [2018-09-12T23:14:37.058195 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:14:37.060260 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:14:37.069324 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:14:37 +0530
I, [2018-09-12T23:14:37.093554 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:14:37.093630 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:14:37.096060 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:14:37.097744 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:14:44.107823 #11095] DEBUG -- :   [1m[36mSetting Load (1.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:14:44.109218 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.5ms | ActiveRecord: 2.4ms)


D, [2018-09-12T23:14:44.112089 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:14:44.114155 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:14:44.126719 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:14:44 +0530
I, [2018-09-12T23:14:44.144875 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:14:44.144952 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:14:44.147192 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:14:44.148684 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T23:14:48.380342 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 23:14:48 +0530
I, [2018-09-12T23:14:48.397691 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T23:14:48.397774 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T23:14:48.400460 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:14:48.403344 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:14:48.405223 #11095] DEBUG -- :   [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:14:48.407462 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:14:48.409260 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T23:14:48.410141 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:14:48.410884 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:14:48.412448 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:44:48.410000"], ["id", 1]]
D, [2018-09-12T23:14:48.419872 #11095] DEBUG -- :   [1m[35m (6.9ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:14:48.421442 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 09:44:48.420536')[0m
D, [2018-09-12T23:14:48.422923 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:14:48.423349 #11095]  INFO -- : Completed 200 OK in 25ms (Views: 0.1ms | ActiveRecord: 10.5ms)


D, [2018-09-12T23:14:48.424626 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:14:48.425384 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:14:49.153434 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T23:14:49.154847 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:14:49.155249 #11095]  INFO -- : Completed 200 OK in 5010ms (Views: 0.2ms | ActiveRecord: 1.2ms)


D, [2018-09-12T23:14:49.156094 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:14:49.156739 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:14:49.160038 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 23:14:49 +0530
I, [2018-09-12T23:14:49.160584 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:14:49 +0530
I, [2018-09-12T23:14:49.182819 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T23:14:49.183144 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
I, [2018-09-12T23:14:49.184926 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:14:49.186703 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:14:49.188426 #11095] DEBUG -- :   [1m[35m (1.7ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:14:49.189510 #11095] DEBUG -- :   [1m[35m (1.2ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:14:49.190484 #11095] DEBUG -- :   [1m[35m (1.0ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:14:49.191704 #11095] DEBUG -- :   [1m[35m (1.2ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:14:49.192508 #11095] DEBUG -- :   [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:14:49.195381 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:14:49.197676 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T23:14:49.198901 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:14:49.199548 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:14:49.200081 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:14:49.202239 #11095] DEBUG -- :   [1m[35mSQL (0.5ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:44:49.199000"], ["id", 1]]
D, [2018-09-12T23:14:49.203507 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:14:49.204957 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T23:14:49.205878 #11095] DEBUG -- :   [1m[36mChat Load (0.2ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T23:14:49.207733 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:42:49.207037')[0m  [["active", "t"]]
D, [2018-09-12T23:14:49.210093 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T23:14:49.210891 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T23:14:49.211511 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.2ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T23:14:49.212378 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T23:14:49.213432 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:42:49.212617')[0m  [["active", "t"]]
D, [2018-09-12T23:14:49.214443 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:42:49.213615')[0m  [["active", "t"]]
D, [2018-09-12T23:14:49.215510 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T23:14:49.217498 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.5ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:42:49.215887')[0m  [["active", "t"]]
D, [2018-09-12T23:14:49.218888 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:14:49.220231 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T23:14:49.224887 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:14:49.225524 #11095]  INFO -- : Completed 200 OK in 42ms (Views: 0.2ms | ActiveRecord: 10.6ms)


D, [2018-09-12T23:14:49.227032 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:14:49.228018 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:14:50.196203 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T23:14:50.202642 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:14:50.203821 #11095]  INFO -- : Completed 200 OK in 1017ms (Views: 3.2ms | ActiveRecord: 3.5ms)


D, [2018-09-12T23:14:50.206249 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:14:50.208305 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:14:50.217531 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:14:50 +0530
I, [2018-09-12T23:14:50.244085 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:14:50.244186 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:14:50.246705 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:14:50.248423 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:14:57.257857 #11095] DEBUG -- :   [1m[36mSetting Load (0.9ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:14:57.259051 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.5ms | ActiveRecord: 1.8ms)


D, [2018-09-12T23:14:57.260254 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:14:57.260832 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:14:57.263953 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:14:57 +0530
I, [2018-09-12T23:14:57.275342 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:14:57.275406 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:14:57.277413 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:14:57.278669 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:15:04.289243 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:15:04.290557 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.5ms | ActiveRecord: 1.9ms)


D, [2018-09-12T23:15:04.293406 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:15:04.295796 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:15:04.305406 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:15:04 +0530
I, [2018-09-12T23:15:04.337932 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:15:04.338040 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:15:04.341297 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:15:04.343458 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:15:11.355715 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:15:11.357143 #11095]  INFO -- : Completed 200 OK in 7019ms (Views: 0.5ms | ActiveRecord: 2.3ms)


D, [2018-09-12T23:15:11.360093 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:15:11.361059 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:15:11.364245 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:15:11 +0530
I, [2018-09-12T23:15:11.374737 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:15:11.374796 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:15:11.376700 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:15:11.377960 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:15:18.387275 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:15:18.388577 #11095]  INFO -- : Completed 200 OK in 7013ms (Views: 0.4ms | ActiveRecord: 1.8ms)


D, [2018-09-12T23:15:18.391187 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:15:18.393317 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:15:18.401886 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:15:18 +0530
I, [2018-09-12T23:15:18.434531 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:15:18.434622 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:15:18.437275 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:15:18.439142 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:15:25.451615 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:15:25.453049 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.5ms | ActiveRecord: 2.1ms)


D, [2018-09-12T23:15:25.457069 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:15:25.459483 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:15:25.469264 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:15:25 +0530
I, [2018-09-12T23:15:25.497868 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:15:25.498025 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:15:25.501600 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:15:25.503835 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:15:32.513865 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:15:32.514842 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.5ms | ActiveRecord: 2.3ms)


D, [2018-09-12T23:15:32.517992 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:15:32.520576 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:15:32.525443 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:15:32 +0530
I, [2018-09-12T23:15:32.543341 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:15:32.543426 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:15:32.546373 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:15:32.549831 #11095] DEBUG -- :   [1m[35m (1.0ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:15:39.559196 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:15:39.560588 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.4ms | ActiveRecord: 2.5ms)


D, [2018-09-12T23:15:39.562992 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:15:39.565117 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:15:39.573983 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:15:39 +0530
I, [2018-09-12T23:15:39.602053 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:15:39.602168 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:15:39.605500 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:15:39.607871 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T23:15:43.363307 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 23:15:43 +0530
I, [2018-09-12T23:15:43.395089 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T23:15:43.395195 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T23:15:43.399729 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:15:43.401377 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:15:43.402814 #11095] DEBUG -- :   [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:15:43.404544 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:15:43.406004 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T23:15:43.406777 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:15:43.407353 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:15:43.408831 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:45:43.406000"], ["id", 1]]
D, [2018-09-12T23:15:43.411869 #11095] DEBUG -- :   [1m[35m (2.7ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:15:43.413211 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 09:45:43.412425')[0m
D, [2018-09-12T23:15:43.415200 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:15:43.415674 #11095]  INFO -- : Completed 200 OK in 20ms (Views: 0.2ms | ActiveRecord: 6.1ms)


D, [2018-09-12T23:15:43.417056 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:15:43.418592 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:15:44.612680 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T23:15:44.614105 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:15:44.614484 #11095]  INFO -- : Completed 200 OK in 5012ms (Views: 0.2ms | ActiveRecord: 1.7ms)


D, [2018-09-12T23:15:44.615300 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:15:44.615933 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:15:44.619258 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 23:15:44 +0530
I, [2018-09-12T23:15:44.628212 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:15:44 +0530
I, [2018-09-12T23:15:44.638312 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T23:15:44.638624 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
I, [2018-09-12T23:15:44.642918 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
D, [2018-09-12T23:15:44.643130 #11095] DEBUG -- :   [1m[35m (2.2ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
I, [2018-09-12T23:15:44.643236 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:15:44.646824 #11095] DEBUG -- :   [1m[35m (2.2ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:15:44.647798 #11095] DEBUG -- :   [1m[35m (1.1ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:15:44.648886 #11095] DEBUG -- :   [1m[36mUser Load (1.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:15:44.650832 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:15:44.651879 #11095] DEBUG -- :   [1m[35m (3.1ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:15:44.652443 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T23:15:44.653060 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:15:44.653407 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:15:44.653743 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:15:44.654919 #11095] DEBUG -- :   [1m[35mSQL (0.2ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:45:44.653000"], ["id", 1]]
D, [2018-09-12T23:15:44.658294 #11095] DEBUG -- :   [1m[35m (2.8ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:15:44.660005 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.4ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T23:15:44.660956 #11095] DEBUG -- :   [1m[36mChat Load (0.3ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T23:15:44.662875 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:43:44.662062')[0m  [["active", "t"]]
D, [2018-09-12T23:15:44.666079 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.5ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T23:15:44.667397 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T23:15:44.668258 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T23:15:44.669045 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T23:15:44.669948 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:43:44.669217')[0m  [["active", "t"]]
D, [2018-09-12T23:15:44.670811 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:43:44.670090')[0m  [["active", "t"]]
D, [2018-09-12T23:15:44.672586 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T23:15:44.673760 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:43:44.672897')[0m  [["active", "t"]]
D, [2018-09-12T23:15:44.674485 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:15:44.675732 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T23:15:44.679985 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:15:44.680389 #11095]  INFO -- : Completed 200 OK in 42ms (Views: 0.1ms | ActiveRecord: 14.8ms)


D, [2018-09-12T23:15:44.681653 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:15:44.682485 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:15:45.654199 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T23:15:45.657227 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:15:45.657773 #11095]  INFO -- : Completed 200 OK in 1013ms (Views: 1.6ms | ActiveRecord: 4.6ms)


D, [2018-09-12T23:15:45.658830 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:15:45.659644 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:15:45.663310 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:15:45 +0530
I, [2018-09-12T23:15:45.676975 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:15:45.677080 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:15:45.681242 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:15:45.683198 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:15:52.694232 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:15:52.695567 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.4ms | ActiveRecord: 2.6ms)


D, [2018-09-12T23:15:52.698038 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:15:52.699427 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:15:52.702890 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:15:52 +0530
I, [2018-09-12T23:15:52.715599 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:15:52.715683 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:15:52.717904 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:15:52.719697 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:15:59.731426 #11095] DEBUG -- :   [1m[36mSetting Load (1.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:15:59.732847 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.4ms | ActiveRecord: 2.3ms)


D, [2018-09-12T23:15:59.735570 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:15:59.738608 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:15:59.748377 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:15:59 +0530
I, [2018-09-12T23:15:59.772418 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:15:59.772490 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:15:59.774612 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:15:59.776021 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:16:06.786266 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:16:06.787526 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.4ms | ActiveRecord: 1.7ms)


D, [2018-09-12T23:16:06.789990 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:16:06.792030 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:16:06.800879 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:16:06 +0530
I, [2018-09-12T23:16:06.830256 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:16:06.830351 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:16:06.833469 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:16:06.835324 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:16:13.846815 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:16:13.848230 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.5ms | ActiveRecord: 2.3ms)


D, [2018-09-12T23:16:13.851096 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:16:13.853431 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:16:13.863860 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:16:13 +0530
I, [2018-09-12T23:16:13.899029 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:16:13.899180 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:16:13.903463 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:16:13.906512 #11095] DEBUG -- :   [1m[35m (1.0ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:16:20.916095 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:16:20.917307 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.4ms | ActiveRecord: 2.7ms)


D, [2018-09-12T23:16:20.919781 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:16:20.921557 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:16:20.925086 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:16:20 +0530
I, [2018-09-12T23:16:20.936608 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:16:20.936678 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:16:20.938727 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:16:20.940032 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:16:27.949895 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:16:27.951268 #11095]  INFO -- : Completed 200 OK in 7014ms (Views: 0.4ms | ActiveRecord: 1.8ms)


D, [2018-09-12T23:16:27.953588 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:16:27.955511 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:16:27.964221 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:16:27 +0530
I, [2018-09-12T23:16:27.992088 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:16:27.992214 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:16:27.994926 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:16:27.996640 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:16:35.003295 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:16:35.003923 #11095]  INFO -- : Completed 200 OK in 7012ms (Views: 0.2ms | ActiveRecord: 1.5ms)


D, [2018-09-12T23:16:35.005235 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:16:35.006236 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:16:35.016477 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:16:35 +0530
I, [2018-09-12T23:16:35.031854 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:16:35.031966 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:16:35.034882 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:16:35.037088 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T23:16:38.359122 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 23:16:38 +0530
I, [2018-09-12T23:16:38.378890 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T23:16:38.379012 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T23:16:38.381577 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:16:38.383475 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:16:38.385317 #11095] DEBUG -- :   [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:16:38.387161 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:16:38.390131 #11095] DEBUG -- :   [1m[35m (1.4ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T23:16:38.391404 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:16:38.393279 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:16:38.396088 #11095] DEBUG -- :   [1m[35mSQL (0.4ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:46:38.392000"], ["id", 1]]
D, [2018-09-12T23:16:38.397294 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:16:38.398580 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 09:46:38.397847')[0m
D, [2018-09-12T23:16:38.400054 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:16:38.400492 #11095]  INFO -- : Completed 200 OK in 21ms (Views: 0.1ms | ActiveRecord: 6.1ms)


D, [2018-09-12T23:16:38.401681 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:16:38.402794 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:16:40.040527 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T23:16:40.042751 #11095] DEBUG -- :   [1m[36mSetting Load (0.7ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:16:40.044103 #11095]  INFO -- : Completed 200 OK in 5011ms (Views: 0.2ms | ActiveRecord: 1.9ms)


D, [2018-09-12T23:16:40.046248 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:16:40.047224 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:16:40.050655 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 23:16:40 +0530
I, [2018-09-12T23:16:40.060776 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:16:40 +0530
I, [2018-09-12T23:16:40.074903 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T23:16:40.075058 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
I, [2018-09-12T23:16:40.081435 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
D, [2018-09-12T23:16:40.081572 #11095] DEBUG -- :   [1m[35m (2.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
I, [2018-09-12T23:16:40.083401 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:16:40.085332 #11095] DEBUG -- :   [1m[35m (1.9ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:16:40.086616 #11095] DEBUG -- :   [1m[35m (1.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:16:40.087871 #11095] DEBUG -- :   [1m[36mUser Load (1.2ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:16:40.091286 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:16:40.093593 #11095] DEBUG -- :   [1m[35m (3.9ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:16:40.095336 #11095] DEBUG -- :   [1m[35m (1.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T23:16:40.096600 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:16:40.097191 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:16:40.097719 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:16:40.099631 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:46:40.097000"], ["id", 1]]
D, [2018-09-12T23:16:40.102812 #11095] DEBUG -- :   [1m[35m (2.7ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:16:40.104953 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.4ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T23:16:40.106101 #11095] DEBUG -- :   [1m[36mChat Load (0.2ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T23:16:40.108568 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:44:40.107690')[0m  [["active", "t"]]
D, [2018-09-12T23:16:40.112314 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T23:16:40.113436 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T23:16:40.114278 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.2ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T23:16:40.115202 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T23:16:40.116386 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:44:40.115422')[0m  [["active", "t"]]
D, [2018-09-12T23:16:40.117845 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:44:40.116699')[0m  [["active", "t"]]
D, [2018-09-12T23:16:40.119062 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T23:16:40.120251 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:44:40.119406')[0m  [["active", "t"]]
D, [2018-09-12T23:16:40.121063 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:16:40.122103 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T23:16:40.125312 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:16:40.125752 #11095]  INFO -- : Completed 200 OK in 51ms (Views: 0.2ms | ActiveRecord: 14.1ms)


D, [2018-09-12T23:16:40.126906 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:16:40.127791 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:16:41.096636 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T23:16:41.098781 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:16:41.099167 #11095]  INFO -- : Completed 200 OK in 1016ms (Views: 1.0ms | ActiveRecord: 5.7ms)


D, [2018-09-12T23:16:41.100012 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:16:41.100798 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:16:41.104032 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:16:41 +0530
I, [2018-09-12T23:16:41.115887 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:16:41.115990 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:16:41.119920 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:16:41.121389 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:16:48.129043 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:16:48.129606 #11095]  INFO -- : Completed 200 OK in 7013ms (Views: 0.3ms | ActiveRecord: 1.3ms)


D, [2018-09-12T23:16:48.130648 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:16:48.131880 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:16:48.135749 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:16:48 +0530
I, [2018-09-12T23:16:48.149072 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:16:48.149148 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:16:48.151550 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:16:48.153176 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:16:55.164402 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:16:55.165648 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.5ms | ActiveRecord: 2.1ms)


D, [2018-09-12T23:16:55.168079 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:16:55.170132 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:16:55.178568 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:16:55 +0530
I, [2018-09-12T23:16:55.208254 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:16:55.208359 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:16:55.211430 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:16:55.213116 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:17:02.223889 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:17:02.225306 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.5ms | ActiveRecord: 2.1ms)


D, [2018-09-12T23:17:02.228299 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:17:02.230654 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:17:02.240358 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:17:02 +0530
I, [2018-09-12T23:17:02.270398 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:17:02.270524 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:17:02.280354 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:17:02.281866 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:17:09.292636 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:17:09.293542 #11095]  INFO -- : Completed 200 OK in 7023ms (Views: 0.5ms | ActiveRecord: 1.9ms)


D, [2018-09-12T23:17:09.295402 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:17:09.297337 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:17:09.302366 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:17:09 +0530
I, [2018-09-12T23:17:09.317199 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:17:09.317275 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:17:09.319645 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:17:09.321629 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:17:16.329055 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:17:16.329745 #11095]  INFO -- : Completed 200 OK in 7012ms (Views: 0.2ms | ActiveRecord: 1.5ms)


D, [2018-09-12T23:17:16.331046 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:17:16.332746 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:17:16.342322 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:17:16 +0530
I, [2018-09-12T23:17:16.359035 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:17:16.359419 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:17:16.364189 #11095] DEBUG -- :   [1m[35m (1.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:17:16.366054 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:17:23.375707 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:17:23.377188 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.7ms | ActiveRecord: 2.8ms)


D, [2018-09-12T23:17:23.380332 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:17:23.383206 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:17:23.389397 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:17:23 +0530
I, [2018-09-12T23:17:23.407361 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:17:23.407759 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:17:23.413393 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:17:23.415744 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:17:30.423323 #11095] DEBUG -- :   [1m[36mSetting Load (0.6ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:17:30.423886 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.2ms | ActiveRecord: 1.8ms)


D, [2018-09-12T23:17:30.424919 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:17:30.425692 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:17:30.431144 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:17:30 +0530
I, [2018-09-12T23:17:30.443538 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:17:30.443618 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:17:30.446070 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:17:30.447777 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T23:17:33.366387 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 23:17:33 +0530
I, [2018-09-12T23:17:33.402681 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T23:17:33.402788 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T23:17:33.405284 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:17:33.406732 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:17:33.408094 #11095] DEBUG -- :   [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:17:33.409839 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:17:33.411215 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T23:17:33.411982 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:17:33.412643 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:17:33.414213 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:47:33.412000"], ["id", 1]]
D, [2018-09-12T23:17:33.417037 #11095] DEBUG -- :   [1m[35m (2.5ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:17:33.418143 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 09:47:33.417487')[0m
D, [2018-09-12T23:17:33.419456 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:17:33.419846 #11095]  INFO -- : Completed 200 OK in 17ms (Views: 0.1ms | ActiveRecord: 5.4ms)


D, [2018-09-12T23:17:33.420913 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:17:33.421637 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:17:33.450491 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T23:17:33.452079 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:17:33.452548 #11095]  INFO -- : Completed 200 OK in 3009ms (Views: 0.2ms | ActiveRecord: 1.5ms)


D, [2018-09-12T23:17:33.453429 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:17:33.454272 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:17:33.459380 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 23:17:33 +0530
I, [2018-09-12T23:17:33.459682 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:17:33 +0530
I, [2018-09-12T23:17:33.481782 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T23:17:33.481928 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
I, [2018-09-12T23:17:33.483343 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:17:33.485534 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:17:33.488099 #11095] DEBUG -- :   [1m[35m (2.1ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:17:33.489416 #11095] DEBUG -- :   [1m[35m (2.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:17:33.490434 #11095] DEBUG -- :   [1m[35m (1.1ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:17:33.491529 #11095] DEBUG -- :   [1m[35m (1.1ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:17:33.492136 #11095] DEBUG -- :   [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:17:33.493755 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:17:33.495137 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T23:17:33.495932 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:17:33.496327 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:17:33.496785 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:17:33.498181 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:47:33.496000"], ["id", 1]]
D, [2018-09-12T23:17:33.499309 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:17:33.500598 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T23:17:33.501511 #11095] DEBUG -- :   [1m[36mChat Load (0.3ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T23:17:33.503366 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:45:33.502654')[0m  [["active", "t"]]
D, [2018-09-12T23:17:33.505759 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T23:17:33.506576 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T23:17:33.507224 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T23:17:33.507970 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T23:17:33.508834 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:45:33.508128')[0m  [["active", "t"]]
D, [2018-09-12T23:17:33.509597 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:45:33.508973')[0m  [["active", "t"]]
D, [2018-09-12T23:17:33.510475 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T23:17:33.511250 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:45:33.510628')[0m  [["active", "t"]]
D, [2018-09-12T23:17:33.511883 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:17:33.512777 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T23:17:33.515765 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:17:33.516198 #11095]  INFO -- : Completed 200 OK in 33ms (Views: 0.1ms | ActiveRecord: 10.0ms)


D, [2018-09-12T23:17:33.517536 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:17:33.518508 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:17:34.496618 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T23:17:34.504747 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:17:34.506313 #11095]  INFO -- : Completed 200 OK in 1020ms (Views: 4.3ms | ActiveRecord: 4.4ms)


D, [2018-09-12T23:17:34.509177 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:17:34.510908 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:17:34.518316 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:17:34 +0530
I, [2018-09-12T23:17:34.536719 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:17:34.536811 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:17:34.539585 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:17:34.541839 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:17:41.553325 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:17:41.554763 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.5ms | ActiveRecord: 2.4ms)


D, [2018-09-12T23:17:41.558312 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:17:41.561203 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:17:41.571074 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:17:41 +0530
I, [2018-09-12T23:17:41.602579 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:17:41.602682 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:17:41.605855 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:17:41.607672 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:17:48.618750 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:17:48.620019 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.4ms | ActiveRecord: 2.0ms)


D, [2018-09-12T23:17:48.622512 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:17:48.624629 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:17:48.633120 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:17:48 +0530
I, [2018-09-12T23:17:48.662334 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:17:48.662454 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:17:48.665539 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:17:48.667254 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:17:55.676897 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:17:55.678133 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.4ms | ActiveRecord: 2.0ms)


D, [2018-09-12T23:17:55.680746 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:17:55.682609 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:17:55.691343 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:17:55 +0530
I, [2018-09-12T23:17:55.717217 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:17:55.717302 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:17:55.719791 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:17:55.721425 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:18:02.730229 #11095] DEBUG -- :   [1m[36mSetting Load (0.7ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:18:02.731102 #11095]  INFO -- : Completed 200 OK in 7014ms (Views: 0.5ms | ActiveRecord: 1.6ms)


D, [2018-09-12T23:18:02.732666 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:18:02.734139 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:18:02.740428 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:18:02 +0530
I, [2018-09-12T23:18:02.756773 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:18:02.756886 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:18:02.759671 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:18:02.761399 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:18:09.771644 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:18:09.772889 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.4ms | ActiveRecord: 2.2ms)


D, [2018-09-12T23:18:09.775263 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:18:09.777953 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:18:09.786570 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:18:09 +0530
I, [2018-09-12T23:18:09.817388 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:18:09.817518 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:18:09.820656 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:18:09.822660 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:18:16.831971 #11095] DEBUG -- :   [1m[36mSetting Load (0.8ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:18:16.832800 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.3ms | ActiveRecord: 2.0ms)


D, [2018-09-12T23:18:16.834163 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:18:16.835227 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:18:16.841626 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:18:16 +0530
I, [2018-09-12T23:18:16.856529 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:18:16.856601 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:18:16.858814 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:18:16.860291 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:18:23.872802 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:18:23.874177 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.5ms | ActiveRecord: 2.0ms)


D, [2018-09-12T23:18:23.876943 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:18:23.879211 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:18:23.887282 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:18:23 +0530
I, [2018-09-12T23:18:23.900561 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:18:23.900633 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:18:23.903024 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:18:23.904760 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T23:18:28.362807 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 23:18:28 +0530
I, [2018-09-12T23:18:28.376977 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T23:18:28.377060 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T23:18:28.379292 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:18:28.380771 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:18:28.382073 #11095] DEBUG -- :   [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:18:28.383666 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:18:28.385056 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T23:18:28.385806 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:18:28.386373 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:18:28.387815 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:48:28.386000"], ["id", 1]]
D, [2018-09-12T23:18:28.390929 #11095] DEBUG -- :   [1m[35m (2.8ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:18:28.392293 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 09:48:28.391412')[0m
D, [2018-09-12T23:18:28.394380 #11095] DEBUG -- :   [1m[36mSetting Load (0.6ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:18:28.394914 #11095]  INFO -- : Completed 200 OK in 18ms (Views: 0.1ms | ActiveRecord: 6.3ms)


D, [2018-09-12T23:18:28.396314 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:18:28.397124 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:18:28.911870 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T23:18:28.915702 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:18:28.916612 #11095]  INFO -- : Completed 200 OK in 5016ms (Views: 0.5ms | ActiveRecord: 2.0ms)


D, [2018-09-12T23:18:28.917575 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:18:28.918385 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:18:28.922614 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 23:18:28 +0530
I, [2018-09-12T23:18:28.934974 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:18:28 +0530
I, [2018-09-12T23:18:28.948890 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T23:18:28.948974 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
I, [2018-09-12T23:18:28.952426 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:18:28.952496 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:18:28.954187 #11095] DEBUG -- :   [1m[35m (3.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:18:28.955317 #11095] DEBUG -- :   [1m[35m (1.2ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:18:28.956368 #11095] DEBUG -- :   [1m[35m (1.1ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:18:28.957384 #11095] DEBUG -- :   [1m[35m (1.1ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:18:28.957992 #11095] DEBUG -- :   [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:18:28.959570 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:18:28.960981 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T23:18:28.961780 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:18:28.962203 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:18:28.962648 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:18:28.964139 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:48:28.962000"], ["id", 1]]
D, [2018-09-12T23:18:28.971506 #11095] DEBUG -- :   [1m[35m (6.8ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:18:28.976510 #11095] DEBUG -- :   [1m[36mChat::Session Load (1.1ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T23:18:28.979381 #11095] DEBUG -- :   [1m[36mChat Load (0.8ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T23:18:28.984653 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.7ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:46:28.982667')[0m  [["active", "t"]]
D, [2018-09-12T23:18:28.991190 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.7ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T23:18:28.993364 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T23:18:28.994576 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.5ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T23:18:28.996003 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T23:18:28.997684 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:46:28.996343')[0m  [["active", "t"]]
D, [2018-09-12T23:18:28.998983 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:46:28.997966')[0m  [["active", "t"]]
D, [2018-09-12T23:18:29.000279 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T23:18:29.001470 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:46:29.000518')[0m  [["active", "t"]]
D, [2018-09-12T23:18:29.002388 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:18:29.003854 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.4ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T23:18:29.008230 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:18:29.008735 #11095]  INFO -- : Completed 200 OK in 60ms (Views: 0.2ms | ActiveRecord: 21.1ms)


D, [2018-09-12T23:18:29.010033 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:18:29.010848 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:18:29.962884 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T23:18:29.966901 #11095] DEBUG -- :   [1m[36mSetting Load (0.6ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:18:29.967422 #11095]  INFO -- : Completed 200 OK in 1015ms (Views: 2.3ms | ActiveRecord: 2.9ms)


D, [2018-09-12T23:18:29.968546 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:18:29.969599 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:18:29.975847 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:18:29 +0530
I, [2018-09-12T23:18:29.993182 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:18:29.993304 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:18:29.996896 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:18:29.998926 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:18:37.011879 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:18:37.013365 #11095]  INFO -- : Completed 200 OK in 7020ms (Views: 0.5ms | ActiveRecord: 2.4ms)


D, [2018-09-12T23:18:37.016367 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:18:37.018708 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:18:37.028779 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:18:37 +0530
I, [2018-09-12T23:18:37.045770 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:18:37.045855 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:18:37.048387 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:18:37.050153 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:18:44.070076 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:18:44.071406 #11095]  INFO -- : Completed 200 OK in 7025ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T23:18:44.074135 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:18:44.076470 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:18:44.084708 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:18:44 +0530
I, [2018-09-12T23:18:44.097830 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:18:44.097905 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:18:44.100514 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:18:44.102638 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:18:51.113604 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:18:51.115012 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.4ms | ActiveRecord: 2.2ms)


D, [2018-09-12T23:18:51.118649 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:18:51.119872 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:18:51.123678 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:18:51 +0530
I, [2018-09-12T23:18:51.136290 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:18:51.136362 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:18:51.138549 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:18:51.139989 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:18:58.151313 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:18:58.152611 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.4ms | ActiveRecord: 1.8ms)


D, [2018-09-12T23:18:58.154950 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:18:58.156792 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:18:58.167423 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:18:58 +0530
I, [2018-09-12T23:18:58.195595 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:18:58.195683 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:18:58.198207 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:18:58.199982 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:19:05.212292 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:19:05.213634 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.5ms | ActiveRecord: 2.4ms)


D, [2018-09-12T23:19:05.216434 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:19:05.218729 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:19:05.228502 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:19:05 +0530
I, [2018-09-12T23:19:05.260012 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:19:05.260125 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:19:05.262862 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:19:05.264659 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:19:12.276375 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:19:12.277732 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T23:19:12.280481 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:19:12.282797 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:19:12.294880 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:19:12 +0530
I, [2018-09-12T23:19:12.327877 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:19:12.327990 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:19:12.331209 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:19:12.333153 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:19:19.346719 #11095] DEBUG -- :   [1m[36mSetting Load (1.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:19:19.348324 #11095]  INFO -- : Completed 200 OK in 7020ms (Views: 0.5ms | ActiveRecord: 2.5ms)


D, [2018-09-12T23:19:19.351291 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:19:19.354244 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:19:19.364628 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:19:19 +0530
I, [2018-09-12T23:19:19.392633 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:19:19.392726 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:19:19.395368 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:19:19.397070 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T23:19:23.361988 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 23:19:23 +0530
I, [2018-09-12T23:19:23.388707 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T23:19:23.388792 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T23:19:23.391287 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:19:23.393122 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:19:23.394600 #11095] DEBUG -- :   [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:19:23.396360 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:19:23.397799 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T23:19:23.399013 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:19:23.400140 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:19:23.402657 #11095] DEBUG -- :   [1m[35mSQL (0.4ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:49:23.399000"], ["id", 1]]
D, [2018-09-12T23:19:23.409604 #11095] DEBUG -- :   [1m[35m (6.3ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:19:23.413013 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.6ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 09:49:23.411178')[0m
D, [2018-09-12T23:19:23.416861 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:19:23.418871 #11095]  INFO -- : Completed 200 OK in 30ms (Views: 0.2ms | ActiveRecord: 11.2ms)


D, [2018-09-12T23:19:23.421550 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:19:23.422742 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:19:24.404181 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T23:19:24.408269 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:19:24.410175 #11095]  INFO -- : Completed 200 OK in 5017ms (Views: 0.5ms | ActiveRecord: 2.0ms)


D, [2018-09-12T23:19:24.412859 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:19:24.414965 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:19:24.426264 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 23:19:24 +0530
I, [2018-09-12T23:19:24.452696 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:19:24 +0530
I, [2018-09-12T23:19:24.470714 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T23:19:24.470831 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
I, [2018-09-12T23:19:24.475938 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
D, [2018-09-12T23:19:24.476170 #11095] DEBUG -- :   [1m[35m (2.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
I, [2018-09-12T23:19:24.476337 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:19:24.479625 #11095] DEBUG -- :   [1m[35m (2.0ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:19:24.480791 #11095] DEBUG -- :   [1m[35m (1.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:19:24.482468 #11095] DEBUG -- :   [1m[36mUser Load (1.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:19:24.485573 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:19:24.486966 #11095] DEBUG -- :   [1m[35m (4.8ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:19:24.487856 #11095] DEBUG -- :   [1m[35m (1.1ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T23:19:24.489041 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:19:24.489562 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:19:24.489986 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:19:24.491395 #11095] DEBUG -- :   [1m[35mSQL (0.2ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:49:24.489000"], ["id", 1]]
D, [2018-09-12T23:19:24.494557 #11095] DEBUG -- :   [1m[35m (2.7ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:19:24.498037 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.6ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T23:19:24.500297 #11095] DEBUG -- :   [1m[36mChat Load (0.6ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T23:19:24.504547 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:47:24.503221')[0m  [["active", "t"]]
D, [2018-09-12T23:19:24.508629 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.4ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T23:19:24.509547 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T23:19:24.510218 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.2ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T23:19:24.511019 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T23:19:24.512103 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:47:24.511218')[0m  [["active", "t"]]
D, [2018-09-12T23:19:24.512811 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:47:24.512246')[0m  [["active", "t"]]
D, [2018-09-12T23:19:24.513643 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T23:19:24.514404 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:47:24.513799')[0m  [["active", "t"]]
D, [2018-09-12T23:19:24.515154 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:19:24.517298 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.6ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T23:19:24.520797 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:19:24.521667 #11095]  INFO -- : Completed 200 OK in 50ms (Views: 0.2ms | ActiveRecord: 15.2ms)


D, [2018-09-12T23:19:24.523200 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:19:24.523977 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:19:25.493574 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T23:19:25.502469 #11095] DEBUG -- :   [1m[36mSetting Load (1.7ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:19:25.504491 #11095]  INFO -- : Completed 200 OK in 1026ms (Views: 3.8ms | ActiveRecord: 7.8ms)


D, [2018-09-12T23:19:25.507629 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:19:25.509496 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:19:25.516612 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:19:25 +0530
I, [2018-09-12T23:19:25.531920 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:19:25.532084 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:19:25.536306 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:19:25.538382 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:19:32.547620 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:19:32.548524 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.4ms | ActiveRecord: 2.2ms)


D, [2018-09-12T23:19:32.550239 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:19:32.551655 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:19:32.556841 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:19:32 +0530
I, [2018-09-12T23:19:32.570178 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:19:32.570250 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:19:32.572643 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:19:32.574545 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:19:39.584992 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:19:39.586317 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.5ms | ActiveRecord: 2.3ms)


D, [2018-09-12T23:19:39.589066 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:19:39.591343 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:19:39.602327 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:19:39 +0530
I, [2018-09-12T23:19:39.627738 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:19:39.627830 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:19:39.630311 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:19:39.631787 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:19:46.641204 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:19:46.642495 #11095]  INFO -- : Completed 200 OK in 7014ms (Views: 0.4ms | ActiveRecord: 2.0ms)


D, [2018-09-12T23:19:46.645138 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:19:46.648602 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:19:46.658129 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:19:46 +0530
I, [2018-09-12T23:19:46.687483 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:19:46.687639 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:19:46.690756 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:19:46.692571 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:19:53.702107 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:19:53.703544 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.5ms | ActiveRecord: 2.4ms)


D, [2018-09-12T23:19:53.706323 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:19:53.708650 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:19:53.718230 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:19:53 +0530
I, [2018-09-12T23:19:53.752328 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:19:53.752441 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:19:53.755675 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:19:53.757768 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:20:00.768788 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:20:00.770106 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.4ms | ActiveRecord: 2.2ms)


D, [2018-09-12T23:20:00.772879 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:20:00.775128 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:20:00.784685 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:20:00 +0530
I, [2018-09-12T23:20:00.812321 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:20:00.812428 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:20:00.814955 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:20:00.816730 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:20:00.817860 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:20:00.819258 #11095] DEBUG -- :   [1m[35mSQL (0.4ms)[0m  [1m[32mINSERT INTO "delayed_jobs" ("handler", "run_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["handler", "--- !ruby/object:Observer::UserDeviceLogJob\nhttp_user_agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko)\n  Chrome/68.0.3440.106 Safari/537.36\nremote_ip: \"::1\"\nuser_id: 3\nfingerprint: \"-1992429858\"\ntype: session\n"], ["run_at", "2018-09-12 17:50:00.817988"], ["created_at", "2018-09-12 17:50:00.818000"], ["updated_at", "2018-09-12 17:50:00.818000"]]
D, [2018-09-12T23:20:00.822735 #11095] DEBUG -- :   [1m[35m (3.0ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:20:07.834846 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:20:07.836246 #11095]  INFO -- : Completed 200 OK in 7023ms (Views: 0.6ms | ActiveRecord: 5.8ms)


D, [2018-09-12T23:20:07.839989 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:20:07.844042 #11095] DEBUG -- :   [1m[35mSQL (0.9ms)[0m  [1m[33mUPDATE "sessions" SET "data" = $1, "updated_at" = $2 WHERE "sessions"."id" = $3[0m  [["data", "BAh7D0kiCXBpbmcGOgZFRkkiGTIwMTgtMDktMTJUMTY6MDk6MjZaBjsAVEki\nD3VzZXJfYWdlbnQGOwBGIm5Nb3ppbGxhLzUuMCAoWDExOyBMaW51eCB4ODZf\nNjQpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENo\ncm9tZS82OC4wLjM0NDAuMTA2IFNhZmFyaS81MzcuMzZJIhBfY3NyZl90b2tl\nbgY7AEZJIjE1SzlmTEZWTnRwVFYydjArWGQ1M21QMjFWbDAzT1RSeEp2cUpm\nbitDRDUwPQY7AEZJIgx1c2VyX2lkBjsARmkISSIadXNlcl9kZXZpY2VfcmVt\nb3RlX2lwBjsARiIIOjoxSSIcdXNlcl9kZXZpY2VfZmluZ2VycHJpbnQGOwBG\nSSIQLTE5OTI0Mjk4NTgGOwBUSSIbdXNlcl9kZXZpY2VfdXBkYXRlZF9hdAY7\nAEZVOiBBY3RpdmVTdXBwb3J0OjpUaW1lV2l0aFpvbmVbCEl1OglUaW1lDZGh\nHcBvdwzICToJem9uZUkiCFVUQwY7AEY6DW5hbm9fbnVtaQK2AzoNbmFub19k\nZW5pBjoNc3VibWljcm8iBpVJIghVVEMGOwBUQBZJIg9wZXJzaXN0ZW50BjsA\nRlRJIg5yZW1vdGVfaXAGOwBGIgg6OjFJIghnZW8GOwBGewA=\n"], ["updated_at", "2018-09-12 17:50:07.840866"], ["id", 33]]
D, [2018-09-12T23:20:07.852474 #11095] DEBUG -- :   [1m[35m (7.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:20:07.862044 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:20:07 +0530
I, [2018-09-12T23:20:07.892478 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:20:07.892584 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:20:07.895859 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:20:07.897973 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:20:14.908753 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:20:14.910086 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.5ms | ActiveRecord: 2.3ms)


D, [2018-09-12T23:20:14.912895 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:20:14.915235 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:20:14.924933 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:20:14 +0530
I, [2018-09-12T23:20:14.955363 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:20:14.955466 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:20:14.958150 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:20:14.959837 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T23:20:18.363127 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 23:20:18 +0530
I, [2018-09-12T23:20:18.375015 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T23:20:18.375096 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T23:20:18.377485 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:20:18.379516 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:20:18.380942 #11095] DEBUG -- :   [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:20:18.382615 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:20:18.384008 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T23:20:18.384772 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:20:18.385280 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:20:18.386880 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:50:18.384000"], ["id", 1]]
D, [2018-09-12T23:20:18.392993 #11095] DEBUG -- :   [1m[35m (5.6ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:20:18.396335 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.6ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 09:50:18.393722')[0m
D, [2018-09-12T23:20:18.398855 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:20:18.399544 #11095]  INFO -- : Completed 200 OK in 24ms (Views: 0.2ms | ActiveRecord: 9.6ms)


D, [2018-09-12T23:20:18.401595 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:20:18.405772 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:20:19.964270 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T23:20:19.966039 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:20:19.966607 #11095]  INFO -- : Completed 200 OK in 5011ms (Views: 0.2ms | ActiveRecord: 1.6ms)


D, [2018-09-12T23:20:19.967975 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:20:19.969227 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:20:19.974045 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 23:20:19 +0530
I, [2018-09-12T23:20:19.988881 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:20:19 +0530
I, [2018-09-12T23:20:20.009715 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T23:20:20.009927 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:20:20.010070 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
I, [2018-09-12T23:20:20.012481 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:20:20.015375 #11095] DEBUG -- :   [1m[35m (2.8ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:20:20.016841 #11095] DEBUG -- :   [1m[35m (1.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:20:20.018678 #11095] DEBUG -- :   [1m[35m (1.9ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:20:20.020438 #11095] DEBUG -- :   [1m[35m (1.9ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:20:20.021324 #11095] DEBUG -- :   [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:20:20.024464 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:20:20.026985 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T23:20:20.028262 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:20:20.029006 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:20:20.029683 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:20:20.031924 #11095] DEBUG -- :   [1m[35mSQL (0.4ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:50:20.029000"], ["id", 1]]
D, [2018-09-12T23:20:20.039328 #11095] DEBUG -- :   [1m[35m (6.9ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:20:20.041526 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.4ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T23:20:20.042705 #11095] DEBUG -- :   [1m[36mChat Load (0.3ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T23:20:20.045387 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:48:20.044481')[0m  [["active", "t"]]
D, [2018-09-12T23:20:20.048840 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T23:20:20.049806 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T23:20:20.050510 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.2ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T23:20:20.051292 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T23:20:20.052306 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:48:20.051502')[0m  [["active", "t"]]
D, [2018-09-12T23:20:20.053187 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:48:20.052498')[0m  [["active", "t"]]
D, [2018-09-12T23:20:20.054353 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T23:20:20.055601 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:48:20.054610')[0m  [["active", "t"]]
D, [2018-09-12T23:20:20.056989 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:20:20.058189 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T23:20:20.064105 #11095] DEBUG -- :   [1m[36mSetting Load (2.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:20:20.065053 #11095]  INFO -- : Completed 200 OK in 55ms (Views: 0.2ms | ActiveRecord: 19.9ms)


D, [2018-09-12T23:20:20.068364 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:20:20.070420 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:20:21.027462 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T23:20:21.044517 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:20:21.045052 #11095]  INFO -- : Completed 200 OK in 1032ms (Views: 15.4ms | ActiveRecord: 4.0ms)


D, [2018-09-12T23:20:21.046107 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:20:21.046828 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:20:21.050428 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:20:21 +0530
I, [2018-09-12T23:20:21.065586 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:20:21.065748 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:20:21.068514 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:20:21.070030 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:20:28.076956 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:20:28.077410 #11095]  INFO -- : Completed 200 OK in 7012ms (Views: 0.2ms | ActiveRecord: 1.3ms)


D, [2018-09-12T23:20:28.078295 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:20:28.079001 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:20:28.082604 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:20:28 +0530
I, [2018-09-12T23:20:28.094326 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:20:28.094393 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:20:28.096587 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:20:28.098081 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:20:35.105358 #11095] DEBUG -- :   [1m[36mSetting Load (0.7ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:20:35.106105 #11095]  INFO -- : Completed 200 OK in 7011ms (Views: 0.7ms | ActiveRecord: 1.7ms)


D, [2018-09-12T23:20:35.107514 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:20:35.108687 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:20:35.114146 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:20:35 +0530
I, [2018-09-12T23:20:35.136972 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:20:35.137126 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:20:35.139857 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:20:35.141455 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:20:42.148693 #11095] DEBUG -- :   [1m[36mSetting Load (0.6ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:20:42.149362 #11095]  INFO -- : Completed 200 OK in 7012ms (Views: 0.3ms | ActiveRecord: 1.5ms)


D, [2018-09-12T23:20:42.150780 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:20:42.151819 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:20:42.156457 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:20:42 +0530
I, [2018-09-12T23:20:42.174085 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:20:42.174206 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:20:42.177717 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:20:42.179568 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:20:49.188515 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:20:49.190026 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.4ms | ActiveRecord: 2.1ms)


D, [2018-09-12T23:20:49.192998 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:20:49.195075 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:20:49.204062 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:20:49 +0530
I, [2018-09-12T23:20:49.231378 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:20:49.231475 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:20:49.234020 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:20:49.235581 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:20:56.244554 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:20:56.245722 #11095]  INFO -- : Completed 200 OK in 7014ms (Views: 0.4ms | ActiveRecord: 1.9ms)


D, [2018-09-12T23:20:56.248250 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:20:56.250053 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:20:56.257963 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:20:56 +0530
I, [2018-09-12T23:20:56.284346 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:20:56.284437 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:20:56.287065 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:20:56.288623 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:21:03.297114 #11095] DEBUG -- :   [1m[36mSetting Load (0.8ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:21:03.298097 #11095]  INFO -- : Completed 200 OK in 7013ms (Views: 0.5ms | ActiveRecord: 1.8ms)


D, [2018-09-12T23:21:03.299917 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:21:03.301342 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:21:03.307341 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:21:03 +0530
I, [2018-09-12T23:21:03.328225 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:21:03.328333 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:21:03.331483 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:21:03.332807 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:21:10.339803 #11095] DEBUG -- :   [1m[36mSetting Load (0.7ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:21:10.340471 #11095]  INFO -- : Completed 200 OK in 7012ms (Views: 0.3ms | ActiveRecord: 1.5ms)


D, [2018-09-12T23:21:10.341801 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:21:10.343039 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:21:10.347711 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:21:10 +0530
I, [2018-09-12T23:21:10.367824 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:21:10.367935 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:21:10.372253 #11095] DEBUG -- :   [1m[35m (1.2ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:21:10.374493 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T23:21:13.370947 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 23:21:13 +0530
I, [2018-09-12T23:21:13.387753 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T23:21:13.387833 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T23:21:13.390000 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:21:13.391306 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:21:13.392569 #11095] DEBUG -- :   [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:21:13.394010 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:21:13.395236 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T23:21:13.395949 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:21:13.396412 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:21:13.397600 #11095] DEBUG -- :   [1m[35mSQL (0.2ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:51:13.396000"], ["id", 1]]
D, [2018-09-12T23:21:13.402260 #11095] DEBUG -- :   [1m[35m (4.3ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:21:13.403906 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.6ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 09:51:13.402776')[0m
D, [2018-09-12T23:21:13.405271 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:21:13.405627 #11095]  INFO -- : Completed 200 OK in 18ms (Views: 0.1ms | ActiveRecord: 7.6ms)


D, [2018-09-12T23:21:13.406734 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:21:13.407395 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:21:15.384277 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T23:21:15.386339 #11095] DEBUG -- :   [1m[36mSetting Load (0.6ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:21:15.386956 #11095]  INFO -- : Completed 200 OK in 5019ms (Views: 0.3ms | ActiveRecord: 2.4ms)


D, [2018-09-12T23:21:15.388067 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:21:15.389356 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:21:15.393936 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 23:21:15 +0530
I, [2018-09-12T23:21:15.403214 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:21:15 +0530
I, [2018-09-12T23:21:15.413506 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T23:21:15.413905 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
I, [2018-09-12T23:21:15.417270 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:21:15.417344 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:21:15.419172 #11095] DEBUG -- :   [1m[35m (2.2ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:21:15.420298 #11095] DEBUG -- :   [1m[35m (1.1ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:21:15.421360 #11095] DEBUG -- :   [1m[35m (1.0ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:21:15.422666 #11095] DEBUG -- :   [1m[35m (1.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:21:15.423310 #11095] DEBUG -- :   [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:21:15.425000 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:21:15.426329 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T23:21:15.426982 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:21:15.427343 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:21:15.427764 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:21:15.429058 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:51:15.427000"], ["id", 1]]
D, [2018-09-12T23:21:15.430178 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:21:15.431283 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T23:21:15.432104 #11095] DEBUG -- :   [1m[36mChat Load (0.2ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T23:21:15.433743 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:49:15.433119')[0m  [["active", "t"]]
D, [2018-09-12T23:21:15.435869 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.2ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T23:21:15.436740 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T23:21:15.437295 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.2ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T23:21:15.437991 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T23:21:15.438816 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:49:15.438144')[0m  [["active", "t"]]
D, [2018-09-12T23:21:15.439437 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:49:15.438937')[0m  [["active", "t"]]
D, [2018-09-12T23:21:15.440158 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T23:21:15.440815 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:49:15.440292')[0m  [["active", "t"]]
D, [2018-09-12T23:21:15.441367 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:21:15.442160 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T23:21:15.444682 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:21:15.445195 #11095]  INFO -- : Completed 200 OK in 31ms (Views: 0.1ms | ActiveRecord: 9.4ms)


D, [2018-09-12T23:21:15.446342 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:21:15.447004 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:21:16.428183 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T23:21:16.435385 #11095] DEBUG -- :   [1m[36mSetting Load (1.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:21:16.436595 #11095]  INFO -- : Completed 200 OK in 1019ms (Views: 3.3ms | ActiveRecord: 4.0ms)


D, [2018-09-12T23:21:16.439046 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:21:16.441090 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:21:16.450626 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:21:16 +0530
I, [2018-09-12T23:21:16.475534 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:21:16.475664 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:21:16.478175 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:21:16.479722 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:21:23.487994 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:21:23.489503 #11095]  INFO -- : Completed 200 OK in 7013ms (Views: 0.5ms | ActiveRecord: 2.1ms)


D, [2018-09-12T23:21:23.492453 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:21:23.494617 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:21:23.503656 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:21:23 +0530
I, [2018-09-12T23:21:23.520924 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:21:23.521004 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:21:23.523411 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:21:23.525001 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:21:30.532937 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:21:30.533381 #11095]  INFO -- : Completed 200 OK in 7012ms (Views: 0.3ms | ActiveRecord: 1.4ms)


D, [2018-09-12T23:21:30.534165 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:21:30.534854 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:21:30.537845 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:21:30 +0530
I, [2018-09-12T23:21:30.549539 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:21:30.549604 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:21:30.551480 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:21:30.552726 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:21:37.560158 #11095] DEBUG -- :   [1m[36mSetting Load (1.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:21:37.560761 #11095]  INFO -- : Completed 200 OK in 7011ms (Views: 0.4ms | ActiveRecord: 2.0ms)


D, [2018-09-12T23:21:37.561954 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:21:37.563000 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:21:37.567219 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:21:37 +0530
I, [2018-09-12T23:21:37.583641 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:21:37.583761 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:21:37.586804 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:21:37.588614 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:21:44.597486 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:21:44.598809 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.4ms | ActiveRecord: 2.0ms)


D, [2018-09-12T23:21:44.601412 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:21:44.603998 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:21:44.613930 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:21:44 +0530
I, [2018-09-12T23:21:44.636422 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:21:44.636493 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:21:44.638761 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:21:44.640252 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:21:51.650228 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:21:51.651679 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T23:21:51.654280 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:21:51.656313 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:21:51.667024 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:21:51 +0530
I, [2018-09-12T23:21:51.693881 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:21:51.693959 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:21:51.696437 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:21:51.697926 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:21:58.705250 #11095] DEBUG -- :   [1m[36mSetting Load (0.8ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:21:58.706447 #11095]  INFO -- : Completed 200 OK in 7012ms (Views: 0.3ms | ActiveRecord: 1.7ms)


D, [2018-09-12T23:21:58.708643 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:21:58.710885 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:21:58.719484 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:21:58 +0530
I, [2018-09-12T23:21:58.743184 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:21:58.743278 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:21:58.745947 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:21:58.747589 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:22:05.756272 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:22:05.758041 #11095]  INFO -- : Completed 200 OK in 7014ms (Views: 0.4ms | ActiveRecord: 2.0ms)


D, [2018-09-12T23:22:05.760262 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:22:05.762149 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:22:05.766707 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:22:05 +0530
I, [2018-09-12T23:22:05.782632 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:22:05.782713 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:22:05.785697 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:22:05.787708 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T23:22:08.359927 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 23:22:08 +0530
I, [2018-09-12T23:22:08.381565 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T23:22:08.381687 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T23:22:08.384524 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:22:08.387118 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:22:08.390473 #11095] DEBUG -- :   [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:22:08.392968 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:22:08.394708 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T23:22:08.395585 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:22:08.396148 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:22:08.397700 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:52:08.395000"], ["id", 1]]
D, [2018-09-12T23:22:08.398909 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:22:08.400088 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 09:52:08.399413')[0m
D, [2018-09-12T23:22:08.401459 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:22:08.401888 #11095]  INFO -- : Completed 200 OK in 20ms (Views: 0.1ms | ActiveRecord: 4.7ms)


D, [2018-09-12T23:22:08.403039 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:22:08.403927 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:22:08.791840 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T23:22:08.793827 #11095] DEBUG -- :   [1m[36mSetting Load (0.6ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:22:08.794337 #11095]  INFO -- : Completed 200 OK in 3011ms (Views: 0.3ms | ActiveRecord: 1.7ms)


D, [2018-09-12T23:22:08.795398 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:22:08.796288 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:22:08.800090 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 23:22:08 +0530
I, [2018-09-12T23:22:08.812972 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:22:08 +0530
I, [2018-09-12T23:22:08.839897 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T23:22:08.840288 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
I, [2018-09-12T23:22:08.844181 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
D, [2018-09-12T23:22:08.844438 #11095] DEBUG -- :   [1m[35m (1.9ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
I, [2018-09-12T23:22:08.845471 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:22:08.847518 #11095] DEBUG -- :   [1m[35m (2.0ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:22:08.848615 #11095] DEBUG -- :   [1m[35m (1.1ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:22:08.849799 #11095] DEBUG -- :   [1m[36mUser Load (1.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:22:08.851709 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:22:08.853069 #11095] DEBUG -- :   [1m[35m (3.3ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:22:08.853852 #11095] DEBUG -- :   [1m[35m (1.0ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T23:22:08.854595 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:22:08.855015 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:22:08.855401 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:22:08.856800 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:52:08.855000"], ["id", 1]]
D, [2018-09-12T23:22:08.859792 #11095] DEBUG -- :   [1m[35m (2.7ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:22:08.861002 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T23:22:08.861885 #11095] DEBUG -- :   [1m[36mChat Load (0.2ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T23:22:08.863623 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:50:08.862997')[0m  [["active", "t"]]
D, [2018-09-12T23:22:08.865915 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.2ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T23:22:08.867257 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T23:22:08.868128 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T23:22:08.869441 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T23:22:08.871207 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:50:08.869764')[0m  [["active", "t"]]
D, [2018-09-12T23:22:08.872565 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:50:08.871583')[0m  [["active", "t"]]
D, [2018-09-12T23:22:08.874283 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T23:22:08.876187 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:50:08.874941')[0m  [["active", "t"]]
D, [2018-09-12T23:22:08.876948 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:22:08.877987 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T23:22:08.881433 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:22:08.881897 #11095]  INFO -- : Completed 200 OK in 41ms (Views: 0.1ms | ActiveRecord: 14.5ms)


D, [2018-09-12T23:22:08.883914 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:22:08.884766 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:22:09.855271 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T23:22:09.858199 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:22:09.858812 #11095]  INFO -- : Completed 200 OK in 1013ms (Views: 1.5ms | ActiveRecord: 4.9ms)


D, [2018-09-12T23:22:09.859940 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:22:09.861394 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:22:09.866941 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:22:09 +0530
I, [2018-09-12T23:22:09.886966 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:22:09.887041 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:22:09.889933 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:22:09.892430 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:22:16.899848 #11095] DEBUG -- :   [1m[36mSetting Load (0.6ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:22:16.900533 #11095]  INFO -- : Completed 200 OK in 7013ms (Views: 0.7ms | ActiveRecord: 1.9ms)


D, [2018-09-12T23:22:16.902128 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:22:16.903153 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:22:16.907889 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:22:16 +0530
I, [2018-09-12T23:22:16.935364 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:22:16.935469 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:22:16.939717 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:22:16.942253 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:22:23.950108 #11095] DEBUG -- :   [1m[36mSetting Load (0.8ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:22:23.951337 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.4ms | ActiveRecord: 2.3ms)


D, [2018-09-12T23:22:23.952934 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:22:23.954159 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:22:23.958673 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:22:23 +0530
I, [2018-09-12T23:22:23.972300 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:22:23.972384 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:22:23.977381 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:22:23.981194 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:22:30.990066 #11095] DEBUG -- :   [1m[36mSetting Load (0.6ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:22:30.990760 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.3ms | ActiveRecord: 2.2ms)


D, [2018-09-12T23:22:30.992212 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:22:30.993394 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:22:31.000432 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:22:31 +0530
I, [2018-09-12T23:22:31.014944 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:22:31.015019 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:22:31.017663 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:22:31.019420 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:22:38.027898 #11095] DEBUG -- :   [1m[36mSetting Load (0.7ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:22:38.029794 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.2ms | ActiveRecord: 1.8ms)


D, [2018-09-12T23:22:38.031135 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:22:38.032050 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:22:38.038700 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:22:38 +0530
I, [2018-09-12T23:22:38.050570 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:22:38.050637 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:22:38.052868 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:22:38.054306 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:22:45.062326 #11095] DEBUG -- :   [1m[36mSetting Load (0.8ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:22:45.062985 #11095]  INFO -- : Completed 200 OK in 7012ms (Views: 0.3ms | ActiveRecord: 1.6ms)


D, [2018-09-12T23:22:45.064331 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:22:45.065267 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:22:45.071375 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:22:45 +0530
I, [2018-09-12T23:22:45.087461 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:22:45.087576 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:22:45.090593 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:22:45.092365 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:22:52.098787 #11095] DEBUG -- :   [1m[36mSetting Load (0.7ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:22:52.100007 #11095]  INFO -- : Completed 200 OK in 7012ms (Views: 0.2ms | ActiveRecord: 1.8ms)


D, [2018-09-12T23:22:52.104038 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:22:52.106163 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:22:52.110075 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:22:52 +0530
I, [2018-09-12T23:22:52.131310 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:22:52.132240 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:22:52.141324 #11095] DEBUG -- :   [1m[35m (1.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:22:52.148501 #11095] DEBUG -- :   [1m[35m (1.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:22:59.155220 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:22:59.155780 #11095]  INFO -- : Completed 200 OK in 7023ms (Views: 0.2ms | ActiveRecord: 3.5ms)


D, [2018-09-12T23:22:59.156785 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:22:59.157592 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:22:59.161684 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:22:59 +0530
I, [2018-09-12T23:22:59.174736 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:22:59.174852 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:22:59.177320 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:22:59.179273 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T23:23:03.359290 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 23:23:03 +0530
I, [2018-09-12T23:23:03.374782 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T23:23:03.374893 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T23:23:03.377653 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:23:03.380180 #11095] DEBUG -- :   [1m[35m (1.0ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:23:03.383625 #11095] DEBUG -- :   [1m[36mUser Load (1.1ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:23:03.387572 #11095] DEBUG -- :   [1m[35mCACHE  (0.1ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:23:03.391020 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T23:23:03.393762 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.8ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:23:03.394418 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:23:03.396174 #11095] DEBUG -- :   [1m[35mSQL (0.4ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:53:03.394000"], ["id", 1]]
D, [2018-09-12T23:23:03.399333 #11095] DEBUG -- :   [1m[35m (2.7ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:23:03.400863 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 09:53:03.399909')[0m
D, [2018-09-12T23:23:03.402400 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:23:03.402858 #11095]  INFO -- : Completed 200 OK in 28ms (Views: 0.1ms | ActiveRecord: 8.3ms)


D, [2018-09-12T23:23:03.404118 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:23:03.405039 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:23:04.184760 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T23:23:04.187046 #11095] DEBUG -- :   [1m[36mSetting Load (0.7ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:23:04.187868 #11095]  INFO -- : Completed 200 OK in 5013ms (Views: 0.3ms | ActiveRecord: 1.9ms)


D, [2018-09-12T23:23:04.189743 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:23:04.190796 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:23:04.196206 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 23:23:04 +0530
I, [2018-09-12T23:23:04.208972 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:23:04 +0530
I, [2018-09-12T23:23:04.222674 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T23:23:04.222759 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
I, [2018-09-12T23:23:04.225657 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:23:04.227425 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:23:04.228647 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:23:04.232738 #11095] DEBUG -- :   [1m[35m (2.2ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:23:04.234724 #11095] DEBUG -- :   [1m[35m (2.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:23:04.237039 #11095] DEBUG -- :   [1m[36mUser Load (2.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:23:04.238965 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:23:04.240082 #11095] DEBUG -- :   [1m[35m (3.2ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:23:04.241054 #11095] DEBUG -- :   [1m[35m (1.0ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T23:23:04.242408 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:23:04.243134 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:23:04.243759 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:23:04.246701 #11095] DEBUG -- :   [1m[35mSQL (0.4ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:53:04.243000"], ["id", 1]]
D, [2018-09-12T23:23:04.248097 #11095] DEBUG -- :   [1m[35m (1.0ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:23:04.249677 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T23:23:04.250541 #11095] DEBUG -- :   [1m[36mChat Load (0.2ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T23:23:04.252547 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:51:04.251833')[0m  [["active", "t"]]
D, [2018-09-12T23:23:04.254836 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.2ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T23:23:04.255539 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T23:23:04.256159 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.2ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T23:23:04.256839 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T23:23:04.257720 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:51:04.257031')[0m  [["active", "t"]]
D, [2018-09-12T23:23:04.258532 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:51:04.257887')[0m  [["active", "t"]]
D, [2018-09-12T23:23:04.259513 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T23:23:04.260350 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:51:04.259686')[0m  [["active", "t"]]
D, [2018-09-12T23:23:04.261020 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:23:04.261949 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T23:23:04.265014 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:23:04.265555 #11095]  INFO -- : Completed 200 OK in 43ms (Views: 0.1ms | ActiveRecord: 11.9ms)


D, [2018-09-12T23:23:04.267949 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:23:04.268731 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:23:05.243117 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T23:23:05.246781 #11095] DEBUG -- :   [1m[36mSetting Load (0.7ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:23:05.247402 #11095]  INFO -- : Completed 200 OK in 1020ms (Views: 1.8ms | ActiveRecord: 6.2ms)


D, [2018-09-12T23:23:05.248684 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:23:05.249679 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:23:05.256196 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:23:05 +0530
I, [2018-09-12T23:23:05.271287 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:23:05.271369 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:23:05.274942 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:23:05.276949 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:23:12.285668 #11095] DEBUG -- :   [1m[36mSetting Load (0.7ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:23:12.286362 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.7ms | ActiveRecord: 1.9ms)


D, [2018-09-12T23:23:12.288120 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:23:12.289369 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:23:12.293866 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:23:12 +0530
I, [2018-09-12T23:23:12.307413 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:23:12.307510 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:23:12.309741 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:23:12.311036 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:23:19.316278 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:23:19.316724 #11095]  INFO -- : Completed 200 OK in 7009ms (Views: 0.2ms | ActiveRecord: 1.4ms)


D, [2018-09-12T23:23:19.317704 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:23:19.318500 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:23:19.322207 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:23:19 +0530
I, [2018-09-12T23:23:19.336576 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:23:19.336655 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:23:19.340161 #11095] DEBUG -- :   [1m[35m (1.1ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:23:19.342102 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:23:26.348431 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:23:26.348859 #11095]  INFO -- : Completed 200 OK in 7012ms (Views: 0.2ms | ActiveRecord: 2.1ms)


D, [2018-09-12T23:23:26.349691 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:23:26.350387 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:23:26.354537 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:23:26 +0530
I, [2018-09-12T23:23:26.365772 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:23:26.365841 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:23:26.367791 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:23:26.369088 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:23:33.373872 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:23:33.374411 #11095]  INFO -- : Completed 200 OK in 7008ms (Views: 0.2ms | ActiveRecord: 1.3ms)


D, [2018-09-12T23:23:33.375467 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:23:33.376331 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:23:33.380043 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:23:33 +0530
I, [2018-09-12T23:23:33.397415 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:23:33.397525 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:23:33.400675 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:23:33.402233 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:23:40.408388 #11095] DEBUG -- :   [1m[36mSetting Load (0.6ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:23:40.409321 #11095]  INFO -- : Completed 200 OK in 7012ms (Views: 0.3ms | ActiveRecord: 1.6ms)


D, [2018-09-12T23:23:40.410370 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:23:40.411143 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:23:40.415805 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:23:40 +0530
I, [2018-09-12T23:23:40.431250 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:23:40.431324 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:23:40.434255 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:23:40.437718 #11095] DEBUG -- :   [1m[35m (1.4ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:23:47.447979 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:23:47.450253 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.8ms | ActiveRecord: 3.3ms)


D, [2018-09-12T23:23:47.452175 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:23:47.453563 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:23:47.462173 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:23:47 +0530
I, [2018-09-12T23:23:47.482140 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:23:47.482225 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:23:47.485945 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:23:47.488254 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:23:54.499605 #11095] DEBUG -- :   [1m[36mSetting Load (1.6ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:23:54.501317 #11095]  INFO -- : Completed 200 OK in 7019ms (Views: 0.8ms | ActiveRecord: 2.7ms)


D, [2018-09-12T23:23:54.507421 #11095] DEBUG -- :   [1m[35m (1.8ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:23:54.509118 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:23:54.514462 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:23:54 +0530
I, [2018-09-12T23:23:54.529189 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:23:54.529268 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:23:54.532588 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:23:54.534220 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T23:23:58.364880 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 23:23:58 +0530
I, [2018-09-12T23:23:58.401744 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T23:23:58.401850 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T23:23:58.404441 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:23:58.406023 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:23:58.407397 #11095] DEBUG -- :   [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:23:58.409286 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:23:58.410824 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T23:23:58.411672 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:23:58.412309 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:23:58.413965 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:53:58.411000"], ["id", 1]]
D, [2018-09-12T23:23:58.415138 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:23:58.416436 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 09:53:58.415660')[0m
D, [2018-09-12T23:23:58.417900 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:23:58.418345 #11095]  INFO -- : Completed 200 OK in 16ms (Views: 0.1ms | ActiveRecord: 4.0ms)


D, [2018-09-12T23:23:58.419633 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:23:58.420635 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:23:59.538704 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T23:23:59.541726 #11095] DEBUG -- :   [1m[36mSetting Load (0.7ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:23:59.543174 #11095]  INFO -- : Completed 200 OK in 5014ms (Views: 0.7ms | ActiveRecord: 1.7ms)


D, [2018-09-12T23:23:59.545327 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:23:59.547199 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:23:59.552666 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 23:23:59 +0530
I, [2018-09-12T23:23:59.564406 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:23:59 +0530
I, [2018-09-12T23:23:59.576975 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T23:23:59.578344 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:23:59.578527 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
I, [2018-09-12T23:23:59.578629 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:23:59.582132 #11095] DEBUG -- :   [1m[35m (1.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:23:59.583323 #11095] DEBUG -- :   [1m[35m (1.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:23:59.584515 #11095] DEBUG -- :   [1m[35m (1.3ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:23:59.585603 #11095] DEBUG -- :   [1m[35m (1.2ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:23:59.586251 #11095] DEBUG -- :   [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:23:59.587833 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:23:59.589198 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T23:23:59.589955 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:23:59.590615 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:23:59.591166 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:23:59.594090 #11095] DEBUG -- :   [1m[35mSQL (0.8ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:53:59.590000"], ["id", 1]]
D, [2018-09-12T23:23:59.601559 #11095] DEBUG -- :   [1m[35m (6.8ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:23:59.603077 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T23:23:59.604069 #11095] DEBUG -- :   [1m[36mChat Load (0.2ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T23:23:59.605858 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:51:59.605247')[0m  [["active", "t"]]
D, [2018-09-12T23:23:59.608119 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.2ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T23:23:59.608806 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T23:23:59.609327 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.2ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T23:23:59.609977 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T23:23:59.610774 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:51:59.610150')[0m  [["active", "t"]]
D, [2018-09-12T23:23:59.611456 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:51:59.610908')[0m  [["active", "t"]]
D, [2018-09-12T23:23:59.612282 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T23:23:59.613065 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:51:59.612437')[0m  [["active", "t"]]
D, [2018-09-12T23:23:59.613631 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:23:59.614430 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.2ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T23:23:59.616754 #11095] DEBUG -- :   [1m[36mSetting Load (0.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:23:59.617106 #11095]  INFO -- : Completed 200 OK in 38ms (Views: 0.2ms | ActiveRecord: 15.3ms)


D, [2018-09-12T23:23:59.618358 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:23:59.619080 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:24:00.590359 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T23:24:00.596772 #11095] DEBUG -- :   [1m[36mSetting Load (0.7ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:24:00.597717 #11095]  INFO -- : Completed 200 OK in 1017ms (Views: 3.8ms | ActiveRecord: 3.1ms)


D, [2018-09-12T23:24:00.600384 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:24:00.602929 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:24:00.611938 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:24:00 +0530
I, [2018-09-12T23:24:00.631404 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:24:00.631475 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:24:00.633883 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:24:00.635384 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:24:07.643790 #11095] DEBUG -- :   [1m[36mSetting Load (0.7ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:24:07.645006 #11095]  INFO -- : Completed 200 OK in 7013ms (Views: 0.7ms | ActiveRecord: 1.6ms)


D, [2018-09-12T23:24:07.647364 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:24:07.648848 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:24:07.655776 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:24:07 +0530
I, [2018-09-12T23:24:07.674688 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:24:07.674853 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:24:07.678123 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:24:07.679940 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:24:14.687887 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:24:14.688431 #11095]  INFO -- : Completed 200 OK in 7013ms (Views: 0.7ms | ActiveRecord: 1.7ms)


D, [2018-09-12T23:24:14.689496 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:24:14.690237 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:24:14.693971 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:24:14 +0530
I, [2018-09-12T23:24:14.708349 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:24:14.708424 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:24:14.710677 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:24:14.712183 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:24:21.719088 #11095] DEBUG -- :   [1m[36mSetting Load (0.9ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:24:21.720224 #11095]  INFO -- : Completed 200 OK in 7012ms (Views: 0.3ms | ActiveRecord: 1.7ms)


D, [2018-09-12T23:24:21.722312 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:24:21.724055 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:24:21.731456 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:24:21 +0530
I, [2018-09-12T23:24:21.761443 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:24:21.761607 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:24:21.766221 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:24:21.768977 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:24:28.776205 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:24:28.776736 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.2ms | ActiveRecord: 1.6ms)


D, [2018-09-12T23:24:28.777579 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:24:28.778290 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:24:28.781389 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:24:28 +0530
I, [2018-09-12T23:24:28.793639 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:24:28.793713 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:24:28.798486 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:24:28.801988 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:24:35.808567 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:24:35.809058 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.2ms | ActiveRecord: 2.0ms)


D, [2018-09-12T23:24:35.809995 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:24:35.810743 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:24:35.814459 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:24:35 +0530
I, [2018-09-12T23:24:35.828214 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:24:35.828296 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:24:35.830582 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:24:35.832129 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:24:42.838867 #11095] DEBUG -- :   [1m[36mSetting Load (0.8ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:24:42.840614 #11095]  INFO -- : Completed 200 OK in 7012ms (Views: 0.3ms | ActiveRecord: 1.7ms)


D, [2018-09-12T23:24:42.843161 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:24:42.844441 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:24:42.852990 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:24:42 +0530
I, [2018-09-12T23:24:42.866849 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:24:42.866923 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:24:42.870890 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:24:42.873508 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:24:49.880891 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:24:49.882082 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.4ms | ActiveRecord: 2.7ms)


D, [2018-09-12T23:24:49.883467 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:24:49.884866 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:24:49.890773 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:24:49 +0530
I, [2018-09-12T23:24:49.906462 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:24:49.906534 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:24:49.908858 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:24:49.910827 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T23:24:53.358816 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 23:24:53 +0530
I, [2018-09-12T23:24:53.372988 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T23:24:53.373073 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T23:24:53.375461 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:24:53.376970 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:24:53.378265 #11095] DEBUG -- :   [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:24:53.381550 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:24:53.384026 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T23:24:53.385935 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.6ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:24:53.386551 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:24:53.388506 #11095] DEBUG -- :   [1m[35mSQL (0.5ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:54:53.386000"], ["id", 1]]
D, [2018-09-12T23:24:53.391726 #11095] DEBUG -- :   [1m[35m (2.7ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:24:53.393282 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 09:54:53.392382')[0m
D, [2018-09-12T23:24:53.394793 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:24:53.395219 #11095]  INFO -- : Completed 200 OK in 22ms (Views: 0.1ms | ActiveRecord: 6.7ms)


D, [2018-09-12T23:24:53.396850 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:24:53.397826 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:24:54.914033 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T23:24:54.915625 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:24:54.916080 #11095]  INFO -- : Completed 200 OK in 5009ms (Views: 0.2ms | ActiveRecord: 1.6ms)


D, [2018-09-12T23:24:54.917062 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:24:54.917821 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:24:54.922459 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:24:54 +0530
I, [2018-09-12T23:24:54.935736 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 23:24:54 +0530
I, [2018-09-12T23:24:54.949458 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:24:54.949584 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
I, [2018-09-12T23:24:54.953365 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
D, [2018-09-12T23:24:54.953564 #11095] DEBUG -- :   [1m[35m (1.9ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
I, [2018-09-12T23:24:54.953682 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
D, [2018-09-12T23:24:54.956620 #11095] DEBUG -- :   [1m[35m (1.8ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:24:54.957290 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:24:54.958878 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:24:54.960216 #11095] DEBUG -- :   [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:24:54.961863 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:24:54.963352 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T23:24:54.964134 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:24:54.964526 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:24:54.964992 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:24:54.966365 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:54:54.964000"], ["id", 1]]
D, [2018-09-12T23:24:54.973531 #11095] DEBUG -- :   [1m[35m (6.8ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:24:54.975818 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.9ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T23:24:54.977077 #11095] DEBUG -- :   [1m[36mChat Load (0.2ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T23:24:54.979498 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:52:54.978331')[0m  [["active", "t"]]
D, [2018-09-12T23:24:54.984128 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.4ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T23:24:54.985830 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T23:24:54.987699 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.4ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T23:24:54.988659 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T23:24:54.989701 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:52:54.988874')[0m  [["active", "t"]]
D, [2018-09-12T23:24:54.990540 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:52:54.989864')[0m  [["active", "t"]]
D, [2018-09-12T23:24:54.991561 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T23:24:54.992464 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:52:54.991738')[0m  [["active", "t"]]
D, [2018-09-12T23:24:54.993150 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:24:54.994052 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T23:24:54.996763 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:24:54.997237 #11095]  INFO -- : Completed 200 OK in 42ms (Views: 0.1ms | ActiveRecord: 15.3ms)


D, [2018-09-12T23:24:54.998506 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:24:54.999500 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:24:55.958858 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T23:24:55.962156 #11095] DEBUG -- :   [1m[36mSetting Load (0.6ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:24:55.962755 #11095]  INFO -- : Completed 200 OK in 1013ms (Views: 1.6ms | ActiveRecord: 4.3ms)


D, [2018-09-12T23:24:55.963943 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:24:55.964833 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:24:55.969522 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:24:55 +0530
I, [2018-09-12T23:24:55.989229 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:24:55.989365 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:24:55.993162 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:24:55.995151 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:25:03.004348 #11095] DEBUG -- :   [1m[36mSetting Load (2.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:25:03.006228 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.7ms | ActiveRecord: 3.0ms)


D, [2018-09-12T23:25:03.009354 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:25:03.011904 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:25:03.020939 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:25:03 +0530
I, [2018-09-12T23:25:03.037685 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:25:03.037764 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:25:03.040259 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:25:03.041746 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:25:10.047452 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:25:10.047978 #11095]  INFO -- : Completed 200 OK in 7010ms (Views: 0.2ms | ActiveRecord: 1.4ms)


D, [2018-09-12T23:25:10.048978 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:25:10.049822 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:25:10.053860 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:25:10 +0530
I, [2018-09-12T23:25:10.071477 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:25:10.071608 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:25:10.074385 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:25:10.075912 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:25:17.082203 #11095] DEBUG -- :   [1m[36mSetting Load (0.6ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:25:17.082941 #11095]  INFO -- : Completed 200 OK in 7011ms (Views: 0.2ms | ActiveRecord: 1.6ms)


D, [2018-09-12T23:25:17.084646 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:25:17.086872 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:25:17.094188 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:25:17 +0530
I, [2018-09-12T23:25:17.109976 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:25:17.110075 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:25:17.116022 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:25:17.120690 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:25:24.127900 #11095] DEBUG -- :   [1m[36mSetting Load (0.6ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:25:24.128694 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.3ms | ActiveRecord: 2.1ms)


D, [2018-09-12T23:25:24.130214 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:25:24.131201 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:25:24.135509 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:25:24 +0530
I, [2018-09-12T23:25:24.151978 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:25:24.152052 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:25:24.154586 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:25:24.156129 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:25:31.163755 #11095] DEBUG -- :   [1m[36mSetting Load (0.7ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:25:31.164890 #11095]  INFO -- : Completed 200 OK in 7013ms (Views: 0.3ms | ActiveRecord: 1.5ms)


D, [2018-09-12T23:25:31.166929 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:25:31.168456 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:25:31.175184 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:25:31 +0530
I, [2018-09-12T23:25:31.198768 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:25:31.198859 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:25:31.201779 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:25:31.203601 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:25:38.209055 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:25:38.209753 #11095]  INFO -- : Completed 200 OK in 7011ms (Views: 0.2ms | ActiveRecord: 1.6ms)


D, [2018-09-12T23:25:38.211089 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:25:38.212186 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:25:38.232254 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:25:38 +0530
I, [2018-09-12T23:25:38.251588 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:25:38.251734 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:25:38.255149 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:25:38.256711 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:25:45.262676 #11095] DEBUG -- :   [1m[36mSetting Load (0.7ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:25:45.263470 #11095]  INFO -- : Completed 200 OK in 7011ms (Views: 0.3ms | ActiveRecord: 1.5ms)


D, [2018-09-12T23:25:45.265119 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:25:45.266498 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:25:45.272865 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:25:45 +0530
I, [2018-09-12T23:25:45.293155 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:25:45.293262 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:25:45.297048 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:25:45.298745 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T23:25:48.358816 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 23:25:48 +0530
I, [2018-09-12T23:25:48.375735 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T23:25:48.375860 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T23:25:48.379002 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:25:48.381416 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:25:48.383279 #11095] DEBUG -- :   [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:25:48.385454 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:25:48.386937 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T23:25:48.387771 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:25:48.388384 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:25:48.390060 #11095] DEBUG -- :   [1m[35mSQL (0.5ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:55:48.388000"], ["id", 1]]
D, [2018-09-12T23:25:48.391258 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:25:48.392711 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 09:55:48.391839')[0m
D, [2018-09-12T23:25:48.394223 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:25:48.394620 #11095]  INFO -- : Completed 200 OK in 19ms (Views: 0.1ms | ActiveRecord: 4.5ms)


D, [2018-09-12T23:25:48.395827 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:25:48.396544 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:25:50.302424 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T23:25:50.303897 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:25:50.304297 #11095]  INFO -- : Completed 200 OK in 5011ms (Views: 0.2ms | ActiveRecord: 1.5ms)


D, [2018-09-12T23:25:50.305146 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:25:50.305816 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:25:50.309385 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 23:25:50 +0530
I, [2018-09-12T23:25:50.309430 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:25:50 +0530
I, [2018-09-12T23:25:50.332817 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T23:25:50.333015 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
I, [2018-09-12T23:25:50.336260 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:25:50.336343 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:25:50.337843 #11095] DEBUG -- :   [1m[35m (3.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:25:50.338770 #11095] DEBUG -- :   [1m[35m (1.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:25:50.339653 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:25:50.340593 #11095] DEBUG -- :   [1m[35m (1.1ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:25:50.341096 #11095] DEBUG -- :   [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:25:50.342469 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:25:50.343726 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T23:25:50.344433 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:25:50.344781 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:25:50.345162 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:25:50.346353 #11095] DEBUG -- :   [1m[35mSQL (0.2ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:55:50.344000"], ["id", 1]]
D, [2018-09-12T23:25:50.349220 #11095] DEBUG -- :   [1m[35m (2.6ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:25:50.350300 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T23:25:50.351040 #11095] DEBUG -- :   [1m[36mChat Load (0.2ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T23:25:50.352651 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:53:50.352101')[0m  [["active", "t"]]
D, [2018-09-12T23:25:50.354776 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.2ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T23:25:50.355413 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T23:25:50.356005 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.2ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T23:25:50.356718 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T23:25:50.357734 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:53:50.356946')[0m  [["active", "t"]]
D, [2018-09-12T23:25:50.358510 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:53:50.357885')[0m  [["active", "t"]]
D, [2018-09-12T23:25:50.359415 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T23:25:50.360221 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:53:50.359598')[0m  [["active", "t"]]
D, [2018-09-12T23:25:50.360792 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:25:50.361651 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T23:25:50.364895 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:25:50.365295 #11095]  INFO -- : Completed 200 OK in 32ms (Views: 0.1ms | ActiveRecord: 11.5ms)


D, [2018-09-12T23:25:50.367017 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:25:50.368188 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:25:51.343376 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T23:25:51.346185 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:25:51.346610 #11095]  INFO -- : Completed 200 OK in 1010ms (Views: 1.2ms | ActiveRecord: 2.6ms)


D, [2018-09-12T23:25:51.347573 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:25:51.348362 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:25:51.352394 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:25:51 +0530
I, [2018-09-12T23:25:51.363992 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:25:51.364060 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:25:51.366384 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:25:51.368833 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:25:58.378788 #11095] DEBUG -- :   [1m[36mSetting Load (0.6ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:25:58.379697 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.3ms | ActiveRecord: 1.7ms)


D, [2018-09-12T23:25:58.381620 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:25:58.382436 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:25:58.385959 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:25:58 +0530
I, [2018-09-12T23:25:58.402342 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:25:58.402440 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:25:58.405280 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:25:58.406886 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:26:05.419481 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:26:05.420918 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.5ms | ActiveRecord: 2.3ms)


D, [2018-09-12T23:26:05.423655 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:26:05.425940 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:26:05.436147 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:26:05 +0530
I, [2018-09-12T23:26:05.466642 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:26:05.466753 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:26:05.469667 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:26:05.471455 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:26:12.483642 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:26:12.484976 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T23:26:12.487712 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:26:12.489276 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:26:12.493140 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:26:12 +0530
I, [2018-09-12T23:26:12.507831 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:26:12.507918 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:26:12.510596 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:26:12.512512 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:26:19.525768 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:26:19.527222 #11095]  INFO -- : Completed 200 OK in 7019ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T23:26:19.530587 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:26:19.533100 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:26:19.542441 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:26:19 +0530
I, [2018-09-12T23:26:19.570440 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:26:19.570531 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:26:19.573213 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:26:19.574947 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:26:26.587672 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:26:26.588997 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.5ms | ActiveRecord: 2.3ms)


D, [2018-09-12T23:26:26.591699 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:26:26.593942 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:26:26.603408 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:26:26 +0530
I, [2018-09-12T23:26:26.633501 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:26:26.633613 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:26:26.636536 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:26:26.638363 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:26:33.650224 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:26:33.651682 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T23:26:33.654427 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:26:33.657178 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:26:33.666758 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:26:33 +0530
I, [2018-09-12T23:26:33.696221 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:26:33.696311 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:26:33.698939 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:26:33.700684 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:26:40.712204 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:26:40.713586 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T23:26:40.716385 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:26:40.718132 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:26:40.721710 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:26:40 +0530
I, [2018-09-12T23:26:40.735158 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:26:40.735229 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:26:40.737484 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:26:40.738958 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T23:26:43.363911 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 23:26:43 +0530
I, [2018-09-12T23:26:43.396098 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T23:26:43.396238 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T23:26:43.399017 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:26:43.400813 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:26:43.402103 #11095] DEBUG -- :   [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:26:43.403650 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:26:43.405002 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T23:26:43.405824 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:26:43.406387 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:26:43.407837 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:56:43.406000"], ["id", 1]]
D, [2018-09-12T23:26:43.409375 #11095] DEBUG -- :   [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:26:43.410530 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 09:56:43.409835')[0m
D, [2018-09-12T23:26:43.411893 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:26:43.412299 #11095]  INFO -- : Completed 200 OK in 16ms (Views: 0.1ms | ActiveRecord: 4.6ms)


D, [2018-09-12T23:26:43.413540 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:26:43.414248 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:26:43.743214 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T23:26:43.747346 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:26:43.748229 #11095]  INFO -- : Completed 200 OK in 3013ms (Views: 0.5ms | ActiveRecord: 2.1ms)


D, [2018-09-12T23:26:43.749399 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:26:43.750301 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:26:43.755686 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 23:26:43 +0530
I, [2018-09-12T23:26:43.769513 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:26:43 +0530
I, [2018-09-12T23:26:43.786184 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T23:26:43.786686 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
I, [2018-09-12T23:26:43.791119 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:26:43.791270 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:26:43.793614 #11095] DEBUG -- :   [1m[35m (4.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:26:43.795097 #11095] DEBUG -- :   [1m[35m (1.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:26:43.796498 #11095] DEBUG -- :   [1m[35m (1.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:26:43.797832 #11095] DEBUG -- :   [1m[35m (1.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:26:43.798722 #11095] DEBUG -- :   [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:26:43.801187 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:26:43.803392 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T23:26:43.805004 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.8ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:26:43.805677 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:26:43.806327 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:26:43.808398 #11095] DEBUG -- :   [1m[35mSQL (0.4ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:56:43.805000"], ["id", 1]]
D, [2018-09-12T23:26:43.812077 #11095] DEBUG -- :   [1m[35m (3.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:26:43.815706 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.8ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T23:26:43.818232 #11095] DEBUG -- :   [1m[36mChat Load (0.7ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T23:26:43.823444 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.7ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:54:43.821545')[0m  [["active", "t"]]
D, [2018-09-12T23:26:43.828695 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.5ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T23:26:43.830216 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T23:26:43.831269 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T23:26:43.832493 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T23:26:43.834003 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:54:43.832814')[0m  [["active", "t"]]
D, [2018-09-12T23:26:43.835153 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:54:43.834240')[0m  [["active", "t"]]
D, [2018-09-12T23:26:43.836794 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T23:26:43.837823 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:54:43.837036')[0m  [["active", "t"]]
D, [2018-09-12T23:26:43.838499 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:26:43.839509 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T23:26:43.842110 #11095] DEBUG -- :   [1m[36mSetting Load (0.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:26:43.842505 #11095]  INFO -- : Completed 200 OK in 56ms (Views: 0.1ms | ActiveRecord: 17.8ms)


D, [2018-09-12T23:26:43.843592 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:26:43.845878 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:26:44.803145 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T23:26:44.810821 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:26:44.812150 #11095]  INFO -- : Completed 200 OK in 1021ms (Views: 4.2ms | ActiveRecord: 4.2ms)


D, [2018-09-12T23:26:44.815738 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:26:44.819125 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:26:44.829961 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:26:44 +0530
I, [2018-09-12T23:26:44.857989 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:26:44.858078 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:26:44.860799 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:26:44.862662 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:26:51.870346 #11095] DEBUG -- :   [1m[36mSetting Load (0.9ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:26:51.871440 #11095]  INFO -- : Completed 200 OK in 7013ms (Views: 0.6ms | ActiveRecord: 2.0ms)


D, [2018-09-12T23:26:51.873839 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:26:51.875741 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:26:51.884592 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:26:51 +0530
I, [2018-09-12T23:26:51.916010 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:26:51.916121 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:26:51.918826 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:26:51.920850 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:26:58.931271 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:26:58.932658 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.7ms | ActiveRecord: 2.2ms)


D, [2018-09-12T23:26:58.935565 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:26:58.937689 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:26:58.947975 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:26:58 +0530
I, [2018-09-12T23:26:58.977529 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:26:58.977628 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:26:58.980209 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:26:58.981767 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:27:05.994845 #11095] DEBUG -- :   [1m[36mSetting Load (1.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:27:05.996774 #11095]  INFO -- : Completed 200 OK in 7019ms (Views: 1.2ms | ActiveRecord: 2.3ms)


D, [2018-09-12T23:27:05.999101 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:27:06.001110 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:27:06.007364 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:27:06 +0530
I, [2018-09-12T23:27:06.026488 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:27:06.026606 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:27:06.039259 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:27:06.042789 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:27:13.053130 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:27:13.054455 #11095]  INFO -- : Completed 200 OK in 7027ms (Views: 0.5ms | ActiveRecord: 2.3ms)


D, [2018-09-12T23:27:13.057115 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:27:13.059351 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:27:13.070325 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:27:13 +0530
I, [2018-09-12T23:27:13.101374 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:27:13.101477 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:27:13.104502 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:27:13.107780 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:27:20.121551 #11095] DEBUG -- :   [1m[36mSetting Load (1.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:27:20.122100 #11095]  INFO -- : Completed 200 OK in 7020ms (Views: 0.6ms | ActiveRecord: 2.6ms)


D, [2018-09-12T23:27:20.123177 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:27:20.124052 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:27:20.128217 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:27:20 +0530
I, [2018-09-12T23:27:20.144033 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:27:20.144141 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:27:20.147508 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:27:20.149351 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:27:27.160494 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:27:27.161902 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.5ms | ActiveRecord: 2.6ms)


D, [2018-09-12T23:27:27.164821 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:27:27.167169 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:27:27.177250 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:27:27 +0530
I, [2018-09-12T23:27:27.204561 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:27:27.204658 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:27:27.207318 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:27:27.208926 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:27:34.219739 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:27:34.221614 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.5ms | ActiveRecord: 2.1ms)


D, [2018-09-12T23:27:34.224697 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:27:34.227463 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:27:34.238416 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:27:34 +0530
I, [2018-09-12T23:27:34.269850 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:27:34.269960 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:27:34.273274 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:27:34.275310 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T23:27:38.364429 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 23:27:38 +0530
I, [2018-09-12T23:27:38.398319 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T23:27:38.398450 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T23:27:38.401854 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:27:38.403872 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:27:38.405487 #11095] DEBUG -- :   [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:27:38.407095 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:27:38.408540 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T23:27:38.409375 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:27:38.409965 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:27:38.411412 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:57:38.409000"], ["id", 1]]
D, [2018-09-12T23:27:38.412583 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:27:38.413708 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 09:57:38.413040')[0m
D, [2018-09-12T23:27:38.415093 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:27:38.415479 #11095]  INFO -- : Completed 200 OK in 17ms (Views: 0.1ms | ActiveRecord: 4.4ms)


D, [2018-09-12T23:27:38.416724 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:27:38.417474 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:27:39.282415 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T23:27:39.284528 #11095] DEBUG -- :   [1m[36mSetting Load (0.6ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:27:39.285153 #11095]  INFO -- : Completed 200 OK in 5015ms (Views: 0.4ms | ActiveRecord: 1.8ms)


D, [2018-09-12T23:27:39.286565 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:27:39.288685 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:27:39.294078 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 23:27:39 +0530
I, [2018-09-12T23:27:39.294176 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:27:39 +0530
I, [2018-09-12T23:27:39.318250 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T23:27:39.318336 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
I, [2018-09-12T23:27:39.321753 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:27:39.321854 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:27:39.322037 #11095] DEBUG -- :   [1m[35m (1.7ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:27:39.324718 #11095] DEBUG -- :   [1m[35m (1.1ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:27:39.325725 #11095] DEBUG -- :   [1m[35m (1.1ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:27:39.326779 #11095] DEBUG -- :   [1m[35m (1.1ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:27:39.327382 #11095] DEBUG -- :   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:27:39.328960 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:27:39.330376 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T23:27:39.331199 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:27:39.331613 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:27:39.332092 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:27:39.333509 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:57:39.331000"], ["id", 1]]
D, [2018-09-12T23:27:39.336545 #11095] DEBUG -- :   [1m[35m (2.7ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:27:39.337868 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T23:27:39.338805 #11095] DEBUG -- :   [1m[36mChat Load (0.3ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T23:27:39.340771 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:55:39.340010')[0m  [["active", "t"]]
D, [2018-09-12T23:27:39.343676 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.4ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T23:27:39.344536 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T23:27:39.345216 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T23:27:39.345989 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T23:27:39.346974 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:55:39.346169')[0m  [["active", "t"]]
D, [2018-09-12T23:27:39.347789 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:55:39.347127')[0m  [["active", "t"]]
D, [2018-09-12T23:27:39.348727 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T23:27:39.349580 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:55:39.348892')[0m  [["active", "t"]]
D, [2018-09-12T23:27:39.350197 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:27:39.351121 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T23:27:39.354249 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:27:39.354672 #11095]  INFO -- : Completed 200 OK in 36ms (Views: 0.1ms | ActiveRecord: 11.9ms)


D, [2018-09-12T23:27:39.355957 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:27:39.356830 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:27:40.331841 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T23:27:40.339088 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:27:40.340428 #11095]  INFO -- : Completed 200 OK in 1018ms (Views: 3.7ms | ActiveRecord: 3.3ms)


D, [2018-09-12T23:27:40.343136 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:27:40.345624 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:27:40.357173 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:27:40 +0530
I, [2018-09-12T23:27:40.372629 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:27:40.372704 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:27:40.374985 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:27:40.376521 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:27:47.387386 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:27:47.388845 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.6ms | ActiveRecord: 2.0ms)


D, [2018-09-12T23:27:47.391636 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:27:47.393933 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:27:47.408919 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:27:47 +0530
I, [2018-09-12T23:27:47.434429 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:27:47.434517 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:27:47.437139 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:27:47.438673 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:27:54.451873 #11095] DEBUG -- :   [1m[36mSetting Load (1.8ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:27:54.453621 #11095]  INFO -- : Completed 200 OK in 7019ms (Views: 0.5ms | ActiveRecord: 2.7ms)


D, [2018-09-12T23:27:54.456906 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:27:54.459179 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:27:54.468599 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:27:54 +0530
I, [2018-09-12T23:27:54.481544 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:27:54.481620 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:27:54.484356 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:27:54.486425 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:28:01.498079 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:28:01.499439 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.6ms | ActiveRecord: 2.2ms)


D, [2018-09-12T23:28:01.502167 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:28:01.504456 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:28:01.514562 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:28:01 +0530
I, [2018-09-12T23:28:01.543906 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:28:01.543994 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:28:01.546605 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:28:01.548303 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:28:08.559459 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:28:08.560866 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.5ms | ActiveRecord: 2.1ms)


D, [2018-09-12T23:28:08.563683 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:28:08.565946 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:28:08.577953 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:28:08 +0530
I, [2018-09-12T23:28:08.605350 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:28:08.605466 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:28:08.608107 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:28:08.609614 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:28:15.621488 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:28:15.622923 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T23:28:15.625695 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:28:15.627851 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:28:15.637333 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:28:15 +0530
I, [2018-09-12T23:28:15.667071 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:28:15.667211 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:28:15.670949 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:28:15.672807 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:28:22.682103 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:28:22.682576 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.2ms | ActiveRecord: 1.5ms)


D, [2018-09-12T23:28:22.683461 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:28:22.684551 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:28:22.689073 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:28:22 +0530
I, [2018-09-12T23:28:22.701722 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:28:22.701793 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:28:22.704035 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:28:22.705577 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:28:29.718755 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:28:29.720168 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T23:28:29.722885 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:28:29.724113 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:28:29.735325 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:28:29 +0530
I, [2018-09-12T23:28:29.751675 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:28:29.751787 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:28:29.754958 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:28:29.756526 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T23:28:33.363073 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 23:28:33 +0530
I, [2018-09-12T23:28:33.394045 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T23:28:33.394361 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T23:28:33.397287 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:28:33.398946 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:28:33.400328 #11095] DEBUG -- :   [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:28:33.401861 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:28:33.403174 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T23:28:33.403921 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:28:33.404412 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:28:33.405658 #11095] DEBUG -- :   [1m[35mSQL (0.2ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:58:33.404000"], ["id", 1]]
D, [2018-09-12T23:28:33.406685 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:28:33.407627 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 09:58:33.407083')[0m
D, [2018-09-12T23:28:33.409015 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:28:33.409608 #11095]  INFO -- : Completed 200 OK in 15ms (Views: 0.1ms | ActiveRecord: 3.7ms)


D, [2018-09-12T23:28:33.410966 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:28:33.411655 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:28:34.763385 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T23:28:34.767028 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:28:34.768308 #11095]  INFO -- : Completed 200 OK in 5016ms (Views: 0.5ms | ActiveRecord: 2.0ms)


D, [2018-09-12T23:28:34.770734 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:28:34.772728 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:28:34.782435 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 23:28:34 +0530
I, [2018-09-12T23:28:34.806578 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:28:34 +0530
I, [2018-09-12T23:28:34.821525 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T23:28:34.823385 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:28:34.823600 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
I, [2018-09-12T23:28:34.823969 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:28:34.828457 #11095] DEBUG -- :   [1m[35m (2.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:28:34.829726 #11095] DEBUG -- :   [1m[35m (1.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:28:34.830872 #11095] DEBUG -- :   [1m[35m (1.3ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:28:34.832068 #11095] DEBUG -- :   [1m[35m (1.3ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:28:34.832811 #11095] DEBUG -- :   [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:28:34.834822 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:28:34.836849 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T23:28:34.837745 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:28:34.838202 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:28:34.838650 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:28:34.840427 #11095] DEBUG -- :   [1m[35mSQL (0.4ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:58:34.838000"], ["id", 1]]
D, [2018-09-12T23:28:34.843534 #11095] DEBUG -- :   [1m[35m (2.8ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:28:34.845087 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.4ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T23:28:34.846147 #11095] DEBUG -- :   [1m[36mChat Load (0.3ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T23:28:34.848354 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:56:34.847559')[0m  [["active", "t"]]
D, [2018-09-12T23:28:34.851158 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T23:28:34.852149 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T23:28:34.852957 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T23:28:34.854091 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T23:28:34.855707 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:56:34.854339')[0m  [["active", "t"]]
D, [2018-09-12T23:28:34.856636 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:56:34.855910')[0m  [["active", "t"]]
D, [2018-09-12T23:28:34.857557 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T23:28:34.858339 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:56:34.857708')[0m  [["active", "t"]]
D, [2018-09-12T23:28:34.858913 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:28:34.859756 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T23:28:34.861948 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:28:34.862310 #11095]  INFO -- : Completed 200 OK in 38ms (Views: 0.1ms | ActiveRecord: 12.6ms)


D, [2018-09-12T23:28:34.863376 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:28:34.864299 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:28:35.836722 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T23:28:35.843556 #11095] DEBUG -- :   [1m[36mSetting Load (1.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:28:35.844729 #11095]  INFO -- : Completed 200 OK in 1018ms (Views: 3.4ms | ActiveRecord: 4.1ms)


D, [2018-09-12T23:28:35.847093 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:28:35.849225 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:28:35.859093 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:28:35 +0530
I, [2018-09-12T23:28:35.885370 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:28:35.885461 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:28:35.888118 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:28:35.889885 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:28:42.901320 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:28:42.902775 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T23:28:42.905614 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:28:42.907989 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:28:42.918257 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:28:42 +0530
I, [2018-09-12T23:28:42.956768 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:28:42.956849 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:28:42.959245 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:28:42.960973 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:28:49.973338 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:28:49.974750 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.4ms | ActiveRecord: 2.1ms)


D, [2018-09-12T23:28:49.977467 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:28:49.979705 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:28:49.989703 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:28:49 +0530
I, [2018-09-12T23:28:50.017286 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:28:50.017380 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:28:50.020108 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:28:50.021737 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:28:57.033826 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:28:57.035147 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.5ms | ActiveRecord: 2.1ms)


D, [2018-09-12T23:28:57.037902 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:28:57.040211 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:28:57.050978 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:28:57 +0530
I, [2018-09-12T23:28:57.082212 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:28:57.082337 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:28:57.085885 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:28:57.087802 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:29:04.099665 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:29:04.101009 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.5ms | ActiveRecord: 2.5ms)


D, [2018-09-12T23:29:04.103783 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:29:04.106087 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:29:04.116634 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:29:04 +0530
I, [2018-09-12T23:29:04.136930 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:29:04.137006 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:29:04.139339 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:29:04.140944 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:29:11.153036 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:29:11.154410 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.5ms | ActiveRecord: 1.9ms)


D, [2018-09-12T23:29:11.157040 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:29:11.159221 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:29:11.168680 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:29:11 +0530
I, [2018-09-12T23:29:11.202949 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:29:11.203063 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:29:11.207290 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:29:11.209963 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:29:18.221074 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:29:18.222449 #11095]  INFO -- : Completed 200 OK in 7019ms (Views: 0.5ms | ActiveRecord: 2.7ms)


D, [2018-09-12T23:29:18.225154 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:29:18.227402 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:29:18.236844 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:29:18 +0530
I, [2018-09-12T23:29:18.265332 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:29:18.265420 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:29:18.268043 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:29:18.269847 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:29:25.278963 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:29:25.280301 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.4ms | ActiveRecord: 2.3ms)


D, [2018-09-12T23:29:25.282649 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:29:25.283811 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:29:25.287200 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:29:25 +0530
I, [2018-09-12T23:29:25.300535 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:29:25.300612 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:29:25.302987 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:29:25.304568 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T23:29:28.362762 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 23:29:28 +0530
I, [2018-09-12T23:29:28.379732 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T23:29:28.379887 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T23:29:28.382688 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:29:28.384604 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:29:28.386209 #11095] DEBUG -- :   [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:29:28.388045 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:29:28.389747 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T23:29:28.390542 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:29:28.391265 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:29:28.392906 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:59:28.390000"], ["id", 1]]
D, [2018-09-12T23:29:28.394460 #11095] DEBUG -- :   [1m[35m (1.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:29:28.395891 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 09:59:28.395017')[0m
D, [2018-09-12T23:29:28.397476 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:29:28.397907 #11095]  INFO -- : Completed 200 OK in 18ms (Views: 0.1ms | ActiveRecord: 4.5ms)


D, [2018-09-12T23:29:28.399172 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:29:28.400005 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:29:30.310873 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T23:29:30.314868 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:29:30.316149 #11095]  INFO -- : Completed 200 OK in 5015ms (Views: 0.6ms | ActiveRecord: 2.0ms)


D, [2018-09-12T23:29:30.318748 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:29:30.320988 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:29:30.331388 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 23:29:30 +0530
I, [2018-09-12T23:29:30.332584 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:29:30 +0530
I, [2018-09-12T23:29:30.384803 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T23:29:30.386592 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:29:30.386698 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
I, [2018-09-12T23:29:30.386920 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:29:30.390277 #11095] DEBUG -- :   [1m[35m (1.1ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:29:30.391311 #11095] DEBUG -- :   [1m[35m (1.1ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:29:30.392826 #11095] DEBUG -- :   [1m[35m (1.3ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:29:30.394777 #11095] DEBUG -- :   [1m[35m (2.1ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:29:30.395606 #11095] DEBUG -- :   [1m[36mUser Load (1.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:29:30.397414 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:29:30.398951 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T23:29:30.399773 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:29:30.400228 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:29:30.400697 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:29:30.402119 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 17:59:30.400000"], ["id", 1]]
D, [2018-09-12T23:29:30.403302 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:29:30.404607 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T23:29:30.405500 #11095] DEBUG -- :   [1m[36mChat Load (0.3ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T23:29:30.407408 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:57:30.406692')[0m  [["active", "t"]]
D, [2018-09-12T23:29:30.409785 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T23:29:30.410600 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T23:29:30.411313 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.2ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T23:29:30.412066 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T23:29:30.413150 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:57:30.412266')[0m  [["active", "t"]]
D, [2018-09-12T23:29:30.413958 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:57:30.413318')[0m  [["active", "t"]]
D, [2018-09-12T23:29:30.414977 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T23:29:30.416216 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:57:30.415537')[0m  [["active", "t"]]
D, [2018-09-12T23:29:30.416830 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:29:30.417688 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T23:29:30.420039 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:29:30.420408 #11095]  INFO -- : Completed 200 OK in 34ms (Views: 0.1ms | ActiveRecord: 9.7ms)


D, [2018-09-12T23:29:30.421561 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:29:30.422294 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:29:31.397017 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T23:29:31.399554 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:29:31.399989 #11095]  INFO -- : Completed 200 OK in 1013ms (Views: 1.3ms | ActiveRecord: 3.6ms)


D, [2018-09-12T23:29:31.400828 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:29:31.402242 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:29:31.406692 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:29:31 +0530
I, [2018-09-12T23:29:31.418761 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:29:31.418827 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:29:31.421177 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:29:31.422594 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:29:38.433352 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:29:38.434766 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.5ms | ActiveRecord: 2.0ms)


D, [2018-09-12T23:29:38.437532 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:29:38.439948 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:29:38.449604 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:29:38 +0530
I, [2018-09-12T23:29:38.470081 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:29:38.470176 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:29:38.472605 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:29:38.474121 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:29:45.484978 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:29:45.486330 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.5ms | ActiveRecord: 2.1ms)


D, [2018-09-12T23:29:45.489712 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:29:45.490743 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:29:45.494769 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:29:45 +0530
I, [2018-09-12T23:29:45.509972 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:29:45.510061 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:29:45.512744 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:29:45.514572 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:29:52.529386 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:29:52.530789 #11095]  INFO -- : Completed 200 OK in 7020ms (Views: 0.5ms | ActiveRecord: 2.3ms)


D, [2018-09-12T23:29:52.533683 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:29:52.536084 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:29:52.545808 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:29:52 +0530
I, [2018-09-12T23:29:52.572818 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:29:52.572913 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:29:52.575679 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:29:52.577300 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:29:59.593802 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:29:59.595255 #11095]  INFO -- : Completed 200 OK in 7022ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T23:29:59.598007 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:29:59.601322 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:29:59.611202 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:29:59 +0530
I, [2018-09-12T23:29:59.627926 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:29:59.628007 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:29:59.630493 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:29:59.632084 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:30:06.645509 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:30:06.646839 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.5ms | ActiveRecord: 2.3ms)


D, [2018-09-12T23:30:06.649598 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:30:06.651802 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:30:06.662602 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:30:06 +0530
I, [2018-09-12T23:30:06.681014 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:30:06.681121 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:30:06.684571 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:30:06.686675 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:30:06.688231 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:30:06.690004 #11095] DEBUG -- :   [1m[35mSQL (0.4ms)[0m  [1m[32mINSERT INTO "delayed_jobs" ("handler", "run_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["handler", "--- !ruby/object:Observer::UserDeviceLogJob\nhttp_user_agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko)\n  Chrome/68.0.3440.106 Safari/537.36\nremote_ip: \"::1\"\nuser_id: 3\nfingerprint: \"-1992429858\"\ntype: session\n"], ["run_at", "2018-09-12 18:00:06.688422"], ["created_at", "2018-09-12 18:00:06.688000"], ["updated_at", "2018-09-12 18:00:06.688000"]]
D, [2018-09-12T23:30:06.693107 #11095] DEBUG -- :   [1m[35m (2.7ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:30:13.705679 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:30:13.707358 #11095]  INFO -- : Completed 200 OK in 7026ms (Views: 0.7ms | ActiveRecord: 6.0ms)


D, [2018-09-12T23:30:13.710983 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:30:13.714953 #11095] DEBUG -- :   [1m[35mSQL (0.8ms)[0m  [1m[33mUPDATE "sessions" SET "data" = $1, "updated_at" = $2 WHERE "sessions"."id" = $3[0m  [["data", "BAh7D0kiCXBpbmcGOgZFRkkiGTIwMTgtMDktMTJUMTY6MDk6MjZaBjsAVEki\nD3VzZXJfYWdlbnQGOwBGIm5Nb3ppbGxhLzUuMCAoWDExOyBMaW51eCB4ODZf\nNjQpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENo\ncm9tZS82OC4wLjM0NDAuMTA2IFNhZmFyaS81MzcuMzZJIhBfY3NyZl90b2tl\nbgY7AEZJIjE1SzlmTEZWTnRwVFYydjArWGQ1M21QMjFWbDAzT1RSeEp2cUpm\nbitDRDUwPQY7AEZJIgx1c2VyX2lkBjsARmkISSIadXNlcl9kZXZpY2VfcmVt\nb3RlX2lwBjsARiIIOjoxSSIcdXNlcl9kZXZpY2VfZmluZ2VycHJpbnQGOwBG\nSSIQLTE5OTI0Mjk4NTgGOwBUSSIbdXNlcl9kZXZpY2VfdXBkYXRlZF9hdAY7\nAEZVOiBBY3RpdmVTdXBwb3J0OjpUaW1lV2l0aFpvbmVbCEl1OglUaW1lDZKh\nHcDce2oACToJem9uZUkiCFVUQwY7AEY6DW5hbm9fbnVtaQLYAToNbmFub19k\nZW5pBjoNc3VibWljcm8iB0cgSSIIVVRDBjsAVEAWSSIPcGVyc2lzdGVudAY7\nAEZUSSIOcmVtb3RlX2lwBjsARiIIOjoxSSIIZ2VvBjsARnsA\n"], ["updated_at", "2018-09-12 18:00:13.711947"], ["id", 33]]
D, [2018-09-12T23:30:13.723352 #11095] DEBUG -- :   [1m[35m (7.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:30:13.733184 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:30:13 +0530
I, [2018-09-12T23:30:13.760026 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:30:13.760109 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:30:13.762793 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:30:13.764469 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:30:20.777354 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:30:20.778752 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T23:30:20.781563 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:30:20.783915 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:30:20.789688 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:30:20 +0530
I, [2018-09-12T23:30:20.802459 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:30:20.802536 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:30:20.804801 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:30:20.806369 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T23:30:23.365494 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 23:30:23 +0530
I, [2018-09-12T23:30:23.397901 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T23:30:23.398029 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T23:30:23.401187 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:30:23.402983 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:30:23.404502 #11095] DEBUG -- :   [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:30:23.406067 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:30:23.407478 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T23:30:23.408346 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:30:23.408940 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:30:23.410408 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 18:00:23.408000"], ["id", 1]]
D, [2018-09-12T23:30:23.418077 #11095] DEBUG -- :   [1m[35m (7.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:30:23.421784 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.8ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 10:00:23.419606')[0m
D, [2018-09-12T23:30:23.425218 #11095] DEBUG -- :   [1m[36mSetting Load (0.7ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:30:23.426037 #11095]  INFO -- : Completed 200 OK in 28ms (Views: 0.3ms | ActiveRecord: 11.4ms)


D, [2018-09-12T23:30:23.429059 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:30:23.430282 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:30:23.811892 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T23:30:23.815741 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:30:23.816553 #11095]  INFO -- : Completed 200 OK in 3014ms (Views: 0.5ms | ActiveRecord: 1.9ms)


D, [2018-09-12T23:30:23.817520 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:30:23.818521 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:30:23.823015 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 23:30:23 +0530
I, [2018-09-12T23:30:23.835193 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:30:23 +0530
I, [2018-09-12T23:30:23.849616 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T23:30:23.849703 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
I, [2018-09-12T23:30:23.851277 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:30:23.853390 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:30:23.855139 #11095] DEBUG -- :   [1m[35m (1.8ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:30:23.856384 #11095] DEBUG -- :   [1m[35m (1.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:30:23.857486 #11095] DEBUG -- :   [1m[35m (1.2ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:30:23.858555 #11095] DEBUG -- :   [1m[35m (1.2ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:30:23.859169 #11095] DEBUG -- :   [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:30:23.860920 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:30:23.862406 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T23:30:23.863224 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:30:23.863666 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:30:23.864151 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:30:23.865616 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 18:00:23.863000"], ["id", 1]]
D, [2018-09-12T23:30:23.868643 #11095] DEBUG -- :   [1m[35m (2.7ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:30:23.870013 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T23:30:23.871033 #11095] DEBUG -- :   [1m[36mChat Load (0.3ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T23:30:23.873777 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:58:23.872790')[0m  [["active", "t"]]
D, [2018-09-12T23:30:23.885162 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T23:30:23.885958 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T23:30:23.886569 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.2ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T23:30:23.887242 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T23:30:23.888134 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:58:23.887412')[0m  [["active", "t"]]
D, [2018-09-12T23:30:23.888883 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:58:23.888282')[0m  [["active", "t"]]
D, [2018-09-12T23:30:23.889737 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T23:30:23.890499 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:58:23.889916')[0m  [["active", "t"]]
D, [2018-09-12T23:30:23.890976 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:30:23.891741 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.2ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T23:30:23.894065 #11095] DEBUG -- :   [1m[36mSetting Load (0.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:30:23.894444 #11095]  INFO -- : Completed 200 OK in 43ms (Views: 0.1ms | ActiveRecord: 11.1ms)


D, [2018-09-12T23:30:23.895486 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:30:23.896225 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:30:24.864250 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T23:30:24.872854 #11095] DEBUG -- :   [1m[36mSetting Load (1.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:30:24.874232 #11095]  INFO -- : Completed 200 OK in 1021ms (Views: 4.1ms | ActiveRecord: 4.0ms)


D, [2018-09-12T23:30:24.877132 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:30:24.879368 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:30:24.892077 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:30:24 +0530
I, [2018-09-12T23:30:24.909310 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:30:24.909463 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:30:24.913738 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:30:24.916354 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:30:31.927468 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:30:31.928671 #11095]  INFO -- : Completed 200 OK in 7019ms (Views: 0.4ms | ActiveRecord: 2.3ms)


D, [2018-09-12T23:30:31.930910 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:30:31.932818 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:30:31.943903 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:30:31 +0530
I, [2018-09-12T23:30:31.954756 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:30:31.954817 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:30:31.956810 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:30:31.958325 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:30:38.970133 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:30:38.970630 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.7ms | ActiveRecord: 1.3ms)


D, [2018-09-12T23:30:38.971580 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:30:38.972340 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:30:38.976199 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:30:38 +0530
I, [2018-09-12T23:30:38.991068 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:30:38.991151 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:30:38.993710 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:30:38.995578 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:30:46.007951 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:30:46.009289 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.4ms | ActiveRecord: 2.2ms)


D, [2018-09-12T23:30:46.012087 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:30:46.014307 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:30:46.024272 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:30:46 +0530
I, [2018-09-12T23:30:46.039188 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:30:46.039259 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:30:46.042047 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:30:46.043583 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:30:53.055803 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:30:53.057190 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.5ms | ActiveRecord: 2.3ms)


D, [2018-09-12T23:30:53.060026 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:30:53.061689 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:30:53.066782 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:30:53 +0530
I, [2018-09-12T23:30:53.081463 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:30:53.081569 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:30:53.084263 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:30:53.086130 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:31:00.098723 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:31:00.099957 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.4ms | ActiveRecord: 2.1ms)


D, [2018-09-12T23:31:00.102422 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:31:00.104475 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:31:00.107583 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:31:00 +0530
I, [2018-09-12T23:31:00.119388 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:31:00.119455 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:31:00.121721 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:31:00.123118 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:31:07.135195 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:31:07.136643 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.5ms | ActiveRecord: 2.0ms)


D, [2018-09-12T23:31:07.137585 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:31:07.138300 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:31:07.141862 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:31:07 +0530
I, [2018-09-12T23:31:07.156365 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:31:07.156449 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:31:07.158957 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:31:07.160680 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:31:14.172158 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:31:14.173404 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.5ms | ActiveRecord: 2.0ms)


D, [2018-09-12T23:31:14.175810 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:31:14.177738 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:31:14.182078 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:31:14 +0530
I, [2018-09-12T23:31:14.195333 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:31:14.195411 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:31:14.197829 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:31:14.199446 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T23:31:18.363106 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 23:31:18 +0530
I, [2018-09-12T23:31:18.378298 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T23:31:18.378398 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T23:31:18.381039 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:31:18.382841 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:31:18.384453 #11095] DEBUG -- :   [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:31:18.386302 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:31:18.388002 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T23:31:18.388937 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:31:18.389607 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:31:18.391285 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 18:01:18.389000"], ["id", 1]]
D, [2018-09-12T23:31:18.392550 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:31:18.394131 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 10:01:18.393158')[0m
D, [2018-09-12T23:31:18.396418 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:31:18.396925 #11095]  INFO -- : Completed 200 OK in 18ms (Views: 0.2ms | ActiveRecord: 4.8ms)


D, [2018-09-12T23:31:18.398441 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:31:18.399364 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:31:19.208146 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T23:31:19.212179 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:31:19.213464 #11095]  INFO -- : Completed 200 OK in 5018ms (Views: 0.6ms | ActiveRecord: 2.2ms)


D, [2018-09-12T23:31:19.216160 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:31:19.217383 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:31:19.221528 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 23:31:19 +0530
I, [2018-09-12T23:31:19.233670 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:31:19 +0530
I, [2018-09-12T23:31:19.248928 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T23:31:19.249024 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
I, [2018-09-12T23:31:19.252812 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:31:19.252901 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:31:19.254878 #11095] DEBUG -- :   [1m[35m (3.7ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:31:19.256146 #11095] DEBUG -- :   [1m[35m (1.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:31:19.257364 #11095] DEBUG -- :   [1m[35m (1.3ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:31:19.258537 #11095] DEBUG -- :   [1m[35m (1.3ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:31:19.259298 #11095] DEBUG -- :   [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:31:19.261116 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:31:19.262708 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T23:31:19.263564 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:31:19.264034 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:31:19.264557 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:31:19.266420 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 18:01:19.264000"], ["id", 1]]
D, [2018-09-12T23:31:19.274043 #11095] DEBUG -- :   [1m[35m (7.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:31:19.276145 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.5ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T23:31:19.277379 #11095] DEBUG -- :   [1m[36mChat Load (0.3ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T23:31:19.279919 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:59:19.278962')[0m  [["active", "t"]]
D, [2018-09-12T23:31:19.282986 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T23:31:19.284039 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T23:31:19.284880 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T23:31:19.285897 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T23:31:19.287098 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:59:19.286149')[0m  [["active", "t"]]
D, [2018-09-12T23:31:19.288177 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:59:19.287293')[0m  [["active", "t"]]
D, [2018-09-12T23:31:19.289369 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T23:31:19.290409 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 17:59:19.289590')[0m  [["active", "t"]]
D, [2018-09-12T23:31:19.291203 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:31:19.292343 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.4ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T23:31:19.295466 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:31:19.296063 #11095]  INFO -- : Completed 200 OK in 47ms (Views: 0.2ms | ActiveRecord: 19.4ms)


D, [2018-09-12T23:31:19.297861 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:31:19.299133 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:31:20.265734 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T23:31:20.273063 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:31:20.274419 #11095]  INFO -- : Completed 200 OK in 1021ms (Views: 3.9ms | ActiveRecord: 3.8ms)


D, [2018-09-12T23:31:20.277083 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:31:20.279203 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:31:20.289607 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:31:20 +0530
I, [2018-09-12T23:31:20.317628 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:31:20.317719 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:31:20.320492 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:31:20.322131 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:31:27.336724 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:31:27.338078 #11095]  INFO -- : Completed 200 OK in 7020ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T23:31:27.340929 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:31:27.343230 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:31:27.351226 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:31:27 +0530
I, [2018-09-12T23:31:27.366667 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:31:27.366759 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:31:27.370237 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:31:27.372316 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:31:34.388209 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:31:34.389561 #11095]  INFO -- : Completed 200 OK in 7022ms (Views: 0.6ms | ActiveRecord: 2.8ms)


D, [2018-09-12T23:31:34.392377 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:31:34.394658 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:31:34.404679 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:31:34 +0530
I, [2018-09-12T23:31:34.438537 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:31:34.438665 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:31:34.441849 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:31:34.443669 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:31:41.456498 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:31:41.457916 #11095]  INFO -- : Completed 200 OK in 7019ms (Views: 0.5ms | ActiveRecord: 2.3ms)


D, [2018-09-12T23:31:41.460683 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:31:41.462936 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:31:41.472725 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:31:41 +0530
I, [2018-09-12T23:31:41.502472 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:31:41.502579 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:31:41.505304 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:31:41.507044 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:31:48.521501 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:31:48.522911 #11095]  INFO -- : Completed 200 OK in 7020ms (Views: 0.5ms | ActiveRecord: 2.0ms)


D, [2018-09-12T23:31:48.523840 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:31:48.524618 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:31:48.528581 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:31:48 +0530
I, [2018-09-12T23:31:48.543594 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:31:48.543680 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:31:48.546377 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:31:48.548221 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:31:55.560334 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:31:55.561670 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.4ms | ActiveRecord: 2.2ms)


D, [2018-09-12T23:31:55.564507 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:31:55.567856 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:31:55.577349 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:31:55 +0530
I, [2018-09-12T23:31:55.604876 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:31:55.604966 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:31:55.607848 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:31:55.609353 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:32:02.621358 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:32:02.622815 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T23:32:02.625685 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:32:02.628876 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:32:02.636698 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:32:02 +0530
I, [2018-09-12T23:32:02.649801 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:32:02.649873 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:32:02.653003 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:32:02.655205 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:32:09.667744 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:32:09.668970 #11095]  INFO -- : Completed 200 OK in 7019ms (Views: 0.4ms | ActiveRecord: 2.2ms)


D, [2018-09-12T23:32:09.671518 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:32:09.673317 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:32:09.676855 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:32:09 +0530
I, [2018-09-12T23:32:09.689240 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:32:09.689310 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:32:09.691575 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:32:09.693084 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T23:32:13.363314 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 23:32:13 +0530
I, [2018-09-12T23:32:13.385112 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T23:32:13.385266 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T23:32:13.388111 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:32:13.389756 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:32:13.391187 #11095] DEBUG -- :   [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:32:13.393202 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:32:13.395545 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T23:32:13.404915 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:32:13.405651 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:32:13.407555 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 18:02:13.405000"], ["id", 1]]
D, [2018-09-12T23:32:13.408753 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:32:13.410001 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 10:02:13.409256')[0m
D, [2018-09-12T23:32:13.411463 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:32:13.411901 #11095]  INFO -- : Completed 200 OK in 26ms (Views: 0.1ms | ActiveRecord: 4.5ms)


D, [2018-09-12T23:32:13.413169 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:32:13.414093 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:32:14.701674 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T23:32:14.705272 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:32:14.706542 #11095]  INFO -- : Completed 200 OK in 5017ms (Views: 0.5ms | ActiveRecord: 1.9ms)


D, [2018-09-12T23:32:14.709073 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:32:14.710453 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:32:14.715094 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 23:32:14 +0530
I, [2018-09-12T23:32:14.726920 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:32:14 +0530
I, [2018-09-12T23:32:14.738367 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T23:32:14.739763 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:32:14.739866 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
I, [2018-09-12T23:32:14.740010 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:32:14.743244 #11095] DEBUG -- :   [1m[35m (1.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:32:14.744280 #11095] DEBUG -- :   [1m[35m (1.1ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:32:14.745169 #11095] DEBUG -- :   [1m[35m (1.0ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:32:14.745791 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:32:14.746806 #11095] DEBUG -- :   [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:32:14.748191 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:32:14.749345 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T23:32:14.749971 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:32:14.750306 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:32:14.750654 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:32:14.751814 #11095] DEBUG -- :   [1m[35mSQL (0.2ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 18:02:14.750000"], ["id", 1]]
D, [2018-09-12T23:32:14.755017 #11095] DEBUG -- :   [1m[35m (2.8ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:32:14.758354 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.7ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T23:32:14.760704 #11095] DEBUG -- :   [1m[36mChat Load (0.6ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T23:32:14.766463 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.7ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 18:00:14.764196')[0m  [["active", "t"]]
D, [2018-09-12T23:32:14.771702 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.4ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T23:32:14.773021 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T23:32:14.774046 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.4ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T23:32:14.775015 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T23:32:14.776229 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 18:00:14.775247')[0m  [["active", "t"]]
D, [2018-09-12T23:32:14.777220 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 18:00:14.776430')[0m  [["active", "t"]]
D, [2018-09-12T23:32:14.778373 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T23:32:14.779365 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 18:00:14.778629')[0m  [["active", "t"]]
D, [2018-09-12T23:32:14.780025 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:32:14.780980 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T23:32:14.784130 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:32:14.784514 #11095]  INFO -- : Completed 200 OK in 44ms (Views: 0.2ms | ActiveRecord: 11.3ms)


D, [2018-09-12T23:32:14.785623 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:32:14.786343 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:32:15.750282 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T23:32:15.757193 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:32:15.758544 #11095]  INFO -- : Completed 200 OK in 1018ms (Views: 3.6ms | ActiveRecord: 3.0ms)


D, [2018-09-12T23:32:15.761644 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:32:15.764651 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:32:15.775453 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:32:15 +0530
I, [2018-09-12T23:32:15.804762 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:32:15.804850 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:32:15.808280 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:32:15.810292 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:32:22.817918 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:32:22.818369 #11095]  INFO -- : Completed 200 OK in 7013ms (Views: 0.2ms | ActiveRecord: 1.6ms)


D, [2018-09-12T23:32:22.819294 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:32:22.820294 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:32:22.824027 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:32:22 +0530
I, [2018-09-12T23:32:22.836211 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:32:22.836290 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:32:22.838447 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:32:22.839868 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:32:29.849735 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:32:29.851121 #11095]  INFO -- : Completed 200 OK in 7014ms (Views: 0.5ms | ActiveRecord: 1.8ms)


D, [2018-09-12T23:32:29.852031 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:32:29.852783 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:32:29.856701 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:32:29 +0530
I, [2018-09-12T23:32:29.872687 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:32:29.872783 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:32:29.875672 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:32:29.877764 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:32:36.887832 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:32:36.889237 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.5ms | ActiveRecord: 2.5ms)


D, [2018-09-12T23:32:36.891919 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:32:36.893523 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:32:36.897705 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:32:36 +0530
I, [2018-09-12T23:32:36.911279 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:32:36.911360 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:32:36.913594 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:32:36.915094 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:32:43.925759 #11095] DEBUG -- :   [1m[36mSetting Load (1.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:32:43.927440 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.5ms | ActiveRecord: 2.3ms)


D, [2018-09-12T23:32:43.930490 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:32:43.933141 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:32:43.942676 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:32:43 +0530
I, [2018-09-12T23:32:43.959557 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:32:43.959637 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:32:43.962046 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:32:43.963588 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:32:50.978648 #11095] DEBUG -- :   [1m[36mSetting Load (1.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:32:50.980150 #11095]  INFO -- : Completed 200 OK in 7020ms (Views: 0.6ms | ActiveRecord: 2.4ms)


D, [2018-09-12T23:32:50.982896 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:32:50.985271 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:32:50.995299 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:32:50 +0530
I, [2018-09-12T23:32:51.026284 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:32:51.026393 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:32:51.029330 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:32:51.031178 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:32:58.047142 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:32:58.048634 #11095]  INFO -- : Completed 200 OK in 7022ms (Views: 0.4ms | ActiveRecord: 2.2ms)


D, [2018-09-12T23:32:58.049547 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:32:58.050240 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:32:58.054020 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:32:58 +0530
I, [2018-09-12T23:32:58.066979 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:32:58.067047 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:32:58.069146 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:32:58.070546 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:33:05.087275 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:33:05.088657 #11095]  INFO -- : Completed 200 OK in 7021ms (Views: 0.5ms | ActiveRecord: 2.0ms)


D, [2018-09-12T23:33:05.091397 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:33:05.092580 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:33:05.096818 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:33:05 +0530
I, [2018-09-12T23:33:05.111714 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:33:05.111819 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:33:05.114487 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:33:05.116327 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T23:33:08.364537 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 23:33:08 +0530
I, [2018-09-12T23:33:08.377672 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T23:33:08.377754 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T23:33:08.380050 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:33:08.381565 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:33:08.382886 #11095] DEBUG -- :   [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:33:08.384426 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:33:08.385818 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T23:33:08.386616 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:33:08.387173 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:33:08.388618 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 18:03:08.386000"], ["id", 1]]
D, [2018-09-12T23:33:08.389778 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:33:08.390922 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 10:03:08.390244')[0m
D, [2018-09-12T23:33:08.392420 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:33:08.392822 #11095]  INFO -- : Completed 200 OK in 15ms (Views: 0.1ms | ActiveRecord: 4.0ms)


D, [2018-09-12T23:33:08.394197 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:33:08.395187 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:33:10.127042 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T23:33:10.128554 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:33:10.129072 #11095]  INFO -- : Completed 200 OK in 5017ms (Views: 0.2ms | ActiveRecord: 1.5ms)


D, [2018-09-12T23:33:10.130086 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:33:10.130917 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:33:10.135190 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 23:33:10 +0530
I, [2018-09-12T23:33:10.149015 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:33:10 +0530
I, [2018-09-12T23:33:10.166021 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T23:33:10.166146 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
I, [2018-09-12T23:33:10.170526 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:33:10.170630 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:33:10.172914 #11095] DEBUG -- :   [1m[35m (4.2ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:33:10.174375 #11095] DEBUG -- :   [1m[35m (1.6ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:33:10.175730 #11095] DEBUG -- :   [1m[35m (1.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:33:10.177150 #11095] DEBUG -- :   [1m[35m (1.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:33:10.177962 #11095] DEBUG -- :   [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:33:10.180069 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:33:10.181959 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T23:33:10.182985 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.4ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:33:10.183546 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:33:10.184217 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:33:10.186195 #11095] DEBUG -- :   [1m[35mSQL (0.4ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 18:03:10.183000"], ["id", 1]]
D, [2018-09-12T23:33:10.187897 #11095] DEBUG -- :   [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:33:10.189892 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.5ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T23:33:10.191172 #11095] DEBUG -- :   [1m[36mChat Load (0.3ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T23:33:10.193802 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 18:01:10.192879')[0m  [["active", "t"]]
D, [2018-09-12T23:33:10.196936 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T23:33:10.197894 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T23:33:10.198680 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T23:33:10.199619 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T23:33:10.200781 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 18:01:10.199831')[0m  [["active", "t"]]
D, [2018-09-12T23:33:10.201762 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 18:01:10.200965')[0m  [["active", "t"]]
D, [2018-09-12T23:33:10.202898 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T23:33:10.203890 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 18:01:10.203103')[0m  [["active", "t"]]
D, [2018-09-12T23:33:10.204527 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:33:10.205472 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T23:33:10.208117 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:33:10.208543 #11095]  INFO -- : Completed 200 OK in 42ms (Views: 0.1ms | ActiveRecord: 14.1ms)


D, [2018-09-12T23:33:10.209721 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:33:10.210489 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:33:11.183823 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T23:33:11.186412 #11095] DEBUG -- :   [1m[36mSetting Load (0.5ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:33:11.186872 #11095]  INFO -- : Completed 200 OK in 1016ms (Views: 1.3ms | ActiveRecord: 3.7ms)


D, [2018-09-12T23:33:11.187824 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:33:11.188589 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:33:11.192840 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:33:11 +0530
I, [2018-09-12T23:33:11.206580 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:33:11.206659 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:33:11.209127 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:33:11.210798 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:33:18.223340 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:33:18.224702 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.6ms | ActiveRecord: 2.1ms)


D, [2018-09-12T23:33:18.227395 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:33:18.229883 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:33:18.238929 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:33:18 +0530
I, [2018-09-12T23:33:18.265747 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:33:18.265854 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:33:18.268656 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:33:18.270370 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:33:25.289615 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:33:25.290826 #11095]  INFO -- : Completed 200 OK in 7025ms (Views: 0.4ms | ActiveRecord: 2.1ms)


D, [2018-09-12T23:33:25.293180 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:33:25.296030 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:33:25.305400 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:33:25 +0530
I, [2018-09-12T23:33:25.333154 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:33:25.333260 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:33:25.335973 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:33:25.337677 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:33:32.352961 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:33:32.354145 #11095]  INFO -- : Completed 200 OK in 7021ms (Views: 0.5ms | ActiveRecord: 2.0ms)


D, [2018-09-12T23:33:32.356850 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:33:32.358304 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:33:32.363709 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:33:32 +0530
I, [2018-09-12T23:33:32.375024 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:33:32.375085 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:33:32.377077 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:33:32.378392 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:33:39.390181 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:33:39.391398 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.4ms | ActiveRecord: 1.8ms)


D, [2018-09-12T23:33:39.393819 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:33:39.395508 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:33:39.401431 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:33:39 +0530
I, [2018-09-12T23:33:39.413022 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:33:39.413092 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:33:39.415389 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:33:39.416902 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:33:46.430504 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:33:46.431917 #11095]  INFO -- : Completed 200 OK in 7018ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T23:33:46.434674 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:33:46.437020 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:33:46.446828 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:33:46 +0530
I, [2018-09-12T23:33:46.479016 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:33:46.479166 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:33:46.482071 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:33:46.483935 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:33:53.498041 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:33:53.499407 #11095]  INFO -- : Completed 200 OK in 7020ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T23:33:53.502193 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:33:53.504486 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:33:53.514475 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:33:53 +0530
I, [2018-09-12T23:33:53.554850 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:33:53.554921 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:33:53.557378 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:33:53.559005 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:34:00.568880 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:34:00.570268 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.5ms | ActiveRecord: 2.2ms)


D, [2018-09-12T23:34:00.573012 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:34:00.574542 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:34:00.578443 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:34:00 +0530
I, [2018-09-12T23:34:00.591619 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:34:00.591695 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:34:00.594013 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:34:00.595633 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T23:34:03.363941 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 23:34:03 +0530
I, [2018-09-12T23:34:03.379158 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T23:34:03.379252 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T23:34:03.381455 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:34:03.382915 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:34:03.384244 #11095] DEBUG -- :   [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:34:03.385796 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:34:03.387158 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T23:34:03.387996 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:34:03.388548 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:34:03.389919 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 18:04:03.388000"], ["id", 1]]
D, [2018-09-12T23:34:03.391069 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:34:03.392323 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 10:04:03.391572')[0m
D, [2018-09-12T23:34:03.393894 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:34:03.394707 #11095]  INFO -- : Completed 200 OK in 15ms (Views: 0.1ms | ActiveRecord: 4.0ms)


D, [2018-09-12T23:34:03.396186 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:34:03.397001 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:34:03.599655 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T23:34:03.603638 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:34:03.604970 #11095]  INFO -- : Completed 200 OK in 3013ms (Views: 0.6ms | ActiveRecord: 2.2ms)


D, [2018-09-12T23:34:03.607639 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:34:03.609836 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:34:03.620461 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:34:03 +0530
I, [2018-09-12T23:34:03.633890 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 23:34:03 +0530
I, [2018-09-12T23:34:03.646024 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:34:03.647475 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T23:34:03.647643 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
I, [2018-09-12T23:34:03.647810 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
D, [2018-09-12T23:34:03.651816 #11095] DEBUG -- :   [1m[35m (1.7ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:34:03.652963 #11095] DEBUG -- :   [1m[35m (1.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:34:03.653985 #11095] DEBUG -- :   [1m[35m (1.1ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:34:03.654673 #11095] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:34:03.655889 #11095] DEBUG -- :   [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:34:03.657936 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:34:03.659512 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T23:34:03.660809 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:34:03.661287 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:34:03.661781 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:34:03.663277 #11095] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 18:04:03.661000"], ["id", 1]]
D, [2018-09-12T23:34:03.666367 #11095] DEBUG -- :   [1m[35m (2.8ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:34:03.667717 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.4ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T23:34:03.668631 #11095] DEBUG -- :   [1m[36mChat Load (0.3ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T23:34:03.670489 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 18:02:03.669786')[0m  [["active", "t"]]
D, [2018-09-12T23:34:03.672908 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T23:34:03.673713 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T23:34:03.674375 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T23:34:03.675138 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T23:34:03.676061 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 18:02:03.675315')[0m  [["active", "t"]]
D, [2018-09-12T23:34:03.676873 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 18:02:03.676219')[0m  [["active", "t"]]
D, [2018-09-12T23:34:03.677758 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T23:34:03.678532 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 18:02:03.677922')[0m  [["active", "t"]]
D, [2018-09-12T23:34:03.679135 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:34:03.680031 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.3ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T23:34:03.683091 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:34:03.683511 #11095]  INFO -- : Completed 200 OK in 33ms (Views: 0.1ms | ActiveRecord: 10.6ms)


D, [2018-09-12T23:34:03.684741 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:34:03.685573 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:34:04.658582 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T23:34:04.662257 #11095] DEBUG -- :   [1m[36mSetting Load (0.6ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:34:04.662723 #11095]  INFO -- : Completed 200 OK in 1015ms (Views: 2.1ms | ActiveRecord: 3.3ms)


D, [2018-09-12T23:34:04.663766 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:34:04.664672 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:34:04.669552 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:34:04 +0530
I, [2018-09-12T23:34:04.686734 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:34:04.686837 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:34:04.690555 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:34:04.692862 #11095] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:34:11.704796 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:34:11.706213 #11095]  INFO -- : Completed 200 OK in 7019ms (Views: 0.5ms | ActiveRecord: 3.0ms)


D, [2018-09-12T23:34:11.709055 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:34:11.711373 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:34:11.721331 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:34:11 +0530
I, [2018-09-12T23:34:11.754912 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:34:11.755059 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:34:11.758217 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:34:11.760311 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:34:18.771425 #11095] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:34:18.772853 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.5ms | ActiveRecord: 2.3ms)


D, [2018-09-12T23:34:18.775753 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:34:18.778031 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:34:18.787955 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:34:18 +0530
I, [2018-09-12T23:34:18.818264 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:34:18.818378 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:34:18.820977 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:34:18.822579 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:34:25.833324 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:34:25.834656 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.5ms | ActiveRecord: 2.0ms)


D, [2018-09-12T23:34:25.837413 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:34:25.839727 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:34:25.849943 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:34:25 +0530
I, [2018-09-12T23:34:25.880070 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:34:25.880204 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:34:25.882914 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:34:25.884708 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:34:32.902317 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:34:32.903628 #11095]  INFO -- : Completed 200 OK in 7023ms (Views: 0.4ms | ActiveRecord: 2.0ms)


D, [2018-09-12T23:34:32.906082 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:34:32.908853 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:34:32.917885 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:34:32 +0530
I, [2018-09-12T23:34:32.946592 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:34:32.946685 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:34:32.949328 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:34:32.951260 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:34:39.962120 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:34:39.963347 #11095]  INFO -- : Completed 200 OK in 7016ms (Views: 0.5ms | ActiveRecord: 2.0ms)


D, [2018-09-12T23:34:39.965898 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:34:39.967717 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:34:39.976650 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:34:39 +0530
I, [2018-09-12T23:34:40.008080 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:34:40.008238 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:34:40.011342 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:34:40.013002 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:34:47.019795 #11095] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:34:47.020227 #11095]  INFO -- : Completed 200 OK in 7012ms (Views: 0.2ms | ActiveRecord: 1.4ms)


D, [2018-09-12T23:34:47.021122 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:34:47.021805 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:34:47.024878 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:34:47 +0530
I, [2018-09-12T23:34:47.036209 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:34:47.036274 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:34:47.038216 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:34:47.039471 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:34:54.049642 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:34:54.050824 #11095]  INFO -- : Completed 200 OK in 7014ms (Views: 0.4ms | ActiveRecord: 1.7ms)


D, [2018-09-12T23:34:54.053314 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:34:54.055338 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:34:54.064068 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:34:54 +0530
I, [2018-09-12T23:34:54.094206 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:34:54.094339 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:34:54.097379 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:34:54.099359 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
I, [2018-09-12T23:34:58.364846 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 23:34:58 +0530
I, [2018-09-12T23:34:58.396864 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T23:34:58.396993 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_agent_state", "data"=>{"active"=>true}}}
D, [2018-09-12T23:34:58.400258 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:34:58.401968 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:34:58.403477 #11095] DEBUG -- :   [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:34:58.405205 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:34:58.406532 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T23:34:58.407288 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:34:58.407819 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:34:58.409164 #11095] DEBUG -- :   [1m[35mSQL (0.2ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 18:04:58.407000"], ["id", 1]]
D, [2018-09-12T23:34:58.416170 #11095] DEBUG -- :   [1m[35m (6.7ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:34:58.417205 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.3ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE (active = 't' OR updated_at > '2018-09-12 10:04:58.416554')[0m
D, [2018-09-12T23:34:58.418502 #11095] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:34:58.418854 #11095]  INFO -- : Completed 200 OK in 22ms (Views: 0.1ms | ActiveRecord: 9.8ms)


D, [2018-09-12T23:34:58.420001 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:34:58.420650 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:34:59.105389 #11095] DEBUG -- : send [{"event"=>"chat_agent_state", "data"=>{"state"=>"ok", "active"=>true}}] to 668100529
D, [2018-09-12T23:34:59.108889 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:34:59.110085 #11095]  INFO -- : Completed 200 OK in 5015ms (Views: 0.5ms | ActiveRecord: 2.0ms)


D, [2018-09-12T23:34:59.112775 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:34:59.114185 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:34:59.117804 #11095]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-12 23:34:59 +0530
I, [2018-09-12T23:34:59.126369 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:34:59 +0530
I, [2018-09-12T23:34:59.136339 #11095]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-12T23:34:59.136678 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529", "data"=>{"event"=>"chat_status_agent"}}
I, [2018-09-12T23:34:59.139629 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:34:59.139692 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:34:59.141110 #11095] DEBUG -- :   [1m[35m (2.8ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:34:59.141998 #11095] DEBUG -- :   [1m[35m (1.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:34:59.142775 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:34:59.143601 #11095] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:34:59.144089 #11095] DEBUG -- :   [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT  "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:34:59.145332 #11095] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:34:59.146533 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('chat','chat.agent') AND permissions.active = 't')[0m
D, [2018-09-12T23:34:59.147149 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:34:59.147503 #11095] DEBUG -- :   [1m[36mCACHE Chat::Agent Load (0.0ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:34:59.147859 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:34:59.148949 #11095] DEBUG -- :   [1m[35mSQL (0.2ms)[0m  [1m[33mUPDATE "chat_agents" SET "updated_at" = $1 WHERE "chat_agents"."id" = $2[0m  [["updated_at", "2018-09-12 18:04:59.147000"], ["id", 1]]
D, [2018-09-12T23:34:59.155710 #11095] DEBUG -- :   [1m[35m (6.5ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:34:59.156749 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.2ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY created_at ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T23:34:59.157420 #11095] DEBUG -- :   [1m[36mChat Load (0.2ms)[0m  [1m[34mSELECT "chats".* FROM "chats" WHERE "chats"."active" = $1[0m  [["active", "t"]]
D, [2018-09-12T23:34:59.158836 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 18:02:59.158325')[0m  [["active", "t"]]
D, [2018-09-12T23:34:59.160879 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.2ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T23:34:59.161460 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T23:34:59.161929 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.2ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = 'waiting'[0m
D, [2018-09-12T23:34:59.162467 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" = 'running'[0m
D, [2018-09-12T23:34:59.163130 #11095] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 18:02:59.162603')[0m  [["active", "t"]]
D, [2018-09-12T23:34:59.163775 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 18:02:59.163263')[0m  [["active", "t"]]
D, [2018-09-12T23:34:59.164580 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "chat_sessions" WHERE "chat_sessions"."state" IN ('waiting', 'running')[0m
D, [2018-09-12T23:34:59.165318 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.2ms)[0m  [1m[34mSELECT "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."active" = $1 AND (updated_at > '2018-09-12 18:02:59.164718')[0m  [["active", "t"]]
D, [2018-09-12T23:34:59.166219 #11095] DEBUG -- :   [1m[36mChat::Agent Load (0.5ms)[0m  [1m[34mSELECT  "chat_agents".* FROM "chat_agents" WHERE "chat_agents"."updated_by_id" = $1 LIMIT $2[0m  [["updated_by_id", 3], ["LIMIT", 1]]
D, [2018-09-12T23:34:59.167121 #11095] DEBUG -- :   [1m[36mChat::Session Load (0.2ms)[0m  [1m[34mSELECT "chat_sessions".* FROM "chat_sessions" WHERE "chat_sessions"."state" = $1 AND "chat_sessions"."user_id" = $2 ORDER BY "chat_sessions"."created_at" ASC[0m  [["state", "running"], ["user_id", 3]]
D, [2018-09-12T23:34:59.169298 #11095] DEBUG -- :   [1m[36mSetting Load (0.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:34:59.169634 #11095]  INFO -- : Completed 200 OK in 33ms (Views: 0.1ms | ActiveRecord: 15.1ms)


D, [2018-09-12T23:34:59.170596 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:34:59.171327 #11095] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-12T23:35:00.148931 #11095] DEBUG -- : send [{"event"=>"chat_status_agent", "data"=>{"waiting_chat_count"=>0, "waiting_chat_session_list"=>[], "running_chat_count"=>0, "running_chat_session_list"=>[], "active_agent_count"=>1, "active_agent_ids"=>[3], "seads_available"=>5, "seads_total"=>5, "active"=>true, "assets"=>{"Chat"=>{"1"=>{"id"=>1, "name"=>"default", "max_queue"=>5, "note"=>"", "active"=>true, "public"=>false, "block_ip"=>nil, "block_country"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:27.469Z", "updated_at"=>"2018-09-02T13:50:27.469Z"}}, "User"=>{"1"=>{"id"=>1, "organization_id"=>nil, "login"=>"-", "firstname"=>"-", "lastname"=>"", "email"=>"", "image"=>nil, "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "active"=>false, "note"=>"", "last_login"=>nil, "source"=>nil, "login_failed"=>0, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.224Z", "updated_at"=>"2018-09-02T13:50:20.224Z", "role_ids"=>[], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{}, "accounts"=>{}}, "3"=>{"active"=>true, "login_failed"=>0, "login"=>"vaibhav.dkm@gmail.com", "last_login"=>"2018-09-12T16:09:03.061Z", "id"=>3, "firstname"=>"Vaibhav", "lastname"=>"Maheshwari", "email"=>"vaibhav.dkm@gmail.com", "organization_id"=>nil, "image"=>"e8f60b313a33d58e7d328e1f65123476", "image_source"=>nil, "web"=>"", "phone"=>"", "fax"=>"", "mobile"=>"", "department"=>"", "street"=>"", "zip"=>"", "city"=>"", "country"=>"", "address"=>"", "vip"=>false, "verified"=>false, "note"=>"", "source"=>nil, "out_of_office"=>false, "out_of_office_start_at"=>nil, "out_of_office_end_at"=>nil, "out_of_office_replacement_id"=>nil, "preferences"=>{"notification_config"=>{"matrix"=>{"create"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "update"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>true, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "reminder_reached"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}, "escalation"=>{"criteria"=>{"owned_by_me"=>true, "owned_by_nobody"=>false, "no"=>false}, "channel"=>{"email"=>true, "online"=>true}}}}, "locale"=>"en-us", "intro"=>true, "tickets_open"=>5, "tickets_closed"=>0, "chat"=>{"active"=>{"1"=>"on"}}}, "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T14:03:13.274Z", "updated_at"=>"2018-09-12T16:09:03.081Z", "role_ids"=>[1, 2], "organization_ids"=>[], "authorization_ids"=>[], "group_ids"=>{"1"=>["full"]}, "accounts"=>{}}}, "Role"=>{"1"=>{"id"=>1, "name"=>"Admin", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To configure your system.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.512Z", "updated_at"=>"2018-09-02T13:50:20.512Z", "permission_ids"=>[1, 33, 43], "group_ids"=>{}}, "2"=>{"id"=>2, "name"=>"Agent", "preferences"=>{"not"=>["Customer"]}, "default_at_signup"=>false, "active"=>true, "note"=>"To work on Tickets.", "updated_by_id"=>1, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.521Z", "updated_at"=>"2018-09-02T13:50:20.521Z", "permission_ids"=>[33, 45, 48, 50], "group_ids"=>{}}}, "Group"=>{"1"=>{"id"=>1, "signature_id"=>1, "email_address_id"=>1, "name"=>"Users", "assignment_timeout"=>nil, "follow_up_possible"=>"yes", "follow_up_assignment"=>true, "active"=>true, "note"=>"Standard Group/Pool for Tickets.", "updated_by_id"=>3, "created_by_id"=>1, "created_at"=>"2018-09-02T13:50:20.864Z", "updated_at"=>"2018-09-07T13:52:36.578Z", "user_ids"=>[3, 4, 5, 52]}}}, "active_sessions"=>[]}}] to 668100529
D, [2018-09-12T23:35:00.155329 #11095] DEBUG -- :   [1m[36mSetting Load (1.1ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:35:00.156610 #11095]  INFO -- : Completed 200 OK in 1017ms (Views: 3.3ms | ActiveRecord: 2.9ms)


D, [2018-09-12T23:35:00.159106 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:35:00.161222 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:35:00.171326 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:35:00 +0530
I, [2018-09-12T23:35:00.197554 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:35:00.197639 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:35:00.200317 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:35:00.201991 #11095] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:35:07.211243 #11095] DEBUG -- :   [1m[36mSetting Load (1.0ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:35:07.212557 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.5ms | ActiveRecord: 1.9ms)


D, [2018-09-12T23:35:07.215016 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:35:07.216908 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:35:07.220023 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:35:07 +0530
I, [2018-09-12T23:35:07.230561 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:35:07.230632 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:35:07.232531 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:35:07.233728 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:35:14.243643 #11095] DEBUG -- :   [1m[36mSetting Load (1.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:35:14.246111 #11095]  INFO -- : Completed 200 OK in 7015ms (Views: 0.5ms | ActiveRecord: 2.1ms)


D, [2018-09-12T23:35:14.249584 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:35:14.251724 #11095] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-12T23:35:14.262993 #11095]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-12 23:35:14 +0530
I, [2018-09-12T23:35:14.296196 #11095]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-12T23:35:14.296410 #11095]  INFO -- :   Parameters: {"client_id"=>"668100529"}
D, [2018-09-12T23:35:14.299443 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT "roles".id FROM "roles" INNER JOIN "roles_users" ON "roles"."id" = "roles_users"."role_id" WHERE "roles_users"."user_id" = $1[0m  [["user_id", 3]]
D, [2018-09-12T23:35:14.301111 #11095] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT "permissions"."preferences" FROM "permissions" INNER JOIN "permissions_roles" ON "permissions_roles"."permission_id" = "permissions"."id" INNER JOIN "roles" ON "roles"."id" = "permissions_roles"."role_id" WHERE (roles.id IN (1,2) AND roles.active = 't' AND permissions.name IN ('user_preferences','user_preferences.device') AND permissions.active = 't')[0m
D, [2018-09-12T23:35:21.312393 #11095] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-12T23:35:21.313811 #11095]  INFO -- : Completed 200 OK in 7017ms (Views: 0.5ms | ActiveRecord: 2.3ms)


D, [2018-09-12T23:35:21.316811 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-12T23:35:21.319136 #11095] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-15T16:41:39.942310 #11195] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mSHOW server_version;[0m
D, [2018-09-15T16:41:39.992002 #11195] DEBUG -- :   [1m[36mStore Load (2.7ms)[0m  [1m[34mSELECT "stores".* FROM "stores" WHERE "stores"."store_object_id" = 3 AND "stores"."o_id" = $1 ORDER BY created_at ASC, id ASC[0m  [["o_id", 2]]
D, [2018-09-15T16:41:40.003579 #11195] DEBUG -- :   [1m[36mStore Load (0.2ms)[0m  [1m[34mSELECT  "stores".* FROM "stores" WHERE "stores"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
D, [2018-09-15T16:41:40.007097 #11195] DEBUG -- :   [1m[36mStore::File Load (1.5ms)[0m  [1m[34mSELECT  "store_files".* FROM "store_files" WHERE "store_files"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-15T16:41:40.016676 #11195] DEBUG -- :   [1m[36mStore::Provider::DB Load (2.1ms)[0m  [1m[34mSELECT  "store_provider_dbs".* FROM "store_provider_dbs" WHERE "store_provider_dbs"."sha" = $1 LIMIT $2[0m  [["sha", "8180fbd3b72f3fbf6e4e22d187ee0632ad7b63f72c6bcf22e59ed4d0ba381b24"], ["LIMIT", 1]]
D, [2018-09-15T16:41:40.023826 #11195] DEBUG -- :   [1m[36mSetting Load (1.5ms)[0m  [1m[34mSELECT  "settings".* FROM "settings" WHERE "settings"."name" = $1 LIMIT $2[0m  [["name", "product_logo"], ["LIMIT", 1]]
D, [2018-09-15T16:41:40.032624 #11195] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-15T16:41:40.044880 #11195] DEBUG -- : Setting.reset_change_id: set new cache, 98864516
D, [2018-09-15T16:41:40.045530 #11195] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-15T16:41:40.046320 #11195]  INFO -- : Setting.set('product_logo', "73a4aa758e6629c9ad420d2e312af0a0.png")
D, [2018-09-15T16:41:40.046745 #11195] DEBUG -- :   [1m[36mStore::File Load (0.2ms)[0m  [1m[34mSELECT  "store_files".* FROM "store_files" WHERE "store_files"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-15T16:41:40.047252 #11195] DEBUG -- :   [1m[36mStore::Provider::DB Load (0.2ms)[0m  [1m[34mSELECT  "store_provider_dbs".* FROM "store_provider_dbs" WHERE "store_provider_dbs"."sha" = $1 LIMIT $2[0m  [["sha", "8180fbd3b72f3fbf6e4e22d187ee0632ad7b63f72c6bcf22e59ed4d0ba381b24"], ["LIMIT", 1]]
D, [2018-09-15T16:41:40.047864 #11195] DEBUG -- :   [1m[36mStore::File Load (0.2ms)[0m  [1m[34mSELECT  "store_files".* FROM "store_files" WHERE "store_files"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-15T16:41:40.048323 #11195] DEBUG -- :   [1m[36mStore::Provider::DB Load (0.2ms)[0m  [1m[34mSELECT  "store_provider_dbs".* FROM "store_provider_dbs" WHERE "store_provider_dbs"."sha" = $1 LIMIT $2[0m  [["sha", "8180fbd3b72f3fbf6e4e22d187ee0632ad7b63f72c6bcf22e59ed4d0ba381b24"], ["LIMIT", 1]]
D, [2018-09-15T16:41:40.873200 #11195] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT  "settings"."updated_at" FROM "settings" ORDER BY "settings"."updated_at" DESC LIMIT $1[0m  [["LIMIT", 1]]
D, [2018-09-15T16:41:40.873844 #11195] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT "settings"."name", "settings"."state_current" FROM "settings" ORDER BY "settings"."id" ASC[0m
D, [2018-09-15T16:41:40.884405 #11195] DEBUG -- :   [1m[36mSetting Load (0.2ms)[0m  [1m[34mSELECT  "settings".* FROM "settings" WHERE "settings"."name" = $1 LIMIT $2[0m  [["name", "models_searchable"], ["LIMIT", 1]]
D, [2018-09-18T22:48:21.740753 #5903] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mSHOW server_version;[0m
D, [2018-09-18T22:48:21.811455 #5903] DEBUG -- :   [1m[36mStore::Object Load (2.1ms)[0m  [1m[34mSELECT  "store_objects".* FROM "store_objects" WHERE "store_objects"."name" = $1 LIMIT $2[0m  [["name", "System::Logo"], ["LIMIT", 1]]
D, [2018-09-18T22:48:21.830960 #5903] DEBUG -- :   [1m[36mStore Load (1.9ms)[0m  [1m[34mSELECT "stores".* FROM "stores" WHERE "stores"."store_object_id" = 3 AND "stores"."o_id" = $1 ORDER BY created_at ASC, id ASC[0m  [["o_id", 2]]
D, [2018-09-18T22:48:21.844362 #5903] DEBUG -- :   [1m[36mStore Load (0.2ms)[0m  [1m[34mSELECT  "stores".* FROM "stores" WHERE "stores"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
D, [2018-09-18T22:48:21.849007 #5903] DEBUG -- :   [1m[36mStore::File Load (1.5ms)[0m  [1m[34mSELECT  "store_files".* FROM "store_files" WHERE "store_files"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-18T22:48:21.863270 #5903] DEBUG -- :   [1m[36mStore::Provider::DB Load (2.4ms)[0m  [1m[34mSELECT  "store_provider_dbs".* FROM "store_provider_dbs" WHERE "store_provider_dbs"."sha" = $1 LIMIT $2[0m  [["sha", "8180fbd3b72f3fbf6e4e22d187ee0632ad7b63f72c6bcf22e59ed4d0ba381b24"], ["LIMIT", 1]]
D, [2018-09-18T22:48:21.874380 #5903] DEBUG -- :   [1m[36mSetting Load (1.9ms)[0m  [1m[34mSELECT  "settings".* FROM "settings" WHERE "settings"."name" = $1 LIMIT $2[0m  [["name", "product_logo"], ["LIMIT", 1]]
D, [2018-09-18T22:48:21.888952 #5903] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-18T22:48:21.905846 #5903] DEBUG -- : Setting.reset_change_id: set new cache, 869919574
D, [2018-09-18T22:48:21.907006 #5903] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-18T22:48:21.908414 #5903]  INFO -- : Setting.set('product_logo', "73a4aa758e6629c9ad420d2e312af0a0.png")
D, [2018-09-18T22:48:21.909131 #5903] DEBUG -- :   [1m[36mStore::File Load (0.3ms)[0m  [1m[34mSELECT  "store_files".* FROM "store_files" WHERE "store_files"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-18T22:48:21.909997 #5903] DEBUG -- :   [1m[36mStore::Provider::DB Load (0.3ms)[0m  [1m[34mSELECT  "store_provider_dbs".* FROM "store_provider_dbs" WHERE "store_provider_dbs"."sha" = $1 LIMIT $2[0m  [["sha", "8180fbd3b72f3fbf6e4e22d187ee0632ad7b63f72c6bcf22e59ed4d0ba381b24"], ["LIMIT", 1]]
D, [2018-09-18T22:48:21.911221 #5903] DEBUG -- :   [1m[36mStore::File Load (0.2ms)[0m  [1m[34mSELECT  "store_files".* FROM "store_files" WHERE "store_files"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-18T22:48:21.911958 #5903] DEBUG -- :   [1m[36mStore::Provider::DB Load (0.3ms)[0m  [1m[34mSELECT  "store_provider_dbs".* FROM "store_provider_dbs" WHERE "store_provider_dbs"."sha" = $1 LIMIT $2[0m  [["sha", "8180fbd3b72f3fbf6e4e22d187ee0632ad7b63f72c6bcf22e59ed4d0ba381b24"], ["LIMIT", 1]]
D, [2018-09-18T22:48:23.146606 #5903] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT  "settings"."updated_at" FROM "settings" ORDER BY "settings"."updated_at" DESC LIMIT $1[0m  [["LIMIT", 1]]
D, [2018-09-18T22:48:23.147281 #5903] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT "settings"."name", "settings"."state_current" FROM "settings" ORDER BY "settings"."id" ASC[0m
D, [2018-09-18T22:48:23.157860 #5903] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT  "settings".* FROM "settings" WHERE "settings"."name" = $1 LIMIT $2[0m  [["name", "models_searchable"], ["LIMIT", 1]]
D, [2018-09-18T22:48:30.223456 #5911] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mSHOW server_version;[0m
D, [2018-09-18T22:48:30.292158 #5911] DEBUG -- :   [1m[36mStore Load (0.8ms)[0m  [1m[34mSELECT "stores".* FROM "stores" WHERE "stores"."store_object_id" = 3 AND "stores"."o_id" = $1 ORDER BY created_at ASC, id ASC[0m  [["o_id", 2]]
D, [2018-09-18T22:48:30.312862 #5911] DEBUG -- :   [1m[36mStore Load (0.3ms)[0m  [1m[34mSELECT  "stores".* FROM "stores" WHERE "stores"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
D, [2018-09-18T22:48:30.316578 #5911] DEBUG -- :   [1m[36mStore::File Load (0.4ms)[0m  [1m[34mSELECT  "store_files".* FROM "store_files" WHERE "store_files"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-18T22:48:30.329638 #5911] DEBUG -- :   [1m[36mStore::Provider::DB Load (0.5ms)[0m  [1m[34mSELECT  "store_provider_dbs".* FROM "store_provider_dbs" WHERE "store_provider_dbs"."sha" = $1 LIMIT $2[0m  [["sha", "8180fbd3b72f3fbf6e4e22d187ee0632ad7b63f72c6bcf22e59ed4d0ba381b24"], ["LIMIT", 1]]
D, [2018-09-18T22:48:30.339554 #5911] DEBUG -- :   [1m[36mSetting Load (0.6ms)[0m  [1m[34mSELECT  "settings".* FROM "settings" WHERE "settings"."name" = $1 LIMIT $2[0m  [["name", "product_logo"], ["LIMIT", 1]]
D, [2018-09-18T22:48:30.355148 #5911] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-18T22:48:30.367333 #5911] DEBUG -- : Setting.reset_change_id: set new cache, 494326212
D, [2018-09-18T22:48:30.368340 #5911] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-18T22:48:30.369790 #5911]  INFO -- : Setting.set('product_logo', "73a4aa758e6629c9ad420d2e312af0a0.png")
D, [2018-09-18T22:48:30.370491 #5911] DEBUG -- :   [1m[36mStore::File Load (0.3ms)[0m  [1m[34mSELECT  "store_files".* FROM "store_files" WHERE "store_files"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-18T22:48:30.371300 #5911] DEBUG -- :   [1m[36mStore::Provider::DB Load (0.3ms)[0m  [1m[34mSELECT  "store_provider_dbs".* FROM "store_provider_dbs" WHERE "store_provider_dbs"."sha" = $1 LIMIT $2[0m  [["sha", "8180fbd3b72f3fbf6e4e22d187ee0632ad7b63f72c6bcf22e59ed4d0ba381b24"], ["LIMIT", 1]]
D, [2018-09-18T22:48:30.372217 #5911] DEBUG -- :   [1m[36mStore::File Load (0.2ms)[0m  [1m[34mSELECT  "store_files".* FROM "store_files" WHERE "store_files"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-18T22:48:30.373060 #5911] DEBUG -- :   [1m[36mStore::Provider::DB Load (0.2ms)[0m  [1m[34mSELECT  "store_provider_dbs".* FROM "store_provider_dbs" WHERE "store_provider_dbs"."sha" = $1 LIMIT $2[0m  [["sha", "8180fbd3b72f3fbf6e4e22d187ee0632ad7b63f72c6bcf22e59ed4d0ba381b24"], ["LIMIT", 1]]
D, [2018-09-18T22:48:31.252480 #5911] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT  "settings"."updated_at" FROM "settings" ORDER BY "settings"."updated_at" DESC LIMIT $1[0m  [["LIMIT", 1]]
D, [2018-09-18T22:48:31.258250 #5911] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT "settings"."name", "settings"."state_current" FROM "settings" ORDER BY "settings"."id" ASC[0m
D, [2018-09-18T22:48:31.267605 #5911] DEBUG -- :   [1m[36mSetting Load (0.2ms)[0m  [1m[34mSELECT  "settings".* FROM "settings" WHERE "settings"."name" = $1 LIMIT $2[0m  [["name", "models_searchable"], ["LIMIT", 1]]
D, [2018-09-18T22:48:32.712997 #5911] DEBUG -- :   [1m[35mSQL (5.3ms)[0m  [1m[31mDELETE FROM "users"[0m
D, [2018-09-18T22:48:50.686048 #5911] DEBUG -- :   [1m[35mSQL (1.9ms)[0m  [1m[31mDELETE FROM "users"[0m
D, [2018-09-18T22:49:00.856954 #6208] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mSHOW server_version;[0m
D, [2018-09-18T22:49:00.928804 #6208] DEBUG -- :   [1m[36mStore Load (0.8ms)[0m  [1m[34mSELECT "stores".* FROM "stores" WHERE "stores"."store_object_id" = 3 AND "stores"."o_id" = $1 ORDER BY created_at ASC, id ASC[0m  [["o_id", 2]]
D, [2018-09-18T22:49:00.951546 #6208] DEBUG -- :   [1m[36mStore Load (0.3ms)[0m  [1m[34mSELECT  "stores".* FROM "stores" WHERE "stores"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
D, [2018-09-18T22:49:00.955843 #6208] DEBUG -- :   [1m[36mStore::File Load (0.5ms)[0m  [1m[34mSELECT  "store_files".* FROM "store_files" WHERE "store_files"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-18T22:49:00.969686 #6208] DEBUG -- :   [1m[36mStore::Provider::DB Load (0.5ms)[0m  [1m[34mSELECT  "store_provider_dbs".* FROM "store_provider_dbs" WHERE "store_provider_dbs"."sha" = $1 LIMIT $2[0m  [["sha", "8180fbd3b72f3fbf6e4e22d187ee0632ad7b63f72c6bcf22e59ed4d0ba381b24"], ["LIMIT", 1]]
D, [2018-09-18T22:49:00.980579 #6208] DEBUG -- :   [1m[36mSetting Load (0.6ms)[0m  [1m[34mSELECT  "settings".* FROM "settings" WHERE "settings"."name" = $1 LIMIT $2[0m  [["name", "product_logo"], ["LIMIT", 1]]
D, [2018-09-18T22:49:00.997480 #6208] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-18T22:49:01.010837 #6208] DEBUG -- : Setting.reset_change_id: set new cache, 136097597
D, [2018-09-18T22:49:01.011747 #6208] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-18T22:49:01.013476 #6208]  INFO -- : Setting.set('product_logo', "73a4aa758e6629c9ad420d2e312af0a0.png")
D, [2018-09-18T22:49:01.014233 #6208] DEBUG -- :   [1m[36mStore::File Load (0.3ms)[0m  [1m[34mSELECT  "store_files".* FROM "store_files" WHERE "store_files"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-18T22:49:01.015091 #6208] DEBUG -- :   [1m[36mStore::Provider::DB Load (0.3ms)[0m  [1m[34mSELECT  "store_provider_dbs".* FROM "store_provider_dbs" WHERE "store_provider_dbs"."sha" = $1 LIMIT $2[0m  [["sha", "8180fbd3b72f3fbf6e4e22d187ee0632ad7b63f72c6bcf22e59ed4d0ba381b24"], ["LIMIT", 1]]
D, [2018-09-18T22:49:01.016086 #6208] DEBUG -- :   [1m[36mStore::File Load (0.3ms)[0m  [1m[34mSELECT  "store_files".* FROM "store_files" WHERE "store_files"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-18T22:49:01.017062 #6208] DEBUG -- :   [1m[36mStore::Provider::DB Load (0.3ms)[0m  [1m[34mSELECT  "store_provider_dbs".* FROM "store_provider_dbs" WHERE "store_provider_dbs"."sha" = $1 LIMIT $2[0m  [["sha", "8180fbd3b72f3fbf6e4e22d187ee0632ad7b63f72c6bcf22e59ed4d0ba381b24"], ["LIMIT", 1]]
D, [2018-09-18T22:49:02.175041 #6208] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[34mSELECT  "settings"."updated_at" FROM "settings" ORDER BY "settings"."updated_at" DESC LIMIT $1[0m  [["LIMIT", 1]]
D, [2018-09-18T22:49:02.175722 #6208] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT "settings"."name", "settings"."state_current" FROM "settings" ORDER BY "settings"."id" ASC[0m
D, [2018-09-18T22:49:02.185862 #6208] DEBUG -- :   [1m[36mSetting Load (0.2ms)[0m  [1m[34mSELECT  "settings".* FROM "settings" WHERE "settings"."name" = $1 LIMIT $2[0m  [["name", "models_searchable"], ["LIMIT", 1]]
I, [2018-09-18T22:49:03.375736 #6208]  INFO -- : Started GET "/" for ::1 at 2018-09-18 22:49:03 +0530
D, [2018-09-18T22:49:03.423272 #6208] DEBUG -- :   [1m[35m (1.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
I, [2018-09-18T22:49:03.491102 #6208]  INFO -- : Processing by InitController#index as HTML
I, [2018-09-18T22:49:03.515054 #6208]  INFO -- :   Rendering init/index.html.erb within layouts/application
I, [2018-09-18T22:49:03.515899 #6208]  INFO -- :   Rendered init/index.html.erb within layouts/application (0.7ms)
D, [2018-09-18T22:49:04.262466 #6208] DEBUG -- :   [1m[36mSetting Load (0.7ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-18T22:49:04.263130 #6208]  INFO -- : Completed 200 OK in 772ms (Views: 749.0ms | ActiveRecord: 9.1ms)


D, [2018-09-18T22:49:04.264530 #6208] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-18T22:49:04.265773 #6208] DEBUG -- :   [1m[35mSQL (0.2ms)[0m  [1m[33mUPDATE "sessions" SET "data" = $1, "updated_at" = $2 WHERE "sessions"."id" = $3[0m  [["data", "BAh7CEkiCXBpbmcGOgZFRkkiGTIwMTgtMDktMThUMTc6MTk6MDNaBjsAVEki\nD3VzZXJfYWdlbnQGOwBGIm5Nb3ppbGxhLzUuMCAoWDExOyBMaW51eCB4ODZf\nNjQpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENo\ncm9tZS82OC4wLjM0NDAuMTA2IFNhZmFyaS81MzcuMzZJIhBfY3NyZl90b2tl\nbgY7AEZJIjFUU1RITnF4UDkrd3BzRVZEa1pFNmk3ejM0c1pFWnBWNWFsUlY1\nb0ZkNVdrPQY7AEY=\n"], ["updated_at", "2018-09-18 17:19:04.264722"], ["id", 34]]
D, [2018-09-18T22:49:04.266861 #6208] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-18T22:49:04.279824 #6208]  INFO -- : Started GET "/assets/application.css" for ::1 at 2018-09-18 22:49:04 +0530
I, [2018-09-18T22:49:04.294044 #6208]  INFO -- : Started GET "/assets/application.js" for ::1 at 2018-09-18 22:49:04 +0530
D, [2018-09-18T22:49:04.317150 #6208] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-18T22:49:04.318825 #6208] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-18T22:49:04.327769 #6208]  INFO -- : Started GET "/assets/application-print.css" for ::1 at 2018-09-18 22:49:04 +0530
D, [2018-09-18T22:49:04.435228 #6208] DEBUG -- :   [1m[35m (14.5ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-18T22:49:04.438965 #6208] DEBUG -- :   [1m[35m (3.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-18T22:49:04.440429 #6208] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-18T22:49:04.440667 #6208] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-18T22:49:04.716948 #6208]  INFO -- : Started POST "/api/v1/signshow" for ::1 at 2018-09-18 22:49:04 +0530
I, [2018-09-18T22:49:04.741193 #6208]  INFO -- : Processing by SessionsController#show as JSON
I, [2018-09-18T22:49:04.741267 #6208]  INFO -- :   Parameters: {"fingerprint"=>"-1992429858"}
D, [2018-09-18T22:49:04.746636 #6208] DEBUG -- :   [1m[36mObjectLookup Load (0.7ms)[0m  [1m[34mSELECT  "object_lookups".* FROM "object_lookups" WHERE "object_lookups"."name" = $1 LIMIT $2[0m  [["name", "Ticket"], ["LIMIT", 1]]
D, [2018-09-18T22:49:04.751222 #6208] DEBUG -- :   [1m[36mObjectManager::Attribute Load (1.5ms)[0m  [1m[34mSELECT "object_manager_attributes".* FROM "object_manager_attributes" WHERE "object_manager_attributes"."object_lookup_id" = $1 AND "object_manager_attributes"."active" = $2 AND "object_manager_attributes"."to_create" = $3 AND "object_manager_attributes"."to_delete" = $4 ORDER BY position ASC, name ASC[0m  [["object_lookup_id", 2], ["active", "t"], ["to_create", "f"], ["to_delete", "f"]]
D, [2018-09-18T22:49:04.759050 #6208] DEBUG -- :   [1m[36mObjectLookup Load (0.3ms)[0m  [1m[34mSELECT  "object_lookups".* FROM "object_lookups" WHERE "object_lookups"."name" = $1 LIMIT $2[0m  [["name", "TicketArticle"], ["LIMIT", 1]]
D, [2018-09-18T22:49:04.760769 #6208] DEBUG -- :   [1m[36mObjectManager::Attribute Load (0.4ms)[0m  [1m[34mSELECT "object_manager_attributes".* FROM "object_manager_attributes" WHERE "object_manager_attributes"."object_lookup_id" = $1 AND "object_manager_attributes"."active" = $2 AND "object_manager_attributes"."to_create" = $3 AND "object_manager_attributes"."to_delete" = $4 ORDER BY position ASC, name ASC[0m  [["object_lookup_id", 3], ["active", "t"], ["to_create", "f"], ["to_delete", "f"]]
D, [2018-09-18T22:49:04.765199 #6208] DEBUG -- :   [1m[36mObjectLookup Load (0.3ms)[0m  [1m[34mSELECT  "object_lookups".* FROM "object_lookups" WHERE "object_lookups"."name" = $1 LIMIT $2[0m  [["name", "User"], ["LIMIT", 1]]
D, [2018-09-18T22:49:04.767750 #6208] DEBUG -- :   [1m[36mObjectManager::Attribute Load (0.5ms)[0m  [1m[34mSELECT "object_manager_attributes".* FROM "object_manager_attributes" WHERE "object_manager_attributes"."object_lookup_id" = $1 AND "object_manager_attributes"."active" = $2 AND "object_manager_attributes"."to_create" = $3 AND "object_manager_attributes"."to_delete" = $4 ORDER BY position ASC, name ASC[0m  [["object_lookup_id", 1], ["active", "t"], ["to_create", "f"], ["to_delete", "f"]]
D, [2018-09-18T22:49:04.779362 #6208] DEBUG -- :   [1m[36mObjectLookup Load (0.3ms)[0m  [1m[34mSELECT  "object_lookups".* FROM "object_lookups" WHERE "object_lookups"."name" = $1 LIMIT $2[0m  [["name", "Organization"], ["LIMIT", 1]]
D, [2018-09-18T22:49:04.782153 #6208] DEBUG -- :   [1m[36mObjectManager::Attribute Load (0.5ms)[0m  [1m[34mSELECT "object_manager_attributes".* FROM "object_manager_attributes" WHERE "object_manager_attributes"."object_lookup_id" = $1 AND "object_manager_attributes"."active" = $2 AND "object_manager_attributes"."to_create" = $3 AND "object_manager_attributes"."to_delete" = $4 ORDER BY position ASC, name ASC[0m  [["object_lookup_id", 4], ["active", "t"], ["to_create", "f"], ["to_delete", "f"]]
D, [2018-09-18T22:49:04.786720 #6208] DEBUG -- :   [1m[36mObjectLookup Load (0.5ms)[0m  [1m[34mSELECT  "object_lookups".* FROM "object_lookups" WHERE "object_lookups"."name" = $1 LIMIT $2[0m  [["name", "Group"], ["LIMIT", 1]]
D, [2018-09-18T22:49:04.790321 #6208] DEBUG -- :   [1m[36mObjectManager::Attribute Load (0.5ms)[0m  [1m[34mSELECT "object_manager_attributes".* FROM "object_manager_attributes" WHERE "object_manager_attributes"."object_lookup_id" = $1 AND "object_manager_attributes"."active" = $2 AND "object_manager_attributes"."to_create" = $3 AND "object_manager_attributes"."to_delete" = $4 ORDER BY position ASC, name ASC[0m  [["object_lookup_id", 5], ["active", "t"], ["to_create", "f"], ["to_delete", "f"]]
D, [2018-09-18T22:49:04.795887 #6208] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT name, preferences FROM "settings" WHERE "settings"."frontend" = $1[0m  [["frontend", "t"]]
D, [2018-09-18T22:49:04.817055 #6208] DEBUG -- :   [1m[36mLocale Load (1.2ms)[0m  [1m[34mSELECT "locales".* FROM "locales" WHERE "locales"."active" = $1[0m  [["active", "t"]]
D, [2018-09-18T22:49:04.839331 #6208] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-18T22:49:04.840610 #6208]  INFO -- : Completed 200 OK in 99ms (Views: 22.1ms | ActiveRecord: 8.0ms)


D, [2018-09-18T22:49:04.841872 #6208] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-18T22:49:04.843642 #6208] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "sessions" SET "data" = $1, "updated_at" = $2 WHERE "sessions"."id" = $3[0m  [["data", "BAh7CEkiCXBpbmcGOgZFRkkiGTIwMTgtMDktMThUMTc6MTk6MDRaBjsAVEki\nD3VzZXJfYWdlbnQGOwBGIm5Nb3ppbGxhLzUuMCAoWDExOyBMaW51eCB4ODZf\nNjQpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENo\ncm9tZS82OC4wLjM0NDAuMTA2IFNhZmFyaS81MzcuMzZJIhBfY3NyZl90b2tl\nbgY7AEZJIjFUU1RITnF4UDkrd3BzRVZEa1pFNmk3ejM0c1pFWnBWNWFsUlY1\nb0ZkNVdrPQY7AEY=\n"], ["updated_at", "2018-09-18 17:19:04.842569"], ["id", 34]]
D, [2018-09-18T22:49:04.845203 #6208] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-18T22:49:04.856122 #6208]  INFO -- : Started GET "/api/v1/translations/lang/en-us?_=1537291144625" for ::1 at 2018-09-18 22:49:04 +0530
I, [2018-09-18T22:49:04.890572 #6208]  INFO -- : Processing by TranslationsController#lang as JSON
I, [2018-09-18T22:49:04.890644 #6208]  INFO -- :   Parameters: {"_"=>"1537291144625", "locale"=>"en-us"}
D, [2018-09-18T22:49:04.907379 #6208] DEBUG -- :   [1m[35m (14.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "translations" WHERE "translations"."locale" = $1[0m  [["locale", "de-de"]]
D, [2018-09-18T22:49:04.917287 #6208] DEBUG -- :   [1m[36mTranslation Load (8.7ms)[0m  [1m[34mSELECT "translations".* FROM "translations" WHERE "translations"."locale" = $1 AND ("translations"."target" != $2) ORDER BY "translations"."source" ASC[0m  [["locale", "en-us"], ["target", ""]]
D, [2018-09-18T22:49:04.921828 #6208] DEBUG -- :   [1m[36mSetting Load (0.9ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-18T22:49:04.922723 #6208]  INFO -- : Completed 200 OK in 32ms (Views: 0.8ms | ActiveRecord: 23.9ms)


D, [2018-09-18T22:49:04.924140 #6208] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-18T22:49:04.924824 #6208] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-18T22:49:04.929899 #6208]  INFO -- : Started GET "/ws" for ::1 at 2018-09-18 22:49:04 +0530
D, [2018-09-18T22:49:04.958726 #6208] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-18T22:49:04.959641 #6208] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
F, [2018-09-18T22:49:04.960379 #6208] FATAL -- :   
F, [2018-09-18T22:49:04.960442 #6208] FATAL -- : ActionController::RoutingError (No route matches [GET] "/ws"):
F, [2018-09-18T22:49:04.960489 #6208] FATAL -- :   
F, [2018-09-18T22:49:04.960571 #6208] FATAL -- : actionpack (5.1.5) lib/action_dispatch/middleware/debug_exceptions.rb:63:in `call'
actionpack (5.1.5) lib/action_dispatch/middleware/show_exceptions.rb:31:in `call'
railties (5.1.5) lib/rails/rack/logger.rb:36:in `call_app'
railties (5.1.5) lib/rails/rack/logger.rb:24:in `block in call'
activesupport (5.1.5) lib/active_support/tagged_logging.rb:69:in `block in tagged'
activesupport (5.1.5) lib/active_support/tagged_logging.rb:26:in `tagged'
activesupport (5.1.5) lib/active_support/tagged_logging.rb:69:in `tagged'
railties (5.1.5) lib/rails/rack/logger.rb:24:in `call'
actionpack (5.1.5) lib/action_dispatch/middleware/remote_ip.rb:79:in `call'
actionpack (5.1.5) lib/action_dispatch/middleware/request_id.rb:25:in `call'
rack (2.0.5) lib/rack/method_override.rb:22:in `call'
rack (2.0.5) lib/rack/runtime.rb:22:in `call'
activesupport (5.1.5) lib/active_support/cache/strategy/local_cache_middleware.rb:27:in `call'
actionpack (5.1.5) lib/action_dispatch/middleware/executor.rb:12:in `call'
actionpack (5.1.5) lib/action_dispatch/middleware/static.rb:125:in `call'
rack (2.0.5) lib/rack/sendfile.rb:111:in `call'
railties (5.1.5) lib/rails/engine.rb:522:in `call'
puma (3.11.0) lib/puma/configuration.rb:225:in `call'
puma (3.11.0) lib/puma/server.rb:624:in `handle_request'
puma (3.11.0) lib/puma/server.rb:438:in `process_client'
puma (3.11.0) lib/puma/server.rb:302:in `block in run'
puma (3.11.0) lib/puma/thread_pool.rb:120:in `block in spawn_thread'
logging (2.2.2) lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'
I, [2018-09-18T22:49:05.151243 #6208]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-18 22:49:05 +0530
I, [2018-09-18T22:49:05.164419 #6208]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-18T22:49:05.164508 #6208]  INFO -- :   Parameters: {"data"=>{"event"=>"login"}}
I, [2018-09-18T22:49:05.165421 #6208]  INFO -- : client(6051492996) new client connection
D, [2018-09-18T22:49:05.167009 #6208] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-18T22:49:05.167410 #6208]  INFO -- : Completed 200 OK in 3ms (Views: 0.1ms | ActiveRecord: 0.4ms)


D, [2018-09-18T22:49:05.168196 #6208] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-18T22:49:05.168715 #6208] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-18T22:49:05.172315 #6208]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-18 22:49:05 +0530
I, [2018-09-18T22:49:05.180905 #6208]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-18 22:49:05 +0530
I, [2018-09-18T22:49:05.192237 #6208]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-18T22:49:05.192320 #6208]  INFO -- :   Parameters: {"client_id"=>"6051492996"}
I, [2018-09-18T22:49:05.193817 #6208]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-18T22:49:05.193880 #6208]  INFO -- :   Parameters: {"client_id"=>"6051492996", "data"=>{"event"=>"login", "fingerprint"=>"-1992429858"}}
D, [2018-09-18T22:49:05.195520 #6208] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-18T22:49:05.195876 #6208]  INFO -- : Completed 200 OK in 2ms (Views: 0.1ms | ActiveRecord: 0.3ms)


D, [2018-09-18T22:49:05.196609 #6208] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-18T22:49:05.197130 #6208] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-18T22:49:12.203983 #6208] DEBUG -- :   [1m[36mSetting Load (1.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-18T22:49:12.205313 #6208]  INFO -- : Completed 200 OK in 7013ms (Views: 0.5ms | ActiveRecord: 1.3ms)


D, [2018-09-18T22:49:12.208000 #6208] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-18T22:49:12.209580 #6208] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-18T22:49:12.213976 #6208]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-18 22:49:12 +0530
I, [2018-09-18T22:49:12.228960 #6208]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-18T22:49:12.229044 #6208]  INFO -- :   Parameters: {"client_id"=>"6051492996"}
I, [2018-09-18T22:49:12.449124 #6208]  INFO -- : Started GET "/" for ::1 at 2018-09-18 22:49:12 +0530
I, [2018-09-18T22:49:12.465308 #6208]  INFO -- : Processing by InitController#index as HTML
I, [2018-09-18T22:49:12.467605 #6208]  INFO -- :   Rendering init/index.html.erb within layouts/application
I, [2018-09-18T22:49:12.468155 #6208]  INFO -- :   Rendered init/index.html.erb within layouts/application (0.4ms)
D, [2018-09-18T22:49:12.505555 #6208] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-18T22:49:12.505966 #6208]  INFO -- : Completed 200 OK in 40ms (Views: 38.4ms | ActiveRecord: 0.4ms)


D, [2018-09-18T22:49:12.506889 #6208] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-18T22:49:12.508077 #6208] DEBUG -- :   [1m[35mSQL (0.3ms)[0m  [1m[33mUPDATE "sessions" SET "data" = $1, "updated_at" = $2 WHERE "sessions"."id" = $3[0m  [["data", "BAh7CEkiCXBpbmcGOgZFRkkiGTIwMTgtMDktMThUMTc6MTk6MTJaBjsAVEki\nD3VzZXJfYWdlbnQGOwBGIm5Nb3ppbGxhLzUuMCAoWDExOyBMaW51eCB4ODZf\nNjQpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENo\ncm9tZS82OC4wLjM0NDAuMTA2IFNhZmFyaS81MzcuMzZJIhBfY3NyZl90b2tl\nbgY7AEZJIjFUU1RITnF4UDkrd3BzRVZEa1pFNmk3ejM0c1pFWnBWNWFsUlY1\nb0ZkNVdrPQY7AEY=\n"], ["updated_at", "2018-09-18 17:19:12.507138"], ["id", 34]]
D, [2018-09-18T22:49:12.515051 #6208] DEBUG -- :   [1m[35m (6.7ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-18T22:49:12.528713 #6208]  INFO -- : Started GET "/assets/application.css" for ::1 at 2018-09-18 22:49:12 +0530
I, [2018-09-18T22:49:12.548588 #6208]  INFO -- : Started GET "/assets/application.js" for ::1 at 2018-09-18 22:49:12 +0530
I, [2018-09-18T22:49:12.562120 #6208]  INFO -- : Started GET "/assets/application-print.css" for ::1 at 2018-09-18 22:49:12 +0530
D, [2018-09-18T22:49:12.574465 #6208] DEBUG -- :   [1m[35m (25.6ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-18T22:49:12.575515 #6208] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-18T22:49:12.626450 #6208] DEBUG -- :   [1m[35m (3.5ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-18T22:49:12.627330 #6208] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-18T22:49:12.627813 #6208] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-18T22:49:12.628117 #6208] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-18T22:49:12.714281 #6208]  INFO -- : Started POST "/api/v1/signshow" for ::1 at 2018-09-18 22:49:12 +0530
I, [2018-09-18T22:49:12.724274 #6208]  INFO -- : Processing by SessionsController#show as JSON
I, [2018-09-18T22:49:12.724326 #6208]  INFO -- :   Parameters: {"fingerprint"=>"-1992429858"}
D, [2018-09-18T22:49:12.725701 #6208] DEBUG -- :   [1m[36mObjectManager::Attribute Load (0.4ms)[0m  [1m[34mSELECT "object_manager_attributes".* FROM "object_manager_attributes" WHERE "object_manager_attributes"."object_lookup_id" = $1 AND "object_manager_attributes"."active" = $2 AND "object_manager_attributes"."to_create" = $3 AND "object_manager_attributes"."to_delete" = $4 ORDER BY position ASC, name ASC[0m  [["object_lookup_id", 2], ["active", "t"], ["to_create", "f"], ["to_delete", "f"]]
D, [2018-09-18T22:49:12.729512 #6208] DEBUG -- :   [1m[36mObjectManager::Attribute Load (0.4ms)[0m  [1m[34mSELECT "object_manager_attributes".* FROM "object_manager_attributes" WHERE "object_manager_attributes"."object_lookup_id" = $1 AND "object_manager_attributes"."active" = $2 AND "object_manager_attributes"."to_create" = $3 AND "object_manager_attributes"."to_delete" = $4 ORDER BY position ASC, name ASC[0m  [["object_lookup_id", 3], ["active", "t"], ["to_create", "f"], ["to_delete", "f"]]
D, [2018-09-18T22:49:12.732721 #6208] DEBUG -- :   [1m[36mObjectManager::Attribute Load (0.4ms)[0m  [1m[34mSELECT "object_manager_attributes".* FROM "object_manager_attributes" WHERE "object_manager_attributes"."object_lookup_id" = $1 AND "object_manager_attributes"."active" = $2 AND "object_manager_attributes"."to_create" = $3 AND "object_manager_attributes"."to_delete" = $4 ORDER BY position ASC, name ASC[0m  [["object_lookup_id", 1], ["active", "t"], ["to_create", "f"], ["to_delete", "f"]]
D, [2018-09-18T22:49:12.738504 #6208] DEBUG -- :   [1m[36mObjectManager::Attribute Load (0.4ms)[0m  [1m[34mSELECT "object_manager_attributes".* FROM "object_manager_attributes" WHERE "object_manager_attributes"."object_lookup_id" = $1 AND "object_manager_attributes"."active" = $2 AND "object_manager_attributes"."to_create" = $3 AND "object_manager_attributes"."to_delete" = $4 ORDER BY position ASC, name ASC[0m  [["object_lookup_id", 4], ["active", "t"], ["to_create", "f"], ["to_delete", "f"]]
D, [2018-09-18T22:49:12.740919 #6208] DEBUG -- :   [1m[36mObjectManager::Attribute Load (0.3ms)[0m  [1m[34mSELECT "object_manager_attributes".* FROM "object_manager_attributes" WHERE "object_manager_attributes"."object_lookup_id" = $1 AND "object_manager_attributes"."active" = $2 AND "object_manager_attributes"."to_create" = $3 AND "object_manager_attributes"."to_delete" = $4 ORDER BY position ASC, name ASC[0m  [["object_lookup_id", 5], ["active", "t"], ["to_create", "f"], ["to_delete", "f"]]
D, [2018-09-18T22:49:12.744010 #6208] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT name, preferences FROM "settings" WHERE "settings"."frontend" = $1[0m  [["frontend", "t"]]
D, [2018-09-18T22:49:12.755507 #6208] DEBUG -- :   [1m[36mLocale Load (0.4ms)[0m  [1m[34mSELECT "locales".* FROM "locales" WHERE "locales"."active" = $1[0m  [["active", "t"]]
D, [2018-09-18T22:49:12.763558 #6208] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-18T22:49:12.763917 #6208]  INFO -- : Completed 200 OK in 39ms (Views: 8.3ms | ActiveRecord: 3.1ms)


D, [2018-09-18T22:49:12.764751 #6208] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-18T22:49:12.765360 #6208] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-18T22:49:12.770987 #6208]  INFO -- : Started GET "/api/v1/translations/lang/en-us?_=1537291152632" for ::1 at 2018-09-18 22:49:12 +0530
I, [2018-09-18T22:49:12.780996 #6208]  INFO -- : Processing by TranslationsController#lang as JSON
I, [2018-09-18T22:49:12.781055 #6208]  INFO -- :   Parameters: {"_"=>"1537291152632", "locale"=>"en-us"}
D, [2018-09-18T22:49:12.782784 #6208] DEBUG -- :   [1m[36mSetting Load (0.6ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-18T22:49:12.783150 #6208]  INFO -- : Completed 200 OK in 2ms (Views: 0.2ms | ActiveRecord: 0.6ms)


D, [2018-09-18T22:49:12.783896 #6208] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-18T22:49:12.784490 #6208] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-18T22:49:12.788137 #6208]  INFO -- : Started GET "/ws" for ::1 at 2018-09-18 22:49:12 +0530
D, [2018-09-18T22:49:12.799379 #6208] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-18T22:49:12.800115 #6208] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
F, [2018-09-18T22:49:12.801098 #6208] FATAL -- :   
F, [2018-09-18T22:49:12.801284 #6208] FATAL -- : ActionController::RoutingError (No route matches [GET] "/ws"):
F, [2018-09-18T22:49:12.801366 #6208] FATAL -- :   
F, [2018-09-18T22:49:12.801669 #6208] FATAL -- : actionpack (5.1.5) lib/action_dispatch/middleware/debug_exceptions.rb:63:in `call'
actionpack (5.1.5) lib/action_dispatch/middleware/show_exceptions.rb:31:in `call'
railties (5.1.5) lib/rails/rack/logger.rb:36:in `call_app'
railties (5.1.5) lib/rails/rack/logger.rb:24:in `block in call'
activesupport (5.1.5) lib/active_support/tagged_logging.rb:69:in `block in tagged'
activesupport (5.1.5) lib/active_support/tagged_logging.rb:26:in `tagged'
activesupport (5.1.5) lib/active_support/tagged_logging.rb:69:in `tagged'
railties (5.1.5) lib/rails/rack/logger.rb:24:in `call'
actionpack (5.1.5) lib/action_dispatch/middleware/remote_ip.rb:79:in `call'
actionpack (5.1.5) lib/action_dispatch/middleware/request_id.rb:25:in `call'
rack (2.0.5) lib/rack/method_override.rb:22:in `call'
rack (2.0.5) lib/rack/runtime.rb:22:in `call'
activesupport (5.1.5) lib/active_support/cache/strategy/local_cache_middleware.rb:27:in `call'
actionpack (5.1.5) lib/action_dispatch/middleware/executor.rb:12:in `call'
actionpack (5.1.5) lib/action_dispatch/middleware/static.rb:125:in `call'
rack (2.0.5) lib/rack/sendfile.rb:111:in `call'
railties (5.1.5) lib/rails/engine.rb:522:in `call'
puma (3.11.0) lib/puma/configuration.rb:225:in `call'
puma (3.11.0) lib/puma/server.rb:624:in `handle_request'
puma (3.11.0) lib/puma/server.rb:438:in `process_client'
puma (3.11.0) lib/puma/server.rb:302:in `block in run'
puma (3.11.0) lib/puma/thread_pool.rb:120:in `block in spawn_thread'
logging (2.2.2) lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'
I, [2018-09-18T22:49:12.935249 #6208]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-18 22:49:12 +0530
I, [2018-09-18T22:49:12.945028 #6208]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-18T22:49:12.945087 #6208]  INFO -- :   Parameters: {"data"=>{"event"=>"login"}}
I, [2018-09-18T22:49:12.945411 #6208]  INFO -- : client(2021766280) new client connection
D, [2018-09-18T22:49:12.947077 #6208] DEBUG -- :   [1m[36mSetting Load (0.4ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-18T22:49:12.947483 #6208]  INFO -- : Completed 200 OK in 2ms (Views: 0.2ms | ActiveRecord: 0.4ms)


D, [2018-09-18T22:49:12.948325 #6208] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-18T22:49:12.949001 #6208] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-18T22:49:12.952606 #6208]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-18 22:49:12 +0530
I, [2018-09-18T22:49:12.960499 #6208]  INFO -- : Started POST "/api/v1/message_send" for ::1 at 2018-09-18 22:49:12 +0530
I, [2018-09-18T22:49:12.970015 #6208]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-18T22:49:12.970354 #6208]  INFO -- :   Parameters: {"client_id"=>"2021766280"}
I, [2018-09-18T22:49:12.971854 #6208]  INFO -- : Processing by LongPollingController#message_send as JSON
I, [2018-09-18T22:49:12.971910 #6208]  INFO -- :   Parameters: {"client_id"=>"2021766280", "data"=>{"event"=>"login", "fingerprint"=>"-1992429858"}}
D, [2018-09-18T22:49:12.973729 #6208] DEBUG -- :   [1m[36mSetting Load (0.6ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-18T22:49:12.974123 #6208]  INFO -- : Completed 200 OK in 2ms (Views: 0.1ms | ActiveRecord: 0.6ms)


D, [2018-09-18T22:49:12.974885 #6208] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-18T22:49:12.975487 #6208] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-18T22:49:18.132157 #6208]  INFO -- : Started GET "/rails/db" for ::1 at 2018-09-18 22:49:18 +0530
D, [2018-09-18T22:49:19.239398 #6208] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-18T22:49:19.240923 #6208]  INFO -- : Completed 200 OK in 7011ms (Views: 0.6ms | ActiveRecord: 1.2ms)


D, [2018-09-18T22:49:19.244126 #6208] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-18T22:49:19.246322 #6208] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-18T22:49:20.003865 #6208]  INFO -- : Processing by RailsDb::DashboardController#index as HTML
D, [2018-09-18T22:49:20.004724 #6208] DEBUG -- :   [1m[36mSetting Load (25.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-18T22:49:20.009014 #6208]  INFO -- : Completed 200 OK in 7038ms (Views: 0.5ms | ActiveRecord: 25.2ms)


D, [2018-09-18T22:49:20.018393 #6208] DEBUG -- :   [1m[35m (6.5ms)[0m  [1m[35mBEGIN[0m
I, [2018-09-18T22:49:20.019775 #6208]  INFO -- :   Rendering /home/vaibhav/.rvm/gems/ruby-2.4.4/gems/rails_db-2.0.3/app/views/rails_db/dashboard/index.html.erb within layouts/rails_db/application
I, [2018-09-18T22:49:20.021361 #6208]  INFO -- :   Rendered /home/vaibhav/.rvm/gems/ruby-2.4.4/gems/rails_db-2.0.3/app/views/rails_db/dashboard/index.html.erb within layouts/rails_db/application (1.4ms)
D, [2018-09-18T22:49:20.023061 #6208] DEBUG -- :   [1m[35m (3.7ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-18T22:49:20.028793 #6208]  INFO -- : Started POST "/api/v1/message_receive" for ::1 at 2018-09-18 22:49:20 +0530
I, [2018-09-18T22:49:20.048371 #6208]  INFO -- : Processing by LongPollingController#message_receive as JSON
I, [2018-09-18T22:49:20.051282 #6208]  INFO -- :   Parameters: {"client_id"=>"2021766280"}
I, [2018-09-18T22:49:20.051905 #6208]  INFO -- :   Rendered /home/vaibhav/.rvm/gems/ruby-2.4.4/gems/rails_db-2.0.3/app/views/rails_db/shared/_header.html.erb (6.9ms)
I, [2018-09-18T22:49:20.062948 #6208]  INFO -- :   Rendered /home/vaibhav/.rvm/gems/ruby-2.4.4/gems/rails_db-2.0.3/app/views/rails_db/shared/_sidebar.html.erb (9.7ms)
I, [2018-09-18T22:49:20.067107 #6208]  INFO -- :   Rendered /home/vaibhav/.rvm/gems/ruby-2.4.4/gems/rails_db-2.0.3/app/views/rails_db/shared/_gems.html.erb (0.5ms)
I, [2018-09-18T22:49:20.067224 #6208]  INFO -- :   Rendered /home/vaibhav/.rvm/gems/ruby-2.4.4/gems/rails_db-2.0.3/app/views/rails_db/shared/_footer.html.erb (3.4ms)
I, [2018-09-18T22:49:20.067506 #6208]  INFO -- : Completed 200 OK in 62ms (Views: 54.2ms | ActiveRecord: 0.8ms)


D, [2018-09-18T22:49:20.068795 #6208] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-18T22:49:20.069664 #6208] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-18T22:49:20.079804 #6208]  INFO -- : Started GET "/assets/rails_db/application.css" for ::1 at 2018-09-18 22:49:20 +0530
I, [2018-09-18T22:49:20.098291 #6208]  INFO -- : Started GET "/assets/rails_db/application.js" for ::1 at 2018-09-18 22:49:20 +0530
I, [2018-09-18T22:49:20.113954 #6208]  INFO -- : Started GET "/assets/rails_db/logo_mini.png" for ::1 at 2018-09-18 22:49:20 +0530
I, [2018-09-18T22:49:20.124989 #6208]  INFO -- : Started GET "/assets/rails_db/logo.png" for ::1 at 2018-09-18 22:49:20 +0530
D, [2018-09-18T22:49:20.143892 #6208] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-18T22:49:20.152586 #6208] DEBUG -- :   [1m[35m (1.9ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-18T22:49:20.153216 #6208] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-18T22:49:20.154167 #6208] DEBUG -- :   [1m[35m (9.5ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-18T22:49:20.155021 #6208] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-18T22:49:20.155509 #6208] DEBUG -- :   [1m[35m (2.0ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-18T22:49:20.166909 #6208] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-18T22:49:20.167857 #6208] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-18T22:49:27.060870 #6208] DEBUG -- :   [1m[36mSetting Load (1.2ms)[0m  [1m[34mSELECT "settings".* FROM "settings" WHERE "settings"."area" = $1 ORDER BY "settings"."name" ASC[0m  [["area", "Transaction::Backend::Sync"]]
I, [2018-09-18T22:49:27.062183 #6208]  INFO -- : Completed 200 OK in 7011ms (Views: 0.5ms | ActiveRecord: 1.2ms)


D, [2018-09-18T22:49:27.064791 #6208] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-18T22:49:27.066237 #6208] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-18T22:49:35.549110 #6208]  INFO -- : Started GET "/rails/db/tables/signatures/data" for ::1 at 2018-09-18 22:49:35 +0530
I, [2018-09-18T22:49:35.576830 #6208]  INFO -- : Processing by RailsDb::TablesController#data as JS
I, [2018-09-18T22:49:35.577052 #6208]  INFO -- :   Parameters: {"table_id"=>"signatures"}
D, [2018-09-18T22:49:35.597235 #6208] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "signatures"[0m
I, [2018-09-18T22:49:35.638160 #6208]  INFO -- :   Rendering /home/vaibhav/.rvm/gems/ruby-2.4.4/gems/rails_db-2.0.3/app/views/rails_db/tables/data.js.erb
I, [2018-09-18T22:49:35.642625 #6208]  INFO -- :   Rendered /home/vaibhav/.rvm/gems/ruby-2.4.4/gems/rails_db-2.0.3/app/views/rails_db/shared/_exp_col.html.erb (0.3ms)
I, [2018-09-18T22:49:35.690169 #6208]  INFO -- :   Rendered /home/vaibhav/.rvm/gems/ruby-2.4.4/gems/rails_db-2.0.3/app/views/rails_db/tables/_condition_fields.html.erb (40.7ms)
I, [2018-09-18T22:49:35.698123 #6208]  INFO -- :   Rendered /home/vaibhav/.rvm/gems/ruby-2.4.4/gems/rails_db-2.0.3/app/views/rails_db/tables/_condition_fields.html.erb (7.0ms)
D, [2018-09-18T22:49:35.717750 #6208] DEBUG -- :   [1m[36m Load (0.3ms)[0m  [1m[34mSELECT  "signatures".* FROM "signatures" LIMIT $1 OFFSET $2[0m  [["LIMIT", 25], ["OFFSET", 0]]
I, [2018-09-18T22:49:35.741691 #6208]  INFO -- :   Rendered /home/vaibhav/.rvm/gems/ruby-2.4.4/gems/rails_db-2.0.3/app/views/rails_db/tables/_row.html.erb (8.6ms)
I, [2018-09-18T22:49:35.742784 #6208]  INFO -- :   Rendered /home/vaibhav/.rvm/gems/ruby-2.4.4/gems/rails_db-2.0.3/app/views/rails_db/tables/_sql.html.erb (0.2ms)
I, [2018-09-18T22:49:35.742870 #6208]  INFO -- :   Rendered /home/vaibhav/.rvm/gems/ruby-2.4.4/gems/rails_db-2.0.3/app/views/rails_db/tables/_data.html.erb (103.3ms)
I, [2018-09-18T22:49:35.743804 #6208]  INFO -- :   Rendered /home/vaibhav/.rvm/gems/ruby-2.4.4/gems/rails_db-2.0.3/app/views/rails_db/tables/data.js.erb (105.5ms)
I, [2018-09-18T22:49:35.743988 #6208]  INFO -- : Completed 200 OK in 167ms (Views: 94.3ms | ActiveRecord: 24.0ms)


D, [2018-09-18T22:49:35.744995 #6208] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-18T22:49:35.745644 #6208] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-18T22:49:43.320064 #6208]  INFO -- : Started GET "/rails/db/tables/signatures/destroy?pk_id=1" for ::1 at 2018-09-18 22:49:43 +0530
I, [2018-09-18T22:49:43.353869 #6208]  INFO -- : Processing by RailsDb::TablesController#destroy as JS
I, [2018-09-18T22:49:43.354004 #6208]  INFO -- :   Parameters: {"pk_id"=>"1", "table_id"=>"signatures"}
D, [2018-09-18T22:49:43.363674 #6208] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "signatures"[0m
D, [2018-09-18T22:49:43.421440 #6208] DEBUG -- :   [1m[35m (9.5ms)[0m  [1m[31mDELETE FROM signatures WHERE id = '1';[0m
I, [2018-09-18T22:49:43.422244 #6208]  INFO -- : Completed 500 Internal Server Error in 68ms (ActiveRecord: 16.1ms)


F, [2018-09-18T22:49:43.425082 #6208] FATAL -- :   
F, [2018-09-18T22:49:43.425222 #6208] FATAL -- : ActiveRecord::InvalidForeignKey (PG::ForeignKeyViolation: ERROR:  update or delete on table "signatures" violates foreign key constraint "fk_rails_5538295cdc" on table "groups"
DETAIL:  Key (id)=(1) is still referenced from table "groups".
: DELETE FROM signatures WHERE id = '1';):
F, [2018-09-18T22:49:43.425360 #6208] FATAL -- :   
F, [2018-09-18T22:49:43.425832 #6208] FATAL -- : activerecord (5.1.5) lib/active_record/connection_adapters/postgresql/database_statements.rb:73:in `async_exec'
activerecord (5.1.5) lib/active_record/connection_adapters/postgresql/database_statements.rb:73:in `block (2 levels) in execute'
activesupport (5.1.5) lib/active_support/dependencies/interlock.rb:46:in `block in permit_concurrent_loads'
activesupport (5.1.5) lib/active_support/concurrency/share_lock.rb:185:in `yield_shares'
activesupport (5.1.5) lib/active_support/dependencies/interlock.rb:45:in `permit_concurrent_loads'
activerecord (5.1.5) lib/active_record/connection_adapters/postgresql/database_statements.rb:72:in `block in execute'
activerecord (5.1.5) lib/active_record/connection_adapters/abstract_adapter.rb:613:in `block (2 levels) in log'
/home/vaibhav/.rvm/rubies/ruby-2.4.4/lib/ruby/2.4.0/monitor.rb:214:in `mon_synchronize'
activerecord (5.1.5) lib/active_record/connection_adapters/abstract_adapter.rb:612:in `block in log'
activesupport (5.1.5) lib/active_support/notifications/instrumenter.rb:21:in `instrument'
activerecord (5.1.5) lib/active_record/connection_adapters/abstract_adapter.rb:604:in `log'
activerecord (5.1.5) lib/active_record/connection_adapters/postgresql/database_statements.rb:71:in `execute'
rails_db (2.0.3) lib/rails_db/adapters/base_adapter.rb:11:in `execute'
rails_db (2.0.3) lib/rails_db/adapters/base_adapter.rb:47:in `delete'
rails_db (2.0.3) lib/rails_db/database.rb:8:in `delete'
rails_db (2.0.3) lib/rails_db/table.rb:46:in `delete'
rails_db (2.0.3) app/controllers/rails_db/tables_controller.rb:56:in `destroy'
actionpack (5.1.5) lib/action_controller/metal/basic_implicit_render.rb:4:in `send_action'
actionpack (5.1.5) lib/abstract_controller/base.rb:186:in `process_action'
actionpack (5.1.5) lib/action_controller/metal/rendering.rb:30:in `process_action'
actionpack (5.1.5) lib/abstract_controller/callbacks.rb:20:in `block in process_action'
activesupport (5.1.5) lib/active_support/callbacks.rb:131:in `run_callbacks'
actionpack (5.1.5) lib/abstract_controller/callbacks.rb:19:in `process_action'
actionpack (5.1.5) lib/action_controller/metal/rescue.rb:20:in `process_action'
actionpack (5.1.5) lib/action_controller/metal/instrumentation.rb:32:in `block in process_action'
activesupport (5.1.5) lib/active_support/notifications.rb:166:in `block in instrument'
activesupport (5.1.5) lib/active_support/notifications/instrumenter.rb:21:in `instrument'
activesupport (5.1.5) lib/active_support/notifications.rb:166:in `instrument'
actionpack (5.1.5) lib/action_controller/metal/instrumentation.rb:30:in `process_action'
actionpack (5.1.5) lib/action_controller/metal/params_wrapper.rb:252:in `process_action'
activerecord (5.1.5) lib/active_record/railties/controller_runtime.rb:22:in `process_action'
actionpack (5.1.5) lib/abstract_controller/base.rb:124:in `process'
actionview (5.1.5) lib/action_view/rendering.rb:30:in `process'
actionpack (5.1.5) lib/action_controller/metal.rb:189:in `dispatch'
actionpack (5.1.5) lib/action_controller/metal.rb:253:in `dispatch'
actionpack (5.1.5) lib/action_dispatch/routing/route_set.rb:49:in `dispatch'
actionpack (5.1.5) lib/action_dispatch/routing/route_set.rb:31:in `serve'
actionpack (5.1.5) lib/action_dispatch/journey/router.rb:50:in `block in serve'
actionpack (5.1.5) lib/action_dispatch/journey/router.rb:33:in `each'
actionpack (5.1.5) lib/action_dispatch/journey/router.rb:33:in `serve'
actionpack (5.1.5) lib/action_dispatch/routing/route_set.rb:844:in `call'
railties (5.1.5) lib/rails/engine.rb:522:in `call'
railties (5.1.5) lib/rails/railtie.rb:185:in `public_send'
railties (5.1.5) lib/rails/railtie.rb:185:in `method_missing'
actionpack (5.1.5) lib/action_dispatch/routing/mapper.rb:17:in `block in <class:Constraints>'
actionpack (5.1.5) lib/action_dispatch/routing/mapper.rb:46:in `serve'
actionpack (5.1.5) lib/action_dispatch/journey/router.rb:50:in `block in serve'
actionpack (5.1.5) lib/action_dispatch/journey/router.rb:33:in `each'
actionpack (5.1.5) lib/action_dispatch/journey/router.rb:33:in `serve'
actionpack (5.1.5) lib/action_dispatch/routing/route_set.rb:844:in `call'
omniauth (1.7.1) lib/omniauth/strategy.rb:190:in `call!'
omniauth (1.7.1) lib/omniauth/strategy.rb:168:in `call'
omniauth (1.7.1) lib/omniauth/strategy.rb:190:in `call!'
omniauth (1.7.1) lib/omniauth/strategy.rb:168:in `call'
omniauth (1.7.1) lib/omniauth/strategy.rb:190:in `call!'
omniauth (1.7.1) lib/omniauth/strategy.rb:168:in `call'
omniauth (1.7.1) lib/omniauth/strategy.rb:190:in `call!'
omniauth (1.7.1) lib/omniauth/strategy.rb:168:in `call'
omniauth (1.7.1) lib/omniauth/strategy.rb:190:in `call!'
omniauth (1.7.1) lib/omniauth/strategy.rb:168:in `call'
omniauth (1.7.1) lib/omniauth/strategy.rb:190:in `call!'
omniauth (1.7.1) lib/omniauth/strategy.rb:168:in `call'
omniauth (1.7.1) lib/omniauth/strategy.rb:190:in `call!'
omniauth (1.7.1) lib/omniauth/strategy.rb:168:in `call'
omniauth (1.7.1) lib/omniauth/strategy.rb:190:in `call!'
omniauth (1.7.1) lib/omniauth/strategy.rb:168:in `call'
omniauth (1.7.1) lib/omniauth/strategy.rb:190:in `call!'
omniauth (1.7.1) lib/omniauth/strategy.rb:168:in `call'
omniauth (1.7.1) lib/omniauth/builder.rb:63:in `call'
rack (2.0.5) lib/rack/etag.rb:25:in `call'
rack (2.0.5) lib/rack/conditional_get.rb:25:in `call'
rack (2.0.5) lib/rack/head.rb:12:in `call'
rack (2.0.5) lib/rack/session/abstract/id.rb:232:in `context'
rack (2.0.5) lib/rack/session/abstract/id.rb:226:in `call'
actionpack (5.1.5) lib/action_dispatch/middleware/cookies.rb:613:in `call'
activerecord (5.1.5) lib/active_record/migration.rb:556:in `call'
actionpack (5.1.5) lib/action_dispatch/middleware/callbacks.rb:26:in `block in call'
activesupport (5.1.5) lib/active_support/callbacks.rb:97:in `run_callbacks'
actionpack (5.1.5) lib/action_dispatch/middleware/callbacks.rb:24:in `call'
actionpack (5.1.5) lib/action_dispatch/middleware/executor.rb:12:in `call'
actionpack (5.1.5) lib/action_dispatch/middleware/debug_exceptions.rb:59:in `call'
actionpack (5.1.5) lib/action_dispatch/middleware/show_exceptions.rb:31:in `call'
railties (5.1.5) lib/rails/rack/logger.rb:36:in `call_app'
railties (5.1.5) lib/rails/rack/logger.rb:24:in `block in call'
activesupport (5.1.5) lib/active_support/tagged_logging.rb:69:in `block in tagged'
activesupport (5.1.5) lib/active_support/tagged_logging.rb:26:in `tagged'
activesupport (5.1.5) lib/active_support/tagged_logging.rb:69:in `tagged'
railties (5.1.5) lib/rails/rack/logger.rb:24:in `call'
actionpack (5.1.5) lib/action_dispatch/middleware/remote_ip.rb:79:in `call'
actionpack (5.1.5) lib/action_dispatch/middleware/request_id.rb:25:in `call'
rack (2.0.5) lib/rack/method_override.rb:22:in `call'
rack (2.0.5) lib/rack/runtime.rb:22:in `call'
activesupport (5.1.5) lib/active_support/cache/strategy/local_cache_middleware.rb:27:in `call'
actionpack (5.1.5) lib/action_dispatch/middleware/executor.rb:12:in `call'
actionpack (5.1.5) lib/action_dispatch/middleware/static.rb:125:in `call'
rack (2.0.5) lib/rack/sendfile.rb:111:in `call'
railties (5.1.5) lib/rails/engine.rb:522:in `call'
puma (3.11.0) lib/puma/configuration.rb:225:in `call'
puma (3.11.0) lib/puma/server.rb:624:in `handle_request'
puma (3.11.0) lib/puma/server.rb:438:in `process_client'
puma (3.11.0) lib/puma/server.rb:302:in `block in run'
puma (3.11.0) lib/puma/thread_pool.rb:120:in `block in spawn_thread'
logging (2.2.2) lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'
I, [2018-09-18T22:49:51.366499 #6208]  INFO -- : Started GET "/rails/db/tables/signatures/destroy?pk_id=1" for ::1 at 2018-09-18 22:49:51 +0530
I, [2018-09-18T22:49:51.401550 #6208]  INFO -- : Processing by RailsDb::TablesController#destroy as JS
I, [2018-09-18T22:49:51.401664 #6208]  INFO -- :   Parameters: {"pk_id"=>"1", "table_id"=>"signatures"}
D, [2018-09-18T22:49:51.411932 #6208] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "signatures"[0m
D, [2018-09-18T22:49:51.460674 #6208] DEBUG -- :   [1m[35m (1.4ms)[0m  [1m[31mDELETE FROM signatures WHERE id = '1';[0m
I, [2018-09-18T22:49:51.460966 #6208]  INFO -- : Completed 500 Internal Server Error in 59ms (ActiveRecord: 8.3ms)


F, [2018-09-18T22:49:51.462310 #6208] FATAL -- :   
F, [2018-09-18T22:49:51.462368 #6208] FATAL -- : ActiveRecord::InvalidForeignKey (PG::ForeignKeyViolation: ERROR:  update or delete on table "signatures" violates foreign key constraint "fk_rails_5538295cdc" on table "groups"
DETAIL:  Key (id)=(1) is still referenced from table "groups".
: DELETE FROM signatures WHERE id = '1';):
F, [2018-09-18T22:49:51.462414 #6208] FATAL -- :   
F, [2018-09-18T22:49:51.462546 #6208] FATAL -- : activerecord (5.1.5) lib/active_record/connection_adapters/postgresql/database_statements.rb:73:in `async_exec'
activerecord (5.1.5) lib/active_record/connection_adapters/postgresql/database_statements.rb:73:in `block (2 levels) in execute'
activesupport (5.1.5) lib/active_support/dependencies/interlock.rb:46:in `block in permit_concurrent_loads'
activesupport (5.1.5) lib/active_support/concurrency/share_lock.rb:185:in `yield_shares'
activesupport (5.1.5) lib/active_support/dependencies/interlock.rb:45:in `permit_concurrent_loads'
activerecord (5.1.5) lib/active_record/connection_adapters/postgresql/database_statements.rb:72:in `block in execute'
activerecord (5.1.5) lib/active_record/connection_adapters/abstract_adapter.rb:613:in `block (2 levels) in log'
/home/vaibhav/.rvm/rubies/ruby-2.4.4/lib/ruby/2.4.0/monitor.rb:214:in `mon_synchronize'
activerecord (5.1.5) lib/active_record/connection_adapters/abstract_adapter.rb:612:in `block in log'
activesupport (5.1.5) lib/active_support/notifications/instrumenter.rb:21:in `instrument'
activerecord (5.1.5) lib/active_record/connection_adapters/abstract_adapter.rb:604:in `log'
activerecord (5.1.5) lib/active_record/connection_adapters/postgresql/database_statements.rb:71:in `execute'
rails_db (2.0.3) lib/rails_db/adapters/base_adapter.rb:11:in `execute'
rails_db (2.0.3) lib/rails_db/adapters/base_adapter.rb:47:in `delete'
rails_db (2.0.3) lib/rails_db/database.rb:8:in `delete'
rails_db (2.0.3) lib/rails_db/table.rb:46:in `delete'
rails_db (2.0.3) app/controllers/rails_db/tables_controller.rb:56:in `destroy'
actionpack (5.1.5) lib/action_controller/metal/basic_implicit_render.rb:4:in `send_action'
actionpack (5.1.5) lib/abstract_controller/base.rb:186:in `process_action'
actionpack (5.1.5) lib/action_controller/metal/rendering.rb:30:in `process_action'
actionpack (5.1.5) lib/abstract_controller/callbacks.rb:20:in `block in process_action'
activesupport (5.1.5) lib/active_support/callbacks.rb:131:in `run_callbacks'
actionpack (5.1.5) lib/abstract_controller/callbacks.rb:19:in `process_action'
actionpack (5.1.5) lib/action_controller/metal/rescue.rb:20:in `process_action'
actionpack (5.1.5) lib/action_controller/metal/instrumentation.rb:32:in `block in process_action'
activesupport (5.1.5) lib/active_support/notifications.rb:166:in `block in instrument'
activesupport (5.1.5) lib/active_support/notifications/instrumenter.rb:21:in `instrument'
activesupport (5.1.5) lib/active_support/notifications.rb:166:in `instrument'
actionpack (5.1.5) lib/action_controller/metal/instrumentation.rb:30:in `process_action'
actionpack (5.1.5) lib/action_controller/metal/params_wrapper.rb:252:in `process_action'
activerecord (5.1.5) lib/active_record/railties/controller_runtime.rb:22:in `process_action'
actionpack (5.1.5) lib/abstract_controller/base.rb:124:in `process'
actionview (5.1.5) lib/action_view/rendering.rb:30:in `process'
actionpack (5.1.5) lib/action_controller/metal.rb:189:in `dispatch'
actionpack (5.1.5) lib/action_controller/metal.rb:253:in `dispatch'
actionpack (5.1.5) lib/action_dispatch/routing/route_set.rb:49:in `dispatch'
actionpack (5.1.5) lib/action_dispatch/routing/route_set.rb:31:in `serve'
actionpack (5.1.5) lib/action_dispatch/journey/router.rb:50:in `block in serve'
actionpack (5.1.5) lib/action_dispatch/journey/router.rb:33:in `each'
actionpack (5.1.5) lib/action_dispatch/journey/router.rb:33:in `serve'
actionpack (5.1.5) lib/action_dispatch/routing/route_set.rb:844:in `call'
railties (5.1.5) lib/rails/engine.rb:522:in `call'
railties (5.1.5) lib/rails/railtie.rb:185:in `public_send'
railties (5.1.5) lib/rails/railtie.rb:185:in `method_missing'
actionpack (5.1.5) lib/action_dispatch/routing/mapper.rb:17:in `block in <class:Constraints>'
actionpack (5.1.5) lib/action_dispatch/routing/mapper.rb:46:in `serve'
actionpack (5.1.5) lib/action_dispatch/journey/router.rb:50:in `block in serve'
actionpack (5.1.5) lib/action_dispatch/journey/router.rb:33:in `each'
actionpack (5.1.5) lib/action_dispatch/journey/router.rb:33:in `serve'
actionpack (5.1.5) lib/action_dispatch/routing/route_set.rb:844:in `call'
omniauth (1.7.1) lib/omniauth/strategy.rb:190:in `call!'
omniauth (1.7.1) lib/omniauth/strategy.rb:168:in `call'
omniauth (1.7.1) lib/omniauth/strategy.rb:190:in `call!'
omniauth (1.7.1) lib/omniauth/strategy.rb:168:in `call'
omniauth (1.7.1) lib/omniauth/strategy.rb:190:in `call!'
omniauth (1.7.1) lib/omniauth/strategy.rb:168:in `call'
omniauth (1.7.1) lib/omniauth/strategy.rb:190:in `call!'
omniauth (1.7.1) lib/omniauth/strategy.rb:168:in `call'
omniauth (1.7.1) lib/omniauth/strategy.rb:190:in `call!'
omniauth (1.7.1) lib/omniauth/strategy.rb:168:in `call'
omniauth (1.7.1) lib/omniauth/strategy.rb:190:in `call!'
omniauth (1.7.1) lib/omniauth/strategy.rb:168:in `call'
omniauth (1.7.1) lib/omniauth/strategy.rb:190:in `call!'
omniauth (1.7.1) lib/omniauth/strategy.rb:168:in `call'
omniauth (1.7.1) lib/omniauth/strategy.rb:190:in `call!'
omniauth (1.7.1) lib/omniauth/strategy.rb:168:in `call'
omniauth (1.7.1) lib/omniauth/strategy.rb:190:in `call!'
omniauth (1.7.1) lib/omniauth/strategy.rb:168:in `call'
omniauth (1.7.1) lib/omniauth/builder.rb:63:in `call'
rack (2.0.5) lib/rack/etag.rb:25:in `call'
rack (2.0.5) lib/rack/conditional_get.rb:25:in `call'
rack (2.0.5) lib/rack/head.rb:12:in `call'
rack (2.0.5) lib/rack/session/abstract/id.rb:232:in `context'
rack (2.0.5) lib/rack/session/abstract/id.rb:226:in `call'
actionpack (5.1.5) lib/action_dispatch/middleware/cookies.rb:613:in `call'
activerecord (5.1.5) lib/active_record/migration.rb:556:in `call'
actionpack (5.1.5) lib/action_dispatch/middleware/callbacks.rb:26:in `block in call'
activesupport (5.1.5) lib/active_support/callbacks.rb:97:in `run_callbacks'
actionpack (5.1.5) lib/action_dispatch/middleware/callbacks.rb:24:in `call'
actionpack (5.1.5) lib/action_dispatch/middleware/executor.rb:12:in `call'
actionpack (5.1.5) lib/action_dispatch/middleware/debug_exceptions.rb:59:in `call'
actionpack (5.1.5) lib/action_dispatch/middleware/show_exceptions.rb:31:in `call'
railties (5.1.5) lib/rails/rack/logger.rb:36:in `call_app'
railties (5.1.5) lib/rails/rack/logger.rb:24:in `block in call'
activesupport (5.1.5) lib/active_support/tagged_logging.rb:69:in `block in tagged'
activesupport (5.1.5) lib/active_support/tagged_logging.rb:26:in `tagged'
activesupport (5.1.5) lib/active_support/tagged_logging.rb:69:in `tagged'
railties (5.1.5) lib/rails/rack/logger.rb:24:in `call'
actionpack (5.1.5) lib/action_dispatch/middleware/remote_ip.rb:79:in `call'
actionpack (5.1.5) lib/action_dispatch/middleware/request_id.rb:25:in `call'
rack (2.0.5) lib/rack/method_override.rb:22:in `call'
rack (2.0.5) lib/rack/runtime.rb:22:in `call'
activesupport (5.1.5) lib/active_support/cache/strategy/local_cache_middleware.rb:27:in `call'
actionpack (5.1.5) lib/action_dispatch/middleware/executor.rb:12:in `call'
actionpack (5.1.5) lib/action_dispatch/middleware/static.rb:125:in `call'
rack (2.0.5) lib/rack/sendfile.rb:111:in `call'
railties (5.1.5) lib/rails/engine.rb:522:in `call'
puma (3.11.0) lib/puma/configuration.rb:225:in `call'
puma (3.11.0) lib/puma/server.rb:624:in `handle_request'
puma (3.11.0) lib/puma/server.rb:438:in `process_client'
puma (3.11.0) lib/puma/server.rb:302:in `block in run'
puma (3.11.0) lib/puma/thread_pool.rb:120:in `block in spawn_thread'
logging (2.2.2) lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'
I, [2018-09-18T22:49:53.572855 #6208]  INFO -- : Started GET "/rails/db/tables/activity_streams/data" for ::1 at 2018-09-18 22:49:53 +0530
I, [2018-09-18T22:49:53.584912 #6208]  INFO -- : Processing by RailsDb::TablesController#data as JS
I, [2018-09-18T22:49:53.584989 #6208]  INFO -- :   Parameters: {"table_id"=>"activity_streams"}
D, [2018-09-18T22:49:53.600818 #6208] DEBUG -- :   [1m[35m (7.9ms)[0m  [1m[34mSELECT COUNT(*) FROM "activity_streams"[0m
I, [2018-09-18T22:49:53.634233 #6208]  INFO -- :   Rendering /home/vaibhav/.rvm/gems/ruby-2.4.4/gems/rails_db-2.0.3/app/views/rails_db/tables/data.js.erb
I, [2018-09-18T22:49:53.638002 #6208]  INFO -- :   Rendered /home/vaibhav/.rvm/gems/ruby-2.4.4/gems/rails_db-2.0.3/app/views/rails_db/shared/_exp_col.html.erb (0.2ms)
I, [2018-09-18T22:49:53.653449 #6208]  INFO -- :   Rendered /home/vaibhav/.rvm/gems/ruby-2.4.4/gems/rails_db-2.0.3/app/views/rails_db/tables/_condition_fields.html.erb (9.0ms)
I, [2018-09-18T22:49:53.661656 #6208]  INFO -- :   Rendered /home/vaibhav/.rvm/gems/ruby-2.4.4/gems/rails_db-2.0.3/app/views/rails_db/tables/_condition_fields.html.erb (7.3ms)
D, [2018-09-18T22:49:53.680463 #6208] DEBUG -- :   [1m[36m Load (0.3ms)[0m  [1m[34mSELECT  "activity_streams".* FROM "activity_streams" LIMIT $1 OFFSET $2[0m  [["LIMIT", 25], ["OFFSET", 0]]
I, [2018-09-18T22:49:53.701164 #6208]  INFO -- :   Rendered /home/vaibhav/.rvm/gems/ruby-2.4.4/gems/rails_db-2.0.3/app/views/rails_db/tables/_row.html.erb (7.0ms)
I, [2018-09-18T22:49:53.708097 #6208]  INFO -- :   Rendered /home/vaibhav/.rvm/gems/ruby-2.4.4/gems/rails_db-2.0.3/app/views/rails_db/tables/_row.html.erb (5.0ms)
I, [2018-09-18T22:49:53.714430 #6208]  INFO -- :   Rendered /home/vaibhav/.rvm/gems/ruby-2.4.4/gems/rails_db-2.0.3/app/views/rails_db/tables/_row.html.erb (4.6ms)
I, [2018-09-18T22:49:53.720774 #6208]  INFO -- :   Rendered /home/vaibhav/.rvm/gems/ruby-2.4.4/gems/rails_db-2.0.3/app/views/rails_db/tables/_row.html.erb (4.7ms)
I, [2018-09-18T22:49:53.728044 #6208]  INFO -- :   Rendered /home/vaibhav/.rvm/gems/ruby-2.4.4/gems/rails_db-2.0.3/app/views/rails_db/tables/_row.html.erb (5.5ms)
I, [2018-09-18T22:49:53.734582 #6208]  INFO -- :   Rendered /home/vaibhav/.rvm/gems/ruby-2.4.4/gems/rails_db-2.0.3/app/views/rails_db/tables/_row.html.erb (4.7ms)
I, [2018-09-18T22:49:53.740915 #6208]  INFO -- :   Rendered /home/vaibhav/.rvm/gems/ruby-2.4.4/gems/rails_db-2.0.3/app/views/rails_db/tables/_row.html.erb (4.6ms)
I, [2018-09-18T22:49:53.747178 #6208]  INFO -- :   Rendered /home/vaibhav/.rvm/gems/ruby-2.4.4/gems/rails_db-2.0.3/app/views/rails_db/tables/_row.html.erb (4.6ms)
I, [2018-09-18T22:49:53.753554 #6208]  INFO -- :   Rendered /home/vaibhav/.rvm/gems/ruby-2.4.4/gems/rails_db-2.0.3/app/views/rails_db/tables/_row.html.erb (4.7ms)
I, [2018-09-18T22:49:53.760918 #6208]  INFO -- :   Rendered /home/vaibhav/.rvm/gems/ruby-2.4.4/gems/rails_db-2.0.3/app/views/rails_db/tables/_row.html.erb (5.5ms)
I, [2018-09-18T22:49:53.767343 #6208]  INFO -- :   Rendered /home/vaibhav/.rvm/gems/ruby-2.4.4/gems/rails_db-2.0.3/app/views/rails_db/tables/_row.html.erb (4.7ms)
I, [2018-09-18T22:49:53.773698 #6208]  INFO -- :   Rendered /home/vaibhav/.rvm/gems/ruby-2.4.4/gems/rails_db-2.0.3/app/views/rails_db/tables/_row.html.erb (4.6ms)
I, [2018-09-18T22:49:53.779999 #6208]  INFO -- :   Rendered /home/vaibhav/.rvm/gems/ruby-2.4.4/gems/rails_db-2.0.3/app/views/rails_db/tables/_row.html.erb (4.6ms)
I, [2018-09-18T22:49:53.787289 #6208]  INFO -- :   Rendered /home/vaibhav/.rvm/gems/ruby-2.4.4/gems/rails_db-2.0.3/app/views/rails_db/tables/_row.html.erb (5.5ms)
I, [2018-09-18T22:49:53.794329 #6208]  INFO -- :   Rendered /home/vaibhav/.rvm/gems/ruby-2.4.4/gems/rails_db-2.0.3/app/views/rails_db/tables/_row.html.erb (5.0ms)
I, [2018-09-18T22:49:53.800761 #6208]  INFO -- :   Rendered /home/vaibhav/.rvm/gems/ruby-2.4.4/gems/rails_db-2.0.3/app/views/rails_db/tables/_row.html.erb (4.7ms)
I, [2018-09-18T22:49:53.807088 #6208]  INFO -- :   Rendered /home/vaibhav/.rvm/gems/ruby-2.4.4/gems/rails_db-2.0.3/app/views/rails_db/tables/_row.html.erb (4.6ms)
I, [2018-09-18T22:49:53.813440 #6208]  INFO -- :   Rendered /home/vaibhav/.rvm/gems/ruby-2.4.4/gems/rails_db-2.0.3/app/views/rails_db/tables/_row.html.erb (4.7ms)
I, [2018-09-18T22:49:53.820667 #6208]  INFO -- :   Rendered /home/vaibhav/.rvm/gems/ruby-2.4.4/gems/rails_db-2.0.3/app/views/rails_db/tables/_row.html.erb (5.5ms)
I, [2018-09-18T22:49:53.827165 #6208]  INFO -- :   Rendered /home/vaibhav/.rvm/gems/ruby-2.4.4/gems/rails_db-2.0.3/app/views/rails_db/tables/_row.html.erb (4.7ms)
I, [2018-09-18T22:49:53.833418 #6208]  INFO -- :   Rendered /home/vaibhav/.rvm/gems/ruby-2.4.4/gems/rails_db-2.0.3/app/views/rails_db/tables/_row.html.erb (4.6ms)
I, [2018-09-18T22:49:53.839021 #6208]  INFO -- :   Rendered /home/vaibhav/.rvm/gems/ruby-2.4.4/gems/rails_db-2.0.3/app/views/rails_db/tables/_row.html.erb (4.1ms)
I, [2018-09-18T22:49:53.844538 #6208]  INFO -- :   Rendered /home/vaibhav/.rvm/gems/ruby-2.4.4/gems/rails_db-2.0.3/app/views/rails_db/tables/_row.html.erb (4.0ms)
I, [2018-09-18T22:49:53.851114 #6208]  INFO -- :   Rendered /home/vaibhav/.rvm/gems/ruby-2.4.4/gems/rails_db-2.0.3/app/views/rails_db/tables/_row.html.erb (4.9ms)
I, [2018-09-18T22:49:53.856921 #6208]  INFO -- :   Rendered /home/vaibhav/.rvm/gems/ruby-2.4.4/gems/rails_db-2.0.3/app/views/rails_db/tables/_row.html.erb (4.2ms)
D, [2018-09-18T22:49:53.863981 #6208] DEBUG -- :   [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "activity_streams"[0m
I, [2018-09-18T22:49:53.885009 #6208]  INFO -- :   Rendered /home/vaibhav/.rvm/gems/ruby-2.4.4/gems/rails_db-2.0.3/app/views/rails_db/tables/_sql.html.erb (0.2ms)
I, [2018-09-18T22:49:53.885099 #6208]  INFO -- :   Rendered /home/vaibhav/.rvm/gems/ruby-2.4.4/gems/rails_db-2.0.3/app/views/rails_db/tables/_data.html.erb (249.8ms)
I, [2018-09-18T22:49:53.887464 #6208]  INFO -- :   Rendered /home/vaibhav/.rvm/gems/ruby-2.4.4/gems/rails_db-2.0.3/app/views/rails_db/tables/data.js.erb (253.1ms)
I, [2018-09-18T22:49:53.887646 #6208]  INFO -- : Completed 200 OK in 303ms (Views: 130.1ms | ActiveRecord: 136.8ms)


D, [2018-09-18T22:49:53.888709 #6208] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-18T22:49:53.889327 #6208] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-18T22:49:55.608305 #6208]  INFO -- : Started GET "/rails/db/tables/signatures/data" for ::1 at 2018-09-18 22:49:55 +0530
I, [2018-09-18T22:49:55.633600 #6208]  INFO -- : Processing by RailsDb::TablesController#data as HTML
I, [2018-09-18T22:49:55.633674 #6208]  INFO -- :   Parameters: {"table_id"=>"signatures"}
D, [2018-09-18T22:49:55.644102 #6208] DEBUG -- :   [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "signatures"[0m
I, [2018-09-18T22:49:55.694283 #6208]  INFO -- :   Rendering /home/vaibhav/.rvm/gems/ruby-2.4.4/gems/rails_db-2.0.3/app/views/rails_db/tables/data.html.erb within layouts/rails_db/application
I, [2018-09-18T22:49:55.698134 #6208]  INFO -- :   Rendered /home/vaibhav/.rvm/gems/ruby-2.4.4/gems/rails_db-2.0.3/app/views/rails_db/shared/_exp_col.html.erb (0.3ms)
I, [2018-09-18T22:49:55.716149 #6208]  INFO -- :   Rendered /home/vaibhav/.rvm/gems/ruby-2.4.4/gems/rails_db-2.0.3/app/views/rails_db/tables/_condition_fields.html.erb (10.6ms)
I, [2018-09-18T22:49:55.727951 #6208]  INFO -- :   Rendered /home/vaibhav/.rvm/gems/ruby-2.4.4/gems/rails_db-2.0.3/app/views/rails_db/tables/_condition_fields.html.erb (10.9ms)
D, [2018-09-18T22:49:55.751799 #6208] DEBUG -- :   [1m[36m Load (0.4ms)[0m  [1m[34mSELECT  "signatures".* FROM "signatures" LIMIT $1 OFFSET $2[0m  [["LIMIT", 25], ["OFFSET", 0]]
I, [2018-09-18T22:49:55.783921 #6208]  INFO -- :   Rendered /home/vaibhav/.rvm/gems/ruby-2.4.4/gems/rails_db-2.0.3/app/views/rails_db/tables/_row.html.erb (11.6ms)
I, [2018-09-18T22:49:55.784997 #6208]  INFO -- :   Rendered /home/vaibhav/.rvm/gems/ruby-2.4.4/gems/rails_db-2.0.3/app/views/rails_db/tables/_sql.html.erb (0.3ms)
I, [2018-09-18T22:49:55.785093 #6208]  INFO -- :   Rendered /home/vaibhav/.rvm/gems/ruby-2.4.4/gems/rails_db-2.0.3/app/views/rails_db/tables/_data.html.erb (89.9ms)
I, [2018-09-18T22:49:55.785206 #6208]  INFO -- :   Rendered /home/vaibhav/.rvm/gems/ruby-2.4.4/gems/rails_db-2.0.3/app/views/rails_db/tables/data.html.erb within layouts/rails_db/application (90.8ms)
I, [2018-09-18T22:49:55.798288 #6208]  INFO -- :   Rendered /home/vaibhav/.rvm/gems/ruby-2.4.4/gems/rails_db-2.0.3/app/views/rails_db/shared/_header.html.erb (2.7ms)
I, [2018-09-18T22:49:55.808167 #6208]  INFO -- :   Rendered /home/vaibhav/.rvm/gems/ruby-2.4.4/gems/rails_db-2.0.3/app/views/rails_db/shared/_sidebar.html.erb (9.0ms)
I, [2018-09-18T22:49:55.811322 #6208]  INFO -- :   Rendered /home/vaibhav/.rvm/gems/ruby-2.4.4/gems/rails_db-2.0.3/app/views/rails_db/shared/_gems.html.erb (0.5ms)
I, [2018-09-18T22:49:55.811410 #6208]  INFO -- :   Rendered /home/vaibhav/.rvm/gems/ruby-2.4.4/gems/rails_db-2.0.3/app/views/rails_db/shared/_footer.html.erb (2.6ms)
I, [2018-09-18T22:49:55.811596 #6208]  INFO -- : Completed 200 OK in 178ms (Views: 98.8ms | ActiveRecord: 25.3ms)


D, [2018-09-18T22:49:55.812701 #6208] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-18T22:49:55.813344 #6208] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-18T22:49:55.827533 #6208]  INFO -- : Started GET "/assets/rails_db/application.css" for ::1 at 2018-09-18 22:49:55 +0530
I, [2018-09-18T22:49:55.840818 #6208]  INFO -- : Started GET "/assets/rails_db/application.js" for ::1 at 2018-09-18 22:49:55 +0530
I, [2018-09-18T22:49:55.841821 #6208]  INFO -- : Started GET "/assets/rails_db/logo_mini.png" for ::1 at 2018-09-18 22:49:55 +0530
D, [2018-09-18T22:49:55.878745 #6208] DEBUG -- :   [1m[35m (1.7ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-18T22:49:55.883164 #6208] DEBUG -- :   [1m[35m (3.8ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-18T22:49:55.886551 #6208] DEBUG -- :   [1m[35m (3.5ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-18T22:49:55.887493 #6208] DEBUG -- :   [1m[35m (1.0ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-18T22:49:55.887680 #6208] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-18T22:49:55.890327 #6208] DEBUG -- :   [1m[35m (1.7ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-18T22:49:59.443045 #6208]  INFO -- : Started GET "/rails/db/tables/signatures/destroy?pk_id=1" for ::1 at 2018-09-18 22:49:59 +0530
I, [2018-09-18T22:49:59.461988 #6208]  INFO -- : Processing by RailsDb::TablesController#destroy as JS
I, [2018-09-18T22:49:59.462068 #6208]  INFO -- :   Parameters: {"pk_id"=>"1", "table_id"=>"signatures"}
D, [2018-09-18T22:49:59.470053 #6208] DEBUG -- :   [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "signatures"[0m
D, [2018-09-18T22:49:59.529224 #6208] DEBUG -- :   [1m[35m (1.0ms)[0m  [1m[31mDELETE FROM signatures WHERE id = '1';[0m
I, [2018-09-18T22:49:59.529524 #6208]  INFO -- : Completed 500 Internal Server Error in 67ms (ActiveRecord: 6.5ms)


F, [2018-09-18T22:49:59.530986 #6208] FATAL -- :   
F, [2018-09-18T22:49:59.531047 #6208] FATAL -- : ActiveRecord::InvalidForeignKey (PG::ForeignKeyViolation: ERROR:  update or delete on table "signatures" violates foreign key constraint "fk_rails_5538295cdc" on table "groups"
DETAIL:  Key (id)=(1) is still referenced from table "groups".
: DELETE FROM signatures WHERE id = '1';):
F, [2018-09-18T22:49:59.531095 #6208] FATAL -- :   
F, [2018-09-18T22:49:59.531335 #6208] FATAL -- : activerecord (5.1.5) lib/active_record/connection_adapters/postgresql/database_statements.rb:73:in `async_exec'
activerecord (5.1.5) lib/active_record/connection_adapters/postgresql/database_statements.rb:73:in `block (2 levels) in execute'
activesupport (5.1.5) lib/active_support/dependencies/interlock.rb:46:in `block in permit_concurrent_loads'
activesupport (5.1.5) lib/active_support/concurrency/share_lock.rb:185:in `yield_shares'
activesupport (5.1.5) lib/active_support/dependencies/interlock.rb:45:in `permit_concurrent_loads'
activerecord (5.1.5) lib/active_record/connection_adapters/postgresql/database_statements.rb:72:in `block in execute'
activerecord (5.1.5) lib/active_record/connection_adapters/abstract_adapter.rb:613:in `block (2 levels) in log'
/home/vaibhav/.rvm/rubies/ruby-2.4.4/lib/ruby/2.4.0/monitor.rb:214:in `mon_synchronize'
activerecord (5.1.5) lib/active_record/connection_adapters/abstract_adapter.rb:612:in `block in log'
activesupport (5.1.5) lib/active_support/notifications/instrumenter.rb:21:in `instrument'
activerecord (5.1.5) lib/active_record/connection_adapters/abstract_adapter.rb:604:in `log'
activerecord (5.1.5) lib/active_record/connection_adapters/postgresql/database_statements.rb:71:in `execute'
rails_db (2.0.3) lib/rails_db/adapters/base_adapter.rb:11:in `execute'
rails_db (2.0.3) lib/rails_db/adapters/base_adapter.rb:47:in `delete'
rails_db (2.0.3) lib/rails_db/database.rb:8:in `delete'
rails_db (2.0.3) lib/rails_db/table.rb:46:in `delete'
rails_db (2.0.3) app/controllers/rails_db/tables_controller.rb:56:in `destroy'
actionpack (5.1.5) lib/action_controller/metal/basic_implicit_render.rb:4:in `send_action'
actionpack (5.1.5) lib/abstract_controller/base.rb:186:in `process_action'
actionpack (5.1.5) lib/action_controller/metal/rendering.rb:30:in `process_action'
actionpack (5.1.5) lib/abstract_controller/callbacks.rb:20:in `block in process_action'
activesupport (5.1.5) lib/active_support/callbacks.rb:131:in `run_callbacks'
actionpack (5.1.5) lib/abstract_controller/callbacks.rb:19:in `process_action'
actionpack (5.1.5) lib/action_controller/metal/rescue.rb:20:in `process_action'
actionpack (5.1.5) lib/action_controller/metal/instrumentation.rb:32:in `block in process_action'
activesupport (5.1.5) lib/active_support/notifications.rb:166:in `block in instrument'
activesupport (5.1.5) lib/active_support/notifications/instrumenter.rb:21:in `instrument'
activesupport (5.1.5) lib/active_support/notifications.rb:166:in `instrument'
actionpack (5.1.5) lib/action_controller/metal/instrumentation.rb:30:in `process_action'
actionpack (5.1.5) lib/action_controller/metal/params_wrapper.rb:252:in `process_action'
activerecord (5.1.5) lib/active_record/railties/controller_runtime.rb:22:in `process_action'
actionpack (5.1.5) lib/abstract_controller/base.rb:124:in `process'
actionview (5.1.5) lib/action_view/rendering.rb:30:in `process'
actionpack (5.1.5) lib/action_controller/metal.rb:189:in `dispatch'
actionpack (5.1.5) lib/action_controller/metal.rb:253:in `dispatch'
actionpack (5.1.5) lib/action_dispatch/routing/route_set.rb:49:in `dispatch'
actionpack (5.1.5) lib/action_dispatch/routing/route_set.rb:31:in `serve'
actionpack (5.1.5) lib/action_dispatch/journey/router.rb:50:in `block in serve'
actionpack (5.1.5) lib/action_dispatch/journey/router.rb:33:in `each'
actionpack (5.1.5) lib/action_dispatch/journey/router.rb:33:in `serve'
actionpack (5.1.5) lib/action_dispatch/routing/route_set.rb:844:in `call'
railties (5.1.5) lib/rails/engine.rb:522:in `call'
railties (5.1.5) lib/rails/railtie.rb:185:in `public_send'
railties (5.1.5) lib/rails/railtie.rb:185:in `method_missing'
actionpack (5.1.5) lib/action_dispatch/routing/mapper.rb:17:in `block in <class:Constraints>'
actionpack (5.1.5) lib/action_dispatch/routing/mapper.rb:46:in `serve'
actionpack (5.1.5) lib/action_dispatch/journey/router.rb:50:in `block in serve'
actionpack (5.1.5) lib/action_dispatch/journey/router.rb:33:in `each'
actionpack (5.1.5) lib/action_dispatch/journey/router.rb:33:in `serve'
actionpack (5.1.5) lib/action_dispatch/routing/route_set.rb:844:in `call'
omniauth (1.7.1) lib/omniauth/strategy.rb:190:in `call!'
omniauth (1.7.1) lib/omniauth/strategy.rb:168:in `call'
omniauth (1.7.1) lib/omniauth/strategy.rb:190:in `call!'
omniauth (1.7.1) lib/omniauth/strategy.rb:168:in `call'
omniauth (1.7.1) lib/omniauth/strategy.rb:190:in `call!'
omniauth (1.7.1) lib/omniauth/strategy.rb:168:in `call'
omniauth (1.7.1) lib/omniauth/strategy.rb:190:in `call!'
omniauth (1.7.1) lib/omniauth/strategy.rb:168:in `call'
omniauth (1.7.1) lib/omniauth/strategy.rb:190:in `call!'
omniauth (1.7.1) lib/omniauth/strategy.rb:168:in `call'
omniauth (1.7.1) lib/omniauth/strategy.rb:190:in `call!'
omniauth (1.7.1) lib/omniauth/strategy.rb:168:in `call'
omniauth (1.7.1) lib/omniauth/strategy.rb:190:in `call!'
omniauth (1.7.1) lib/omniauth/strategy.rb:168:in `call'
omniauth (1.7.1) lib/omniauth/strategy.rb:190:in `call!'
omniauth (1.7.1) lib/omniauth/strategy.rb:168:in `call'
omniauth (1.7.1) lib/omniauth/strategy.rb:190:in `call!'
omniauth (1.7.1) lib/omniauth/strategy.rb:168:in `call'
omniauth (1.7.1) lib/omniauth/builder.rb:63:in `call'
rack (2.0.5) lib/rack/etag.rb:25:in `call'
rack (2.0.5) lib/rack/conditional_get.rb:25:in `call'
rack (2.0.5) lib/rack/head.rb:12:in `call'
rack (2.0.5) lib/rack/session/abstract/id.rb:232:in `context'
rack (2.0.5) lib/rack/session/abstract/id.rb:226:in `call'
actionpack (5.1.5) lib/action_dispatch/middleware/cookies.rb:613:in `call'
activerecord (5.1.5) lib/active_record/migration.rb:556:in `call'
actionpack (5.1.5) lib/action_dispatch/middleware/callbacks.rb:26:in `block in call'
activesupport (5.1.5) lib/active_support/callbacks.rb:97:in `run_callbacks'
actionpack (5.1.5) lib/action_dispatch/middleware/callbacks.rb:24:in `call'
actionpack (5.1.5) lib/action_dispatch/middleware/executor.rb:12:in `call'
actionpack (5.1.5) lib/action_dispatch/middleware/debug_exceptions.rb:59:in `call'
actionpack (5.1.5) lib/action_dispatch/middleware/show_exceptions.rb:31:in `call'
railties (5.1.5) lib/rails/rack/logger.rb:36:in `call_app'
railties (5.1.5) lib/rails/rack/logger.rb:24:in `block in call'
activesupport (5.1.5) lib/active_support/tagged_logging.rb:69:in `block in tagged'
activesupport (5.1.5) lib/active_support/tagged_logging.rb:26:in `tagged'
activesupport (5.1.5) lib/active_support/tagged_logging.rb:69:in `tagged'
railties (5.1.5) lib/rails/rack/logger.rb:24:in `call'
actionpack (5.1.5) lib/action_dispatch/middleware/remote_ip.rb:79:in `call'
actionpack (5.1.5) lib/action_dispatch/middleware/request_id.rb:25:in `call'
rack (2.0.5) lib/rack/method_override.rb:22:in `call'
rack (2.0.5) lib/rack/runtime.rb:22:in `call'
activesupport (5.1.5) lib/active_support/cache/strategy/local_cache_middleware.rb:27:in `call'
actionpack (5.1.5) lib/action_dispatch/middleware/executor.rb:12:in `call'
actionpack (5.1.5) lib/action_dispatch/middleware/static.rb:125:in `call'
rack (2.0.5) lib/rack/sendfile.rb:111:in `call'
railties (5.1.5) lib/rails/engine.rb:522:in `call'
puma (3.11.0) lib/puma/configuration.rb:225:in `call'
puma (3.11.0) lib/puma/server.rb:624:in `handle_request'
puma (3.11.0) lib/puma/server.rb:438:in `process_client'
puma (3.11.0) lib/puma/server.rb:302:in `block in run'
puma (3.11.0) lib/puma/thread_pool.rb:120:in `block in spawn_thread'
logging (2.2.2) lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'
I, [2018-09-18T22:50:01.411076 #6208]  INFO -- : Started GET "/rails/db/tables/signatures" for ::1 at 2018-09-18 22:50:01 +0530
I, [2018-09-18T22:50:01.444265 #6208]  INFO -- : Processing by RailsDb::TablesController#show as JS
I, [2018-09-18T22:50:01.444368 #6208]  INFO -- :   Parameters: {"id"=>"signatures"}
I, [2018-09-18T22:50:01.464960 #6208]  INFO -- :   Rendering /home/vaibhav/.rvm/gems/ruby-2.4.4/gems/rails_db-2.0.3/app/views/rails_db/tables/show.js.erb
I, [2018-09-18T22:50:01.475683 #6208]  INFO -- :   Rendered /home/vaibhav/.rvm/gems/ruby-2.4.4/gems/rails_db-2.0.3/app/views/rails_db/shared/_exp_col.html.erb (0.3ms)
I, [2018-09-18T22:50:01.516539 #6208]  INFO -- :   Rendered /home/vaibhav/.rvm/gems/ruby-2.4.4/gems/rails_db-2.0.3/app/views/rails_db/tables/_show.html.erb (46.1ms)
I, [2018-09-18T22:50:01.517228 #6208]  INFO -- :   Rendered /home/vaibhav/.rvm/gems/ruby-2.4.4/gems/rails_db-2.0.3/app/views/rails_db/tables/show.js.erb (52.2ms)
I, [2018-09-18T22:50:01.517430 #6208]  INFO -- : Completed 200 OK in 73ms (Views: 21.7ms | ActiveRecord: 38.2ms)


D, [2018-09-18T22:50:01.518337 #6208] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-18T22:50:01.518947 #6208] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-18T22:50:02.147687 #6208]  INFO -- : Started GET "/rails/db/tables/signatures/data" for ::1 at 2018-09-18 22:50:02 +0530
I, [2018-09-18T22:50:02.179591 #6208]  INFO -- : Processing by RailsDb::TablesController#data as JS
I, [2018-09-18T22:50:02.179697 #6208]  INFO -- :   Parameters: {"table_id"=>"signatures"}
D, [2018-09-18T22:50:02.186690 #6208] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "signatures"[0m
I, [2018-09-18T22:50:02.221201 #6208]  INFO -- :   Rendering /home/vaibhav/.rvm/gems/ruby-2.4.4/gems/rails_db-2.0.3/app/views/rails_db/tables/data.js.erb
I, [2018-09-18T22:50:02.224840 #6208]  INFO -- :   Rendered /home/vaibhav/.rvm/gems/ruby-2.4.4/gems/rails_db-2.0.3/app/views/rails_db/shared/_exp_col.html.erb (0.2ms)
I, [2018-09-18T22:50:02.238403 #6208]  INFO -- :   Rendered /home/vaibhav/.rvm/gems/ruby-2.4.4/gems/rails_db-2.0.3/app/views/rails_db/tables/_condition_fields.html.erb (8.1ms)
I, [2018-09-18T22:50:02.246678 #6208]  INFO -- :   Rendered /home/vaibhav/.rvm/gems/ruby-2.4.4/gems/rails_db-2.0.3/app/views/rails_db/tables/_condition_fields.html.erb (7.0ms)
D, [2018-09-18T22:50:02.265298 #6208] DEBUG -- :   [1m[36m Load (0.2ms)[0m  [1m[34mSELECT  "signatures".* FROM "signatures" LIMIT $1 OFFSET $2[0m  [["LIMIT", 25], ["OFFSET", 0]]
I, [2018-09-18T22:50:02.287788 #6208]  INFO -- :   Rendered /home/vaibhav/.rvm/gems/ruby-2.4.4/gems/rails_db-2.0.3/app/views/rails_db/tables/_row.html.erb (8.7ms)
I, [2018-09-18T22:50:02.288753 #6208]  INFO -- :   Rendered /home/vaibhav/.rvm/gems/ruby-2.4.4/gems/rails_db-2.0.3/app/views/rails_db/tables/_sql.html.erb (0.3ms)
I, [2018-09-18T22:50:02.288833 #6208]  INFO -- :   Rendered /home/vaibhav/.rvm/gems/ruby-2.4.4/gems/rails_db-2.0.3/app/views/rails_db/tables/_data.html.erb (66.5ms)
I, [2018-09-18T22:50:02.289794 #6208]  INFO -- :   Rendered /home/vaibhav/.rvm/gems/ruby-2.4.4/gems/rails_db-2.0.3/app/views/rails_db/tables/data.js.erb (68.5ms)
I, [2018-09-18T22:50:02.289977 #6208]  INFO -- : Completed 200 OK in 110ms (Views: 59.3ms | ActiveRecord: 13.7ms)


D, [2018-09-18T22:50:02.291017 #6208] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-18T22:50:02.291697 #6208] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-18T22:50:04.023535 #6208]  INFO -- : Started GET "/rails/db/tables/signatures/data" for ::1 at 2018-09-18 22:50:04 +0530
I, [2018-09-18T22:50:04.062284 #6208]  INFO -- : Processing by RailsDb::TablesController#data as HTML
I, [2018-09-18T22:50:04.062395 #6208]  INFO -- :   Parameters: {"table_id"=>"signatures"}
D, [2018-09-18T22:50:04.070462 #6208] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "signatures"[0m
I, [2018-09-18T22:50:04.115927 #6208]  INFO -- :   Rendering /home/vaibhav/.rvm/gems/ruby-2.4.4/gems/rails_db-2.0.3/app/views/rails_db/tables/data.html.erb within layouts/rails_db/application
I, [2018-09-18T22:50:04.122101 #6208]  INFO -- :   Rendered /home/vaibhav/.rvm/gems/ruby-2.4.4/gems/rails_db-2.0.3/app/views/rails_db/shared/_exp_col.html.erb (0.4ms)
I, [2018-09-18T22:50:04.139886 #6208]  INFO -- :   Rendered /home/vaibhav/.rvm/gems/ruby-2.4.4/gems/rails_db-2.0.3/app/views/rails_db/tables/_condition_fields.html.erb (10.8ms)
I, [2018-09-18T22:50:04.163505 #6208]  INFO -- :   Rendered /home/vaibhav/.rvm/gems/ruby-2.4.4/gems/rails_db-2.0.3/app/views/rails_db/tables/_condition_fields.html.erb (22.8ms)
D, [2018-09-18T22:50:04.189780 #6208] DEBUG -- :   [1m[36m Load (0.4ms)[0m  [1m[34mSELECT  "signatures".* FROM "signatures" LIMIT $1 OFFSET $2[0m  [["LIMIT", 25], ["OFFSET", 0]]
I, [2018-09-18T22:50:04.219594 #6208]  INFO -- :   Rendered /home/vaibhav/.rvm/gems/ruby-2.4.4/gems/rails_db-2.0.3/app/views/rails_db/tables/_row.html.erb (11.5ms)
I, [2018-09-18T22:50:04.221050 #6208]  INFO -- :   Rendered /home/vaibhav/.rvm/gems/ruby-2.4.4/gems/rails_db-2.0.3/app/views/rails_db/tables/_sql.html.erb (0.5ms)
I, [2018-09-18T22:50:04.221157 #6208]  INFO -- :   Rendered /home/vaibhav/.rvm/gems/ruby-2.4.4/gems/rails_db-2.0.3/app/views/rails_db/tables/_data.html.erb (104.0ms)
I, [2018-09-18T22:50:04.221280 #6208]  INFO -- :   Rendered /home/vaibhav/.rvm/gems/ruby-2.4.4/gems/rails_db-2.0.3/app/views/rails_db/tables/data.html.erb within layouts/rails_db/application (105.2ms)
I, [2018-09-18T22:50:04.233376 #6208]  INFO -- :   Rendered /home/vaibhav/.rvm/gems/ruby-2.4.4/gems/rails_db-2.0.3/app/views/rails_db/shared/_header.html.erb (2.7ms)
I, [2018-09-18T22:50:04.246250 #6208]  INFO -- :   Rendered /home/vaibhav/.rvm/gems/ruby-2.4.4/gems/rails_db-2.0.3/app/views/rails_db/shared/_sidebar.html.erb (12.0ms)
I, [2018-09-18T22:50:04.250141 #6208]  INFO -- :   Rendered /home/vaibhav/.rvm/gems/ruby-2.4.4/gems/rails_db-2.0.3/app/views/rails_db/shared/_gems.html.erb (0.7ms)
I, [2018-09-18T22:50:04.250281 #6208]  INFO -- :   Rendered /home/vaibhav/.rvm/gems/ruby-2.4.4/gems/rails_db-2.0.3/app/views/rails_db/shared/_footer.html.erb (3.4ms)
I, [2018-09-18T22:50:04.250563 #6208]  INFO -- : Completed 200 OK in 188ms (Views: 116.6ms | ActiveRecord: 21.1ms)


D, [2018-09-18T22:50:04.252976 #6208] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-18T22:50:04.253898 #6208] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-18T22:50:04.273728 #6208]  INFO -- : Started GET "/assets/rails_db/application.css" for ::1 at 2018-09-18 22:50:04 +0530
I, [2018-09-18T22:50:04.290403 #6208]  INFO -- : Started GET "/assets/rails_db/application.js" for ::1 at 2018-09-18 22:50:04 +0530
I, [2018-09-18T22:50:04.304549 #6208]  INFO -- : Started GET "/assets/rails_db/logo_mini.png" for ::1 at 2018-09-18 22:50:04 +0530
D, [2018-09-18T22:50:04.329543 #6208] DEBUG -- :   [1m[35m (3.8ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-18T22:50:04.329676 #6208] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-18T22:50:04.331308 #6208] DEBUG -- :   [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-18T22:50:04.331850 #6208] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
D, [2018-09-18T22:50:04.339576 #6208] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-18T22:50:04.340291 #6208] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-18T22:50:06.790327 #6208]  INFO -- : Started GET "/rails/db/tables/signatures/destroy?pk_id=1" for ::1 at 2018-09-18 22:50:06 +0530
I, [2018-09-18T22:50:06.822847 #6208]  INFO -- : Processing by RailsDb::TablesController#destroy as JS
I, [2018-09-18T22:50:06.822944 #6208]  INFO -- :   Parameters: {"pk_id"=>"1", "table_id"=>"signatures"}
D, [2018-09-18T22:50:06.829542 #6208] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "signatures"[0m
D, [2018-09-18T22:50:06.881157 #6208] DEBUG -- :   [1m[35m (0.9ms)[0m  [1m[31mDELETE FROM signatures WHERE id = '1';[0m
I, [2018-09-18T22:50:06.881461 #6208]  INFO -- : Completed 500 Internal Server Error in 58ms (ActiveRecord: 4.6ms)


F, [2018-09-18T22:50:06.883748 #6208] FATAL -- :   
F, [2018-09-18T22:50:06.883849 #6208] FATAL -- : ActiveRecord::InvalidForeignKey (PG::ForeignKeyViolation: ERROR:  update or delete on table "signatures" violates foreign key constraint "fk_rails_5538295cdc" on table "groups"
DETAIL:  Key (id)=(1) is still referenced from table "groups".
: DELETE FROM signatures WHERE id = '1';):
F, [2018-09-18T22:50:06.883910 #6208] FATAL -- :   
F, [2018-09-18T22:50:06.884113 #6208] FATAL -- : activerecord (5.1.5) lib/active_record/connection_adapters/postgresql/database_statements.rb:73:in `async_exec'
activerecord (5.1.5) lib/active_record/connection_adapters/postgresql/database_statements.rb:73:in `block (2 levels) in execute'
activesupport (5.1.5) lib/active_support/dependencies/interlock.rb:46:in `block in permit_concurrent_loads'
activesupport (5.1.5) lib/active_support/concurrency/share_lock.rb:185:in `yield_shares'
activesupport (5.1.5) lib/active_support/dependencies/interlock.rb:45:in `permit_concurrent_loads'
activerecord (5.1.5) lib/active_record/connection_adapters/postgresql/database_statements.rb:72:in `block in execute'
activerecord (5.1.5) lib/active_record/connection_adapters/abstract_adapter.rb:613:in `block (2 levels) in log'
/home/vaibhav/.rvm/rubies/ruby-2.4.4/lib/ruby/2.4.0/monitor.rb:214:in `mon_synchronize'
activerecord (5.1.5) lib/active_record/connection_adapters/abstract_adapter.rb:612:in `block in log'
activesupport (5.1.5) lib/active_support/notifications/instrumenter.rb:21:in `instrument'
activerecord (5.1.5) lib/active_record/connection_adapters/abstract_adapter.rb:604:in `log'
activerecord (5.1.5) lib/active_record/connection_adapters/postgresql/database_statements.rb:71:in `execute'
rails_db (2.0.3) lib/rails_db/adapters/base_adapter.rb:11:in `execute'
rails_db (2.0.3) lib/rails_db/adapters/base_adapter.rb:47:in `delete'
rails_db (2.0.3) lib/rails_db/database.rb:8:in `delete'
rails_db (2.0.3) lib/rails_db/table.rb:46:in `delete'
rails_db (2.0.3) app/controllers/rails_db/tables_controller.rb:56:in `destroy'
actionpack (5.1.5) lib/action_controller/metal/basic_implicit_render.rb:4:in `send_action'
actionpack (5.1.5) lib/abstract_controller/base.rb:186:in `process_action'
actionpack (5.1.5) lib/action_controller/metal/rendering.rb:30:in `process_action'
actionpack (5.1.5) lib/abstract_controller/callbacks.rb:20:in `block in process_action'
activesupport (5.1.5) lib/active_support/callbacks.rb:131:in `run_callbacks'
actionpack (5.1.5) lib/abstract_controller/callbacks.rb:19:in `process_action'
actionpack (5.1.5) lib/action_controller/metal/rescue.rb:20:in `process_action'
actionpack (5.1.5) lib/action_controller/metal/instrumentation.rb:32:in `block in process_action'
activesupport (5.1.5) lib/active_support/notifications.rb:166:in `block in instrument'
activesupport (5.1.5) lib/active_support/notifications/instrumenter.rb:21:in `instrument'
activesupport (5.1.5) lib/active_support/notifications.rb:166:in `instrument'
actionpack (5.1.5) lib/action_controller/metal/instrumentation.rb:30:in `process_action'
actionpack (5.1.5) lib/action_controller/metal/params_wrapper.rb:252:in `process_action'
activerecord (5.1.5) lib/active_record/railties/controller_runtime.rb:22:in `process_action'
actionpack (5.1.5) lib/abstract_controller/base.rb:124:in `process'
actionview (5.1.5) lib/action_view/rendering.rb:30:in `process'
actionpack (5.1.5) lib/action_controller/metal.rb:189:in `dispatch'
actionpack (5.1.5) lib/action_controller/metal.rb:253:in `dispatch'
actionpack (5.1.5) lib/action_dispatch/routing/route_set.rb:49:in `dispatch'
actionpack (5.1.5) lib/action_dispatch/routing/route_set.rb:31:in `serve'
actionpack (5.1.5) lib/action_dispatch/journey/router.rb:50:in `block in serve'
actionpack (5.1.5) lib/action_dispatch/journey/router.rb:33:in `each'
actionpack (5.1.5) lib/action_dispatch/journey/router.rb:33:in `serve'
actionpack (5.1.5) lib/action_dispatch/routing/route_set.rb:844:in `call'
railties (5.1.5) lib/rails/engine.rb:522:in `call'
railties (5.1.5) lib/rails/railtie.rb:185:in `public_send'
railties (5.1.5) lib/rails/railtie.rb:185:in `method_missing'
actionpack (5.1.5) lib/action_dispatch/routing/mapper.rb:17:in `block in <class:Constraints>'
actionpack (5.1.5) lib/action_dispatch/routing/mapper.rb:46:in `serve'
actionpack (5.1.5) lib/action_dispatch/journey/router.rb:50:in `block in serve'
actionpack (5.1.5) lib/action_dispatch/journey/router.rb:33:in `each'
actionpack (5.1.5) lib/action_dispatch/journey/router.rb:33:in `serve'
actionpack (5.1.5) lib/action_dispatch/routing/route_set.rb:844:in `call'
omniauth (1.7.1) lib/omniauth/strategy.rb:190:in `call!'
omniauth (1.7.1) lib/omniauth/strategy.rb:168:in `call'
omniauth (1.7.1) lib/omniauth/strategy.rb:190:in `call!'
omniauth (1.7.1) lib/omniauth/strategy.rb:168:in `call'
omniauth (1.7.1) lib/omniauth/strategy.rb:190:in `call!'
omniauth (1.7.1) lib/omniauth/strategy.rb:168:in `call'
omniauth (1.7.1) lib/omniauth/strategy.rb:190:in `call!'
omniauth (1.7.1) lib/omniauth/strategy.rb:168:in `call'
omniauth (1.7.1) lib/omniauth/strategy.rb:190:in `call!'
omniauth (1.7.1) lib/omniauth/strategy.rb:168:in `call'
omniauth (1.7.1) lib/omniauth/strategy.rb:190:in `call!'
omniauth (1.7.1) lib/omniauth/strategy.rb:168:in `call'
omniauth (1.7.1) lib/omniauth/strategy.rb:190:in `call!'
omniauth (1.7.1) lib/omniauth/strategy.rb:168:in `call'
omniauth (1.7.1) lib/omniauth/strategy.rb:190:in `call!'
omniauth (1.7.1) lib/omniauth/strategy.rb:168:in `call'
omniauth (1.7.1) lib/omniauth/strategy.rb:190:in `call!'
omniauth (1.7.1) lib/omniauth/strategy.rb:168:in `call'
omniauth (1.7.1) lib/omniauth/builder.rb:63:in `call'
rack (2.0.5) lib/rack/etag.rb:25:in `call'
rack (2.0.5) lib/rack/conditional_get.rb:25:in `call'
rack (2.0.5) lib/rack/head.rb:12:in `call'
rack (2.0.5) lib/rack/session/abstract/id.rb:232:in `context'
rack (2.0.5) lib/rack/session/abstract/id.rb:226:in `call'
actionpack (5.1.5) lib/action_dispatch/middleware/cookies.rb:613:in `call'
activerecord (5.1.5) lib/active_record/migration.rb:556:in `call'
actionpack (5.1.5) lib/action_dispatch/middleware/callbacks.rb:26:in `block in call'
activesupport (5.1.5) lib/active_support/callbacks.rb:97:in `run_callbacks'
actionpack (5.1.5) lib/action_dispatch/middleware/callbacks.rb:24:in `call'
actionpack (5.1.5) lib/action_dispatch/middleware/executor.rb:12:in `call'
actionpack (5.1.5) lib/action_dispatch/middleware/debug_exceptions.rb:59:in `call'
actionpack (5.1.5) lib/action_dispatch/middleware/show_exceptions.rb:31:in `call'
railties (5.1.5) lib/rails/rack/logger.rb:36:in `call_app'
railties (5.1.5) lib/rails/rack/logger.rb:24:in `block in call'
activesupport (5.1.5) lib/active_support/tagged_logging.rb:69:in `block in tagged'
activesupport (5.1.5) lib/active_support/tagged_logging.rb:26:in `tagged'
activesupport (5.1.5) lib/active_support/tagged_logging.rb:69:in `tagged'
railties (5.1.5) lib/rails/rack/logger.rb:24:in `call'
actionpack (5.1.5) lib/action_dispatch/middleware/remote_ip.rb:79:in `call'
actionpack (5.1.5) lib/action_dispatch/middleware/request_id.rb:25:in `call'
rack (2.0.5) lib/rack/method_override.rb:22:in `call'
rack (2.0.5) lib/rack/runtime.rb:22:in `call'
activesupport (5.1.5) lib/active_support/cache/strategy/local_cache_middleware.rb:27:in `call'
actionpack (5.1.5) lib/action_dispatch/middleware/executor.rb:12:in `call'
actionpack (5.1.5) lib/action_dispatch/middleware/static.rb:125:in `call'
rack (2.0.5) lib/rack/sendfile.rb:111:in `call'
railties (5.1.5) lib/rails/engine.rb:522:in `call'
puma (3.11.0) lib/puma/configuration.rb:225:in `call'
puma (3.11.0) lib/puma/server.rb:624:in `handle_request'
puma (3.11.0) lib/puma/server.rb:438:in `process_client'
puma (3.11.0) lib/puma/server.rb:302:in `block in run'
puma (3.11.0) lib/puma/thread_pool.rb:120:in `block in spawn_thread'
logging (2.2.2) lib/logging/diagnostic_context.rb:474:in `block in create_with_logging_context'
D, [2018-09-18T22:50:30.870119 #5911] DEBUG -- :   [1m[35mSQL (1.9ms)[0m  [1m[31mDELETE FROM "users"[0m
D, [2018-09-18T22:50:40.324371 #5911] DEBUG -- :   [1m[35mSQL (1.0ms)[0m  [1m[31mDELETE FROM "signatures"[0m
D, [2018-09-18T22:50:57.054099 #5911] DEBUG -- :   [1m[35mSQL (7.5ms)[0m  [1m[31mDELETE FROM "groups"[0m
D, [2018-09-18T22:51:24.257206 #6382] DEBUG -- :   [1m[35m (0.0ms)[0m  [1m[35mSHOW server_version;[0m
D, [2018-09-18T22:51:24.293162 #6382] DEBUG -- :   [1m[36mStore Load (0.5ms)[0m  [1m[34mSELECT "stores".* FROM "stores" WHERE "stores"."store_object_id" = 3 AND "stores"."o_id" = $1 ORDER BY created_at ASC, id ASC[0m  [["o_id", 2]]
D, [2018-09-18T22:51:24.303911 #6382] DEBUG -- :   [1m[36mStore Load (0.2ms)[0m  [1m[34mSELECT  "stores".* FROM "stores" WHERE "stores"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
D, [2018-09-18T22:51:24.306070 #6382] DEBUG -- :   [1m[36mStore::File Load (0.3ms)[0m  [1m[34mSELECT  "store_files".* FROM "store_files" WHERE "store_files"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-18T22:51:24.312980 #6382] DEBUG -- :   [1m[36mStore::Provider::DB Load (0.3ms)[0m  [1m[34mSELECT  "store_provider_dbs".* FROM "store_provider_dbs" WHERE "store_provider_dbs"."sha" = $1 LIMIT $2[0m  [["sha", "8180fbd3b72f3fbf6e4e22d187ee0632ad7b63f72c6bcf22e59ed4d0ba381b24"], ["LIMIT", 1]]
D, [2018-09-18T22:51:24.318214 #6382] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT  "settings".* FROM "settings" WHERE "settings"."name" = $1 LIMIT $2[0m  [["name", "product_logo"], ["LIMIT", 1]]
D, [2018-09-18T22:51:24.326130 #6382] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-18T22:51:24.332574 #6382] DEBUG -- : Setting.reset_change_id: set new cache, 659806135
D, [2018-09-18T22:51:24.333045 #6382] DEBUG -- :   [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-18T22:51:24.333746 #6382]  INFO -- : Setting.set('product_logo', "73a4aa758e6629c9ad420d2e312af0a0.png")
D, [2018-09-18T22:51:24.334183 #6382] DEBUG -- :   [1m[36mStore::File Load (0.2ms)[0m  [1m[34mSELECT  "store_files".* FROM "store_files" WHERE "store_files"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-18T22:51:24.334687 #6382] DEBUG -- :   [1m[36mStore::Provider::DB Load (0.2ms)[0m  [1m[34mSELECT  "store_provider_dbs".* FROM "store_provider_dbs" WHERE "store_provider_dbs"."sha" = $1 LIMIT $2[0m  [["sha", "8180fbd3b72f3fbf6e4e22d187ee0632ad7b63f72c6bcf22e59ed4d0ba381b24"], ["LIMIT", 1]]
D, [2018-09-18T22:51:24.335256 #6382] DEBUG -- :   [1m[36mStore::File Load (0.2ms)[0m  [1m[34mSELECT  "store_files".* FROM "store_files" WHERE "store_files"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-18T22:51:24.335684 #6382] DEBUG -- :   [1m[36mStore::Provider::DB Load (0.2ms)[0m  [1m[34mSELECT  "store_provider_dbs".* FROM "store_provider_dbs" WHERE "store_provider_dbs"."sha" = $1 LIMIT $2[0m  [["sha", "8180fbd3b72f3fbf6e4e22d187ee0632ad7b63f72c6bcf22e59ed4d0ba381b24"], ["LIMIT", 1]]
D, [2018-09-18T22:51:25.078111 #6382] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT  "settings"."updated_at" FROM "settings" ORDER BY "settings"."updated_at" DESC LIMIT $1[0m  [["LIMIT", 1]]
D, [2018-09-18T22:51:25.078753 #6382] DEBUG -- :   [1m[35m (0.3ms)[0m  [1m[34mSELECT "settings"."name", "settings"."state_current" FROM "settings" ORDER BY "settings"."id" ASC[0m
D, [2018-09-18T22:51:25.088521 #6382] DEBUG -- :   [1m[36mSetting Load (0.2ms)[0m  [1m[34mSELECT  "settings".* FROM "settings" WHERE "settings"."name" = $1 LIMIT $2[0m  [["name", "models_searchable"], ["LIMIT", 1]]
D, [2018-09-28T23:48:05.369711 #3925] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mSHOW server_version;[0m
D, [2018-09-28T23:48:05.441510 #3925] DEBUG -- :   [1m[36mStore::Object Load (2.2ms)[0m  [1m[34mSELECT  "store_objects".* FROM "store_objects" WHERE "store_objects"."name" = $1 LIMIT $2[0m  [["name", "System::Logo"], ["LIMIT", 1]]
D, [2018-09-28T23:48:05.461459 #3925] DEBUG -- :   [1m[36mStore Load (2.0ms)[0m  [1m[34mSELECT "stores".* FROM "stores" WHERE "stores"."store_object_id" = 3 AND "stores"."o_id" = $1 ORDER BY created_at ASC, id ASC[0m  [["o_id", 2]]
D, [2018-09-28T23:48:05.475286 #3925] DEBUG -- :   [1m[36mStore Load (0.3ms)[0m  [1m[34mSELECT  "stores".* FROM "stores" WHERE "stores"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
D, [2018-09-28T23:48:05.480122 #3925] DEBUG -- :   [1m[36mStore::File Load (1.5ms)[0m  [1m[34mSELECT  "store_files".* FROM "store_files" WHERE "store_files"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-28T23:48:05.494540 #3925] DEBUG -- :   [1m[36mStore::Provider::DB Load (2.3ms)[0m  [1m[34mSELECT  "store_provider_dbs".* FROM "store_provider_dbs" WHERE "store_provider_dbs"."sha" = $1 LIMIT $2[0m  [["sha", "8180fbd3b72f3fbf6e4e22d187ee0632ad7b63f72c6bcf22e59ed4d0ba381b24"], ["LIMIT", 1]]
D, [2018-09-28T23:48:05.505730 #3925] DEBUG -- :   [1m[36mSetting Load (1.8ms)[0m  [1m[34mSELECT  "settings".* FROM "settings" WHERE "settings"."name" = $1 LIMIT $2[0m  [["name", "product_logo"], ["LIMIT", 1]]
D, [2018-09-28T23:48:05.520505 #3925] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
D, [2018-09-28T23:48:05.540858 #3925] DEBUG -- : Setting.reset_change_id: set new cache, 312961781
D, [2018-09-28T23:48:05.541903 #3925] DEBUG -- :   [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
I, [2018-09-28T23:48:05.543444 #3925]  INFO -- : Setting.set('product_logo', "73a4aa758e6629c9ad420d2e312af0a0.png")
D, [2018-09-28T23:48:05.544189 #3925] DEBUG -- :   [1m[36mStore::File Load (0.3ms)[0m  [1m[34mSELECT  "store_files".* FROM "store_files" WHERE "store_files"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-28T23:48:05.545105 #3925] DEBUG -- :   [1m[36mStore::Provider::DB Load (0.3ms)[0m  [1m[34mSELECT  "store_provider_dbs".* FROM "store_provider_dbs" WHERE "store_provider_dbs"."sha" = $1 LIMIT $2[0m  [["sha", "8180fbd3b72f3fbf6e4e22d187ee0632ad7b63f72c6bcf22e59ed4d0ba381b24"], ["LIMIT", 1]]
D, [2018-09-28T23:48:05.546480 #3925] DEBUG -- :   [1m[36mStore::File Load (0.3ms)[0m  [1m[34mSELECT  "store_files".* FROM "store_files" WHERE "store_files"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
D, [2018-09-28T23:48:05.547277 #3925] DEBUG -- :   [1m[36mStore::Provider::DB Load (0.3ms)[0m  [1m[34mSELECT  "store_provider_dbs".* FROM "store_provider_dbs" WHERE "store_provider_dbs"."sha" = $1 LIMIT $2[0m  [["sha", "8180fbd3b72f3fbf6e4e22d187ee0632ad7b63f72c6bcf22e59ed4d0ba381b24"], ["LIMIT", 1]]
D, [2018-09-28T23:48:06.796967 #3925] DEBUG -- :   [1m[35m (0.4ms)[0m  [1m[34mSELECT  "settings"."updated_at" FROM "settings" ORDER BY "settings"."updated_at" DESC LIMIT $1[0m  [["LIMIT", 1]]
D, [2018-09-28T23:48:06.798041 #3925] DEBUG -- :   [1m[35m (0.5ms)[0m  [1m[34mSELECT "settings"."name", "settings"."state_current" FROM "settings" ORDER BY "settings"."id" ASC[0m
D, [2018-09-28T23:48:06.816378 #3925] DEBUG -- :   [1m[36mSetting Load (0.3ms)[0m  [1m[34mSELECT  "settings".* FROM "settings" WHERE "settings"."name" = $1 LIMIT $2[0m  [["name", "models_searchable"], ["LIMIT", 1]]
